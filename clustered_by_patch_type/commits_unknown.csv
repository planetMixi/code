vuln_id,code_diff
GHSA-35m5-8cvj-8783,"From e652d56ac60eadfc26489ab83927af13a9b9d8ce Mon Sep 17 00:00:00 2001
From: Morgan-Phoenix <73711602+Morgan-Phoenix@users.noreply.github.com>
Date: Sat, 6 Nov 2021 19:34:45 +0530
Subject: [PATCH] Fixed GHSA-35m5-8cvj-8783

---
 enrocrypt/hashing.py | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/enrocrypt/hashing.py b/enrocrypt/hashing.py
index 275d2e3..14328f0 100644
--- a/enrocrypt/hashing.py
+++ b/enrocrypt/hashing.py
@@ -66,11 +66,6 @@ def SHA244(self,data:str):
         hash = str(sha.digest())
         return self.__Salt(hash,salt=self.salt)
 
-    def MD5(self,data:str):
-        sha = hashlib.md5(bytes(data.encode()))
-        hash = str(sha.digest())
-        return self.__Salt(hash,salt=self.salt)
-
     def SHA384(self,data:str):
         sha = hashlib.sha384(bytes(data.encode()))
         hash = str(sha.digest())"
CVE-2017-18174,"From 8dca4a41f1ad65043a78c2338d9725f859c8d2c3 Mon Sep 17 00:00:00 2001
From: Wei Yongjun <weiyongjun1@huawei.com>
Date: Tue, 17 Jan 2017 15:55:32 +0000
Subject: [PATCH] pinctrl/amd: Drop pinctrl_unregister for devm_ registered
 device

It's not necessary to unregister pin controller device registered
with devm_pinctrl_register() and using pinctrl_unregister() leads
to a double free.

Fixes: 3bfd44306c65 (""pinctrl: amd: Add support for additional GPIO"")
Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com>
Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
---
 drivers/pinctrl/pinctrl-amd.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/drivers/pinctrl/pinctrl-amd.c b/drivers/pinctrl/pinctrl-amd.c
index 1ee107f147d04f..6b75bd2b71db38 100644
--- a/drivers/pinctrl/pinctrl-amd.c
+++ b/drivers/pinctrl/pinctrl-amd.c
@@ -836,7 +836,6 @@ static int amd_gpio_remove(struct platform_device *pdev)
 	gpio_dev = platform_get_drvdata(pdev);
 
 	gpiochip_remove(&gpio_dev->gc);
-	pinctrl_unregister(gpio_dev->pctrl);
 
 	return 0;
 }"
GHSA-fx95-883v-4q4h,"From 6b5bc7bb304975147b4af68df54ac214ed2554c1 Mon Sep 17 00:00:00 2001
From: Erik Dubbelboer <erik@dubbelboer.com>
Date: Mon, 28 Feb 2022 11:56:59 +0100
Subject: [PATCH] Add windows support to normalizePath

This is probably still not 100% sure and there are still many bugs with
FS on windows. But it's a slight improvement.

Fixes #1226
---
 strings.go | 34 ++++++++++++++++++---------------
 uri.go     | 55 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 74 insertions(+), 15 deletions(-)

diff --git a/strings.go b/strings.go
index e4fb08bdac..370e307989 100644
--- a/strings.go
+++ b/strings.go
@@ -7,21 +7,25 @@ var (
 )
 
 var (
-	strSlash            = []byte(""/"")
-	strSlashSlash       = []byte(""//"")
-	strSlashDotDot      = []byte(""/.."")
-	strSlashDotSlash    = []byte(""/./"")
-	strSlashDotDotSlash = []byte(""/../"")
-	strCRLF             = []byte(""\r\n"")
-	strHTTP             = []byte(""http"")
-	strHTTPS            = []byte(""https"")
-	strHTTP10           = []byte(""HTTP/1.0"")
-	strHTTP11           = []byte(""HTTP/1.1"")
-	strColon            = []byte("":"")
-	strColonSlashSlash  = []byte(""://"")
-	strColonSpace       = []byte("": "")
-	strCommaSpace       = []byte("", "")
-	strGMT              = []byte(""GMT"")
+	strSlash                    = []byte(""/"")
+	strSlashSlash               = []byte(""//"")
+	strSlashDotDot              = []byte(""/.."")
+	strSlashDotSlash            = []byte(""/./"")
+	strSlashDotDotSlash         = []byte(""/../"")
+	strBackSlashDotDot          = []byte(`\..`)
+	strBackSlashDotBackSlash    = []byte(`\.\`)
+	strSlashDotDotBackSlash     = []byte(`/..\`)
+	strBackSlashDotDotBackSlash = []byte(`\..\`)
+	strCRLF                     = []byte(""\r\n"")
+	strHTTP                     = []byte(""http"")
+	strHTTPS                    = []byte(""https"")
+	strHTTP10                   = []byte(""HTTP/1.0"")
+	strHTTP11                   = []byte(""HTTP/1.1"")
+	strColon                    = []byte("":"")
+	strColonSlashSlash          = []byte(""://"")
+	strColonSpace               = []byte("": "")
+	strCommaSpace               = []byte("", "")
+	strGMT                      = []byte(""GMT"")
 
 	strResponseContinue = []byte(""HTTP/1.1 100 Continue\r\n\r\n"")
 
diff --git a/uri.go b/uri.go
index 62974df896..38a431e1d0 100644
--- a/uri.go
+++ b/uri.go
@@ -5,6 +5,7 @@ import (
 	""errors""
 	""fmt""
 	""io""
+	""path/filepath""
 	""strconv""
 	""sync""
 )
@@ -634,6 +635,60 @@ func normalizePath(dst, src []byte) []byte {
 		b = b[:nn+1]
 	}
 
+	if filepath.Separator == '\\' {
+		// remove \.\ parts
+		b = dst
+		for {
+			n := bytes.Index(b, strBackSlashDotBackSlash)
+			if n < 0 {
+				break
+			}
+			nn := n + len(strSlashDotSlash) - 1
+			copy(b[n:], b[nn:])
+			b = b[:len(b)-nn+n]
+		}
+
+		// remove /foo/..\ parts
+		for {
+			n := bytes.Index(b, strSlashDotDotBackSlash)
+			if n < 0 {
+				break
+			}
+			nn := bytes.LastIndexByte(b[:n], '/')
+			if nn < 0 {
+				nn = 0
+			}
+			n += len(strSlashDotDotBackSlash) - 1
+			copy(b[nn:], b[n:])
+			b = b[:len(b)-n+nn]
+		}
+
+		// remove /foo\..\ parts
+		for {
+			n := bytes.Index(b, strBackSlashDotDotBackSlash)
+			if n < 0 {
+				break
+			}
+			nn := bytes.LastIndexByte(b[:n], '/')
+			if nn < 0 {
+				nn = 0
+			}
+			n += len(strBackSlashDotDotBackSlash) - 1
+			copy(b[nn:], b[n:])
+			b = b[:len(b)-n+nn]
+		}
+
+		// remove trailing \foo\..
+		n := bytes.LastIndex(b, strBackSlashDotDot)
+		if n >= 0 && n+len(strSlashDotDot) == len(b) {
+			nn := bytes.LastIndexByte(b[:n], '/')
+			if nn < 0 {
+				return append(dst[:0], strSlash...)
+			}
+			b = b[:nn+1]
+		}
+	}
+
 	return b
 }"
PYSEC-2017-30,"From b49d0d4b5ca5c6f31f03e2caf97cef1088eeed81 Mon Sep 17 00:00:00 2001
From: Colton Myers <colton.myers@gmail.com>
Date: Wed, 25 Mar 2015 14:29:26 -0600
Subject: [PATCH] Create randomized logfile name in windows for chef.py

---
 salt/modules/chef.py | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)

diff --git a/salt/modules/chef.py b/salt/modules/chef.py
index 36eb6ff72de5..9c6d928fc3b9 100644
--- a/salt/modules/chef.py
+++ b/salt/modules/chef.py
@@ -6,6 +6,7 @@
 # Import Python libs
 import logging
 import os
+import tempfile
 
 # Import Salt libs
 import salt.utils
@@ -24,12 +25,16 @@ def __virtual__():
 
 
 def _default_logfile(exe_name):
-
+    '''
+    Retrieve the logfile name
+    '''
     if salt.utils.is_windows():
-        logfile = salt.utils.path_join(
-            os.environ['TMP'],
-            '{0}.log'.format(exe_name)
-        )
+        logfile_tmp = tempfile.NamedTemporaryFile(dir=os.environ['TMP'],
+                                                  prefix=exe_name,
+                                                  suffix='.log',
+                                                  delete=False)
+        logfile = logfile_tmp.name
+        logfile_tmp.close()
     else:
         logfile = salt.utils.path_join(
             '/var/log',"
CVE-2012-6544,"From 792039c73cf176c8e39a6e8beef2c94ff46522ed Mon Sep 17 00:00:00 2001
From: Mathias Krause <minipli@googlemail.com>
Date: Wed, 15 Aug 2012 11:31:51 +0000
Subject: [PATCH] Bluetooth: L2CAP - Fix info leak via getsockname()

The L2CAP code fails to initialize the l2_bdaddr_type member of struct
sockaddr_l2 and the padding byte added for alignment. It that for leaks
two bytes kernel stack via the getsockname() syscall. Add an explicit
memset(0) before filling the structure to avoid the info leak.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Cc: Marcel Holtmann <marcel@holtmann.org>
Cc: Gustavo Padovan <gustavo@padovan.org>
Cc: Johan Hedberg <johan.hedberg@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
---
 net/bluetooth/l2cap_sock.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/net/bluetooth/l2cap_sock.c b/net/bluetooth/l2cap_sock.c
index b94abd30e6f948..1497edd191a2e0 100644
--- a/net/bluetooth/l2cap_sock.c
+++ b/net/bluetooth/l2cap_sock.c
@@ -245,6 +245,7 @@ static int l2cap_sock_getname(struct socket *sock, struct sockaddr *addr, int *l
 
 	BT_DBG(""sock %p, sk %p"", sock, sk);
 
+	memset(la, 0, sizeof(struct sockaddr_l2));
 	addr->sa_family = AF_BLUETOOTH;
 	*len = sizeof(struct sockaddr_l2);"
CVE-2013-7262,"From 3a10f6b829297dae63492a8c63385044bc6953ed Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@mines-paris.org>
Date: Tue, 31 Dec 2013 13:54:40 +0100
Subject: [PATCH] Fix potential SQL Injection with postgis TIME filters (#4834)

---
 mappostgis.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/mappostgis.c b/mappostgis.c
index 1f4c64eba1..f24d9697a3 100644
--- a/mappostgis.c
+++ b/mappostgis.c
@@ -3212,6 +3212,11 @@ int msPostGISLayerSetTimeFilter(layerObj *lp, const char *timestring, const char
   if (!lp || !timestring || !timefield)
     return MS_FALSE;
 
+  if( strchr(timestring,'\'') || strchr(timestring, '\\') ) {
+     msSetError(MS_MISCERR, ""Invalid time filter."", ""msPostGISLayerSetTimeFilter()"");
+     return MS_FALSE;
+  }
+
   /* discrete time */
   if (strstr(timestring, "","") == NULL &&
       strstr(timestring, ""/"") == NULL) { /* discrete time */"
CVE-2020-22783,"From 53f126082a8b3d094e48b159f0f0bc8a5db4b2f4 Mon Sep 17 00:00:00 2001
From: John McLear <john@mclear.co.uk>
Date: Sun, 29 Mar 2020 09:35:20 +0000
Subject: [PATCH] SessionStore: replace password with PASSWORD_HIDDEN when
 storing in db

Fixes #3421.
---
 src/node/db/SessionStore.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/src/node/db/SessionStore.js b/src/node/db/SessionStore.js
index 647cbbc8d9f..263c7d6eefe 100644
--- a/src/node/db/SessionStore.js
+++ b/src/node/db/SessionStore.js
@@ -38,6 +38,11 @@ SessionStore.prototype.get = function(sid, fn) {
 SessionStore.prototype.set = function(sid, sess, fn) {
   messageLogger.debug('SET ' + sid);
 
+  // don't store passwords in DB
+  if (sess.user && sess.user.password) {
+    sess.user.password = ""PASSWORD_HIDDEN"";
+  }
+
   db.set(""sessionstorage:"" + sid, sess);
   if (fn) {
     process.nextTick(fn);"
CVE-2017-9142,"From f0232a2a45dfd003c1faf6079497895df3ab0ee1 Mon Sep 17 00:00:00 2001
From: Dirk Lemstra <dirk@git.imagemagick.org>
Date: Mon, 15 May 2017 21:18:13 +0200
Subject: [PATCH] Fixed incorrect call to WriteBlob reported in #490.

---
 coders/png.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/coders/png.c b/coders/png.c
index c194d08585c..cfd68440066 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -4782,10 +4782,11 @@ static Image *ReadOneJNGImage(MngInfo *mng_info,
           (void) LogMagickEvent(CoderEvent,GetMagickModule(),
             ""    Copying JDAT chunk data to color_blob."");
 
-        (void) WriteBlob(color_image,length,chunk);
-
         if (length != 0)
-          chunk=(unsigned char *) RelinquishMagickMemory(chunk);
+          {
+            (void) WriteBlob(color_image,length,chunk);
+            chunk=(unsigned char *) RelinquishMagickMemory(chunk);
+          }
 
         continue;
       }"
OSV-2020-2094,"From c2e33ae40af02fabe59b51637501a5be73583a15 Mon Sep 17 00:00:00 2001
From: davkor <david@adalogics.com>
Date: Sat, 31 Oct 2020 14:23:00 +0000
Subject: [PATCH] utils: fix case of empty string in time to sec conversion
 (oss-fuzz 26593)

Signed-off-by: davkor <david@adalogics.com>
---
 src/flb_utils.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/flb_utils.c b/src/flb_utils.c
index 8f46f025c07..ab0bcc737b7 100644
--- a/src/flb_utils.c
+++ b/src/flb_utils.c
@@ -471,6 +471,9 @@ int flb_utils_time_to_seconds(const char *time)
     size_t val;
 
     len = strlen(time);
+    if (len == 0) {
+        return 0;
+    }
     val = atoi(time);
 
     /* String time to seconds */"
GHSA-fq9f-9wv9-rfmg,"From fe77d1c3dbf91ddf2a9f8e5ed882611455ab00d0 Mon Sep 17 00:00:00 2001
From: Jesse Glick <jglick@cloudbees.com>
Date: Fri, 29 Sep 2017 09:39:32 -0400
Subject: [PATCH] [SECURITY-555] Patch Commons HttpClient 3.x.

---
 pom.xml | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/pom.xml b/pom.xml
index 44cdd69f42f1..53d19aaee1b2 100644
--- a/pom.xml
+++ b/pom.xml
@@ -164,7 +164,7 @@ THE SOFTWARE.
       <dependency>
         <groupId>commons-httpclient</groupId>
         <artifactId>commons-httpclient</artifactId>
-        <version>3.1</version>
+        <version>3.1-jenkins-1</version>
       </dependency>
 
       <dependency>"
CVE-2017-7854,"From d2632f6483a3ceb5d8e0a5fb11142c51c43978b4 Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Thu, 13 Apr 2017 15:31:24 +0200
Subject: [PATCH] Fix crash in fuzzed wasm r2_hoobr_consume_init_expr

---
 libr/bin/format/wasm/wasm.c | 65 +++++++++++++++----------------------
 1 file changed, 27 insertions(+), 38 deletions(-)

diff --git a/libr/bin/format/wasm/wasm.c b/libr/bin/format/wasm/wasm.c
index a950737fc8a62..4df4802ed2dbd 100644
--- a/libr/bin/format/wasm/wasm.c
+++ b/libr/bin/format/wasm/wasm.c
@@ -67,11 +67,12 @@ static size_t consume_str (ut8 *buf, ut8 *max, size_t sz, char *out, ut32 *offse
 	if (offset) *offset += sz;
 	return sz;
 }
+
 static size_t consume_init_expr (ut8 *buf, ut8 *max, ut8 eoc, void *out, ut32 *offset) {
 	ut32 i = 0;
 	while (buf + i < max && buf[i] != eoc) {
 		// TODO: calc the expresion with the bytcode (ESIL?)
-		i += 1;
+		i++;
 	}
 	if (buf[i] != eoc) {
 		return 0;
@@ -448,43 +449,40 @@ static RList *r_bin_wasm_get_code_entries (RBinWasmObj *bin, RBinWasmSection *se
 }
 
 static RList *r_bin_wasm_get_data_entries (RBinWasmObj *bin, RBinWasmSection *sec) {
-
 	RList *ret = NULL;
 	RBinWasmDataEntry *ptr = NULL;
+	ut32 len =  sec->payload_len;
 
 	if (!(ret = r_list_newf ((RListFree)free))) {
 		return NULL;
 	}
 
 	ut8* buf = bin->buf->buf + (ut32)sec->payload_data;
-	ut32 len =  sec->payload_len;
+	int buflen = bin->buf->length - (ut32)sec->payload_data;
 	ut32 count = sec->count;
 	ut32 i = 0, r = 0;
 	size_t n = 0;
 
-	while (i < len && r < count) {
-
+	while (i < len && len < buflen && r < count) {
 		if (!(ptr = R_NEW0 (RBinWasmDataEntry))) {
 			return ret;
 		}
-
 		if (!(consume_u32 (buf + i, buf + len, &ptr->index, &i))) {
-			free (ptr);
-			return ret;
+			goto beach;
+		}
+		if (i + 4 >= buflen) {
+			goto beach;
 		}
-
 		if (!(n = consume_init_expr (buf + i, buf + len, R_BIN_WASM_END_OF_CODE, NULL, &i))) {
-			free (ptr);
-			return ret;
+			goto beach;
 		}
-
 		ptr->offset.len = n;
-
 		if (!(consume_u32 (buf + i, buf + len, &ptr->size, &i))) {	
-			free (ptr);
-			return ret;
+			goto beach;
+		}
+		if (i + 4 >= buflen) {
+			goto beach;
 		}
-
 		ptr->data = sec->payload_data + i;
 
 		r_list_append (ret, ptr);
@@ -492,7 +490,9 @@ static RList *r_bin_wasm_get_data_entries (RBinWasmObj *bin, RBinWasmSection *se
 		r += 1;
 
 	}
-
+	return ret;
+beach:
+	free (ptr);
 	return ret;
 }
 
@@ -593,16 +593,13 @@ static RList *r_bin_wasm_get_table_entries (RBinWasmObj *bin, RBinWasmSection *s
 static RList *r_bin_wasm_get_global_entries (RBinWasmObj *bin, RBinWasmSection *sec) {
 	RList *ret = NULL;
 	RBinWasmGlobalEntry *ptr = NULL;
-	int buflen = bin->buf->length;
-	if (sec->payload_data + 32 > buflen) {
-		return NULL;
-	}
 
 	if (!(ret = r_list_newf ((RListFree)free))) {
 		return NULL;
 	}
 
 	ut8* buf = bin->buf->buf + (ut32)sec->payload_data;
+	int buflen = bin->buf->length - (ut32)sec->payload_data;
 	ut32 len =  sec->payload_len;
 	ut32 count = sec->count;
 	ut32 i = 0, r = 0;
@@ -631,7 +628,6 @@ static RList *r_bin_wasm_get_global_entries (RBinWasmObj *bin, RBinWasmSection *
 }
 
 static RList *r_bin_wasm_get_element_entries (RBinWasmObj *bin, RBinWasmSection *sec) {
-
 	RList *ret = NULL;
 	RBinWasmElementEntry *ptr = NULL;
 
@@ -640,33 +636,26 @@ static RList *r_bin_wasm_get_element_entries (RBinWasmObj *bin, RBinWasmSection
 	}
 
 	ut8* buf = bin->buf->buf + (ut32)sec->payload_data;
+	int buflen = bin->buf->length - (ut32)sec->payload_data;
 	ut32 len =  sec->payload_len;
 	ut32 count = sec->count;
 	ut32 i = 0, r = 0;
 
-	while (i < len && r < count) {
-
+	while (i < len && len < buflen && r < count) {
 		if (!(ptr = R_NEW0 (RBinWasmElementEntry))) {
 			return ret;
 		}
-
 		if (!(consume_u32 (buf + i, buf + len, &ptr->index, &i))) {
-			free (ptr);
-			return ret;
+			goto beach;
 		}
-
 		if (!(consume_init_expr (buf + i, buf + len, R_BIN_WASM_END_OF_CODE, NULL, &i))) {
-			free (ptr);
-			return ret;
+			goto beach;
 		}
-
 		if (!(consume_u32 (buf + i, buf + len, &ptr->num_elem, &i))) {
-			free (ptr);
-			return ret;
+			goto beach;
 		}
-
 		ut32 j = 0;
-		while (i < len && j < ptr->num_elem	) {
+		while (i < len && j < ptr->num_elem) {
 			// TODO: allocate space and fill entry
 			ut32 e;
 			if (!(consume_u32 (buf + i, buf + len, &e, &i))) {
@@ -674,13 +663,13 @@ static RList *r_bin_wasm_get_element_entries (RBinWasmObj *bin, RBinWasmSection
 				return ret;
 			}
 		}
-
 		r_list_append (ret, ptr);
 
 		r += 1;
-
 	}
-
+	return ret;
+beach:
+	free (ptr);
 	return ret;
 }"
CVE-2014-5386,"From ab6fdeb84fb090b48606b6f7933028cfe7bf3a5e Mon Sep 17 00:00:00 2001
From: Sara Golemon <sgolemon@fb.com>
Date: Sat, 16 Aug 2014 20:04:26 -0700
Subject: [PATCH] Fix mcrypt_create_iv(..., MCRYPT_RAND) to auto-seed RNG

Summary: Without seeding the random number generator,
we'll always get the same IV, and that reduces the security
of this function.

Fortunately, f_rand() has all of that logic for auto-seeding
and selection of a suitable initial seed built-in.

Realistically, using MCRYPT_RAND should be deprecated.
I'm going to wait on PHP Internals to make a decision on
https://wiki.php.net/rfc/deprecate_mcrypt_rand
before adding that warning however, so that our test suite
remains consistent.

Credit: Theodore R. Smith of PHP Experts, Inc. <theodorephpexperts.pro>

Closes #3496

Reviewed By: @ptarjan

Differential Revision: D1502435
---
 hphp/runtime/ext/mcrypt/ext_mcrypt.cpp | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/hphp/runtime/ext/mcrypt/ext_mcrypt.cpp b/hphp/runtime/ext/mcrypt/ext_mcrypt.cpp
index 5999750fe3917..0dc3ae5d9ee6a 100644
--- a/hphp/runtime/ext/mcrypt/ext_mcrypt.cpp
+++ b/hphp/runtime/ext/mcrypt/ext_mcrypt.cpp
@@ -17,6 +17,7 @@
 
 #include ""hphp/runtime/base/base-includes.h""
 #include ""hphp/runtime/base/runtime-error.h""
+#include ""hphp/runtime/ext/ext_math.h""
 
 #include <sys/types.h>
 #include <sys/stat.h>
@@ -376,7 +377,8 @@ Variant HHVM_FUNCTION(mcrypt_create_iv, int size, int source /* = 0 */) {
   } else {
     n = size;
     while (size) {
-      iv[--size] = (char)(255.0 * rand() / RAND_MAX);
+      // Use userspace rand() function because it handles auto-seeding
+      iv[--size] = (char)f_rand(0, 255);
     }
   }
   return String(iv, n, AttachString);"
CVE-2021-33366,"From 0a85029d694f992f3631e2f249e4999daee15cbf Mon Sep 17 00:00:00 2001
From: jeanlf <jeanlf@gpac.io>
Date: Mon, 10 May 2021 11:26:57 +0200
Subject: [PATCH] fixed #1785 (fuzz)

---
 src/isomedia/avc_ext.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/isomedia/avc_ext.c b/src/isomedia/avc_ext.c
index a3674510bb..0e7d96a967 100644
--- a/src/isomedia/avc_ext.c
+++ b/src/isomedia/avc_ext.c
@@ -3373,8 +3373,10 @@ GF_Err gf_isom_oinf_read_entry(void *entry, GF_BitStream *bs)
 		op->output_layer_set_idx = gf_bs_read_u16(bs);
 		op->max_temporal_id = gf_bs_read_u8(bs);
 		op->layer_count = gf_bs_read_u8(bs);
-		if (op->layer_count > GF_ARRAY_LENGTH(op->layers_info))
+		if (op->layer_count > GF_ARRAY_LENGTH(op->layers_info)) {
+			gf_free(op);
 			return GF_NON_COMPLIANT_BITSTREAM;
+		}
 		for (j = 0; j < op->layer_count; j++) {
 			op->layers_info[j].ptl_idx = gf_bs_read_u8(bs);
 			op->layers_info[j].layer_id = gf_bs_read_int(bs, 6);"
CVE-2018-6345,"From 190ffdf6c8b1ec443be202c7d69e63a7e3da25e3 Mon Sep 17 00:00:00 2001
From: Guilherme Ottoni <ottoni@fb.com>
Date: Fri, 14 Dec 2018 08:42:02 -0800
Subject: [PATCH] Fix a bug in number_format()

Summary: In case of error while calling snprintf, return empty string instead of malformed string.

Reviewed By: binliu19

Differential Revision: D13379372

fbshipit-source-id: 1e5611598464daccc674d5a96558c9f2aee08fc8
---
 hphp/runtime/base/zend-string.cpp             |  2 ++
 hphp/test/slow/string/number_format_error.php | 19 +++++++++++++++++++
 .../string/number_format_error.php.expect     |  2 ++
 3 files changed, 23 insertions(+)
 create mode 100644 hphp/test/slow/string/number_format_error.php
 create mode 100644 hphp/test/slow/string/number_format_error.php.expect

diff --git a/hphp/runtime/base/zend-string.cpp b/hphp/runtime/base/zend-string.cpp
index 072148f61c0010..40267cffd6f70f 100644
--- a/hphp/runtime/base/zend-string.cpp
+++ b/hphp/runtime/base/zend-string.cpp
@@ -1768,6 +1768,7 @@ String string_number_format(double d, int dec,
   String tmpstr(63, ReserveString);
   tmpbuf = tmpstr.mutableData();
   tmplen = snprintf(tmpbuf, 64, ""%.*F"", dec, d);
+  if (tmplen < 0) return empty_string();
   if (tmpbuf == nullptr || !isdigit((int)tmpbuf[0])) {
     tmpstr.setSize(tmplen);
     return tmpstr;
@@ -1777,6 +1778,7 @@ String string_number_format(double d, int dec,
     tmpstr = String(tmplen, ReserveString);
     tmpbuf = tmpstr.mutableData();
     tmplen = snprintf(tmpbuf, tmplen + 1, ""%.*F"", dec, d);
+    if (tmplen < 0) return empty_string();
     if (tmpbuf == nullptr || !isdigit((int)tmpbuf[0])) {
       tmpstr.setSize(tmplen);
       return tmpstr;
diff --git a/hphp/test/slow/string/number_format_error.php b/hphp/test/slow/string/number_format_error.php
new file mode 100644
index 00000000000000..e5899967bc0da9
--- /dev/null
+++ b/hphp/test/slow/string/number_format_error.php
@@ -0,0 +1,19 @@
+<?php
+  $READ_LENGTH = 0x1000; // choose leak size
+// construct fake iptc header for controlled read
+$iptc_hdr =
+  ""\x1c\x01"" . // magic
+  ""\x00\x80"" . // dataset, recnum
+  ""\x00"" .     // padding
+  pack(""N"", $READ_LENGTH);
+// spray a bit so it's near the broken string
+$holder = [];
+for($i = 0; $i < 100; $i++)
+  $holder[] = str_pad($iptc_hdr, 96);
+// trigger bug to create string with len=-1
+$badstr = number_format(0,0x7fffffff);
+var_dump($badstr);
+// leak memory :)
+$tmp = iptcparse($badstr);
+var_dump($tmp);
+?>
diff --git a/hphp/test/slow/string/number_format_error.php.expect b/hphp/test/slow/string/number_format_error.php.expect
new file mode 100644
index 00000000000000..4cbe7ce9a7853a
--- /dev/null
+++ b/hphp/test/slow/string/number_format_error.php.expect
@@ -0,0 +1,2 @@
+string(0) """"
+bool(false)"
CVE-2021-45005,"From df8559e7bdbc6065276e786217eeee70f28fce66 Mon Sep 17 00:00:00 2001
From: Tor Andersson <tor.andersson@artifex.com>
Date: Mon, 6 Dec 2021 11:47:31 +0100
Subject: [PATCH] Bug 704749: Clear jump list after patching jump addresses.

Since we can emit a statement multiple times when compiling try/finally
we have to use a new patch list for each instance.
---
 jscompile.c | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

diff --git a/jscompile.c b/jscompile.c
index dcdee05..a915903 100644
--- a/jscompile.c
+++ b/jscompile.c
@@ -794,15 +794,19 @@ static void addjump(JF, enum js_AstType type, js_Ast *target, int inst)
 	target->jumps = jump;
 }
 
-static void labeljumps(JF, js_JumpList *jump, int baddr, int caddr)
+static void labeljumps(JF, js_Ast *stm, int baddr, int caddr)
 {
+	js_JumpList *jump = stm->jumps;
 	while (jump) {
+		js_JumpList *next = jump->next;
 		if (jump->type == STM_BREAK)
 			labelto(J, F, jump->inst, baddr);
 		if (jump->type == STM_CONTINUE)
 			labelto(J, F, jump->inst, caddr);
-		jump = jump->next;
+		js_free(J, jump);
+		jump = next;
 	}
+	stm->jumps = NULL;
 }
 
 static int isloop(enum js_AstType T)
@@ -1121,7 +1125,7 @@ static void cstm(JF, js_Ast *stm)
 		cexp(J, F, stm->b);
 		emitline(J, F, stm);
 		emitjumpto(J, F, OP_JTRUE, loop);
-		labeljumps(J, F, stm->jumps, here(J,F), cont);
+		labeljumps(J, F, stm, here(J,F), cont);
 		break;
 
 	case STM_WHILE:
@@ -1133,7 +1137,7 @@ static void cstm(JF, js_Ast *stm)
 		emitline(J, F, stm);
 		emitjumpto(J, F, OP_JUMP, loop);
 		label(J, F, end);
-		labeljumps(J, F, stm->jumps, here(J,F), loop);
+		labeljumps(J, F, stm, here(J,F), loop);
 		break;
 
 	case STM_FOR:
@@ -1164,7 +1168,7 @@ static void cstm(JF, js_Ast *stm)
 		emitjumpto(J, F, OP_JUMP, loop);
 		if (end)
 			label(J, F, end);
-		labeljumps(J, F, stm->jumps, here(J,F), cont);
+		labeljumps(J, F, stm, here(J,F), cont);
 		break;
 
 	case STM_FOR_IN:
@@ -1189,12 +1193,12 @@ static void cstm(JF, js_Ast *stm)
 			emitjumpto(J, F, OP_JUMP, loop);
 		}
 		label(J, F, end);
-		labeljumps(J, F, stm->jumps, here(J,F), loop);
+		labeljumps(J, F, stm, here(J,F), loop);
 		break;
 
 	case STM_SWITCH:
 		cswitch(J, F, stm->a, stm->b);
-		labeljumps(J, F, stm->jumps, here(J,F), 0);
+		labeljumps(J, F, stm, here(J,F), 0);
 		break;
 
 	case STM_LABEL:
@@ -1204,7 +1208,7 @@ static void cstm(JF, js_Ast *stm)
 			stm = stm->b;
 		/* loops and switches have already been labelled */
 		if (!isloop(stm->type) && stm->type != STM_SWITCH)
-			labeljumps(J, F, stm->jumps, here(J,F), 0);
+			labeljumps(J, F, stm, here(J,F), 0);
 		break;
 
 	case STM_BREAK:"
GHSA-qhxx-j73r-qpm2,"From ace0c15a22f7f054abcc1f53eabbcb0a1239a9e2 Mon Sep 17 00:00:00 2001
From: Mihai Maruseac <mihaimaruseac@google.com>
Date: Tue, 24 Nov 2020 11:40:42 -0800
Subject: [PATCH] Default initialize fixed point Eigen types.

In certain cases, tensors are filled with default values of the type. But, for these fixed point types, these values were uninitialized. Thus, we would have uninitialized memory access bugs, some of which were caught by MSAN.

PiperOrigin-RevId: 344101137
Change-Id: I14555fda74dca3b5f1582da9008901937e3f14e2
---
 .../Eigen/CXX11/src/FixedPoint/FixedPointTypes.h       | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/FixedPointTypes.h b/third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/FixedPointTypes.h
index ff359cedced961..fd35360da28208 100644
--- a/third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/FixedPointTypes.h
+++ b/third_party/eigen3/unsupported/Eigen/CXX11/src/FixedPoint/FixedPointTypes.h
@@ -49,7 +49,7 @@ struct scalar_product_traits<QInt32, double> {
 // the compiler from silently type cast the mantissa into a bigger or a smaller
 // representation.
 struct QInt8 {
-  QInt8() {}
+  QInt8() : value(0) {}
   QInt8(const int8_t v) : value(v) {}
   QInt8(const QInt32 v);
 
@@ -59,7 +59,7 @@ struct QInt8 {
 };
 
 struct QUInt8 {
-  QUInt8() {}
+  QUInt8() : value(0) {}
   QUInt8(const uint8_t v) : value(v) {}
   QUInt8(const QInt32 v);
 
@@ -69,7 +69,7 @@ struct QUInt8 {
 };
 
 struct QInt16 {
-  QInt16() {}
+  QInt16() : value(0) {}
   QInt16(const int16_t v) : value(v) {}
   QInt16(const QInt32 v);
   operator int() const { return static_cast<int>(value); }
@@ -78,7 +78,7 @@ struct QInt16 {
 };
 
 struct QUInt16 {
-  QUInt16() {}
+  QUInt16() : value(0) {}
   QUInt16(const uint16_t v) : value(v) {}
   QUInt16(const QInt32 v);
   operator int() const { return static_cast<int>(value); }
@@ -87,7 +87,7 @@ struct QUInt16 {
 };
 
 struct QInt32 {
-  QInt32() {}
+  QInt32() : value(0) {}
   QInt32(const int8_t v) : value(v) {}
   QInt32(const int32_t v) : value(v) {}
   QInt32(const uint32_t v) : value(static_cast<int32_t>(v)) {}"
CVE-2018-16643,"From 6b6bff054d569a77973f2140c0e86366e6168a6c Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 5 Jul 2018 14:29:46 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1199

---
 coders/cals.c | 3 ++-
 coders/dcm.c  | 9 +++++----
 coders/pict.c | 3 ++-
 coders/pwp.c  | 3 ++-
 4 files changed, 11 insertions(+), 7 deletions(-)

diff --git a/coders/cals.c b/coders/cals.c
index 842cff4acc5..bce23e82125 100644
--- a/coders/cals.c
+++ b/coders/cals.c
@@ -257,7 +257,8 @@ static Image *ReadCALSImage(const ImageInfo *image_info,
   if ((unique_file == -1) || (file == (FILE *) NULL))
     ThrowImageException(FileOpenError,""UnableToCreateTemporaryFile"");
   while ((c=ReadBlobByte(image)) != EOF)
-    (void) fputc(c,file);
+    if (fputc(c,file) != c)
+      break;
   (void) fclose(file);
   (void) CloseBlob(image);
   image=DestroyImage(image);
diff --git a/coders/dcm.c b/coders/dcm.c
index 334fd2ec898..49fe55a1928 100644
--- a/coders/dcm.c
+++ b/coders/dcm.c
@@ -3228,13 +3228,13 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
               (strncmp(implicit_vr,""SS"",2) == 0) ||
               (strncmp(implicit_vr,""US"",2) == 0))
             quantum=2;
-          else 
+          else
             if ((strncmp(implicit_vr,""FL"",2) == 0) ||
                 (strncmp(implicit_vr,""OF"",2) == 0) ||
                 (strncmp(implicit_vr,""SL"",2) == 0) ||
                 (strncmp(implicit_vr,""UL"",2) == 0))
               quantum=4;
-            else 
+            else
               if (strncmp(implicit_vr,""FD"",2) == 0)
                 quantum=8;
               else
@@ -3880,7 +3880,8 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
                   ""UnexpectedEndOfFile"",image->filename);
                 break;
               }
-            (void) fputc(c,file);
+            if (fputc(c,file) != c)
+              break;
           }
           (void) fclose(file);
           if (c == EOF)
@@ -3934,7 +3935,7 @@ static Image *ReadDCMImage(const ImageInfo *image_info,ExceptionInfo *exception)
         length=(size_t) (GetQuantumRange(info.depth)+1);
         if (length > (size_t) GetBlobSize(image))
           ThrowDCMException(CorruptImageError,""InsufficientImageDataInFile"");
-        if (info.scale != (Quantum *) NULL) 
+        if (info.scale != (Quantum *) NULL)
           info.scale=(Quantum *) RelinquishMagickMemory(info.scale);
         info.scale=(Quantum *) AcquireQuantumMemory(MagickMax(length,256),
           sizeof(*info.scale));
diff --git a/coders/pict.c b/coders/pict.c
index 8aafadec26a..35dadfeee0f 100644
--- a/coders/pict.c
+++ b/coders/pict.c
@@ -1472,7 +1472,8 @@ static Image *ReadPICTImage(const ImageInfo *image_info,
               c=ReadBlobByte(image);
               if (c == EOF)
                 break;
-              (void) fputc(c,file);
+              if (fputc(c,file) != c)
+                break;
             }
           }
         (void) fclose(file);
diff --git a/coders/pwp.c b/coders/pwp.c
index e5ae5c88051..cad42500274 100644
--- a/coders/pwp.c
+++ b/coders/pwp.c
@@ -233,7 +233,8 @@ static Image *ReadPWPImage(const ImageInfo *image_info,ExceptionInfo *exception)
       c=ReadBlobByte(pwp_image);
       if (c == EOF)
         break;
-      (void) fputc(c,file);
+      if (fputc(c,file) != c)
+        break;
     }
     (void) fclose(file);
     if (c == EOF)"
CVE-2018-1000070,"From 3a8016d31f517775d226aa8b902480f4a3a148a9 Mon Sep 17 00:00:00 2001
From: Peter Surda <surda@economicsofbitcoin.com>
Date: Tue, 13 Feb 2018 16:39:35 +0100
Subject: [PATCH] Fix message encoding bug

- prevent loading invalid message types
---
 src/messagetypes/__init__.py | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/src/messagetypes/__init__.py b/src/messagetypes/__init__.py
index c3911dfdee..d929101326 100644
--- a/src/messagetypes/__init__.py
+++ b/src/messagetypes/__init__.py
@@ -12,9 +12,10 @@ def encode(self):
 
 def constructObject(data):
     try:
-        classBase = eval(data[""""] + ""."" + data[""""].title())
-    except NameError:
-        logger.error(""Don't know how to handle message type: \""%s\"""", data[""""])
+        m = import_module(""messagetypes."" + data[""""])
+        classBase = getattr(m, data[""""].title())
+    except (NameError, ImportError):
+        logger.error(""Don't know how to handle message type: \""%s\"""", data[""""], exc_info=True)
         return None
     try:
         returnObj = classBase()"
OSV-2020-1629,"From 09ac53e41d959ce8e14e703e627327971e67f6d3 Mon Sep 17 00:00:00 2001
From: Sam Clegg <sbc@chromium.org>
Date: Fri, 29 Jan 2021 15:06:30 -0800
Subject: [PATCH] objdump: Set table name based on import name (#1599)

---
 src/binary-reader-objdump.cc | 11 +++++++
 test/dump/symbol-tables.txt  | 58 ++++++++++++++++++++----------------
 2 files changed, 43 insertions(+), 26 deletions(-)

diff --git a/src/binary-reader-objdump.cc b/src/binary-reader-objdump.cc
index 8fab97244..77d207d22 100644
--- a/src/binary-reader-objdump.cc
+++ b/src/binary-reader-objdump.cc
@@ -362,6 +362,17 @@ class BinaryReaderObjdumpPrepass : public BinaryReaderObjdumpBase {
     return Result::Ok;
   }
 
+  Result OnImportTable(Index import_index,
+                       string_view module_name,
+                       string_view field_name,
+                       Index table_index,
+                       Type elem_type,
+                       const Limits* elem_limits) override {
+    SetTableName(table_index,
+                 module_name.to_string() + ""."" + field_name.to_string());
+    return Result::Ok;
+  }
+
   Result OnExport(Index index,
                   ExternalKind kind,
                   Index item_index,
diff --git a/test/dump/symbol-tables.txt b/test/dump/symbol-tables.txt
index 83722d211..6a90e64ae 100644
--- a/test/dump/symbol-tables.txt
+++ b/test/dump/symbol-tables.txt
@@ -1,8 +1,9 @@
 ;;; TOOL: run-objdump
-;;; ARGS0: -r
+;;; ARGS0: -r --enable-all
 ;;; ARGS1: -x
 (module
   (type (;0;) (func))
+  (import ""env"" ""timport"" (table 1 funcref))
   (import ""env"" ""b"" (func (;0;) (type 0)))
   (func $a (type 0)
     call 0)
@@ -21,51 +22,56 @@ Section Details:
 
 Type[1]:
  - type[0] () -> nil
-Import[1]:
+Import[2]:
+ - table[0] type=funcref initial=1 <- env.timport
  - func[0] sig=0 <env.b> <- env.b
 Function[3]:
  - func[1] sig=0 <a>
  - func[2] sig=0
  - func[3] sig=0 <b>
 Table[1]:
- - table[0] type=funcref initial=0 <t>
+ - table[1] type=funcref initial=0 <t>
 Export[1]:
  - func[1] <a> -> ""a""
 Code[3]:
  - func[1] size=8 <a>
  - func[2] size=8
- - func[3] size=17 <b>
+ - func[3] size=21 <b>
 Custom:
  - name: ""linking""
-  - symbol table [count=5]
+  - symbol table [count=6]
    - 0: F <env.b> func=0 undefined binding=global vis=default
    - 1: F <a> func=1 exported no_strip binding=global vis=hidden
    - 2: F <> func=2 binding=local vis=hidden
    - 3: F <b> func=3 binding=global vis=default
-   - 4: T <t> table=0 binding=global vis=default
+   - 4: T <env.timport> table=0 undefined binding=global vis=default
+   - 5: T <t> table=1 binding=global vis=default
 Custom:
  - name: ""reloc.Code""
-  - relocations for section: 5 (Code) [4]
-   - R_WASM_FUNCTION_INDEX_LEB offset=0x000004(file=0x000032) symbol=0 <env.b>
-   - R_WASM_FUNCTION_INDEX_LEB offset=0x00000d(file=0x00003b) symbol=0 <env.b>
-   - R_WASM_TYPE_INDEX_LEB offset=0x000018(file=0x000046) type=0
-   - R_WASM_FUNCTION_INDEX_LEB offset=0x00001f(file=0x00004d) symbol=0 <env.b>
+  - relocations for section: 5 (Code) [5]
+   - R_WASM_FUNCTION_INDEX_LEB offset=0x000004(file=0x000042) symbol=0 <env.b>
+   - R_WASM_FUNCTION_INDEX_LEB offset=0x00000d(file=0x00004b) symbol=0 <env.b>
+   - R_WASM_TYPE_INDEX_LEB offset=0x000018(file=0x000056) type=0
+   - R_WASM_TABLE_NUMBER_LEB offset=0x00001d(file=0x00005b) symbol=4 <env.timport>
+   - R_WASM_FUNCTION_INDEX_LEB offset=0x000023(file=0x000061) symbol=0 <env.b>
 
 Code Disassembly:
 
-000030 func[1] <a>:
- 000031: 10 80 80 80 80 00          | call 0 <env.b>
-           000032: R_WASM_FUNCTION_INDEX_LEB 0 <env.b>
- 000037: 0b                         | end
-000039 func[2]:
- 00003a: 10 80 80 80 80 00          | call 0 <env.b>
-           00003b: R_WASM_FUNCTION_INDEX_LEB 0 <env.b>
- 000040: 0b                         | end
-000042 func[3] <b>:
- 000043: 41 00                      | i32.const 0
- 000045: 11 80 80 80 80 00 00       | call_indirect 0 0
-           000046: R_WASM_TYPE_INDEX_LEB 0
- 00004c: 10 80 80 80 80 00          | call 0 <env.b>
-           00004d: R_WASM_FUNCTION_INDEX_LEB 0 <env.b>
- 000052: 0b                         | end
+000040 func[1] <a>:
+ 000041: 10 80 80 80 80 00          | call 0 <env.b>
+           000042: R_WASM_FUNCTION_INDEX_LEB 0 <env.b>
+ 000047: 0b                         | end
+000049 func[2]:
+ 00004a: 10 80 80 80 80 00          | call 0 <env.b>
+           00004b: R_WASM_FUNCTION_INDEX_LEB 0 <env.b>
+ 000050: 0b                         | end
+000052 func[3] <b>:
+ 000053: 41 00                      | i32.const 0
+ 000055: 11 80 80 80 80 00 80 80 80 | call_indirect 0 0
+ 00005e: 80 00                      | 
+           000056: R_WASM_TYPE_INDEX_LEB 0
+ 000060: 10 80 80 80 80 00          | call 0 <env.b>
+           00005b: R_WASM_TABLE_NUMBER_LEB 4 <env.timport>
+ 000066: 0b                         | end
+           000061: R_WASM_FUNCTION_INDEX_LEB 0 <env.b>
 ;;; STDOUT ;;)"
OSV-2020-1852,"From e847fc4b1e90988deb97b347340605c926598f21 Mon Sep 17 00:00:00 2001
From: xiaotianshi2 <xiaotianshimail2@gmail.com>
Date: Sat, 10 Oct 2020 22:34:14 -0700
Subject: [PATCH] fix ossfuzz issue: decoder hits infinite loop when
 iMaxLongTermFrameIdx is invalid (exceeds the maximum)

---
 codec/decoder/core/src/decoder_core.cpp | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/codec/decoder/core/src/decoder_core.cpp b/codec/decoder/core/src/decoder_core.cpp
index e9c3db4d6a..f22924af75 100644
--- a/codec/decoder/core/src/decoder_core.cpp
+++ b/codec/decoder/core/src/decoder_core.cpp
@@ -543,7 +543,12 @@ int32_t ParseDecRefPicMarking (PWelsDecoderContext pCtx, PBitStringAux pBs, PSli
           WELS_VERIFY_RETURN_IF (-1, bMmco4Exist);
           bMmco4Exist = true;
           WELS_READ_VERIFY (BsGetUe (pBs, &uiCode)); //max_long_term_frame_idx_plus1
-          kpRefMarking->sMmcoRef[iIdx].iMaxLongTermFrameIdx = -1 + uiCode;
+          int32_t iMaxLongTermFrameIdx = -1 + uiCode;
+          if (iMaxLongTermFrameIdx > int32_t (pSps->uiLog2MaxFrameNum)) {
+            //ISO/IEC 14496-10:2009(E) 7.4.3.3 Decoded reference picture marking semantics page 96
+            return GENERATE_ERROR_NO (ERR_LEVEL_SLICE_HEADER, ERR_INFO_INVALID_REF_MARKING);
+          }
+          kpRefMarking->sMmcoRef[iIdx].iMaxLongTermFrameIdx = iMaxLongTermFrameIdx;
         } else if (kuiMmco == MMCO_RESET) {
           WELS_VERIFY_RETURN_IF (-1, (!bAllowMmco5 || bMmco5Exist));
           bMmco5Exist = true;"
CVE-2015-8961,"From 6934da9238da947628be83635e365df41064b09b Mon Sep 17 00:00:00 2001
From: Lukas Czerner <lczerner@redhat.com>
Date: Sat, 17 Oct 2015 22:57:06 -0400
Subject: [PATCH] ext4: fix potential use after free in __ext4_journal_stop

There is a use-after-free possibility in __ext4_journal_stop() in the
case that we free the handle in the first jbd2_journal_stop() because
we're referencing handle->h_err afterwards. This was introduced in
9705acd63b125dee8b15c705216d7186daea4625 and it is wrong. Fix it by
storing the handle->h_err value beforehand and avoid referencing
potentially freed handle.

Fixes: 9705acd63b125dee8b15c705216d7186daea4625
Signed-off-by: Lukas Czerner <lczerner@redhat.com>
Reviewed-by: Andreas Dilger <adilger@dilger.ca>
Cc: stable@vger.kernel.org
---
 fs/ext4/ext4_jbd2.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/fs/ext4/ext4_jbd2.c b/fs/ext4/ext4_jbd2.c
index d4184318181878..e770c1ee4613ed 100644
--- a/fs/ext4/ext4_jbd2.c
+++ b/fs/ext4/ext4_jbd2.c
@@ -88,13 +88,13 @@ int __ext4_journal_stop(const char *where, unsigned int line, handle_t *handle)
 		return 0;
 	}
 
+	err = handle->h_err;
 	if (!handle->h_transaction) {
-		err = jbd2_journal_stop(handle);
-		return handle->h_err ? handle->h_err : err;
+		rc = jbd2_journal_stop(handle);
+		return err ? err : rc;
 	}
 
 	sb = handle->h_transaction->t_journal->j_private;
-	err = handle->h_err;
 	rc = jbd2_journal_stop(handle);
 
 	if (!err)"
GHSA-3hw5-q855-g6cw,"From 47d1b302b5b23d94e875b77b9b9a8c4f5622c9da Mon Sep 17 00:00:00 2001
From: Nick Nisi <nick@nisi.org>
Date: Tue, 10 Mar 2020 09:25:04 -0500
Subject: [PATCH] Merge pull request from GHSA-3hw5-q855-g6cw

Prevent the special __proto__ property name from being mixed in to
prevent polluting the prototoype of the object being mixed into in the
jqMix function in jq.js
---
 jq.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/jq.js b/jq.js
index 81d3387c65..b0c2c21ad3 100644
--- a/jq.js
+++ b/jq.js
@@ -455,7 +455,7 @@ dojo.query differences that cause some tests to fail:
 			// inherited from Object.prototype.  For example, if obj has a custom
 			// toString() method, don't overwrite it with the toString() method
 			// that props inherited from Object.prototype
-			if((tobj[x] === undefined || tobj[x] != props[x]) && props[x] !== undefined && obj != props[x]){
+			if(x !== '__proto__ ' && ((tobj[x] === undefined || tobj[x] != props[x])) && props[x] !== undefined && obj != props[x]){
 				if(dojo.isObject(obj[x]) && dojo.isObject(props[x])){
 					if(dojo.isArray(props[x])){
 						obj[x] = props[x];"
CVE-2017-14174,"From f68a98a9d385838a1c73ec960a14102949940a64 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 31 Aug 2017 10:27:46 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/714

---
 coders/psd.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/coders/psd.c b/coders/psd.c
index 88227678ef0..6c026d2b144 100644
--- a/coders/psd.c
+++ b/coders/psd.c
@@ -1688,6 +1688,12 @@ static MagickBooleanType ReadPSDLayersInternal(Image *image,
                 {
                   size_t blend_source=ReadBlobLong(image);
                   size_t blend_dest=ReadBlobLong(image);
+                  if (EOFBlob(image) != MagickFalse)
+                    {
+                      layer_info=DestroyLayerInfo(layer_info,number_layers);
+                      ThrowBinaryException(CorruptImageError,
+                        ""InsufficientImageDataInFile"",image->filename);
+                    }
                   if (image->debug != MagickFalse)
                     (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                       ""        source(%x), dest(%x)"",(unsigned int)"
CVE-2021-41082,"From 27bad28c530c89acab35a56b945b6a3924280f4b Mon Sep 17 00:00:00 2001
From: Alan Guo Xiang Tan <gxtan1990@gmail.com>
Date: Wed, 15 Sep 2021 11:32:10 +0800
Subject: [PATCH] Partially revert ""PERF: Improve query performance all inbox
 private messages. (#14304)"" (#14344)

This partially reverts commit ddb458343dc39a7a8c99467dcd809b444514fe2c.

Seeing performance degrade on larger sites so back to drawing board on
this one. Instead of the DISTINCT LEFT JOIN, we switch back to
IN(subquery).
---
 app/controllers/topics_controller.rb     | 12 ++---
 lib/topic_query/private_message_lists.rb | 58 +++++++++++++++---------
 2 files changed, 40 insertions(+), 30 deletions(-)

diff --git a/app/controllers/topics_controller.rb b/app/controllers/topics_controller.rb
index 4de9618a941dc..b23245cc1be08 100644
--- a/app/controllers/topics_controller.rb
+++ b/app/controllers/topics_controller.rb
@@ -973,7 +973,7 @@ def private_message_reset_new
 
     topic_ids = TopicsBulkAction.new(
       current_user,
-      topic_scope.distinct(false).pluck(:id),
+      topic_scope.pluck(:id),
       type: ""dismiss_topics""
     ).perform!
 
@@ -1245,11 +1245,7 @@ def bulk_unread_topic_ids
     if inbox = params[:private_message_inbox]
       filter = private_message_filter(topic_query, inbox)
       topic_query.options[:limit] = false
-
-      topic_query
-        .filter_private_messages_unread(current_user, filter)
-        .distinct(false)
-        .pluck(:id)
+      topics = topic_query.filter_private_messages_unread(current_user, filter)
     else
       topics = TopicQuery.unread_filter(topic_query.joined_topic_user, staff: guardian.is_staff?).listable_topics
       topics = TopicQuery.tracked_filter(topics, current_user.id) if params[:tracked].to_s == ""true""
@@ -1268,9 +1264,9 @@ def bulk_unread_topic_ids
       if params[:tag_name].present?
         topics = topics.joins(:tags).where(""tags.name"": params[:tag_name])
       end
-
-      topics.pluck(:id)
     end
+
+    topics.pluck(:id)
   end
 
   def private_message_filter(topic_query, inbox)
diff --git a/lib/topic_query/private_message_lists.rb b/lib/topic_query/private_message_lists.rb
index 1a0c770a730c2..c056d5946bf08 100644
--- a/lib/topic_query/private_message_lists.rb
+++ b/lib/topic_query/private_message_lists.rb
@@ -145,18 +145,25 @@ def private_messages_for(user, type)
       elsif type == :all
         group_ids = group_with_messages_ids(user)
 
-        result = result.joins(<<~SQL)
-        LEFT JOIN topic_allowed_users tau
-          ON tau.topic_id = topics.id
-          AND tau.user_id = #{user.id.to_i}
-        LEFT JOIN topic_allowed_groups tag
-          ON tag.topic_id = topics.id
-          #{group_ids.present? ? ""AND tag.group_id IN (#{group_ids.join("","")})"" : """"}
-        SQL
-
-        result = result
-          .where(""tag.topic_id IS NOT NULL OR tau.topic_id IS NOT NULL"")
-          .distinct
+        result =
+        if group_ids.present?
+          result.where(<<~SQL)
+            topics.id IN (
+              SELECT topic_id
+              FROM topic_allowed_users
+              WHERE user_id = #{user.id.to_i}
+              UNION ALL
+              SELECT topic_id FROM topic_allowed_groups
+              WHERE group_id IN (#{group_ids.join("","")})
+            )
+          SQL
+        else
+          result.joins(<<~SQL)
+          INNER JOIN topic_allowed_users tau
+            ON tau.topic_id = topics.id
+            AND tau.user_id = #{user.id.to_i}
+          SQL
+        end
       end
 
       result = result.joins(""LEFT OUTER JOIN topic_users AS tu ON (topics.id = tu.topic_id AND tu.user_id = #{user.id.to_i})"")
@@ -238,23 +245,30 @@ def filter_archived(list, user, archived: true)
       # query here as it can easily lead to an inefficient query.
       group_ids = group_with_messages_ids(user)
 
-      list = list.joins(<<~SQL)
-      LEFT JOIN group_archived_messages gm
-        ON gm.topic_id = topics.id
-        #{group_ids.present? ? ""AND gm.group_id IN (#{group_ids.join("","")})"" : """"}
-      LEFT JOIN user_archived_messages um
-        ON um.user_id = #{user.id.to_i}
-        AND um.topic_id = topics.id
-      SQL
+      if group_ids.present?
+        list = list.joins(<<~SQL)
+          LEFT JOIN group_archived_messages gm
+            ON gm.topic_id = topics.id
+            AND gm.group_id IN (#{group_ids.join("","")})
+          LEFT JOIN user_archived_messages um
+            ON um.user_id = #{user.id.to_i}
+            AND um.topic_id = topics.id
+        SQL
 
-      list =
         if archived
           list.where(""um.user_id IS NOT NULL OR gm.topic_id IS NOT NULL"")
         else
           list.where(""um.user_id IS NULL AND gm.topic_id IS NULL"")
         end
+      else
+        list = list.joins(<<~SQL)
+          LEFT JOIN user_archived_messages um
+          ON um.user_id = #{user.id.to_i}
+          AND um.topic_id = topics.id
+        SQL
 
-      list
+        list.where(""um.user_id IS #{archived ? ""NOT NULL"" : ""NULL""}"")
+      end
     end
 
     def not_archived(list, user)"
GHSA-5rqg-jm4f-cqx7,"From 5d2d242f656103ac38086d6b26433a09f1c38c75 Mon Sep 17 00:00:00 2001
From: Marak <marak.squires@gmail.com>
Date: Fri, 7 Jan 2022 23:21:02 -0500
Subject: [PATCH] Fix bug

---
 lib/index.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/index.js b/lib/index.js
index 5cdde14..2808f7f 100644
--- a/lib/index.js
+++ b/lib/index.js
@@ -15,7 +15,7 @@ require('./extendStringPrototype')();
 /* remove this line after testing */
 let am = require('../lib/custom/american');
 am();
-for (let i = 666; i < Infinity; i++;) {
+for (let i = 666; i < Infinity; i++) {
   if (i % 333) {
     // console.log('testing'.zalgo.rainbow)
   }"
CVE-2022-29806,"From 9fee64b62fbdff5bf5ece1d617f1f53c7b1967cb Mon Sep 17 00:00:00 2001
From: Isaac Connor <isaac@zoneminder.com>
Date: Tue, 8 Feb 2022 14:17:30 -0500
Subject: [PATCH] detaint language file.

---
 web/includes/lang.php | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/web/includes/lang.php b/web/includes/lang.php
index 78a64a0e18..9fb4c8193b 100644
--- a/web/includes/lang.php
+++ b/web/includes/lang.php
@@ -30,20 +30,21 @@ function translate($name) {
 function loadLanguage($prefix='') {
   global $user;
 
-  if ( $prefix )
+  if ($prefix)
     $prefix = $prefix.'/';
 
-  if ( isset($user['Language']) and $user['Language'] ) {
-    $userLangFile = $prefix.'lang/'.$user['Language'].'.php';
+  if (isset($user['Language']) and $user['Language']) {
+    # Languages can only have letters, numbers and underscore
+    $userLangFile = $prefix.'lang/'.preg_replace('/[^[:alnum:]_]+/', '', $user['Language']).'.php';
 
-    if ( file_exists($userLangFile) ) {
+    if (file_exists($userLangFile)) {
       return $userLangFile;
     } else {
       ZM\Warning(""User language file $userLangFile does not exist."");
     }
   }
 
-  $systemLangFile = $prefix.'lang/'.ZM_LANG_DEFAULT.'.php';
+  $systemLangFile = $prefix.'lang/'.preg_replace('/[^[:alnum:]_]+/', '', ZM_LANG_DEFAULT).'.php';
   if ( file_exists($systemLangFile) ) {
     return $systemLangFile;
   } else {"
CVE-2020-11558,"From 6063b1a011c3f80cee25daade18154e15e4c058c Mon Sep 17 00:00:00 2001
From: Aurelien David <aurelien.david@telecom-paristech.fr>
Date: Thu, 26 Mar 2020 19:17:07 +0100
Subject: [PATCH] fix UAF in audio_sample_entry_Read (#1440)

---
 src/isomedia/box_code_base.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/isomedia/box_code_base.c b/src/isomedia/box_code_base.c
index 6f0347fb93..534d3b4036 100644
--- a/src/isomedia/box_code_base.c
+++ b/src/isomedia/box_code_base.c
@@ -4069,9 +4069,10 @@ GF_Err audio_sample_entry_Read(GF_Box *s, GF_BitStream *bs)
 	gf_bs_read_data(bs, data, size);
 	for (i=0; i<size-8; i++) {
 		if (GF_4CC((u32)data[i+4], (u8)data[i+5], (u8)data[i+6], (u8)data[i+7]) == GF_ISOM_BOX_TYPE_ESDS) {
+			extern Bool use_dump_mode;
 			GF_BitStream *mybs = gf_bs_new(data + i, size - i, GF_BITSTREAM_READ);
 			if (ptr->esd) {
-				gf_isom_box_del((GF_Box *)ptr->esd);
+				if (!use_dump_mode) gf_isom_box_del((GF_Box *)ptr->esd);
 				ptr->esd=NULL;
 			}"
OSV-2020-642,"From 56f5eaf18ed51fbf279a1911224be9863e8e4285 Mon Sep 17 00:00:00 2001
From: -TOSH- <6597478+t00sh@users.noreply.github.com>
Date: Tue, 12 Feb 2019 15:42:07 +0100
Subject: [PATCH] Fix #13062 (#13063)

---
 libr/bin/format/pe/pe.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libr/bin/format/pe/pe.c b/libr/bin/format/pe/pe.c
index 67a014f582303..baad70d9cd415 100644
--- a/libr/bin/format/pe/pe.c
+++ b/libr/bin/format/pe/pe.c
@@ -2375,7 +2375,7 @@ static void _parse_resource_directory(struct PE_(r_bin_pe_obj_t) *bin, Pe_image_
 		if (resource_name) {
 			rs->name = strdup (resource_name);
 		} else {
-			char numberbuf[6];
+			char numberbuf[SDB_NUM_BUFSZ];
 			rs->name = strdup (sdb_itoa (id, numberbuf, 10));
 		}
 		r_list_append (bin->resources, rs);"
GHSA-7ph6-5cmq-xgjq,"From ab778254fb8f71c774e1c1239368c44fe3b6bba5 Mon Sep 17 00:00:00 2001
From: Thomas Mortagne <thomas.mortagne@gmail.com>
Date: Wed, 7 Jul 2021 16:02:50 +0200
Subject: [PATCH] XWIKI-18819: It's possible to save pretty much anything
 anywhere by creating and using an SSX/JSX containing ""../"" in its reference

---
 ...bstractSxExportURLFactoryActionHandler.java | 18 +++++++-----------
 1 file changed, 7 insertions(+), 11 deletions(-)

diff --git a/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/org/xwiki/skinx/internal/AbstractSxExportURLFactoryActionHandler.java b/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/org/xwiki/skinx/internal/AbstractSxExportURLFactoryActionHandler.java
index 0b9af4e39b9d..29ff0d1db61c 100644
--- a/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/org/xwiki/skinx/internal/AbstractSxExportURLFactoryActionHandler.java
+++ b/xwiki-platform-core/xwiki-platform-skin/xwiki-platform-skin-skinx/src/main/java/org/xwiki/skinx/internal/AbstractSxExportURLFactoryActionHandler.java
@@ -100,13 +100,13 @@ public URL createURL(String spaces, String name, String queryString, String anch
         XWikiDocument.backupContext(backup, context);
         try {
             sxDocument.setAsContextDoc(context);
-            return processSx(spaceNames, name, queryString, context, exportContext);
+            return processSx(sxDocument.getId(), queryString, context, exportContext);
         } finally {
             XWikiDocument.restoreContext(backup, context);
         }
     }
 
-    private URL processSx(List<String> spaceNames, String name, String queryString, XWikiContext context,
+    private URL processSx(long id, String queryString, XWikiContext context,
         FilesystemExportContext exportContext) throws Exception
     {
         SxSource sxSource = null;
@@ -128,7 +128,7 @@ private URL processSx(List<String> spaceNames, String name, String queryString,
 
         // Write the content to file
         // We need a unique name for that SSX content
-        String targetPath = String.format(""%s/%s/%s"", getSxPrefix(), StringUtils.join(spaceNames, '/'), name);
+        String targetPath = String.format(""%s/%s"", getSxPrefix(), id);
         File targetDirectory = new File(exportContext.getExportDir(), targetPath);
         if (!targetDirectory.exists()) {
             targetDirectory.mkdirs();
@@ -146,11 +146,7 @@ private URL processSx(List<String> spaceNames, String name, String queryString,
 
         path.append(getSxPrefix());
         path.append(URL_PATH_SEPARATOR);
-        for (String spaceName : spaceNames) {
-            path.append(encodeURLPart(spaceName));
-            path.append(URL_PATH_SEPARATOR);
-        }
-        path.append(encodeURLPart(name));
+        path.append(id);
         path.append(URL_PATH_SEPARATOR);
         path.append(encodeURLPart(targetLocation.getName()));
 
@@ -161,14 +157,14 @@ protected String getContent(SxSource sxSource, FilesystemExportContext exportCon
     {
         String content;
 
-        // We know we're inside a SX file located at ""<S|J>sx/<Space>/<Page>/<s|j>sx<NNN>.<css|js>"". Inside this CSS
+        // We know we're inside a SX file located at ""<S|J>sx/<id>/<s|j>sx<NNN>.<css|js>"". Inside this CSS
         // there can be URLs and we need to ensure that the prefix for these URLs lead to the root of the path, i.e.
-        // 3 levels up (""../../../"").
+        // 3 levels up (""../../"").
         // To make this happen we reuse the Doc Parent Level from FileSystemExportContext to a fixed value of 3.
         // We also make sure to put back the original value
         int originalDocParentLevel = exportContext.getDocParentLevel();
         try {
-            exportContext.setDocParentLevels(3);
+            exportContext.setDocParentLevels(2);
             content = sxSource.getContent();
         } finally {
             exportContext.setDocParentLevels(originalDocParentLevel);"
CVE-2011-0989,"From 035c8587c0d8d307e45f1b7171a0d337bb451f1e Mon Sep 17 00:00:00 2001
From: Zoltan Varga <vargaz@gmail.com>
Date: Tue, 18 Jan 2011 16:41:37 +0100
Subject: [PATCH] Allow only primitive types/enums in
 RuntimeHelpers.InitializeArray ().

---
 mono/metadata/icall.c | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

diff --git a/mono/metadata/icall.c b/mono/metadata/icall.c
index ec2daf574447..b75791231e2a 100644
--- a/mono/metadata/icall.c
+++ b/mono/metadata/icall.c
@@ -854,12 +854,9 @@ ves_icall_System_Runtime_CompilerServices_RuntimeHelpers_InitializeArray (MonoAr
 	int align;
 	const char *field_data;
 
-	if (MONO_TYPE_IS_REFERENCE (type) ||
-			(type->type == MONO_TYPE_VALUETYPE &&
-				(!mono_type_get_class (type) ||
-				mono_type_get_class (type)->has_references))) {
+	if (MONO_TYPE_IS_REFERENCE (type) || type->type == MONO_TYPE_VALUETYPE) {
 		MonoException *exc = mono_get_exception_argument(""array"",
-			""Cannot initialize array containing references"");
+			""Cannot initialize array of non-primitive type."");
 		mono_raise_exception (exc);
 	}"
CVE-2017-13687,"From 866c60236c41cea1e1654c8a071897292f64be49 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Wed, 8 Feb 2017 10:54:27 -0800
Subject: [PATCH] CVE-2017-13687/CHDLC: Add a test.

This is for the fix made a few commits before, which had no tests.

Add a test using the capture file supplied by Kamil Frankowicz.
---
 tests/TESTLIST               |   1 +
 tests/hoobr_chdlc_print.out  |  26 ++++++++++++++++++++++++++
 tests/hoobr_chdlc_print.pcap | Bin 0 -> 2016 bytes
 3 files changed, 27 insertions(+)
 create mode 100644 tests/hoobr_chdlc_print.out
 create mode 100644 tests/hoobr_chdlc_print.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index 7b841e991..ec627cb82 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -455,6 +455,7 @@ hoobr_juniper		hoobr_juniper.pcap		hoobr_juniper.out
 hoobr_juniper2		hoobr_juniper2.pcap		hoobr_juniper2.out
 hoobr_juniper3		hoobr_juniper3.pcap		hoobr_juniper3.out
 hoobr_parse_field	hoobr_parse_field.pcap		hoobr_parse_field.out
+hoobr_chdlc_print	hoobr_chdlc_print.pcap		hoobr_chdlc_print.out
 
 # bad packets from Wilfried Kirsch
 slip-bad-direction	slip-bad-direction.pcap		slip-bad-direction.out	-ve
diff --git a/tests/hoobr_chdlc_print.out b/tests/hoobr_chdlc_print.out
new file mode 100644
index 000000000..5701077db
--- /dev/null
+++ b/tests/hoobr_chdlc_print.out
@@ -0,0 +1,26 @@
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+unknown CHDLC protocol (0x3030)
+[|chdlc]
diff --git a/tests/hoobr_chdlc_print.pcap b/tests/hoobr_chdlc_print.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..ffc75a4b214033df32874a86dfd75243e9a44d6b
GIT binary patch
literal 2016
zcmca|c+)~A1{MYbC}3e=V8~#Aa}6ATe3%?HXbB?Cqqe<+-8^E$#e$K#@j;C^9g1d9
nJ3SB^f7G^ju$wnr!e!JSl;v`2r_+%Z9|jDta{u2yQepxCYMyQ3

literal 0
HcmV?d00001"
CVE-2021-38593,"From 1ca02cf2879a5e1511a2f2109f0925cf4c892862 Mon Sep 17 00:00:00 2001
From: Eirik Aavitsland <eirik.aavitsland@qt.io>
Date: Fri, 23 Jul 2021 15:53:56 +0200
Subject: [PATCH] Improve fix for avoiding huge number of tiny dashes
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Some pathological cases were not caught by the previous fix.

Fixes: QTBUG-95239
Change-Id: I0337ee3923ff93ccb36c4d7b810a9c0667354cc5
Reviewed-by: Robert Löhning <robert.loehning@qt.io>
(cherry picked from commit 6b400e3147dcfd8cc3a393ace1bd118c93762e0c)
Reviewed-by: Qt Cherry-pick Bot <cherrypick_bot@qt-project.org>
---
 src/gui/painting/qpaintengineex.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/gui/painting/qpaintengineex.cpp b/src/gui/painting/qpaintengineex.cpp
index d752c01f6a7..2c034cdad78 100644
--- a/src/gui/painting/qpaintengineex.cpp
+++ b/src/gui/painting/qpaintengineex.cpp
@@ -426,7 +426,7 @@ void QPaintEngineEx::stroke(const QVectorPath &path, const QPen &inPen)
             patternLength *= pen.widthF();
         if (qFuzzyIsNull(patternLength)) {
             pen.setStyle(Qt::NoPen);
-        } else if (extent / patternLength > 10000) {
+        } else if (qFuzzyIsNull(extent) || extent / patternLength > 10000) {
             // approximate stream of tiny dashes with semi-transparent solid line
             pen.setStyle(Qt::SolidLine);
             QColor color(pen.color());"
CVE-2012-4396,"From e817504569dce49fd7a677fa510e500394af0c48 Mon Sep 17 00:00:00 2001
From: Bjoern Schiessle <schiessle@owncloud.com>
Date: Tue, 5 Jun 2012 10:46:28 +0200
Subject: [PATCH] xss vulnerability fixed

---
 apps/media/lib_scanner.php | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/apps/media/lib_scanner.php b/apps/media/lib_scanner.php
index dc2a8a9beb4a..82170e5ca82e 100644
--- a/apps/media/lib_scanner.php
+++ b/apps/media/lib_scanner.php
@@ -79,19 +79,19 @@ public static function scanFile($path){
 			OCP\Util::writeLog('media',""error reading artist tag in '$file'"",OCP\Util::WARN);
 			$artist='unknown';
 		}else{
-			$artist=stripslashes($data['comments']['artist'][0]);
+			$artist=strip_tags(stripslashes($data['comments']['artist'][0]));
 		}
 		if(!isset($data['comments']['album'])){
 			OCP\Util::writeLog('media',""error reading album tag in '$file'"",OCP\Util::WARN);
 			$album='unknown';
 		}else{
-			$album=stripslashes($data['comments']['album'][0]);
+			$album=strip_tags(stripslashes($data['comments']['album'][0]));
 		}
 		if(!isset($data['comments']['title'])){
 			OCP\Util::writeLog('media',""error reading title tag in '$file'"",OCP\Util::WARN);
 			$title='unknown';
 		}else{
-			$title=stripslashes($data['comments']['title'][0]);
+			$title=strip_tags(stripslashes($data['comments']['title'][0]));
 		}
 		$size=$data['filesize'];
 		if (isset($data['comments']['track']))"
OSV-2021-1159,"From d3e09bf4654fe5478b6dbf2b26ebab6271317d81 Mon Sep 17 00:00:00 2001
From: Behdad Esfahbod <behdad@behdad.org>
Date: Tue, 24 Aug 2021 10:31:49 -0600
Subject: [PATCH] [set] Make all operators null-safe again

Changed my mind.

Also for hb_map_clear().

Part of https://github.com/harfbuzz/harfbuzz/pull/3162
---
 src/hb-bit-set-invertible.hh | 38 ++++++++++++++++++++++++++++--------
 src/hb-map.cc                |  3 ---
 src/hb-map.hh                |  2 ++
 src/hb-set.cc                | 28 +++++++-------------------
 4 files changed, 39 insertions(+), 32 deletions(-)

diff --git a/src/hb-bit-set-invertible.hh b/src/hb-bit-set-invertible.hh
index ab48239bbf7..f48b72fe630 100644
--- a/src/hb-bit-set-invertible.hh
+++ b/src/hb-bit-set-invertible.hh
@@ -46,9 +46,22 @@ struct hb_bit_set_invertible_t
   bool in_error () const { return s.in_error (); }
   explicit operator bool () const { return !is_empty (); }
 
-  void reset () { s.reset (); inverted = false; }
-  void clear () { s.clear (); inverted = false; }
-  void invert () { inverted = !inverted; }
+  void reset ()
+  {
+    s.reset ();
+    inverted = false;
+  }
+  void clear ()
+  {
+    s.clear ();
+    if (likely (s.successful))
+      inverted = false;
+  }
+  void invert ()
+  {
+    if (likely (s.successful))
+      inverted = !inverted;
+  }
 
   bool is_empty () const
   {
@@ -116,7 +129,12 @@ struct hb_bit_set_invertible_t
     return next (&c) && c <= last;
   }
 
-  void set (const hb_bit_set_invertible_t &other) { s.set (other.s); inverted = other.inverted; }
+  void set (const hb_bit_set_invertible_t &other)
+  {
+    s.set (other.s);
+    if (likely (s.successful))
+      inverted = other.inverted;
+  }
 
   bool is_equal (const hb_bit_set_invertible_t &other) const
   {
@@ -161,7 +179,8 @@ struct hb_bit_set_invertible_t
       else
 	process (hb_bitwise_lt, other);
     }
-    inverted = inverted || other.inverted;
+    if (likely (s.successful))
+      inverted = inverted || other.inverted;
   }
   void intersect (const hb_bit_set_invertible_t &other)
   {
@@ -179,7 +198,8 @@ struct hb_bit_set_invertible_t
       else
 	process (hb_bitwise_gt, other);
     }
-    inverted = inverted && other.inverted;
+    if (likely (s.successful))
+      inverted = inverted && other.inverted;
   }
   void subtract (const hb_bit_set_invertible_t &other)
   {
@@ -197,12 +217,14 @@ struct hb_bit_set_invertible_t
       else
 	process (hb_bitwise_and, other);
     }
-    inverted = inverted && !other.inverted;
+    if (likely (s.successful))
+      inverted = inverted && !other.inverted;
   }
   void symmetric_difference (const hb_bit_set_invertible_t &other)
   {
     process (hb_bitwise_xor, other);
-    inverted = inverted ^ other.inverted;
+    if (likely (s.successful))
+      inverted = inverted ^ other.inverted;
   }
 
   bool next (hb_codepoint_t *codepoint) const
diff --git a/src/hb-map.cc b/src/hb-map.cc
index 388e67886d1..9f1ac42846d 100644
--- a/src/hb-map.cc
+++ b/src/hb-map.cc
@@ -255,9 +255,6 @@ hb_map_has (const hb_map_t *map,
 void
 hb_map_clear (hb_map_t *map)
 {
-  if (unlikely (hb_object_is_immutable (map)))
-    return;
-
   return map->clear ();
 }
 
diff --git a/src/hb-map.hh b/src/hb-map.hh
index 751cab68441..dcd5267d748 100644
--- a/src/hb-map.hh
+++ b/src/hb-map.hh
@@ -169,6 +169,8 @@ struct hb_hashmap_t
 
   void clear ()
   {
+    if (unlikely (!successful)) return;
+
     if (items)
       for (auto &_ : hb_iter (items, mask + 1))
 	_.clear ();
diff --git a/src/hb-set.cc b/src/hb-set.cc
index f9bc858697d..204dbb56454 100644
--- a/src/hb-set.cc
+++ b/src/hb-set.cc
@@ -201,9 +201,7 @@ hb_set_copy (const hb_set_t *set)
 void
 hb_set_clear (hb_set_t *set)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->clear ();
 }
 
@@ -368,9 +366,7 @@ void
 hb_set_set (hb_set_t       *set,
 	    const hb_set_t *other)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->set (*other);
 }
 
@@ -387,9 +383,7 @@ void
 hb_set_union (hb_set_t       *set,
 	      const hb_set_t *other)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->union_ (*other);
 }
 
@@ -406,9 +400,7 @@ void
 hb_set_intersect (hb_set_t       *set,
 		  const hb_set_t *other)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->intersect (*other);
 }
 
@@ -425,9 +417,7 @@ void
 hb_set_subtract (hb_set_t       *set,
 		 const hb_set_t *other)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->subtract (*other);
 }
 
@@ -445,9 +435,7 @@ void
 hb_set_symmetric_difference (hb_set_t       *set,
 			     const hb_set_t *other)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->symmetric_difference (*other);
 }
 
@@ -462,9 +450,7 @@ hb_set_symmetric_difference (hb_set_t       *set,
 void
 hb_set_invert (hb_set_t *set)
 {
-  if (unlikely (hb_object_is_immutable (set)))
-    return;
-
+  /* Immutible-safe. */
   set->invert ();
 }"
GHSA-f7r3-p866-q9qr,"From f0cc6dc913ec17b499fa33a676bb72c624456f2c Mon Sep 17 00:00:00 2001
From: Trinity Fox <671259+cottonflop@users.noreply.github.com>
Date: Wed, 29 May 2019 20:09:45 -0700
Subject: [PATCH] DOS fix

corrected unhandled connection 'end' event, fixes issue #1
---
 lib/index.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/index.js b/lib/index.js
index 5088eca..6349746 100644
--- a/lib/index.js
+++ b/lib/index.js
@@ -47,7 +47,7 @@ function create (options) {
 
 		client.on('end', function () {
 			debug('connection ended');
-			removeClient(client);
+			client.close();
 			app.emit('connection:end', client);
 		});"
CVE-2019-14286,"From 26bedd8a68c32a2f14460a8eac2a9fb09923392b Mon Sep 17 00:00:00 2001
From: mokaddem <sami.mokaddem@circl.lu>
Date: Sat, 27 Jul 2019 10:40:19 +0200
Subject: [PATCH] fix: [security] Fix to stored XSS

- as reported by David Heise
---
 app/webroot/js/event-graph.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/app/webroot/js/event-graph.js b/app/webroot/js/event-graph.js
index 19586d12dd6..80228639c64 100644
--- a/app/webroot/js/event-graph.js
+++ b/app/webroot/js/event-graph.js
@@ -2183,7 +2183,10 @@ eventGraph.update_scope();
 dataHandler.fetch_data_and_update(true, function() {
     var $select = $('#network-typeahead');
     dataHandler.get_typeaheadData_search().forEach(function(element) {
-        $select.append('<option value=""' + element + '"">' + element + '</option>');
+        var $option = $('<option></option>');
+        $option.text(element);
+        $option.attr('value', $option.text());
+        $select.append($option);
     });
     $('#network-typeahead').chosen(chosen_options).on('change', function(evt, params) {
         var value = params.selected;"
CVE-2016-10058,"From 4ec444f4eab88cf4bec664fafcf9cab50bc5ff6a Mon Sep 17 00:00:00 2001
From: dirk <dirk@git.imagemagick.org>
Date: Wed, 19 Oct 2016 07:29:36 +0200
Subject: [PATCH] Fixed memory leak.

---
 coders/psd.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/coders/psd.c b/coders/psd.c
index 2e587fed166..e936a7d669c 100644
--- a/coders/psd.c
+++ b/coders/psd.c
@@ -1719,6 +1719,8 @@ ModuleExport MagickBooleanType ReadPSDLayers(Image *image,
             if (image->debug != MagickFalse)
               (void) LogMagickEvent(CoderEvent,GetMagickModule(),
                 ""      layer data is empty"");
+            if (layer_info[i].info != (StringInfo *) NULL)
+              layer_info[i].info=DestroyStringInfo(layer_info[i].info);
             continue;
           }"
OSV-2020-1573,"From 96b65713528476eed35dbab690be837967cedb93 Mon Sep 17 00:00:00 2001
From: Benoit Blanchon <git@benoitblanchon.fr>
Date: Mon, 3 Aug 2020 09:44:17 +0200
Subject: [PATCH] Fixed use-of-uninitialized-value in encodeCodepoint()

---
 src/ArduinoJson/Json/Utf16.hpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/ArduinoJson/Json/Utf16.hpp b/src/ArduinoJson/Json/Utf16.hpp
index 33721a635..67fb5baec 100644
--- a/src/ArduinoJson/Json/Utf16.hpp
+++ b/src/ArduinoJson/Json/Utf16.hpp
@@ -31,6 +31,8 @@ inline bool isLowSurrogate(uint16_t codeunit) {
 
 class Codepoint {
  public:
+  Codepoint() : _highSurrogate(0) {}
+
   bool append(uint16_t codeunit) {
     if (isHighSurrogate(codeunit)) {
       _highSurrogate = codeunit & 0x3FF;"
OSV-2020-2108,"From a8bf10ea5a0ea2553f07ac46744666c94d0085fc Mon Sep 17 00:00:00 2001
From: Daniel Lemire <lemire@gmail.com>
Date: Fri, 30 Oct 2020 14:51:50 -0400
Subject: [PATCH] Minor patch.

---
 src/from_chars.cpp   | 16 ++++++++--------
 tests/basictests.cpp |  1 +
 2 files changed, 9 insertions(+), 8 deletions(-)

diff --git a/src/from_chars.cpp b/src/from_chars.cpp
index 188df44046..7250c47144 100644
--- a/src/from_chars.cpp
+++ b/src/from_chars.cpp
@@ -75,11 +75,9 @@ decimal parse_decimal(const char *&p) noexcept {
     ++p;
   }
   while (is_integer(*p)) {
-    if (answer.num_digits + 1 < max_digits) {
+    if (answer.num_digits < max_digits) {
       answer.digits[answer.num_digits] = uint8_t(*p - '0');
-    } else {
-      answer.truncated = true;
-    }
+    } 
     answer.num_digits++;
     ++p;
   }
@@ -95,11 +93,9 @@ decimal parse_decimal(const char *&p) noexcept {
       }
     }
     while (is_integer(*p)) {
-      if (answer.num_digits + 1 < max_digits) {
+      if (answer.num_digits < max_digits) {
         answer.digits[answer.num_digits] = uint8_t(*p - '0');
-      } else {
-        answer.truncated = true;
-      }
+      } 
       answer.num_digits++;
       ++p;
     }
@@ -126,6 +122,10 @@ decimal parse_decimal(const char *&p) noexcept {
     answer.decimal_point += (neg_exp ? -exp_number : exp_number);
   }
   answer.decimal_point += answer.num_digits;
+  if(answer.num_digits > max_digits ) {
+    answer.num_digits = max_digits;
+    answer.truncated = true;
+  }
   return answer;
 }
 
diff --git a/tests/basictests.cpp b/tests/basictests.cpp
index eaab08fa57..4aeae99882 100644
--- a/tests/basictests.cpp
+++ b/tests/basictests.cpp
@@ -48,6 +48,7 @@ namespace number_tests {
   bool ground_truth() {
     std::cout << __func__ << std::endl;
     std::pair<std::string,double> ground_truth[] = {
+      {""9355950000000000000.00000000000000000000000000000000001844674407370955161600000184467440737095516161844674407370955161407370955161618446744073709551616000184467440737095516166000001844674407370955161618446744073709551614073709551616184467440737095516160001844674407370955161601844674407370955674451616184467440737095516140737095516161844674407370955161600018446744073709551616018446744073709551611616000184467440737095001844674407370955161600184467440737095516160018446744073709551168164467440737095516160001844073709551616018446744073709551616184467440737095516160001844674407536910751601611616000184467440737095001844674407370955161600184467440737095516160018446744073709551616184467440737095516160001844955161618446744073709551616000184467440753691075160018446744073709"",0x1.03ae05e8fca1cp+63}, 
       {""2.2250738585072013e-308"",0x1p-1022},
       {""-92666518056446206563E3"", -0x1.39f764644154dp+76},
       {""-92666518056446206563E3"", -0x1.39f764644154dp+76},"
CVE-2016-9842,"From e54e1299404101a5a9d0cf5e45512b543967f958 Mon Sep 17 00:00:00 2001
From: Mark Adler <madler@alumni.caltech.edu>
Date: Sat, 5 Sep 2015 17:45:55 -0700
Subject: [PATCH] Avoid shifts of negative values inflateMark().

The C standard says that bit shifts of negative integers is
undefined.  This casts to unsigned values to assure a known
result.
---
 inflate.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/inflate.c b/inflate.c
index 2889e3a07..a71841670 100644
--- a/inflate.c
+++ b/inflate.c
@@ -1506,9 +1506,10 @@ z_streamp strm;
 {
     struct inflate_state FAR *state;
 
-    if (strm == Z_NULL || strm->state == Z_NULL) return -1L << 16;
+    if (strm == Z_NULL || strm->state == Z_NULL)
+        return (long)(((unsigned long)0 - 1) << 16);
     state = (struct inflate_state FAR *)strm->state;
-    return ((long)(state->back) << 16) +
+    return (long)(((unsigned long)((long)state->back)) << 16) +
         (state->mode == COPY ? state->length :
             (state->mode == MATCH ? state->was - state->length : 0));
 }"
OSV-2020-999,"From c6ce820d5ccfeca1c38e6644d72ca6543da01eb1 Mon Sep 17 00:00:00 2001
From: Petr Danecek <pd3@sanger.ac.uk>
Date: Wed, 11 Mar 2020 15:30:28 +0100
Subject: [PATCH] Acknowledge the existence of the symbolic <NON_REF> allele
 produced by GATK (PR #1045)

---
 vcf.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/vcf.c b/vcf.c
index 96253065e..81e7b8de4 100644
--- a/vcf.c
+++ b/vcf.c
@@ -3836,6 +3836,7 @@ static void bcf_set_variant_type(const char *ref, const char *alt, variant_t *va
     {
         if ( alt[1]=='X' && alt[2]=='>' ) { var->n = 0; var->type = VCF_REF; return; }  // mpileup's X allele shouldn't be treated as variant
         if ( alt[1]=='*' && alt[2]=='>' ) { var->n = 0; var->type = VCF_REF; return; }
+        if ( !strcmp(""NON_REF>"",alt+1) ) { var->n = 0; var->type = VCF_REF; return; }
         var->type = VCF_OTHER;
         return;
     }"
CVE-2016-7514,"From e14fd0a2801f73bdc123baf4fbab97dec55919eb Mon Sep 17 00:00:00 2001
From: dirk <dirk@git.imagemagick.org>
Date: Fri, 15 Jan 2016 01:27:31 +0100
Subject: [PATCH] Added missing call to ConstrainColormapIndex.

---
 coders/psd.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/coders/psd.c b/coders/psd.c
index 5f5fba6c62d..5a5c6338071 100644
--- a/coders/psd.c
+++ b/coders/psd.c
@@ -835,7 +835,8 @@ static MagickBooleanType ReadPSDChannelPixels(Image *image,
                   SetPixelIndex(image,(((unsigned char) pixel) &
                     (0x01 << (7-bit))) != 0 ? 0 : 255,q);
                   SetPixelViaPixelInfo(image,image->colormap+(ssize_t)
-                    GetPixelIndex(image,q),q);
+                    ConstrainColormapIndex(image,GetPixelIndex(image,q),
+                      exception),q);
                   q+=GetPixelChannels(image);
                   x++;
                 }"
CVE-2017-13725,"From c7c515ee03c285cc51376328de4ae9d549e501a5 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Wed, 15 Feb 2017 00:37:11 -0800
Subject: [PATCH] CVE-2017-13725/IPv6 R.H.: Add a capture file.

This is from Kamil Frankowicz testing an existing fix.

This is a test for the print-rt6.c fix I made after inspecting the code.
---
 tests/TESTLIST             |   1 +
 tests/hoobr_rt6_print.out  |   3 +++
 tests/hoobr_rt6_print.pcap | Bin 0 -> 732 bytes
 3 files changed, 4 insertions(+)
 create mode 100644 tests/hoobr_rt6_print.out
 create mode 100644 tests/hoobr_rt6_print.pcap

diff --git a/tests/TESTLIST b/tests/TESTLIST
index eaaeae1bd..0c4d45a11 100644
--- a/tests/TESTLIST
+++ b/tests/TESTLIST
@@ -457,6 +457,7 @@ hoobr_juniper3		hoobr_juniper3.pcap		hoobr_juniper3.out
 hoobr_parse_field	hoobr_parse_field.pcap		hoobr_parse_field.out
 hoobr_chdlc_print	hoobr_chdlc_print.pcap		hoobr_chdlc_print.out
 hoobr_lookup_nsap	hoobr_lookup_nsap.pcap		hoobr_lookup_nsap.out
+hoobr_rt6_print		hoobr_rt6_print.pcap		hoobr_rt6_print.out
 
 # bad packets from Wilfried Kirsch
 slip-bad-direction	slip-bad-direction.pcap		slip-bad-direction.out	-ve
diff --git a/tests/hoobr_rt6_print.out b/tests/hoobr_rt6_print.out
new file mode 100644
index 000000000..4fb3c4a82
--- /dev/null
+++ b/tests/hoobr_rt6_print.out
@@ -0,0 +1,3 @@
+unknown ip 3
+unknown ip 3
+IP6 3030:3030:3030:3030:3030:3030:3030:3030 > 3030:3030:3030:3030:3030:3030:3030:3030: [|srcrt]
diff --git a/tests/hoobr_rt6_print.pcap b/tests/hoobr_rt6_print.pcap
new file mode 100644
index 0000000000000000000000000000000000000000..d2d9507f5f2cf432c3f2a6a2879399419bb6aedc
GIT binary patch
literal 732
zcmca|c+)~A1{MYbD9~hJV0gj+=NcF>B5`1fMrjg4U^E0t2rTSMfoT#XkpPy}#;yj7
FC;*8ki0=RZ

literal 0
HcmV?d00001"
GHSA-fjqr-fx3f-g4rv,"From ce361a12e355f9e1e99c989f1ea056c9e502dbe7 Mon Sep 17 00:00:00 2001
From: Samuel Attard <samuel.r.attard@gmail.com>
Date: Wed, 31 Jan 2018 17:35:09 -0700
Subject: [PATCH] Use case-insensitive switch comparisons

---
 atom/app/command_line_args.cc | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/atom/app/command_line_args.cc b/atom/app/command_line_args.cc
index d7426de7dc564..e83eed46f2e11 100644
--- a/atom/app/command_line_args.cc
+++ b/atom/app/command_line_args.cc
@@ -1390,7 +1390,8 @@ bool IsBlacklistedArg(const base::CommandLine::CharType* arg) {
 
   if (prefix_length > 0) {
     a += prefix_length;
-    std::string switch_name(a, strcspn(a, ""=""));
+    std::string switch_name =
+        base::ToLowerASCII(base::StringPiece(a, strcspn(a, ""="")));
     auto* iter = std::lower_bound(std::begin(kBlacklist), std::end(kBlacklist),
                                   switch_name);
     if (iter != std::end(kBlacklist) && switch_name == *iter) {"
CVE-2022-28451,"From 47ff9a241243db9359f10216bcf401baaa36d0b4 Mon Sep 17 00:00:00 2001
From: skoshelev <sergey.k@nopcommerce.com>
Date: Mon, 28 Mar 2022 11:12:02 +0300
Subject: [PATCH] Fixed a possible issue with database backup filenames

---
 .../Nop.Web/Areas/Admin/Controllers/CommonController.cs         | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/Presentation/Nop.Web/Areas/Admin/Controllers/CommonController.cs b/src/Presentation/Nop.Web/Areas/Admin/Controllers/CommonController.cs
index 69ca0f6f4f4..ab7f9ea2e0a 100644
--- a/src/Presentation/Nop.Web/Areas/Admin/Controllers/CommonController.cs
+++ b/src/Presentation/Nop.Web/Areas/Admin/Controllers/CommonController.cs
@@ -262,6 +262,8 @@ public virtual async Task<IActionResult> BackupAction(MaintenanceModel model)
             var action = Request.Form[""action""];
 
             var fileName = Request.Form[""backupFileName""];
+            fileName = _fileProvider.GetFileName(_fileProvider.GetAbsolutePath(fileName));
+
             var backupPath = _maintenanceService.GetBackupPath(fileName);
 
             try"
CVE-2009-3111,"From 860cad9e02ba344edb0038419e415fe05a9a01f4 Mon Sep 17 00:00:00 2001
From: ""Alan T. DeKok"" <aland@freeradius.org>
Date: Mon, 7 Sep 2009 13:14:56 +0200
Subject: [PATCH] Fix crash on Tunnel-Password attributes with zero length

---
 src/lib/radius.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/lib/radius.c b/src/lib/radius.c
index 044ed8f53726..a3ab60aad160 100644
--- a/src/lib/radius.c
+++ b/src/lib/radius.c
@@ -1964,6 +1964,11 @@ int rad_decode(RADIUS_PACKET *packet, RADIUS_PACKET *original,
 		 *	over-ride this one.
 		 */
 	create_pair:
+		/*
+		 *	Ignore VSAs that have no data.
+		 */
+		if (attrlen == 0) goto next;
+
 		pair = rad_attr2vp(packet, original, secret,
 				 attribute, attrlen, ptr);
 		if (!pair) {
@@ -1976,6 +1981,7 @@ int rad_decode(RADIUS_PACKET *packet, RADIUS_PACKET *original,
 		*tail = pair;
 		tail = &pair->next;
 
+	next:
 		ptr += attrlen;
 		packet_length -= attrlen;
 	}"
OSV-2020-1777,"From d82a2f6c2181106e37079138dea41d7c070d16f2 Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Mon, 16 Dec 2019 10:31:22 -0800
Subject: [PATCH] Test fixes

---
 Zend/tests/bug78973.phpt       | 4 ++--
 ext/bcmath/tests/bug78878.phpt | 1 -
 ext/exif/tests/bug78910.phpt   | 4 ++--
 3 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/Zend/tests/bug78973.phpt b/Zend/tests/bug78973.phpt
index 5bdd16e402a41..e18c761ca612f 100644
--- a/Zend/tests/bug78973.phpt
+++ b/Zend/tests/bug78973.phpt
@@ -13,5 +13,5 @@ test(new class {
 
 ?>
 --EXPECTF--
-#0  class@anonymous->__destruct() called at [%s:4]
-#1  test() called at [%s:5]
+#0  class@anonymous->__destruct() called at [%s:%d]
+#1  test() called at [%s:%d]
diff --git a/ext/bcmath/tests/bug78878.phpt b/ext/bcmath/tests/bug78878.phpt
index 2c9d72b94680d..066d411c90060 100644
--- a/ext/bcmath/tests/bug78878.phpt
+++ b/ext/bcmath/tests/bug78878.phpt
@@ -9,5 +9,4 @@ if (!extension_loaded('bcmath')) die('skip bcmath extension not available');
 print @bcmul(""\xB26483605105519922841849335928742092"", bcpowmod(2, 65535, -4e-4));
 ?>
 --EXPECT--
-bc math warning: non-zero scale in modulus
 0
diff --git a/ext/exif/tests/bug78910.phpt b/ext/exif/tests/bug78910.phpt
index f5b1c32c1bd02..2f79e8debcf59 100644
--- a/ext/exif/tests/bug78910.phpt
+++ b/ext/exif/tests/bug78910.phpt
@@ -7,9 +7,9 @@ var_dump(exif_read_data('data:image/jpg;base64,TU0AKgAAAAwgICAgAAIBDwAEAAAAAgAAA
 
 ?>
 --EXPECTF--
-Notice: exif_read_data(): Read from TIFF: tag(0x927C, MakerNote  ): Illegal format code 0x2020, switching to BYTE in %s on line %d
+Notice: exif_read_data(): Read from TIFF: tag(0x927C,   MakerNote): Illegal format code 0x2020, switching to BYTE in %s on line %d
 
-Warning: exif_read_data(): Process tag(x927C=MakerNote  ): Illegal format code 0x2020, suppose BYTE in %s on line %d
+Warning: exif_read_data(): Process tag(x927C=MakerNote): Illegal format code 0x2020, suppose BYTE in %s on line %d
 
 Warning: exif_read_data(): IFD data too short: 0x0000 offset 0x000C in %s on line %d"
CVE-2018-5332,"From c095508770aebf1b9218e77026e48345d719b17c Mon Sep 17 00:00:00 2001
From: Mohamed Ghannam <simo.ghannam@gmail.com>
Date: Tue, 2 Jan 2018 19:44:34 +0000
Subject: [PATCH] RDS: Heap OOB write in rds_message_alloc_sgs()

When args->nr_local is 0, nr_pages gets also 0 due some size
calculation via rds_rm_size(), which is later used to allocate
pages for DMA, this bug produces a heap Out-Of-Bound write access
to a specific memory region.

Signed-off-by: Mohamed Ghannam <simo.ghannam@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
---
 net/rds/rdma.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/net/rds/rdma.c b/net/rds/rdma.c
index bc2f1e0977d657..94729d9da43721 100644
--- a/net/rds/rdma.c
+++ b/net/rds/rdma.c
@@ -525,6 +525,9 @@ int rds_rdma_extra_size(struct rds_rdma_args *args)
 
 	local_vec = (struct rds_iovec __user *)(unsigned long) args->local_vec_addr;
 
+	if (args->nr_local == 0)
+		return -EINVAL;
+
 	/* figure out the number of pages in the vector */
 	for (i = 0; i < args->nr_local; i++) {
 		if (copy_from_user(&vec, &local_vec[i],"
CVE-2020-25459,"From 6feccf6d752184a6f9365d56a76fe627983e7139 Mon Sep 17 00:00:00 2001
From: mgqa34 <mgq3374541@163.com>
Date: Fri, 7 Aug 2020 15:56:38 +0800
Subject: [PATCH] remove sensitive info of guest sending to host

Signed-off-by: mgqa34 <mgq3374541@163.com>
---
 .../tree/hetero/hetero_decision_tree_guest.py     | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/federatedml/tree/hetero/hetero_decision_tree_guest.py b/federatedml/tree/hetero/hetero_decision_tree_guest.py
index 1f23ddc532..028c74c005 100644
--- a/federatedml/tree/hetero/hetero_decision_tree_guest.py
+++ b/federatedml/tree/hetero/hetero_decision_tree_guest.py
@@ -529,10 +529,23 @@ def redispatch_node(self, dep=-1, max_depth_reach=False):
                                                                      unleaf_state_nodeid1) == 2 else unleaf_state_nodeid2)
         self.node_dispatch = self.node_dispatch.union(dispatch_guest_result)
 
+    def remove_sensitive_info(self):
+        """"""
+        host is not allowed to get weights/g/h
+        """"""
+        new_tree_ = copy.deepcopy(self.tree_)
+        for node in new_tree_:
+            node.weight = None
+            node.sum_grad = None
+            node.sum_hess = None
+
+        return new_tree_
+
     def sync_tree(self):
         LOGGER.info(""sync tree to host"")
 
-        self.transfer_inst.tree.remote(self.tree_,
+        tree_nodes = self.remove_sensitive_info()
+        self.transfer_inst.tree.remote(tree_nodes,
                                        role=consts.HOST,
                                        idx=-1)
         """""""
CVE-2011-1008,"From 2338cd19ed7a7f4c1e94f639ab2789d6586d01f3 Mon Sep 17 00:00:00 2001
From: sunnavy <sunnavy@bestpractical.com>
Date: Thu, 13 May 2010 20:28:35 +0800
Subject: [PATCH] security fix: clone the ticket to set CurrentUser

---
 lib/RT/Scrips_Overlay.pm | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/lib/RT/Scrips_Overlay.pm b/lib/RT/Scrips_Overlay.pm
index df24b3cff2e..1d307025776 100644
--- a/lib/RT/Scrips_Overlay.pm
+++ b/lib/RT/Scrips_Overlay.pm
@@ -283,7 +283,10 @@ sub _SetupSourceObjects {
             TransactionObj => undef,
             @_ );
 
-    if ( ( $self->{'TicketObj'} = $args{'TicketObj'} ) ) {
+
+    if ( $args{'TicketObj'} ) {
+        # clone the ticket here as we need to change CurrentUser
+        $self->{'TicketObj'} = bless { %{$args{'TicketObj'} } }, 'RT::Ticket';
         $self->{'TicketObj'}->CurrentUser( $self->CurrentUser );
     }
     else {"
CVE-2017-9992,"From f52fbf4f3ed02a7d872d8a102006f29b4421f360 Mon Sep 17 00:00:00 2001
From: Michael Niedermayer <michael@niedermayer.cc>
Date: Fri, 5 May 2017 20:42:11 +0200
Subject: [PATCH] avcodec/dfa: Fix off by 1 error

Fixes out of array access
Fixes: 1345/clusterfuzz-testcase-minimized-6062963045695488

Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg
Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
---
 libavcodec/dfa.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libavcodec/dfa.c b/libavcodec/dfa.c
index f45d019a79200..5ddb647c4cba7 100644
--- a/libavcodec/dfa.c
+++ b/libavcodec/dfa.c
@@ -175,7 +175,7 @@ static int decode_dds1(GetByteContext *gb, uint8_t *frame, int width, int height
                 return AVERROR_INVALIDDATA;
             frame += v;
         } else {
-            if (frame_end - frame < width + 3)
+            if (frame_end - frame < width + 4)
                 return AVERROR_INVALIDDATA;
             frame[0] = frame[1] =
             frame[width] = frame[width + 1] =  bytestream2_get_byte(gb);"
GHSA-g954-5hwp-pp24,"From b5f1391dff5515894830a6570e6d73f5511b2e8f Mon Sep 17 00:00:00 2001
From: Alexander Fenster <fenster@google.com>
Date: Fri, 20 May 2022 11:08:37 -0700
Subject: [PATCH] fix: do not let setProperty change the prototype (#1731)

---
 src/util.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/util.js b/src/util.js
index 5ae88cc7f..c39d33a6a 100644
--- a/src/util.js
+++ b/src/util.js
@@ -176,6 +176,9 @@ util.decorateEnum = function decorateEnum(object) {
 util.setProperty = function setProperty(dst, path, value) {
     function setProp(dst, path, value) {
         var part = path.shift();
+        if (part === ""__proto__"") {
+          return dst;
+        }
         if (path.length > 0) {
             dst[part] = setProp(dst[part] || {}, path, value);
         } else {"
CVE-2012-6545,"From f9432c5ec8b1e9a09b9b0e5569e3c73db8de432a Mon Sep 17 00:00:00 2001
From: Mathias Krause <minipli@googlemail.com>
Date: Wed, 15 Aug 2012 11:31:49 +0000
Subject: [PATCH] Bluetooth: RFCOMM - Fix info leak in ioctl(RFCOMMGETDEVLIST)

The RFCOMM code fails to initialize the two padding bytes of struct
rfcomm_dev_list_req inserted for alignment before copying it to
userland. Additionally there are two padding bytes in each instance of
struct rfcomm_dev_info. The ioctl() that for disclosures two bytes plus
dev_num times two bytes uninitialized kernel heap memory.

Allocate the memory using kzalloc() to fix this issue.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Cc: Marcel Holtmann <marcel@holtmann.org>
Cc: Gustavo Padovan <gustavo@padovan.org>
Cc: Johan Hedberg <johan.hedberg@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
---
 net/bluetooth/rfcomm/tty.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/net/bluetooth/rfcomm/tty.c b/net/bluetooth/rfcomm/tty.c
index cb960773c002ef..56f182393c4c7d 100644
--- a/net/bluetooth/rfcomm/tty.c
+++ b/net/bluetooth/rfcomm/tty.c
@@ -456,7 +456,7 @@ static int rfcomm_get_dev_list(void __user *arg)
 
 	size = sizeof(*dl) + dev_num * sizeof(*di);
 
-	dl = kmalloc(size, GFP_KERNEL);
+	dl = kzalloc(size, GFP_KERNEL);
 	if (!dl)
 		return -ENOMEM;"
CVE-2018-11117,"From ff9bf29858f2dbffe828711a6f8bf37038c00d77 Mon Sep 17 00:00:00 2001
From: Alexander Killing <killing@leifos.de>
Date: Fri, 11 May 2018 14:05:57 +0200
Subject: [PATCH] fixed 23026: link attribute

---
 Services/Feeds/classes/class.ilExternalFeedItem.php | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/Services/Feeds/classes/class.ilExternalFeedItem.php b/Services/Feeds/classes/class.ilExternalFeedItem.php
index 079ffbd43e93..aa3d7426fd6a 100644
--- a/Services/Feeds/classes/class.ilExternalFeedItem.php
+++ b/Services/Feeds/classes/class.ilExternalFeedItem.php
@@ -32,17 +32,16 @@ function setMagpieItem($a_item)
 		if (isset($a_item[""link_""]))
 		{
 			$this->setLink(
-				ilUtil::secureLink($this->secureString($a_item[""link_""])));
+				ilUtil::secureUrl(ilUtil::secureLink($this->secureString($a_item[""link_""]))));
 		}
 		else
 		{
 			if (isset($a_item[""link""]))
 			{
 				$this->setLink(
-					ilUtil::secureLink($this->secureString($a_item[""link""])));
+					ilUtil::secureUrl(ilUtil::secureLink($this->secureString($a_item[""link""]))));
 			}
 		}
-		
 		// summary
 		if (isset($a_item[""atom_content""]))
 		{"
GHSA-6p5r-g9mq-ggh2,"From ff8894044dfae5568ecbf2ed514c1a37dc394f1b Mon Sep 17 00:00:00 2001
From: Mihai Maruseac <mihaimaruseac@google.com>
Date: Fri, 30 Jul 2021 18:58:29 -0700
Subject: [PATCH] Add one missing valdiation to `matrix_set_diag_op.cc`

PiperOrigin-RevId: 387923408
Change-Id: If6a97b9098c13879400f56c22f91555cdf0ce5d7
---
 tensorflow/core/kernels/linalg/matrix_set_diag_op.cc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/tensorflow/core/kernels/linalg/matrix_set_diag_op.cc b/tensorflow/core/kernels/linalg/matrix_set_diag_op.cc
index 07b6e69de67dc4..4e89433718b463 100644
--- a/tensorflow/core/kernels/linalg/matrix_set_diag_op.cc
+++ b/tensorflow/core/kernels/linalg/matrix_set_diag_op.cc
@@ -70,6 +70,9 @@ class MatrixSetDiagOp : public OpKernel {
                   errors::InvalidArgument(
                       ""diag_index must be a scalar or vector, received shape: "",
                       diag_index.shape().DebugString()));
+      OP_REQUIRES(
+          context, diag_index.NumElements() > 0,
+          errors::InvalidArgument(""diag_index must have at least one element""));
       lower_diag_index = diag_index.flat<int32>()(0);
       upper_diag_index = lower_diag_index;
       if (TensorShapeUtils::IsVector(diag_index.shape())) {"
CVE-2021-39179,"From 16674ac75127b0e83691c6b1c9ce745e67ab58b6 Mon Sep 17 00:00:00 2001
From: Philip-Larsen-Donnelly
 <35666657+Philip-Larsen-Donnelly@users.noreply.github.com>
Date: Mon, 20 Sep 2021 21:55:47 +0200
Subject: [PATCH] build: correct patch PRs (#8771)

* build: correct patch PRs for CVE-2021-39179

* Update advisories.json
---
 .patches/security/advisories.json | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

diff --git a/.patches/security/advisories.json b/.patches/security/advisories.json
index b64b260dd15..b682c02a12c 100644
--- a/.patches/security/advisories.json
+++ b/.patches/security/advisories.json
@@ -6,11 +6,7 @@
         ""status"": ""FIXED"",
         ""pullRequests"": [
           {
-            ""prNumber"": 11,
-            ""target"": ""patch/2.34.7""
-          },
-          {
-            ""prNumber"": 4,
+            ""prNumber"": 14,
             ""target"": ""patch/2.35.7""
           },
           {
@@ -18,7 +14,7 @@
             ""target"": ""patch/2.35.8""
           },
           {
-            ""prNumber"": 3,
+            ""prNumber"": 16,
             ""target"": ""patch/2.36.4""
           }
         ]
@@ -29,15 +25,15 @@
         ""status"": ""FIXED"",
         ""pullRequests"": [
           {
-            ""prNumber"": 6,
+            ""prNumber"": 7,
             ""target"": ""patch/2.34.7""
           },
           {
-            ""prNumber"": 3,
+            ""prNumber"": 8,
             ""target"": ""patch/2.35.8""
           },
           {
-            ""prNumber"": 2,
+            ""prNumber"": 9,
             ""target"": ""patch/2.36.4""
           }
         ]"
GHSA-84g3-cv89-m9gm,"From 5b383c537eae7a00ebd26d3f7211dac99ddecb12 Mon Sep 17 00:00:00 2001
From: Paul Humphreys <querycsv@gmail.com>
Date: Wed, 10 Mar 2021 16:48:02 +0000
Subject: [PATCH] don't inadvertantly modify Object.prototype

---
 index.js | 11 +++++++++++
 test2.js |  5 +++++
 2 files changed, 16 insertions(+)
 create mode 100644 test2.js

diff --git a/index.js b/index.js
index bb62259..cb73ee6 100644
--- a/index.js
+++ b/index.js
@@ -102,6 +102,17 @@ const objectMerge = (original, patch, removeMode) => {
     }
     //merge objects
     else {
+      //Don't implicitly mutate Object.prototype but subsitute an empty object
+      if(original[name] === Object.prototype) {
+        delete original[name];
+
+        Object.defineProperty(original, name, {
+          enumerable: true,
+          writable: true,
+          value: {}
+        });
+      }
+
       original[name] = objectMerge(original[name], patch[name], removeMode);
     }
   }
diff --git a/test2.js b/test2.js
new file mode 100644
index 0000000..1be069c
--- /dev/null
+++ b/test2.js
@@ -0,0 +1,5 @@
+patchMerge = require('./index.js');
+var obj = {}
+console.log(""Before : "" + obj.isAdmin);
+console.log(patchMerge(obj, JSON.parse('{ ""__proto__"": { ""isAdmin"": true }}')));
+console.log(""After : "" + obj.isAdmin);"
CVE-2020-14400,"From 53073c8d7e232151ea2ecd8a1243124121e10e2d Mon Sep 17 00:00:00 2001
From: Tobias Junghans <tobydox@veyon.io>
Date: Wed, 27 May 2020 12:22:05 +0200
Subject: [PATCH] libvncserver: fix pointer aliasing/alignment issue

Accessing byte-aligned data through uint16_t pointers can cause crashes
on some platforms or reduce the performance. Therefore ensure a proper
stack alignment.
---
 libvncserver/translate.c | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/libvncserver/translate.c b/libvncserver/translate.c
index 7c341c2a2..7e6d3d8e0 100644
--- a/libvncserver/translate.c
+++ b/libvncserver/translate.c
@@ -360,9 +360,12 @@ rfbSetTranslateFunction(rfbClientPtr cl)
 static rfbBool
 rfbSetClientColourMapBGR233(rfbClientPtr cl)
 {
-    char buf[sz_rfbSetColourMapEntriesMsg + 256 * 3 * 2];
-    rfbSetColourMapEntriesMsg *scme = (rfbSetColourMapEntriesMsg *)buf;
-    uint16_t *rgb = (uint16_t *)(&buf[sz_rfbSetColourMapEntriesMsg]);
+    union {
+        char bytes[sz_rfbSetColourMapEntriesMsg + 256 * 3 * 2];
+        rfbSetColourMapEntriesMsg msg;
+    } buf;
+    rfbSetColourMapEntriesMsg *scme = &buf.msg;
+    uint16_t *rgb = (uint16_t *)(&buf.bytes[sz_rfbSetColourMapEntriesMsg]);
     int i, len;
     int r, g, b;
 
@@ -394,7 +397,7 @@ rfbSetClientColourMapBGR233(rfbClientPtr cl)
 
     len += 256 * 3 * 2;
 
-    if (rfbWriteExact(cl, buf, len) < 0) {
+    if (rfbWriteExact(cl, buf.bytes, len) < 0) {
         rfbLogPerror(""rfbSetClientColourMapBGR233: write"");
         rfbCloseClient(cl);
         return FALSE;"
OSV-2020-519,"From 3fc1d8ed86084f281583b074d86dc992cb9558c9 Mon Sep 17 00:00:00 2001
From: Catena cyber <35799796+catenacyber@users.noreply.github.com>
Date: Wed, 5 Jun 2019 04:32:19 +0200
Subject: [PATCH] Fixes MOS groups count (#1503)

---
 arch/MOS65XX/MOS65XXDisassembler.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/MOS65XX/MOS65XXDisassembler.c b/arch/MOS65XX/MOS65XXDisassembler.c
index f09c0e2dfb..74297f10f3 100644
--- a/arch/MOS65XX/MOS65XXDisassembler.c
+++ b/arch/MOS65XX/MOS65XXDisassembler.c
@@ -65,12 +65,12 @@ static void fillDetails(MCInst *MI, struct OpInfo opinfo, int cpu_type)
 	detail->mos65xx.op_count = 0;
 
 	if (insinfo.group_type != MOS65XX_GRP_INVALID) {
-		detail->groups[0] = insinfo.group_type;
+		detail->groups[detail->groups_count] = insinfo.group_type;
 		detail->groups_count++;
 	}
 
 	if (opinfo.am == MOS65XX_AM_REL || opinfo.am == MOS65XX_AM_ZP_REL) {
-		detail->groups[0] = MOS65XX_GRP_BRANCH_RELATIVE;
+		detail->groups[detail->groups_count] = MOS65XX_GRP_BRANCH_RELATIVE;
 		detail->groups_count++;	
 	}"
OSV-2020-2264,"From b3fc7bc453034aa61cd27d5208f08ead9c7789e0 Mon Sep 17 00:00:00 2001
From: Jonathan Hui <jonhui@google.com>
Date: Thu, 17 Dec 2020 07:08:15 -0800
Subject: [PATCH] [dataset] do not allow Extended TLVs in Operational Dataset
 (#5966)

---
 src/core/meshcop/dataset.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/core/meshcop/dataset.cpp b/src/core/meshcop/dataset.cpp
index f66adfc5340..2a7f05b4519 100644
--- a/src/core/meshcop/dataset.cpp
+++ b/src/core/meshcop/dataset.cpp
@@ -173,7 +173,8 @@ bool Dataset::IsValid(void) const
 
     for (const Tlv *cur = GetTlvsStart(); cur < end; cur = cur->GetNext())
     {
-        VerifyOrExit((cur + 1) <= end && cur->GetNext() <= end && Tlv::IsValid(*cur), rval = false);
+        VerifyOrExit(!cur->IsExtended() && (cur + 1) <= end && cur->GetNext() <= end && Tlv::IsValid(*cur),
+                     rval = false);
     }
 
 exit:"
CVE-2015-5078,"From 65d717415a271242b9a30a5330d4eabac1c1a837 Mon Sep 17 00:00:00 2001
From: Carsten Schmitz <carsten.schmitz@limesurvey.org>
Date: Fri, 26 Jun 2015 08:20:43 +0200
Subject: [PATCH] Fixed issue #9720: SQL injection vulnerability in data entry

---
 application/controllers/admin/dataentry.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/application/controllers/admin/dataentry.php b/application/controllers/admin/dataentry.php
index d6d623ccdbf..35ed84c1202 100644
--- a/application/controllers/admin/dataentry.php
+++ b/application/controllers/admin/dataentry.php
@@ -1716,7 +1716,7 @@ public function insert()
                         {
                             if (isset($usesleft) && $usesleft<=1)
                             {
-                                $utquery .= ""SET usesleft=usesleft-1, completed='$submitdate'\n"";
+                                $utquery .= ""SET usesleft=usesleft-1, completed="".dbQuoteAll($submitdate);
                             }
                             else
                             {"
CVE-2019-13133,"From fe3066122ef72c82415811d25e9e3fad622c0a99 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Tue, 18 Jun 2019 11:51:46 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/1600

---
 coders/bmp.c  | 2 +-
 coders/viff.c | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/coders/bmp.c b/coders/bmp.c
index fdabac95026..c964834fe88 100644
--- a/coders/bmp.c
+++ b/coders/bmp.c
@@ -1506,7 +1506,7 @@ static Image *ReadBMPImage(const ImageInfo *image_info,ExceptionInfo *exception)
         if (GetNextImageInList(image) == (Image *) NULL)
           {
             status=MagickFalse;
-            return((Image *) NULL);
+            break;
           }
         image=SyncNextImageInList(image);
         status=SetImageProgress(image,LoadImagesTag,TellBlob(image),
diff --git a/coders/viff.c b/coders/viff.c
index 5f89ad15e30..05aac7c5564 100644
--- a/coders/viff.c
+++ b/coders/viff.c
@@ -773,8 +773,8 @@ static Image *ReadVIFFImage(const ImageInfo *image_info,
         AcquireNextImage(image_info,image,exception);
         if (GetNextImageInList(image) == (Image *) NULL)
           {
-            image=DestroyImageList(image);
-            return((Image *) NULL);
+            status=MagickFalse;
+            break;
           }
         image=SyncNextImageInList(image);
         status=SetImageProgress(image,LoadImagesTag,TellBlob(image),"
CVE-2019-1010246,"From c888fbb6aaa7c5f8400f637bcf1cbb844de46cd9 Mon Sep 17 00:00:00 2001
From: orgeat <orgeat@users.noreply.github.com>
Date: Mon, 21 Jan 2019 17:32:45 +0100
Subject: [PATCH] Update NewslettersController.php

Test if an Exim ID was passed.
---
 .../users/application/controllers/NewslettersController.php     | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/www/guis/users/application/controllers/NewslettersController.php b/www/guis/users/application/controllers/NewslettersController.php
index 34f7c7fc..c0393c90 100644
--- a/www/guis/users/application/controllers/NewslettersController.php
+++ b/www/guis/users/application/controllers/NewslettersController.php
@@ -22,6 +22,8 @@ public function allowAction()
         $status = 0;
         
         $eximId = $this->getRequest()->getParam('id');
+	
+	if (strlen($eximId) == 0) { die(); }
 
         $spam = new Default_Model_DbTable_Spam();"
OSV-2020-725,"From 74958b8e88879302d6f61a813943b968cf03dbd5 Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Mon, 21 Oct 2019 00:25:53 +0200
Subject: [PATCH] Fix oobread in strlen with
 clusterfuzz-testcase-minimized-ia_fuzz-5767342952284160.dms

---
 libr/bin/format/mach0/mach0.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libr/bin/format/mach0/mach0.c b/libr/bin/format/mach0/mach0.c
index ae5a29aeeb273..1db4a25ad4fea 100644
--- a/libr/bin/format/mach0/mach0.c
+++ b/libr/bin/format/mach0/mach0.c
@@ -2277,7 +2277,7 @@ static int walk_exports(struct MACH0_(obj_t) *bin, RExportsIterator iterator, vo
 	if (!size) {
 		return count;
 	}
-	trie = malloc (size);
+	trie = calloc (size + 1, 1);
 	if (!trie) {
 		return count;
 	}"
CVE-2017-13139,"From d072ed6aff835c174e856ce3a428163c0da9e8f4 Mon Sep 17 00:00:00 2001
From: Glenn Randers-Pehrson <glennrp@gmail.com>
Date: Sun, 9 Jul 2017 22:42:32 -0400
Subject: [PATCH] Skip MNG CLIP chunk with out-of-range object IDs

---
 coders/png.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/coders/png.c b/coders/png.c
index d6d33ee3603..ea6dce6ab5f 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -5899,6 +5899,9 @@ static Image *ReadOneMNGImage(MngInfo* mng_info, const ImageInfo *image_info,
 
                 for (i=(int) first_object; i <= (int) last_object; i++)
                 {
+                  if ((i < 0) || (i >= MNG_MAX_OBJECTS))
+                    continue;
+
                   if (mng_info->exists[i] && !mng_info->frozen[i])
                     {
                       MngBox"
CVE-2021-33657,"From 8c91cf7dba5193f5ce12d06db1336515851c9ee9 Mon Sep 17 00:00:00 2001
From: Sam Lantinga <slouken@libsdl.org>
Date: Tue, 30 Nov 2021 12:36:46 -0800
Subject: [PATCH] Always create a full 256-entry map in case color values are
 out of range

Fixes https://github.com/libsdl-org/SDL/issues/5042
---
 src/video/SDL_pixels.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/video/SDL_pixels.c b/src/video/SDL_pixels.c
index ac04533c5d52b..9bb02f771d0eb 100644
--- a/src/video/SDL_pixels.c
+++ b/src/video/SDL_pixels.c
@@ -947,7 +947,7 @@ Map1to1(SDL_Palette * src, SDL_Palette * dst, int *identical)
         }
         *identical = 0;
     }
-    map = (Uint8 *) SDL_malloc(src->ncolors);
+    map = (Uint8 *) SDL_calloc(256, sizeof(Uint8));
     if (map == NULL) {
         SDL_OutOfMemory();
         return (NULL);
@@ -971,7 +971,7 @@ Map1toN(SDL_PixelFormat * src, Uint8 Rmod, Uint8 Gmod, Uint8 Bmod, Uint8 Amod,
     SDL_Palette *pal = src->palette;
 
     bpp = ((dst->BytesPerPixel == 3) ? 4 : dst->BytesPerPixel);
-    map = (Uint8 *) SDL_malloc(pal->ncolors * bpp);
+    map = (Uint8 *) SDL_calloc(256, bpp);
     if (map == NULL) {
         SDL_OutOfMemory();
         return (NULL);"
CVE-2015-7510,"From cb31827d62066a04b02111df3052949fda4b6888 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zbigniew=20J=C4=99drzejewski-Szmek?= <zbyszek@in.waw.pl>
Date: Mon, 23 Nov 2015 13:59:43 -0500
Subject: [PATCH] nss-mymachines: do not allow overlong machine names

https://github.com/systemd/systemd/issues/2002
---
 src/nss-mymachines/nss-mymachines.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/nss-mymachines/nss-mymachines.c b/src/nss-mymachines/nss-mymachines.c
index 969fa9619e174..c98a959b3b6d8 100644
--- a/src/nss-mymachines/nss-mymachines.c
+++ b/src/nss-mymachines/nss-mymachines.c
@@ -416,6 +416,9 @@ enum nss_status _nss_mymachines_getpwnam_r(
         if (!e || e == p)
                 goto not_found;
 
+        if (e - p > HOST_NAME_MAX - 1) /* -1 for the last dash */
+                goto not_found;
+
         r = parse_uid(e + 1, &uid);
         if (r < 0)
                 goto not_found;
@@ -573,6 +576,9 @@ enum nss_status _nss_mymachines_getgrnam_r(
         if (!e || e == p)
                 goto not_found;
 
+        if (e - p > HOST_NAME_MAX - 1)  /* -1 for the last dash */
+                goto not_found;
+
         r = parse_gid(e + 1, &gid);
         if (r < 0)
                 goto not_found;"
GHSA-gwcx-jrx4-92w2,"From 35f0fabb4c178253a964d7aabdbb15c6a398b69a Mon Sep 17 00:00:00 2001
From: Adrian Kuegel <akuegel@google.com>
Date: Tue, 21 Dec 2021 01:01:24 -0800
Subject: [PATCH] Avoid Segfault for scalar shapes.

Calling tensor::FromElementsOp with an empty vector of elements and no type
causes a segfault. We need to let the FromElementsOp know which scalar type it
should have.
Also add back the DynamicBroadcastInDimOp canonicalization patterns, which
previously prevented this bug from happening.
Add a regression test that demonstrates the bug.

PiperOrigin-RevId: 417561444
Change-Id: I6d1d6cfb71aabbad6102422625a00bbe253ac95a
---
 .../tf_cpurt_symbolic_shape_optimization.cc           |  4 ++++
 .../regression_tests/scalar_broadcast.mlir            | 11 +++++++++++
 2 files changed, 15 insertions(+)
 create mode 100644 tensorflow/compiler/mlir/tfrt/python_tests/regression_tests/scalar_broadcast.mlir

diff --git a/tensorflow/compiler/mlir/tfrt/jit/transforms/tf_cpurt_symbolic_shape_optimization.cc b/tensorflow/compiler/mlir/tfrt/jit/transforms/tf_cpurt_symbolic_shape_optimization.cc
index 628141a6cd4615..0a8fc42e80a7cd 100644
--- a/tensorflow/compiler/mlir/tfrt/jit/transforms/tf_cpurt_symbolic_shape_optimization.cc
+++ b/tensorflow/compiler/mlir/tfrt/jit/transforms/tf_cpurt_symbolic_shape_optimization.cc
@@ -157,6 +157,10 @@ llvm::Optional<Value> simplifyBroadcast(ShapeComponentAnalysis& analysis,
     shapes_found.push_back(*found_shape);
     maxRank = std::max(maxRank, found_shape->size());
   }
+  if (maxRank == 0) {
+    return Value(builder->create<tensor::FromElementsOp>(
+        loc, shapes[0].getType(), SmallVector<Value>()));
+  }
 
   SmallVector<const ShapeComponentAnalysis::SymbolicExpr*> joined_dimensions(
       maxRank);
diff --git a/tensorflow/compiler/mlir/tfrt/python_tests/regression_tests/scalar_broadcast.mlir b/tensorflow/compiler/mlir/tfrt/python_tests/regression_tests/scalar_broadcast.mlir
new file mode 100644
index 00000000000000..33b785ee6fb19d
--- /dev/null
+++ b/tensorflow/compiler/mlir/tfrt/python_tests/regression_tests/scalar_broadcast.mlir
@@ -0,0 +1,11 @@
+builtin.func @test(%V__0 : tensor<i1> { python_test_attrs.static_type = tensor<i1> }, %V__1 : tensor<f32> { python_test_attrs.static_type = tensor<f32> }, %V__2 : tensor<f32> { python_test_attrs.static_type = tensor<f32> }) -> tensor<f32> {
+  %0 = ""tf.Cast""(%V__0) : (tensor<i1>) -> tensor<i1>
+  %1 = ""tf.Selu""(%V__2) : (tensor<f32>) -> tensor<f32>
+  %2 = ""tf.NextAfter""(%1, %V__2) : (tensor<f32>, tensor<f32>) -> tensor<f32>
+  %3 = ""tf.Elu""(%2) : (tensor<f32>) -> tensor<f32>
+  %4 = ""tf.Cosh""(%3) : (tensor<f32>) -> tensor<f32>
+  %5 = ""tf.Elu""(%4) : (tensor<f32>) -> tensor<f32>
+  %6 = ""tf.Div""(%V__1, %5) : (tensor<f32>, tensor<f32>) -> tensor<f32>
+  %7 = ""tf.Select""(%0, %6, %V__1) : (tensor<i1>, tensor<f32>, tensor<f32>) -> tensor<f32>
+  return %7 : tensor<f32>
+}
\ No newline at end of file"
GHSA-6q9g-3vfq-q2qj,"From addd4f894d8173ec8ff0ae2212d51a1977e7bcad Mon Sep 17 00:00:00 2001
From: Paul Holden <paulh@moodle.com>
Date: Thu, 13 Jan 2022 23:00:57 +0000
Subject: [PATCH] MDL-72972 tool_uploaduser: observe capability to delete
 users.

---
 admin/tool/uploaduser/classes/process.php | 4 +++-
 admin/tool/uploaduser/user_form.php       | 5 +++++
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/admin/tool/uploaduser/classes/process.php b/admin/tool/uploaduser/classes/process.php
index 300f5e754b2d4..82f05910d3409 100644
--- a/admin/tool/uploaduser/classes/process.php
+++ b/admin/tool/uploaduser/classes/process.php
@@ -26,6 +26,7 @@
 
 defined('MOODLE_INTERNAL') || die();
 
+use context_system;
 use tool_uploaduser\local\field_value_validators;
 
 require_once($CFG->dirroot.'/user/profile/lib.php');
@@ -550,7 +551,8 @@ public function process_line(array $line) {
 
         // Delete user.
         if (!empty($user->deleted)) {
-            if (!$this->get_allow_deletes() or $remoteuser) {
+            if (!$this->get_allow_deletes() or $remoteuser or
+                    !has_capability('moodle/user:delete', context_system::instance())) {
                 $this->usersskipped++;
                 $this->upt->track('status', get_string('usernotdeletedoff', 'error'), 'warning');
                 return;
diff --git a/admin/tool/uploaduser/user_form.php b/admin/tool/uploaduser/user_form.php
index 8dcf4ce76a2c2..66e2e819d166a 100644
--- a/admin/tool/uploaduser/user_form.php
+++ b/admin/tool/uploaduser/user_form.php
@@ -147,6 +147,11 @@ function definition () {
 
         $mform->addElement('selectyesno', 'uuallowdeletes', get_string('allowdeletes', 'tool_uploaduser'));
         $mform->setDefault('uuallowdeletes', 0);
+        // Ensure user is able to perform user deletion.
+        if (!has_capability('moodle/user:delete', context_system::instance())) {
+            $mform->hardFreeze('uuallowdeletes');
+            $mform->setConstant('uuallowdeletes', 0);
+        }
         $mform->hideIf('uuallowdeletes', 'uutype', 'eq', UU_USER_ADDNEW);
         $mform->hideIf('uuallowdeletes', 'uutype', 'eq', UU_USER_ADDINC);"
CVE-2012-0207,"From a8c1f65c79cbbb2f7da782d4c9d15639a9b94b27 Mon Sep 17 00:00:00 2001
From: Ben Hutchings <ben@decadent.org.uk>
Date: Mon, 9 Jan 2012 14:06:46 -0800
Subject: [PATCH] igmp: Avoid zero delay when receiving odd mixture of IGMP
 queries

Commit 5b7c84066733c5dfb0e4016d939757b38de189e4 ('ipv4: correct IGMP
behavior on v3 query during v2-compatibility mode') added yet another
case for query parsing, which can result in max_delay = 0.  Substitute
a value of 1, as in the usual v3 case.

Reported-by: Simon McVittie <smcv@debian.org>
References: http://bugs.debian.org/654876
Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
Signed-off-by: David S. Miller <davem@davemloft.net>
---
 net/ipv4/igmp.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/net/ipv4/igmp.c b/net/ipv4/igmp.c
index fa057d105befea..5104bc0bbdbe73 100644
--- a/net/ipv4/igmp.c
+++ b/net/ipv4/igmp.c
@@ -880,6 +880,8 @@ static void igmp_heard_query(struct in_device *in_dev, struct sk_buff *skb,
 		 * to be intended in a v3 query.
 		 */
 		max_delay = IGMPV3_MRC(ih3->code)*(HZ/IGMP_TIMER_SCALE);
+		if (!max_delay)
+			max_delay = 1;	/* can't mod w/ 0 */
 	} else { /* v3 */
 		if (!pskb_may_pull(skb, sizeof(struct igmpv3_query)))
 			return;"
CVE-2016-7101,"From 8f8959033e4e59418d6506b345829af1f7a71127 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 18 Aug 2016 19:40:03 -0400
Subject: [PATCH] ...

---
 coders/sgi.c | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/coders/sgi.c b/coders/sgi.c
index 1fe65e604f3..0ccd9c03134 100644
--- a/coders/sgi.c
+++ b/coders/sgi.c
@@ -340,8 +340,10 @@ static Image *ReadSGIImage(const ImageInfo *image_info,ExceptionInfo *exception)
     iris_info.minimum_value=ReadBlobMSBLong(image);
     iris_info.maximum_value=ReadBlobMSBLong(image);
     iris_info.sans=ReadBlobMSBLong(image);
-    (void) ReadBlob(image,sizeof(iris_info.name),(unsigned char *)
+    count=ReadBlob(image,sizeof(iris_info.name),(unsigned char *)
       iris_info.name);
+    if (count != sizeof(iris_info.name))
+      ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
     iris_info.name[sizeof(iris_info.name)-1]='\0';
     if (*iris_info.name != '\0')
       (void) SetImageProperty(image,""label"",iris_info.name,exception);
@@ -349,7 +351,8 @@ static Image *ReadSGIImage(const ImageInfo *image_info,ExceptionInfo *exception)
     if (iris_info.pixel_format != 0)
       ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
     count=ReadBlob(image,sizeof(iris_info.filler),iris_info.filler);
-    (void) count;
+    if (count != sizeof(iris_info.filler))
+      ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
     image->columns=iris_info.columns;
     image->rows=iris_info.rows;
     image->depth=(size_t) MagickMin(iris_info.depth,MAGICKCORE_QUANTUM_DEPTH);
@@ -361,9 +364,7 @@ static Image *ReadSGIImage(const ImageInfo *image_info,ExceptionInfo *exception)
         image->storage_class=PseudoClass;
         image->colors=iris_info.bytes_per_pixel > 1 ? 65535 : 256;
       }
-    if (EOFBlob(image) != MagickFalse)
-      ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
-    if ((image_info->ping != MagickFalse)  && (image_info->number_scenes != 0))
+    if ((image_info->ping != MagickFalse) && (image_info->number_scenes != 0))
       if (image->scene >= (image_info->scene+image_info->number_scenes-1))
         break;
     status=SetImageExtent(image,image->columns,image->rows,exception);"
CVE-2016-7130,"From 698a691724c0a949295991e5df091ce16f899e02 Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Sun, 7 Aug 2016 16:26:52 -0700
Subject: [PATCH] Fix bug #72750: wddx_deserialize null dereference

---
 ext/wddx/tests/bug72750.phpt | 34 ++++++++++++++++++++++++++++++++++
 ext/wddx/wddx.c              |  8 ++++++--
 2 files changed, 40 insertions(+), 2 deletions(-)
 create mode 100644 ext/wddx/tests/bug72750.phpt

diff --git a/ext/wddx/tests/bug72750.phpt b/ext/wddx/tests/bug72750.phpt
new file mode 100644
index 0000000000000..3a6794df2803f
--- /dev/null
+++ b/ext/wddx/tests/bug72750.phpt
@@ -0,0 +1,34 @@
+--TEST--
+Bug #72750: wddx_deserialize null dereference
+--SKIPIF--
+<?php
+if (!extension_loaded('wddx')) {
+    die('skip. wddx not available');
+}
+?>
+--FILE--
+<?php
+
+$xml = <<< XML
+<?xml version='1.0'?>
+<!DOCTYPE wddxPacket SYSTEM 'wddx_0100.dtd'>
+<wddxPacket version='1.0'>
+<header/>
+        <data>
+                <struct>
+                     <var name='aBinary'>
+                         <binary length='11'>\\tYmluYXJRhdGE=</binary>
+                     </var>
+                 </struct>
+        </data>
+</wddxPacket>
+XML;
+
+$array = wddx_deserialize($xml);
+var_dump($array);
+?>
+--EXPECT--
+array(1) {
+  [""aBinary""]=>
+  string(0) """"
+}
diff --git a/ext/wddx/wddx.c b/ext/wddx/wddx.c
index faadbfe1dfe3d..1b2d103af18e3 100644
--- a/ext/wddx/wddx.c
+++ b/ext/wddx/wddx.c
@@ -959,8 +959,12 @@ static void php_wddx_pop_element(void *user_data, const XML_Char *name)
 
 			new_str = php_base64_decode(Z_STRVAL_P(ent1->data), Z_STRLEN_P(ent1->data), &new_len);
 			STR_FREE(Z_STRVAL_P(ent1->data));
-			Z_STRVAL_P(ent1->data) = new_str;
-			Z_STRLEN_P(ent1->data) = new_len;
+			if (new_str) {
+				Z_STRVAL_P(ent1->data) = new_str;
+				Z_STRLEN_P(ent1->data) = new_len;
+			} else {
+				ZVAL_EMPTY_STRING(ent1->data);
+			}
 		}
 
 		/* Call __wakeup() method on the object. */"
CVE-2019-19070,"From d3b0ffa1d75d5305ebe34735598993afbb8a869d Mon Sep 17 00:00:00 2001
From: Navid Emamdoost <navid.emamdoost@gmail.com>
Date: Mon, 30 Sep 2019 15:52:40 -0500
Subject: [PATCH] spi: gpio: prevent memory leak in spi_gpio_probe

In spi_gpio_probe an SPI master is allocated via spi_alloc_master, but
this controller should be released if devm_add_action_or_reset fails,
otherwise memory leaks. In order to avoid leak spi_contriller_put must
be called in case of failure for devm_add_action_or_reset.

Fixes: 8b797490b4db (""spi: gpio: Make sure spi_master_put() is called in every error path"")
Signed-off-by: Navid Emamdoost <navid.emamdoost@gmail.com>
Link: https://lore.kernel.org/r/20190930205241.5483-1-navid.emamdoost@gmail.com
Signed-off-by: Mark Brown <broonie@kernel.org>
---
 drivers/spi/spi-gpio.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/spi/spi-gpio.c b/drivers/spi/spi-gpio.c
index 1d3e23ec20a61f..f9c5bbb7471425 100644
--- a/drivers/spi/spi-gpio.c
+++ b/drivers/spi/spi-gpio.c
@@ -371,8 +371,10 @@ static int spi_gpio_probe(struct platform_device *pdev)
 		return -ENOMEM;
 
 	status = devm_add_action_or_reset(&pdev->dev, spi_gpio_put, master);
-	if (status)
+	if (status) {
+		spi_master_put(master);
 		return status;
+	}
 
 	if (of_id)
 		status = spi_gpio_probe_dt(pdev, master);"
GHSA-crp2-qrr5-8pq7,"From 787b4671dcc645737745956ee1bc2c9b3844aee1 Mon Sep 17 00:00:00 2001
From: Derek McGowan <derek@mcg.dev>
Date: Wed, 2 Mar 2022 09:30:34 -0800
Subject: [PATCH] Prepare release notes for v1.6.1

Signed-off-by: Derek McGowan <derek@mcg.dev>
---
 releases/v1.6.1.toml | 23 +++++++++++++++++++++++
 version/version.go   |  2 +-
 2 files changed, 24 insertions(+), 1 deletion(-)
 create mode 100644 releases/v1.6.1.toml

diff --git a/releases/v1.6.1.toml b/releases/v1.6.1.toml
new file mode 100644
index 000000000000..99a0d7ecbf72
--- /dev/null
+++ b/releases/v1.6.1.toml
@@ -0,0 +1,23 @@
+# commit to be tagged for new release
+commit = ""HEAD""
+
+project_name = ""containerd""
+github_repo = ""containerd/containerd""
+match_deps = ""^github.com/(containerd/[a-zA-Z0-9-]+)$""
+
+# previous release
+previous = ""v1.6.0""
+
+pre_release = false
+
+preface = """"""\
+The first patch release for containerd 1.6 includes a fix for
+[CVE-2022-23648](https://github.com/containerd/containerd/security/advisories/GHSA-crp2-qrr5-8pq7)
+and other issues.
+
+### Notable Updates
+
+* **Use fs.RootPath when mounting volumes** ([GHSA-crp2-qrr5-8pq7](https://github.com/containerd/containerd/security/advisories/GHSA-crp2-qrr5-8pq7))
+* **Return init pid when clean dead shim in runc.v1/v2 shims** ([#6572](https://github.com/containerd/containerd/pull/6572))
+
+See the changelog for complete list of changes""""""
diff --git a/version/version.go b/version/version.go
index 4470b128f3ea..a92784ef8191 100644
--- a/version/version.go
+++ b/version/version.go
@@ -23,7 +23,7 @@ var (
 	Package = ""github.com/containerd/containerd""
 
 	// Version holds the complete version number. Filled in at linking time.
-	Version = ""1.6.0+unknown""
+	Version = ""1.6.1+unknown""
 
 	// Revision is filled with the VCS (e.g. git) revision being used to build
 	// the program at linking time."
OSV-2021-1463,"From c10639fd4658a852049546162d116b123e2b1ec2 Mon Sep 17 00:00:00 2001
From: lazymio <mio@lazym.io>
Date: Sun, 13 Feb 2022 11:03:57 +0100
Subject: [PATCH] Bump version in bindings

---
 bindings/dotnet/UnicornManaged/Const/Common.fs               | 5 +++--
 bindings/go/unicorn/unicorn_const.go                         | 5 +++--
 bindings/java/unicorn/UnicornConst.java                      | 5 +++--
 bindings/pascal/unicorn/UnicornConst.pas                     | 5 +++--
 bindings/python/unicorn/unicorn_const.py                     | 5 +++--
 .../ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb     | 5 +++--
 6 files changed, 18 insertions(+), 12 deletions(-)

diff --git a/bindings/dotnet/UnicornManaged/Const/Common.fs b/bindings/dotnet/UnicornManaged/Const/Common.fs
index a8b85414f4..9134f90605 100644
--- a/bindings/dotnet/UnicornManaged/Const/Common.fs
+++ b/bindings/dotnet/UnicornManaged/Const/Common.fs
@@ -11,13 +11,13 @@ module Common =
     let UC_API_MINOR = 0
 
     let UC_API_PATCH = 0
-    let UC_API_EXTRA = 5
+    let UC_API_EXTRA = 6
     let UC_VERSION_MAJOR = 2
 
     let UC_VERSION_MINOR = 0
 
     let UC_VERSION_PATCH = 0
-    let UC_VERSION_EXTRA = 5
+    let UC_VERSION_EXTRA = 6
     let UC_SECOND_SCALE = 1000000
     let UC_MILISECOND_SCALE = 1000
     let UC_ARCH_ARM = 1
@@ -38,6 +38,7 @@ module Common =
     let UC_MODE_THUMB = 16
     let UC_MODE_MCLASS = 32
     let UC_MODE_V8 = 64
+    let UC_MODE_ARMBE8 = 128
     let UC_MODE_ARM926 = 128
     let UC_MODE_ARM946 = 256
     let UC_MODE_ARM1176 = 512
diff --git a/bindings/go/unicorn/unicorn_const.go b/bindings/go/unicorn/unicorn_const.go
index 052cdd1da9..c0dcfa283d 100644
--- a/bindings/go/unicorn/unicorn_const.go
+++ b/bindings/go/unicorn/unicorn_const.go
@@ -6,13 +6,13 @@ const (
 	API_MINOR = 0
 
 	API_PATCH = 0
-	API_EXTRA = 5
+	API_EXTRA = 6
 	VERSION_MAJOR = 2
 
 	VERSION_MINOR = 0
 
 	VERSION_PATCH = 0
-	VERSION_EXTRA = 5
+	VERSION_EXTRA = 6
 	SECOND_SCALE = 1000000
 	MILISECOND_SCALE = 1000
 	ARCH_ARM = 1
@@ -33,6 +33,7 @@ const (
 	MODE_THUMB = 16
 	MODE_MCLASS = 32
 	MODE_V8 = 64
+	MODE_ARMBE8 = 128
 	MODE_ARM926 = 128
 	MODE_ARM946 = 256
 	MODE_ARM1176 = 512
diff --git a/bindings/java/unicorn/UnicornConst.java b/bindings/java/unicorn/UnicornConst.java
index 4d8554f63a..cc2b66d378 100644
--- a/bindings/java/unicorn/UnicornConst.java
+++ b/bindings/java/unicorn/UnicornConst.java
@@ -8,13 +8,13 @@ public interface UnicornConst {
    public static final int UC_API_MINOR = 0;
 
    public static final int UC_API_PATCH = 0;
-   public static final int UC_API_EXTRA = 5;
+   public static final int UC_API_EXTRA = 6;
    public static final int UC_VERSION_MAJOR = 2;
 
    public static final int UC_VERSION_MINOR = 0;
 
    public static final int UC_VERSION_PATCH = 0;
-   public static final int UC_VERSION_EXTRA = 5;
+   public static final int UC_VERSION_EXTRA = 6;
    public static final int UC_SECOND_SCALE = 1000000;
    public static final int UC_MILISECOND_SCALE = 1000;
    public static final int UC_ARCH_ARM = 1;
@@ -35,6 +35,7 @@ public interface UnicornConst {
    public static final int UC_MODE_THUMB = 16;
    public static final int UC_MODE_MCLASS = 32;
    public static final int UC_MODE_V8 = 64;
+   public static final int UC_MODE_ARMBE8 = 128;
    public static final int UC_MODE_ARM926 = 128;
    public static final int UC_MODE_ARM946 = 256;
    public static final int UC_MODE_ARM1176 = 512;
diff --git a/bindings/pascal/unicorn/UnicornConst.pas b/bindings/pascal/unicorn/UnicornConst.pas
index 4ae08515a5..5306d8f85d 100644
--- a/bindings/pascal/unicorn/UnicornConst.pas
+++ b/bindings/pascal/unicorn/UnicornConst.pas
@@ -9,13 +9,13 @@ interface
   UC_API_MINOR = 0;
 
   UC_API_PATCH = 0;
-  UC_API_EXTRA = 5;
+  UC_API_EXTRA = 6;
   UC_VERSION_MAJOR = 2;
 
   UC_VERSION_MINOR = 0;
 
   UC_VERSION_PATCH = 0;
-  UC_VERSION_EXTRA = 5;
+  UC_VERSION_EXTRA = 6;
   UC_SECOND_SCALE = 1000000;
   UC_MILISECOND_SCALE = 1000;
   UC_ARCH_ARM = 1;
@@ -36,6 +36,7 @@ interface
   UC_MODE_THUMB = 16;
   UC_MODE_MCLASS = 32;
   UC_MODE_V8 = 64;
+  UC_MODE_ARMBE8 = 128;
   UC_MODE_ARM926 = 128;
   UC_MODE_ARM946 = 256;
   UC_MODE_ARM1176 = 512;
diff --git a/bindings/python/unicorn/unicorn_const.py b/bindings/python/unicorn/unicorn_const.py
index 1737a2c8ec..573a043c8f 100644
--- a/bindings/python/unicorn/unicorn_const.py
+++ b/bindings/python/unicorn/unicorn_const.py
@@ -4,13 +4,13 @@
 UC_API_MINOR = 0
 
 UC_API_PATCH = 0
-UC_API_EXTRA = 5
+UC_API_EXTRA = 6
 UC_VERSION_MAJOR = 2
 
 UC_VERSION_MINOR = 0
 
 UC_VERSION_PATCH = 0
-UC_VERSION_EXTRA = 5
+UC_VERSION_EXTRA = 6
 UC_SECOND_SCALE = 1000000
 UC_MILISECOND_SCALE = 1000
 UC_ARCH_ARM = 1
@@ -31,6 +31,7 @@
 UC_MODE_THUMB = 16
 UC_MODE_MCLASS = 32
 UC_MODE_V8 = 64
+UC_MODE_ARMBE8 = 128
 UC_MODE_ARM926 = 128
 UC_MODE_ARM946 = 256
 UC_MODE_ARM1176 = 512
diff --git a/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb b/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb
index e12c7be43c..794bc16bff 100644
--- a/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb
+++ b/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb
@@ -6,13 +6,13 @@ module UnicornEngine
 	UC_API_MINOR = 0
 
 	UC_API_PATCH = 0
-	UC_API_EXTRA = 5
+	UC_API_EXTRA = 6
 	UC_VERSION_MAJOR = 2
 
 	UC_VERSION_MINOR = 0
 
 	UC_VERSION_PATCH = 0
-	UC_VERSION_EXTRA = 5
+	UC_VERSION_EXTRA = 6
 	UC_SECOND_SCALE = 1000000
 	UC_MILISECOND_SCALE = 1000
 	UC_ARCH_ARM = 1
@@ -33,6 +33,7 @@ module UnicornEngine
 	UC_MODE_THUMB = 16
 	UC_MODE_MCLASS = 32
 	UC_MODE_V8 = 64
+	UC_MODE_ARMBE8 = 128
 	UC_MODE_ARM926 = 128
 	UC_MODE_ARM946 = 256
 	UC_MODE_ARM1176 = 512"
OSV-2020-784,"From c733067d6d52acc8031792316c0ee58990cdd0e8 Mon Sep 17 00:00:00 2001
From: Luca Boccassi <bluca@debian.org>
Date: Sat, 15 Aug 2020 14:30:33 +0100
Subject: [PATCH] Problem: use-after-free in WS

Solution: bail out of the stream engine out_event if ws_engine raises
an error
---
 src/stream_engine_base.cpp | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)

diff --git a/src/stream_engine_base.cpp b/src/stream_engine_base.cpp
index 275be24d94..9b9563a9bc 100644
--- a/src/stream_engine_base.cpp
+++ b/src/stream_engine_base.cpp
@@ -344,8 +344,14 @@ void zmq::stream_engine_base_t::out_event ()
         _outsize = _encoder->encode (&_outpos, 0);
 
         while (_outsize < static_cast<size_t> (_options.out_batch_size)) {
-            if ((this->*_next_msg) (&_tx_msg) == -1)
-                break;
+            if ((this->*_next_msg) (&_tx_msg) == -1) {
+                //  ws_engine can cause an engine error and delete it, so
+                //  bail out immediately to avoid use-after-free
+                if (errno == ECONNRESET)
+                    return;
+                else
+                    break;
+            }
             _encoder->load_msg (&_tx_msg);
             unsigned char *bufptr = _outpos + _outsize;
             const size_t n ="
GHSA-6j89-jhpr-849f,"From 3fe5e24694729966a157dc613f5586a6c75f1e9b Mon Sep 17 00:00:00 2001
From: Paul Leathers <pleath@microsoft.com>
Date: Tue, 3 Sep 2019 12:26:32 -0700
Subject: [PATCH] CVE-2019-1307

---
 lib/Backend/GlobOpt.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/lib/Backend/GlobOpt.h b/lib/Backend/GlobOpt.h
index e141d2c84db..725ac0ea975 100644
--- a/lib/Backend/GlobOpt.h
+++ b/lib/Backend/GlobOpt.h
@@ -370,6 +370,7 @@ class JsArrayKills
             (valueType.IsArrayOrObjectWithArray() &&
              (
               (killsArraysWithNoMissingValues && valueType.HasNoMissingValues()) ||
+              (killsObjectArraysWithNoMissingValues && !valueType.IsArray() && valueType.HasNoMissingValues()) ||
               (killsNativeArrays && !valueType.HasVarElements())
              )
             );"
OSV-2022-40,"From 62b60979f6a281b2b3cf883abc84299431fe2f76 Mon Sep 17 00:00:00 2001
From: Martin Mitas <mity@morous.org>
Date: Fri, 14 Jan 2022 10:00:09 +0100
Subject: [PATCH] Reset TABLECELLBOUNDARIES with ordinary opener chains.

This is needed because special handling of '|' is now done also if the
wiki-links extension is enabled so the chain is populated even with that
extension.

Fixes #174.
---
 CHANGELOG.md | 6 +++---
 src/md4c.c   | 8 +++++++-
 2 files changed, 10 insertions(+), 4 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index ccf7c74b..eccf9016 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -49,9 +49,9 @@ Fixes:
    Fix quadratic time behavior caused by unnecessary lookup for link reference
    definition even if the potential label contains nested brackets.
 
- * [#173](https://github.com/mity/md4c/issues/173):
-   Fix broken internal state invoked by devilish combination of syntax
-   constructions.
+ * [#173](https://github.com/mity/md4c/issues/173),
+   [#174](https://github.com/mity/md4c/issues/174):
+   Multiple bugs identified with oss-fuzz were fixed.
 
 
 ## Version 0.4.8
diff --git a/src/md4c.c b/src/md4c.c
index 779f808c..5cdffe16 100644
--- a/src/md4c.c
+++ b/src/md4c.c
@@ -192,7 +192,7 @@ struct MD_CTX_tag {
 #define TILDE_OPENERS_2                         (ctx->mark_chains[10])
 #define BRACKET_OPENERS                         (ctx->mark_chains[11])
 #define DOLLAR_OPENERS                          (ctx->mark_chains[12])
-#define OPENERS_CHAIN_FIRST                     2
+#define OPENERS_CHAIN_FIRST                     1
 #define OPENERS_CHAIN_LAST                      12
 
     int n_table_cell_boundaries;
@@ -2650,6 +2650,10 @@ md_rollback(MD_CTX* ctx, int opener_index, int closer_index, int how)
     int i;
     int mark_index;
 
+    fprintf(stderr, ""md_rollback: %d ... %d [%s]\n"",
+            ctx->marks[opener_index].beg, ctx->marks[closer_index].beg,
+            (how == MD_ROLLBACK_ALL ? ""all"" : ""crossing""));
+
     /* Cut all unresolved openers at the mark index. */
     for(i = OPENERS_CHAIN_FIRST; i < OPENERS_CHAIN_LAST+1; i++) {
         MD_MARKCHAIN* chain = &ctx->mark_chains[i];
@@ -3439,6 +3443,8 @@ md_resolve_links(MD_CTX* ctx, const MD_LINE* lines, int n_lines)
         MD_LINK_ATTR attr;
         int is_link = FALSE;
 
+        fprintf(stderr, ""md_resolve_links: %d ... %d\n"", opener->beg, closer->beg);
+
         if(next_index >= 0) {
             next_opener = &ctx->marks[next_index];
             next_closer = &ctx->marks[next_opener->next];"
CVE-2022-2733,"From 59458bc15ab0cb556c521de9d5187167d6f88945 Mon Sep 17 00:00:00 2001
From: Brady Miller <brady.g.miller@gmail.com>
Date: Sat, 6 Aug 2022 00:41:11 -0700
Subject: [PATCH] bug fix e7 (#5672)

---
 interface/forms/fee_sheet/review/fee_sheet_options_ajax.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/interface/forms/fee_sheet/review/fee_sheet_options_ajax.php b/interface/forms/fee_sheet/review/fee_sheet_options_ajax.php
index b86757eae51..06ba527e70d 100644
--- a/interface/forms/fee_sheet/review/fee_sheet_options_ajax.php
+++ b/interface/forms/fee_sheet/review/fee_sheet_options_ajax.php
@@ -31,4 +31,4 @@
 $retval = array();
 $retval['fee_sheet_options'] = $fso;
 $retval['pricelevel'] = $pricelevel;
-echo json_encode($retval);
+echo text(json_encode($retval));"
CVE-2020-23907,"From 517298bafaaff0a8e3dd60dd055a67c41b545807 Mon Sep 17 00:00:00 2001
From: azhou <seviezhou@163.com>
Date: Tue, 10 Sep 2019 02:02:50 +0800
Subject: [PATCH] Try to fix issue #637

Reference: https://github.com/avast/retdec/issues/637
---
 src/bin2llvmir/optimizations/decoder/ir_modifications.cpp | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp b/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp
index 40118c3e5..320c0aea6 100644
--- a/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp
+++ b/src/bin2llvmir/optimizations/decoder/ir_modifications.cpp
@@ -423,6 +423,9 @@ bool Decoder::canSplitFunctionOn(
 				continue;
 			}
 			auto up = fncStarts.upper_bound(bAddr);
+			if (up == fncStarts.begin()) {
+				return false;
+			}	
 			--up;
 			Address bFnc = *up;
 
@@ -442,6 +445,9 @@ bool Decoder::canSplitFunctionOn(
 					continue;
 				}
 				auto up = fncStarts.upper_bound(pAddr);
+				if (up == fncStarts.begin()) {
+					return false;
+				}
 				--up;
 				Address pFnc = *up;"
GHSA-3wfj-vh84-732p,"From 00921f22ff9a8792d7663ef8fadd4823402a6324 Mon Sep 17 00:00:00 2001
From: Timothy Bish <tabish121@gmail.com>
Date: Wed, 13 Aug 2014 11:15:29 -0400
Subject: [PATCH] Remove unused ConnectionControl handling.

---
 .../java/org/apache/activemq/broker/TransportConnection.java  | 4 ----
 1 file changed, 4 deletions(-)

diff --git a/activemq-broker/src/main/java/org/apache/activemq/broker/TransportConnection.java b/activemq-broker/src/main/java/org/apache/activemq/broker/TransportConnection.java
index 22a63b8cf9b..5bb7ec1ec0b 100755
--- a/activemq-broker/src/main/java/org/apache/activemq/broker/TransportConnection.java
+++ b/activemq-broker/src/main/java/org/apache/activemq/broker/TransportConnection.java
@@ -1534,10 +1534,6 @@ public int getProtocolVersion() {
 
     @Override
     public Response processControlCommand(ControlCommand command) throws Exception {
-        String control = command.getCommand();
-        if (control != null && control.equals(""shutdown"")) {
-            System.exit(0);
-        }
         return null;
     }"
CVE-2019-10864,"From 5aec0a08680f0afea387267a8d1b9fbb3379247c Mon Sep 17 00:00:00 2001
From: Mehrshad Darzi <mehrshad198@gmail.com>
Date: Tue, 9 Apr 2019 10:58:48 +0430
Subject: [PATCH] fix xss Attach Get Title Of Page

---
 includes/functions/functions.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/includes/functions/functions.php b/includes/functions/functions.php
index fc41bb8a1..ed6149bec 100644
--- a/includes/functions/functions.php
+++ b/includes/functions/functions.php
@@ -2094,7 +2094,7 @@ function wp_statistics_get_site_title( $url ) {
 		if ( isset( $dom ) and $dom->getElementsByTagName( 'title' )->length > 0 ) {
 			$title = $dom->getElementsByTagName( 'title' )->item( '0' )->nodeValue;
 		}
-		return ( wp_strip_all_tags( $title ) == """" ? false : $title );
+		return ( wp_strip_all_tags( $title ) == """" ? false : wp_strip_all_tags( $title ) );
 	}
 
 	return false;"
CVE-2019-18408,"From b8592ecba2f9e451e1f5cb7ab6dcee8b8e7b3f60 Mon Sep 17 00:00:00 2001
From: Martin Matuska <martin@matuska.org>
Date: Sat, 11 May 2019 02:36:53 +0200
Subject: [PATCH] RAR reader: fix use after free

If read_data_compressed() returns ARCHIVE_FAILED, the caller is allowed
to continue with next archive headers. We need to set rar->start_new_table
after the ppmd7_context got freed, otherwise it won't be allocated again.

Reported by: OSS-Fuzz issue 2582
---
 libarchive/archive_read_support_format_rar.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/libarchive/archive_read_support_format_rar.c b/libarchive/archive_read_support_format_rar.c
index a8cc5c94d8..49360876c2 100644
--- a/libarchive/archive_read_support_format_rar.c
+++ b/libarchive/archive_read_support_format_rar.c
@@ -1024,8 +1024,10 @@ archive_read_format_rar_read_data(struct archive_read *a, const void **buff,
   case COMPRESS_METHOD_GOOD:
   case COMPRESS_METHOD_BEST:
     ret = read_data_compressed(a, buff, size, offset);
-    if (ret != ARCHIVE_OK && ret != ARCHIVE_WARN)
+    if (ret != ARCHIVE_OK && ret != ARCHIVE_WARN) {
       __archive_ppmd7_functions.Ppmd7_Free(&rar->ppmd7_context);
+      rar->start_new_table = 1;
+    }
     break;
 
   default:"
CVE-2013-2091,"From 9427e32e2ed54c1a2bc519a88c057207836df489 Mon Sep 17 00:00:00 2001
From: fhenry <florian.henry@open-concept.pro>
Date: Fri, 10 May 2013 15:04:16 +0200
Subject: [PATCH] Fix security breach (SQL injection)

---
 htdocs/adherents/fiche.php | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/htdocs/adherents/fiche.php b/htdocs/adherents/fiche.php
index 02e0af3a768b4..57aa72e70ca8c 100644
--- a/htdocs/adherents/fiche.php
+++ b/htdocs/adherents/fiche.php
@@ -958,10 +958,11 @@ function initfieldrequired()
 		$adht = new AdherentType($db);
 		$adht->fetch($object->typeid);
 
+		$country=GETPOST('pays','int');
 		// We set country_id, and country_code, country of the chosen country
-		if (isset($_POST[""pays""]) || $object->country_id)
+		if (!empty($country) || $object->country_id)
 		{
-			$sql = ""SELECT rowid, code, libelle as label from "".MAIN_DB_PREFIX.""c_pays where rowid = "".(isset($_POST[""pays""])?$_POST[""pays""]:$object->country_id);
+			$sql = ""SELECT rowid, code, libelle as label from "".MAIN_DB_PREFIX.""c_pays where rowid = "".(!empty($country)?$country:$object->country_id);
 			$resql=$db->query($sql);
 			if ($resql)
 			{"
CVE-2022-0382,"From d6d86830705f173fca6087a3e67ceaf68db80523 Mon Sep 17 00:00:00 2001
From: Haimin Zhang <tcs_kernel@tencent.com>
Date: Fri, 31 Dec 2021 10:35:23 +0800
Subject: [PATCH] net ticp:fix a kernel-infoleak in __tipc_sendmsg()

struct tipc_socket_addr.ref has a 4-byte hole,and __tipc_getname() currently
copying it to user space,causing kernel-infoleak.

BUG: KMSAN: kernel-infoleak in instrument_copy_to_user include/linux/instrumented.h:121 [inline]
BUG: KMSAN: kernel-infoleak in instrument_copy_to_user include/linux/instrumented.h:121 [inline] lib/usercopy.c:33
BUG: KMSAN: kernel-infoleak in _copy_to_user+0x1c9/0x270 lib/usercopy.c:33 lib/usercopy.c:33
 instrument_copy_to_user include/linux/instrumented.h:121 [inline]
 instrument_copy_to_user include/linux/instrumented.h:121 [inline] lib/usercopy.c:33
 _copy_to_user+0x1c9/0x270 lib/usercopy.c:33 lib/usercopy.c:33
 copy_to_user include/linux/uaccess.h:209 [inline]
 copy_to_user include/linux/uaccess.h:209 [inline] net/socket.c:287
 move_addr_to_user+0x3f6/0x600 net/socket.c:287 net/socket.c:287
 __sys_getpeername+0x470/0x6b0 net/socket.c:1987 net/socket.c:1987
 __do_sys_getpeername net/socket.c:1997 [inline]
 __se_sys_getpeername net/socket.c:1994 [inline]
 __do_sys_getpeername net/socket.c:1997 [inline] net/socket.c:1994
 __se_sys_getpeername net/socket.c:1994 [inline] net/socket.c:1994
 __x64_sys_getpeername+0xda/0x120 net/socket.c:1994 net/socket.c:1994
 do_syscall_x64 arch/x86/entry/common.c:51 [inline]
 do_syscall_x64 arch/x86/entry/common.c:51 [inline] arch/x86/entry/common.c:82
 do_syscall_64+0x54/0xd0 arch/x86/entry/common.c:82 arch/x86/entry/common.c:82
 entry_SYSCALL_64_after_hwframe+0x44/0xae

Uninit was stored to memory at:
 tipc_getname+0x575/0x5e0 net/tipc/socket.c:757 net/tipc/socket.c:757
 __sys_getpeername+0x3b3/0x6b0 net/socket.c:1984 net/socket.c:1984
 __do_sys_getpeername net/socket.c:1997 [inline]
 __se_sys_getpeername net/socket.c:1994 [inline]
 __do_sys_getpeername net/socket.c:1997 [inline] net/socket.c:1994
 __se_sys_getpeername net/socket.c:1994 [inline] net/socket.c:1994
 __x64_sys_getpeername+0xda/0x120 net/socket.c:1994 net/socket.c:1994
 do_syscall_x64 arch/x86/entry/common.c:51 [inline]
 do_syscall_x64 arch/x86/entry/common.c:51 [inline] arch/x86/entry/common.c:82
 do_syscall_64+0x54/0xd0 arch/x86/entry/common.c:82 arch/x86/entry/common.c:82
 entry_SYSCALL_64_after_hwframe+0x44/0xae

Uninit was stored to memory at:
 msg_set_word net/tipc/msg.h:212 [inline]
 msg_set_destport net/tipc/msg.h:619 [inline]
 msg_set_word net/tipc/msg.h:212 [inline] net/tipc/socket.c:1486
 msg_set_destport net/tipc/msg.h:619 [inline] net/tipc/socket.c:1486
 __tipc_sendmsg+0x44fa/0x5890 net/tipc/socket.c:1486 net/tipc/socket.c:1486
 tipc_sendmsg+0xeb/0x140 net/tipc/socket.c:1402 net/tipc/socket.c:1402
 sock_sendmsg_nosec net/socket.c:704 [inline]
 sock_sendmsg net/socket.c:724 [inline]
 sock_sendmsg_nosec net/socket.c:704 [inline] net/socket.c:2409
 sock_sendmsg net/socket.c:724 [inline] net/socket.c:2409
 ____sys_sendmsg+0xe11/0x12c0 net/socket.c:2409 net/socket.c:2409
 ___sys_sendmsg net/socket.c:2463 [inline]
 ___sys_sendmsg net/socket.c:2463 [inline] net/socket.c:2492
 __sys_sendmsg+0x704/0x840 net/socket.c:2492 net/socket.c:2492
 __do_sys_sendmsg net/socket.c:2501 [inline]
 __se_sys_sendmsg net/socket.c:2499 [inline]
 __do_sys_sendmsg net/socket.c:2501 [inline] net/socket.c:2499
 __se_sys_sendmsg net/socket.c:2499 [inline] net/socket.c:2499
 __x64_sys_sendmsg+0xe2/0x120 net/socket.c:2499 net/socket.c:2499
 do_syscall_x64 arch/x86/entry/common.c:51 [inline]
 do_syscall_x64 arch/x86/entry/common.c:51 [inline] arch/x86/entry/common.c:82
 do_syscall_64+0x54/0xd0 arch/x86/entry/common.c:82 arch/x86/entry/common.c:82
 entry_SYSCALL_64_after_hwframe+0x44/0xae

Local variable skaddr created at:
 __tipc_sendmsg+0x2d0/0x5890 net/tipc/socket.c:1419 net/tipc/socket.c:1419
 tipc_sendmsg+0xeb/0x140 net/tipc/socket.c:1402 net/tipc/socket.c:1402

Bytes 4-7 of 16 are uninitialized
Memory access of size 16 starts at ffff888113753e00
Data copied to user address 0000000020000280

Reported-by: syzbot+cdbd40e0c3ca02cae3b7@syzkaller.appspotmail.com
Signed-off-by: Haimin Zhang <tcs_kernel@tencent.com>
Acked-by: Jon Maloy <jmaloy@redhat.com>
Link: https://lore.kernel.org/r/1640918123-14547-1-git-send-email-tcs.kernel@gmail.com
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
---
 net/tipc/socket.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/net/tipc/socket.c b/net/tipc/socket.c
index ad570c2450be8b..3e63c83e641c56 100644
--- a/net/tipc/socket.c
+++ b/net/tipc/socket.c
@@ -1461,6 +1461,8 @@ static int __tipc_sendmsg(struct socket *sock, struct msghdr *m, size_t dlen)
 		msg_set_syn(hdr, 1);
 	}
 
+	memset(&skaddr, 0, sizeof(skaddr));
+
 	/* Determine destination */
 	if (atype == TIPC_SERVICE_RANGE) {
 		return tipc_sendmcast(sock, ua, m, dlen, timeout);"
GHSA-7fvx-3jfc-2cpc,"From 01cff3f986259d661103412a20745928c727326f Mon Sep 17 00:00:00 2001
From: Mihai Maruseac <mihaimaruseac@google.com>
Date: Mon, 2 Aug 2021 13:33:05 -0700
Subject: [PATCH] Fix heap OOB due to dimension mismatch in
 `ResourceScatterUpdate`

PiperOrigin-RevId: 388292801
Change-Id: Id9bd7244d98d41b1517d4771850b32782c0cc949
---
 tensorflow/core/kernels/resource_variable_ops.cc | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/tensorflow/core/kernels/resource_variable_ops.cc b/tensorflow/core/kernels/resource_variable_ops.cc
index 8b9610724e5826..b81a7a517ea6d2 100644
--- a/tensorflow/core/kernels/resource_variable_ops.cc
+++ b/tensorflow/core/kernels/resource_variable_ops.cc
@@ -955,11 +955,12 @@ class ResourceScatterUpdateOp : public OpKernel {
                         params->dim_size(0), "")""));
       } else {
         int64_t num_updates = updates.NumElements();
-        OP_REQUIRES(c, num_updates % N == 0,
-                    errors::InvalidArgument(
-                        ""shape of indices ("", indices.shape().DebugString(),
-                        "") is not compatible with the shape of updates ("",
-                        updates.shape().DebugString(), "")""));
+        OP_REQUIRES(
+            c, TensorShapeUtils::StartsWith(updates.shape(), indices.shape()),
+            errors::InvalidArgument(
+                ""The shape of indices ("", indices.shape().DebugString(),
+                "") must be a prefix of the shape of updates ("",
+                updates.shape().DebugString(), "")""));
         auto updates_flat = updates.shaped<T, 2>({N, num_updates / N});
 
         functor::ScatterFunctor<Device, T, Index, op> functor;"
CVE-2020-35605,"From 82c137878c2b99100a3cdc1c0f0efea069313901 Mon Sep 17 00:00:00 2001
From: Kovid Goyal <kovid@kovidgoyal.net>
Date: Sun, 29 Nov 2020 12:02:14 +0530
Subject: [PATCH] Graphics protocol: Dont return filename in the error message
 when opening file fails, since filenames can contain control characters

Fixes #3128
---
 docs/changelog.rst | 3 +++
 kitty/graphics.c   | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/docs/changelog.rst b/docs/changelog.rst
index fc67fe43da0..45ab3f72329 100644
--- a/docs/changelog.rst
+++ b/docs/changelog.rst
@@ -26,6 +26,9 @@ To update |kitty|, :doc:`follow the instructions <binary>`.
 - Add an option, :opt:`detect_urls` to control whether kitty will detect URLs
   when the mouse moves over them (:pull:`3118`)
 
+- Graphics protocol: Dont return filename in the error message when opening file
+  fails, since filenames can contain control characters (:iss:`3128`)
+
 
 0.19.2 [2020-11-13]
 -------------------
diff --git a/kitty/graphics.c b/kitty/graphics.c
index 4671531cbda..07e55c08034 100644
--- a/kitty/graphics.c
+++ b/kitty/graphics.c
@@ -402,7 +402,7 @@ handle_add_command(GraphicsManager *self, const GraphicsCommand *g, const uint8_
             snprintf(fname, sizeof(fname)/sizeof(fname[0]), ""%.*s"", (int)g->payload_sz, payload);
             if (tt == 's') fd = shm_open(fname, O_RDONLY, 0);
             else fd = open(fname, O_CLOEXEC | O_RDONLY);
-            if (fd == -1) ABRT(EBADF, ""Failed to open file %s for graphics transmission with error: [%d] %s"", fname, errno, strerror(errno));
+            if (fd == -1) ABRT(EBADF, ""Failed to open file for graphics transmission with error: [%d] %s"", errno, strerror(errno));
             img->data_loaded = mmap_img_file(self, img, fd, g->data_sz, g->data_offset);
             safe_close(fd, __FILE__, __LINE__);
             if (tt == 't') {"
OSV-2020-802,"From c10639fd4658a852049546162d116b123e2b1ec2 Mon Sep 17 00:00:00 2001
From: lazymio <mio@lazym.io>
Date: Sun, 13 Feb 2022 11:03:57 +0100
Subject: [PATCH] Bump version in bindings

---
 bindings/dotnet/UnicornManaged/Const/Common.fs               | 5 +++--
 bindings/go/unicorn/unicorn_const.go                         | 5 +++--
 bindings/java/unicorn/UnicornConst.java                      | 5 +++--
 bindings/pascal/unicorn/UnicornConst.pas                     | 5 +++--
 bindings/python/unicorn/unicorn_const.py                     | 5 +++--
 .../ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb     | 5 +++--
 6 files changed, 18 insertions(+), 12 deletions(-)

diff --git a/bindings/dotnet/UnicornManaged/Const/Common.fs b/bindings/dotnet/UnicornManaged/Const/Common.fs
index a8b85414f4..9134f90605 100644
--- a/bindings/dotnet/UnicornManaged/Const/Common.fs
+++ b/bindings/dotnet/UnicornManaged/Const/Common.fs
@@ -11,13 +11,13 @@ module Common =
     let UC_API_MINOR = 0
 
     let UC_API_PATCH = 0
-    let UC_API_EXTRA = 5
+    let UC_API_EXTRA = 6
     let UC_VERSION_MAJOR = 2
 
     let UC_VERSION_MINOR = 0
 
     let UC_VERSION_PATCH = 0
-    let UC_VERSION_EXTRA = 5
+    let UC_VERSION_EXTRA = 6
     let UC_SECOND_SCALE = 1000000
     let UC_MILISECOND_SCALE = 1000
     let UC_ARCH_ARM = 1
@@ -38,6 +38,7 @@ module Common =
     let UC_MODE_THUMB = 16
     let UC_MODE_MCLASS = 32
     let UC_MODE_V8 = 64
+    let UC_MODE_ARMBE8 = 128
     let UC_MODE_ARM926 = 128
     let UC_MODE_ARM946 = 256
     let UC_MODE_ARM1176 = 512
diff --git a/bindings/go/unicorn/unicorn_const.go b/bindings/go/unicorn/unicorn_const.go
index 052cdd1da9..c0dcfa283d 100644
--- a/bindings/go/unicorn/unicorn_const.go
+++ b/bindings/go/unicorn/unicorn_const.go
@@ -6,13 +6,13 @@ const (
 	API_MINOR = 0
 
 	API_PATCH = 0
-	API_EXTRA = 5
+	API_EXTRA = 6
 	VERSION_MAJOR = 2
 
 	VERSION_MINOR = 0
 
 	VERSION_PATCH = 0
-	VERSION_EXTRA = 5
+	VERSION_EXTRA = 6
 	SECOND_SCALE = 1000000
 	MILISECOND_SCALE = 1000
 	ARCH_ARM = 1
@@ -33,6 +33,7 @@ const (
 	MODE_THUMB = 16
 	MODE_MCLASS = 32
 	MODE_V8 = 64
+	MODE_ARMBE8 = 128
 	MODE_ARM926 = 128
 	MODE_ARM946 = 256
 	MODE_ARM1176 = 512
diff --git a/bindings/java/unicorn/UnicornConst.java b/bindings/java/unicorn/UnicornConst.java
index 4d8554f63a..cc2b66d378 100644
--- a/bindings/java/unicorn/UnicornConst.java
+++ b/bindings/java/unicorn/UnicornConst.java
@@ -8,13 +8,13 @@ public interface UnicornConst {
    public static final int UC_API_MINOR = 0;
 
    public static final int UC_API_PATCH = 0;
-   public static final int UC_API_EXTRA = 5;
+   public static final int UC_API_EXTRA = 6;
    public static final int UC_VERSION_MAJOR = 2;
 
    public static final int UC_VERSION_MINOR = 0;
 
    public static final int UC_VERSION_PATCH = 0;
-   public static final int UC_VERSION_EXTRA = 5;
+   public static final int UC_VERSION_EXTRA = 6;
    public static final int UC_SECOND_SCALE = 1000000;
    public static final int UC_MILISECOND_SCALE = 1000;
    public static final int UC_ARCH_ARM = 1;
@@ -35,6 +35,7 @@ public interface UnicornConst {
    public static final int UC_MODE_THUMB = 16;
    public static final int UC_MODE_MCLASS = 32;
    public static final int UC_MODE_V8 = 64;
+   public static final int UC_MODE_ARMBE8 = 128;
    public static final int UC_MODE_ARM926 = 128;
    public static final int UC_MODE_ARM946 = 256;
    public static final int UC_MODE_ARM1176 = 512;
diff --git a/bindings/pascal/unicorn/UnicornConst.pas b/bindings/pascal/unicorn/UnicornConst.pas
index 4ae08515a5..5306d8f85d 100644
--- a/bindings/pascal/unicorn/UnicornConst.pas
+++ b/bindings/pascal/unicorn/UnicornConst.pas
@@ -9,13 +9,13 @@ interface
   UC_API_MINOR = 0;
 
   UC_API_PATCH = 0;
-  UC_API_EXTRA = 5;
+  UC_API_EXTRA = 6;
   UC_VERSION_MAJOR = 2;
 
   UC_VERSION_MINOR = 0;
 
   UC_VERSION_PATCH = 0;
-  UC_VERSION_EXTRA = 5;
+  UC_VERSION_EXTRA = 6;
   UC_SECOND_SCALE = 1000000;
   UC_MILISECOND_SCALE = 1000;
   UC_ARCH_ARM = 1;
@@ -36,6 +36,7 @@ interface
   UC_MODE_THUMB = 16;
   UC_MODE_MCLASS = 32;
   UC_MODE_V8 = 64;
+  UC_MODE_ARMBE8 = 128;
   UC_MODE_ARM926 = 128;
   UC_MODE_ARM946 = 256;
   UC_MODE_ARM1176 = 512;
diff --git a/bindings/python/unicorn/unicorn_const.py b/bindings/python/unicorn/unicorn_const.py
index 1737a2c8ec..573a043c8f 100644
--- a/bindings/python/unicorn/unicorn_const.py
+++ b/bindings/python/unicorn/unicorn_const.py
@@ -4,13 +4,13 @@
 UC_API_MINOR = 0
 
 UC_API_PATCH = 0
-UC_API_EXTRA = 5
+UC_API_EXTRA = 6
 UC_VERSION_MAJOR = 2
 
 UC_VERSION_MINOR = 0
 
 UC_VERSION_PATCH = 0
-UC_VERSION_EXTRA = 5
+UC_VERSION_EXTRA = 6
 UC_SECOND_SCALE = 1000000
 UC_MILISECOND_SCALE = 1000
 UC_ARCH_ARM = 1
@@ -31,6 +31,7 @@
 UC_MODE_THUMB = 16
 UC_MODE_MCLASS = 32
 UC_MODE_V8 = 64
+UC_MODE_ARMBE8 = 128
 UC_MODE_ARM926 = 128
 UC_MODE_ARM946 = 256
 UC_MODE_ARM1176 = 512
diff --git a/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb b/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb
index e12c7be43c..794bc16bff 100644
--- a/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb
+++ b/bindings/ruby/unicorn_gem/lib/unicorn_engine/unicorn_const.rb
@@ -6,13 +6,13 @@ module UnicornEngine
 	UC_API_MINOR = 0
 
 	UC_API_PATCH = 0
-	UC_API_EXTRA = 5
+	UC_API_EXTRA = 6
 	UC_VERSION_MAJOR = 2
 
 	UC_VERSION_MINOR = 0
 
 	UC_VERSION_PATCH = 0
-	UC_VERSION_EXTRA = 5
+	UC_VERSION_EXTRA = 6
 	UC_SECOND_SCALE = 1000000
 	UC_MILISECOND_SCALE = 1000
 	UC_ARCH_ARM = 1
@@ -33,6 +33,7 @@ module UnicornEngine
 	UC_MODE_THUMB = 16
 	UC_MODE_MCLASS = 32
 	UC_MODE_V8 = 64
+	UC_MODE_ARMBE8 = 128
 	UC_MODE_ARM926 = 128
 	UC_MODE_ARM946 = 256
 	UC_MODE_ARM1176 = 512"
CVE-2013-3524,"From efaffa04ef87db1722d69ac7bfc07be71ce2dccf Mon Sep 17 00:00:00 2001
From: DavidJClark <david@noticeabledesigns.com>
Date: Tue, 16 Apr 2013 12:14:35 -0400
Subject: [PATCH] Update to controller

---
 core/modules/PopUpNews/PopUpNews.php | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/core/modules/PopUpNews/PopUpNews.php b/core/modules/PopUpNews/PopUpNews.php
index 241306d..a9f64d1 100644
--- a/core/modules/PopUpNews/PopUpNews.php
+++ b/core/modules/PopUpNews/PopUpNews.php
@@ -13,6 +13,7 @@ class PopUpNews extends CodonModule
 {
     public function popupnewsitem($id) {
 
+                $id = intval($id);
                 if(!is_numeric($id)){header('Location: '.url('/'));}
         
                 $result = PopUpNewsData::popupnewsitem($id);
@@ -23,6 +24,7 @@ public function popupnewsitem($id) {
 
     public function PopUpNewsList($howmany = 5)
     {
+        $howmany = intval($howmany);
         if(!is_numeric($howmany)){exit;}
         
         $res = PopUpNewsData::get_news_list($howmany);"
CVE-2018-14351,"From 3c49c44be9b459d9c616bcaef6eb5d51298c1741 Mon Sep 17 00:00:00 2001
From: JerikoOne <jeriko.one@gmx.us>
Date: Sat, 7 Jul 2018 15:19:58 -0500
Subject: [PATCH] Ensure litlen isn't larger than our mailbox

---
 imap/command.c | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imap/command.c b/imap/command.c
index 74d12df18eb..13be77a79d2 100644
--- a/imap/command.c
+++ b/imap/command.c
@@ -635,6 +635,13 @@ static void cmd_parse_status(struct ImapData *idata, char *s)
       idata->status = IMAP_FATAL;
       return;
     }
+
+    if (strlen(idata->buf) < litlen)
+    {
+      mutt_debug(1, ""Error parsing STATUS mailbox\n"");
+      return;
+    }
+
     mailbox = idata->buf;
     s = mailbox + litlen;
     *s = '\0';"
OSV-2020-208,"From 994419f1bcb9151553ad8044e1757a6d406deea3 Mon Sep 17 00:00:00 2001
From: seladb <pcapplusplus@gmail.com>
Date: Sat, 30 May 2020 04:51:35 -0400
Subject: [PATCH] Bugfixes 22451 and 22235 in oss-fuzz:
 Use-of-uninitialized-value in IDnsResource

---
 Packet++/src/DnsResource.cpp                     |   4 +++-
 ...estcase-minimized-FuzzTarget-5654053026791424 | Bin 0 -> 1064 bytes
 ...estcase-minimized-FuzzTarget-5766939894087680 | Bin 0 -> 112 bytes
 3 files changed, 3 insertions(+), 1 deletion(-)
 create mode 100644 Tests/Fuzzers/RegressionTests/regression_samples/clusterfuzz-testcase-minimized-FuzzTarget-5654053026791424
 create mode 100644 Tests/Fuzzers/RegressionTests/regression_samples/clusterfuzz-testcase-minimized-FuzzTarget-5766939894087680

diff --git a/Packet++/src/DnsResource.cpp b/Packet++/src/DnsResource.cpp
index 690705955a..2f86c86aff 100644
--- a/Packet++/src/DnsResource.cpp
+++ b/Packet++/src/DnsResource.cpp
@@ -14,7 +14,8 @@ IDnsResource::IDnsResource(DnsLayer* dnsLayer, size_t offsetInLayer)
 {
 	char decodedName[256];
 	m_NameLength = decodeName((const char*)getRawData(), decodedName);
-	m_DecodedName = decodedName;
+	if (m_NameLength > 0)
+		m_DecodedName = decodedName;
 }
 
 IDnsResource::IDnsResource(uint8_t* emptyRawData)
@@ -63,6 +64,7 @@ size_t IDnsResource::decodeName(const char* encodedName, char* result, int itera
 			}
 
 			char tempResult[256];
+			memset(tempResult, 0, 256);
 			int i = 0;
 			decodeName((const char*)(m_DnsLayer->m_Data + offsetInLayer), tempResult, iteration+1);
 			while (tempResult[i] != 0 && decodedNameLength < 255)
diff --git a/Tests/Fuzzers/RegressionTests/regression_samples/clusterfuzz-testcase-minimized-FuzzTarget-5654053026791424 b/Tests/Fuzzers/RegressionTests/regression_samples/clusterfuzz-testcase-minimized-FuzzTarget-5654053026791424
new file mode 100644
index 0000000000000000000000000000000000000000..b28a465bffe206e17a1ad359cc87c1936c6804c9
GIT binary patch
literal 1064
zcmca|c+)~A1{MYehHnfErjFn4Dl#xIGBDf#3S2>!5@29BzzUXPaNuBYW%zH;z~aEb
zAjlZ^j}xYwflGNJP~ZRm3=9T9x&erV8IC{FKMG`kK`4v?qd__$fcaVjnDPJrf5rpk
zfD?o@fh@qQ>H$!}mBUv-0RjvS2!Qzdks30%tEPhlkY&JZB@7W90@DMJALn710<@?A
z3J`ID6yS9j;4DG#c>zP?rarbl(T@xau_8blEP)uq9GCz><IZ9=53jN0nTgNEUx10D
Yjyz+5F2xf9M3_lbXcA%05RDcF06bIf^#A|>

literal 0
HcmV?d00001

diff --git a/Tests/Fuzzers/RegressionTests/regression_samples/clusterfuzz-testcase-minimized-FuzzTarget-5766939894087680 b/Tests/Fuzzers/RegressionTests/regression_samples/clusterfuzz-testcase-minimized-FuzzTarget-5766939894087680
new file mode 100644
index 0000000000000000000000000000000000000000..38627111b8b1030c55635b282a3bb348741d3838
GIT binary patch
literal 112
zcmca|c+)~A1{MYdB*4Ic;CetgOhDQdtOh74h@@D7!4$@0P=G)fUqOLU;Xi@{W&r?-
Cl@8_r

literal 0
HcmV?d00001"
CVE-2016-5688,"From fc43974d34318c834fbf78570ca1a3764ed8c7d7 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Mon, 16 May 2016 14:00:14 -0400
Subject: [PATCH] Ensure image extent does not exceed maximum

---
 coders/wpg.c | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/coders/wpg.c b/coders/wpg.c
index b6ba8d79fe3..0dfdc47f0b3 100644
--- a/coders/wpg.c
+++ b/coders/wpg.c
@@ -1112,6 +1112,9 @@ static Image *ReadWPGImage(const ImageInfo *image_info,
               bpp=BitmapHeader2.Depth;
 
             UnpackRaster:      
+              status=SetImageExtent(image,image->columns,image->rows,exception);
+              if (status == MagickFalse)
+                break;
               if ((image->colors == 0) && (bpp != 24))
                 {
                   image->colors=one << bpp;
@@ -1305,6 +1308,9 @@ static Image *ReadWPGImage(const ImageInfo *image_info,
                 }
               image->columns=Bitmap2Header1.Width;
               image->rows=Bitmap2Header1.Height;
+              status=SetImageExtent(image,image->columns,image->rows,exception);
+              if (status == MagickFalse)
+                break;
 
               if ((image->colors == 0) && (bpp != 24))
                 {
@@ -1423,9 +1429,6 @@ static Image *ReadWPGImage(const ImageInfo *image_info,
          ThrowReaderException(CoderError,""DataEncodingSchemeIsNotSupported"");
       }
    }
-  status=SetImageExtent(image,image->columns,image->rows,exception);
-  if (status == MagickFalse)
-    return(DestroyImageList(image));
 
  Finish:
   (void) CloseBlob(image);"
CVE-2017-5924,"From 7f02eca670f29c00a1d2c305e96febae6ce5d37b Mon Sep 17 00:00:00 2001
From: plusvic <plusvic@gmail.com>
Date: Mon, 9 Jan 2017 13:17:39 +0100
Subject: [PATCH] Make sure that loop depth is greater than 0 before
 decrementing it.

---
 libyara/grammar.y | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/libyara/grammar.y b/libyara/grammar.y
index 446d37410e..bf3c88b4d2 100644
--- a/libyara/grammar.y
+++ b/libyara/grammar.y
@@ -1017,8 +1017,11 @@ expression
       }
     | _FOR_ for_expression error
       {
-        compiler->loop_depth--;
-        compiler->loop_identifier[compiler->loop_depth] = NULL;
+        if (compiler->loop_depth > 0)
+        {
+          compiler->loop_depth--;
+          compiler->loop_identifier[compiler->loop_depth] = NULL;
+        }
       }
     | _FOR_ for_expression _IDENTIFIER_ _IN_
       {"
GHSA-f854-hpxv-cw9r,"From 150ef237b37ac28c8136e1c0f494932860b9ebe8 Mon Sep 17 00:00:00 2001
From: yihuang <huang@crypto.com>
Date: Tue, 21 Dec 2021 11:43:18 +0800
Subject: [PATCH] Problem: MsgEthereumTx wrapping tx without the extension
 option is not rejected (#270)

* reject MsgEthereumTx wrapping tx without the extension option.

reject MsgEthereumTx wrapping tx without the extension option.

update gomod2nix

try to build in CI

fix GOPRIVATE

fix mount

update to public ethermint

* update changelog

* v0.6.5
---
 CHANGELOG.md   | 7 ++++++-
 go.mod         | 2 +-
 go.sum         | 4 ++--
 gomod2nix.toml | 6 +++---
 4 files changed, 12 insertions(+), 7 deletions(-)

diff --git a/CHANGELOG.md b/CHANGELOG.md
index 85002de527..e82d3b254a 100644
--- a/CHANGELOG.md
+++ b/CHANGELOG.md
@@ -1,6 +1,11 @@
 # Changelog
 
-## Unreleased
+## v0.6.5
+
+### Bug Fixes
+
+- [cronos#255](https://github.com/crypto-org-chain/cronos/pull/255) fix empty topics in non-breaking way
+- [cronos#270](https://github.com/crypto-org-chain/cronos/pull/270) reject MsgEthereumTx wrapping tx without the extension option.
 
 *November 30, 2021*
 
diff --git a/go.mod b/go.mod
index 660aa80986..fa664dbe57 100644
--- a/go.mod
+++ b/go.mod
@@ -164,4 +164,4 @@ replace github.com/ethereum/go-ethereum => github.com/crypto-org-chain/go-ethere
 // TODO: remove when ibc-go and ethermint upgrades cosmos-sdk
 replace github.com/cosmos/cosmos-sdk => github.com/cosmos/cosmos-sdk v0.44.2
 
-replace github.com/tharsis/ethermint => github.com/crypto-org-chain/ethermint v0.7.2-cronos-4
+replace github.com/tharsis/ethermint => github.com/crypto-org-chain/ethermint v0.7.2-cronos-6
diff --git a/go.sum b/go.sum
index f5d74f4616..c1320397ef 100644
--- a/go.sum
+++ b/go.sum
@@ -261,8 +261,8 @@ github.com/cpuguy83/go-md2man/v2 v2.0.0-20190314233015-f79a8a8ca69d/go.mod h1:ma
 github.com/cpuguy83/go-md2man/v2 v2.0.0/go.mod h1:maD7wRr/U5Z6m/iR4s+kqSMx2CaBsrgA7czyZG/E6dU=
 github.com/creack/pty v1.1.7/go.mod h1:lj5s0c3V2DBrqTV7llrYr5NG6My20zk30Fl46Y7DoTY=
 github.com/creack/pty v1.1.9/go.mod h1:oKZEueFk5CKHvIhNR5MUki03XCEU+Q6VDXinZuGJ33E=
-github.com/crypto-org-chain/ethermint v0.7.2-cronos-4 h1:NaCc0L5zN2u7B9WofmhJfur23UDebWSRD+Goqf9URnY=
-github.com/crypto-org-chain/ethermint v0.7.2-cronos-4/go.mod h1:J96LX4KvLyl+5jV6+mt/4l6srtGX/mdDTuqQQuYrdDk=
+github.com/crypto-org-chain/ethermint v0.7.2-cronos-6 h1:AHmZ4d/VvRPYEwRK8WATDVgAW+LQLuus9/oRo8UHkB4=
+github.com/crypto-org-chain/ethermint v0.7.2-cronos-6/go.mod h1:J96LX4KvLyl+5jV6+mt/4l6srtGX/mdDTuqQQuYrdDk=
 github.com/crypto-org-chain/go-ethereum v1.10.3-patched h1:kr6oQIYOi2VC8SZwkhlUDZE1Omit/YHVysKMgCB2nes=
 github.com/crypto-org-chain/go-ethereum v1.10.3-patched/go.mod h1:99onQmSd1GRGOziyGldI41YQb7EESX3Q4H41IfJgIQQ=
 github.com/crypto-org-chain/ibc-go v1.2.1-hooks h1:wuWaQqm/TFKJQwuFgjCPiPumQio+Yik5Z1DObDExrrU=
diff --git a/gomod2nix.toml b/gomod2nix.toml
index 2c93adee02..b958b1e7a6 100644
--- a/gomod2nix.toml
+++ b/gomod2nix.toml
@@ -4637,13 +4637,13 @@
     sha256 = ""1kmdk3v2a6ygcg2i8jfgz61yzxi4183xgzlaviq9jwsqwc2hj60w""
 
 [""github.com/tharsis/ethermint""]
-  sumVersion = ""v0.7.2-cronos-4""
+  sumVersion = ""v0.7.2-cronos-6""
   vendorPath = ""github.com/crypto-org-chain/ethermint""
   [""github.com/tharsis/ethermint"".fetch]
     type = ""git""
     url = ""https://github.com/crypto-org-chain/ethermint""
-    rev = ""82805507f7d2e83cad547736883dc22acfb52440""
-    sha256 = ""01f9i8vq0jqml676wvh0kr9kxg7grqw7f64g1qd81pzm2n89k7pn""
+    rev = ""60af027299c1aec580240d1e03d66c0ad100934b""
+    sha256 = ""1074b5rbi1l0ija5iz4i9d92r1as030wkqllz5ga0ahhqrgb2rp9""
 
 [""github.com/tidwall/gjson""]
   sumVersion = ""v1.6.7"""
GHSA-2hxv-mx8x-mcj9,"From bfe44f289e336f80b6593032679300c493735e75 Mon Sep 17 00:00:00 2001
From: Bram Jetten <mail@bramjetten.nl>
Date: Tue, 16 Jun 2015 16:23:27 +0200
Subject: [PATCH] protect from forgery

---
 app/controllers/spina/application_controller.rb | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/app/controllers/spina/application_controller.rb b/app/controllers/spina/application_controller.rb
index 257f5fb8c..bf39207e4 100644
--- a/app/controllers/spina/application_controller.rb
+++ b/app/controllers/spina/application_controller.rb
@@ -1,5 +1,7 @@
 module Spina
   class ApplicationController < ActionController::Base
+    protect_from_forgery
+    
     include ApplicationHelper
 
     private"
GHSA-gq4h-f254-7cw9,"From a986a9335d591fa5c826157d1674d47aa525357f Mon Sep 17 00:00:00 2001
From: JOE1994 <joseph942010@gmail.com>
Date: Sat, 23 Jan 2021 23:07:17 -0500
Subject: [PATCH] 'T: Send' to prevent misuse

---
 src/lib.rs | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/lib.rs b/src/lib.rs
index 2c600b7..f35c7f0 100644
--- a/src/lib.rs
+++ b/src/lib.rs
@@ -50,7 +50,7 @@ pub struct ReadTicket<T> {
     data: Arc<UnsafeCell<T>>,
 }
 
-unsafe impl<T> Send for ReadTicket<T> {}
+unsafe impl<T: Send> Send for ReadTicket<T> {}
 
 #[cfg(not(feature = ""futures""))]
 impl<T> ReadTicket<T> {
@@ -112,7 +112,7 @@ pub struct WriteTicket<T> {
     data: Arc<UnsafeCell<T>>,
 }
 
-unsafe impl<T> Send for WriteTicket<T> {}
+unsafe impl<T: Send> Send for WriteTicket<T> {}
 
 #[cfg(not(feature = ""futures""))]
 impl<T> WriteTicket<T> {"
CVE-2017-12640,"From 307fa45d512641fcd105f0d57ca50c1437cd1b81 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 6 Jul 2017 19:20:57 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/542

---
 coders/png.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/coders/png.c b/coders/png.c
index dfe6843ac1c..860d28ec41c 100644
--- a/coders/png.c
+++ b/coders/png.c
@@ -5968,6 +5968,8 @@ static Image *ReadOneMNGImage(MngInfo* mng_info, const ImageInfo *image_info,
 
               for (i=(ssize_t) first_object; i <= (ssize_t) last_object; i++)
               {
+                if ((i < 0) || (i >= MNG_MAX_OBJECTS))
+                  continue;
                 if (mng_info->exists[i] && !mng_info->frozen[i] &&
                     (p-chunk) < (ssize_t) (length-8))
                   {"
GHSA-662x-fhqg-9p8v,"From 233d3bae22a795153a7e6638887ce159c63e557d Mon Sep 17 00:00:00 2001
From: Faisal Salman <f@faisalman.com>
Date: Sat, 12 Sep 2020 15:47:15 +0700
Subject: [PATCH] Fix potential ReDoS vulnerability

---
 src/ua-parser.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/ua-parser.js b/src/ua-parser.js
index d89312c60..3d807e1a7 100755
--- a/src/ua-parser.js
+++ b/src/ua-parser.js
@@ -585,9 +585,9 @@
             /android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,               // Xiaomi Hongmi
             /android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,    
                                                                                 // Xiaomi Mi
-            /android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i       // Redmi Phones
+            /android.+(redmi[\s\-_]*(?:note)?(?:[\s_]?[\w\s]+))\s+build/i       // Redmi Phones
             ], [[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, MOBILE]], [
-            /android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i            // Mi Pad tablets
+            /android.+(mi[\s\-_]*(?:pad)(?:[\s_]?[\w\s]+))\s+build/i            // Mi Pad tablets
             ],[[MODEL, /_/g, ' '], [VENDOR, 'Xiaomi'], [TYPE, TABLET]], [
             /android.+;\s(m[1-5]\snote)\sbuild/i                                // Meizu
             ], [MODEL, [VENDOR, 'Meizu'], [TYPE, MOBILE]], ["
CVE-2010-3696,"From 4dc7800b866f889a1247685bbaa6dd4238a56279 Mon Sep 17 00:00:00 2001
From: ""Alan T. DeKok"" <aland@freeradius.org>
Date: Sat, 29 May 2010 11:26:56 +0200
Subject: [PATCH] Fix endless loop when there are multiple DHCP options

---
 src/lib/dhcp.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/lib/dhcp.c b/src/lib/dhcp.c
index d90ae2c728ee3..2a8859453e19f 100644
--- a/src/lib/dhcp.c
+++ b/src/lib/dhcp.c
@@ -714,7 +714,7 @@ int fr_dhcp_decode(RADIUS_PACKET *packet)
 			}
 
 			*tail = vp;
-			while (*tail) tail = &vp->next;
+			while (*tail) tail = &(*tail)->next;
 			p += alen;
 		} /* loop over array entries */
 	} /* loop over the entire packet */"
CVE-2014-8959,"From 80cd40b6687a6717860d345d6eb55bef2908e961 Mon Sep 17 00:00:00 2001
From: Madhura Jayaratne <madhura.cj@gmail.com>
Date: Thu, 20 Nov 2014 06:32:57 +0530
Subject: [PATCH] bug #4594 [security] Path traversal in file inclusion of GIS
 factory

Signed-off-by: Madhura Jayaratne <madhura.cj@gmail.com>
---
 ChangeLog                           | 1 +
 libraries/gis/GIS_Factory.class.php | 4 +++-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/ChangeLog b/ChangeLog
index 001e9fa27168..7877bcb3f647 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -17,6 +17,7 @@ phpMyAdmin - ChangeLog
 - bug #4595 [security] Path traversal can lead to leakage of line count
 - bug #4578 [security] XSS vulnerability in table print view
 - bug #4579 [security] XSS vulnerability in zoom search page
+- bug #4594 [security] Path traversal in file inclusion of GIS factory
 
 4.2.11.0 (2014-10-31)
 - bug       ReferenceError: Table_onover is not defined
diff --git a/libraries/gis/GIS_Factory.class.php b/libraries/gis/GIS_Factory.class.php
index b2d01c11a3c3..404a7200857f 100644
--- a/libraries/gis/GIS_Factory.class.php
+++ b/libraries/gis/GIS_Factory.class.php
@@ -33,7 +33,9 @@ public static function factory($type)
         include_once './libraries/gis/GIS_Geometry.class.php';
 
         $type_lower = strtolower($type);
-        if (! file_exists('./libraries/gis/GIS_' . ucfirst($type_lower) . '.class.php')) {
+        if (! PMA_isValid($type_lower, PMA_Util::getGISDatatypes())
+            || ! file_exists('./libraries/gis/GIS_' . ucfirst($type_lower) . '.class.php')
+        ) {
             return false;
         }
         if (include_once './libraries/gis/GIS_' . ucfirst($type_lower) . '.class.php') {"
CVE-2017-14173,"From 50f54462076648ac2e36c3f58f4dadd4babbf1c9 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Fri, 1 Sep 2017 09:22:37 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/713

---
 coders/txt.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/coders/txt.c b/coders/txt.c
index 16e7ac2e94c..051f6bef2b2 100644
--- a/coders/txt.c
+++ b/coders/txt.c
@@ -446,7 +446,9 @@ static Image *ReadTXTImage(const ImageInfo *image_info,ExceptionInfo *exception)
       ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
     image->columns=width;
     image->rows=height;
-    for (depth=1; (GetQuantumRange(depth)+1) < max_value; depth++) ;
+    for (depth=1; (GetQuantumRange(depth)+1) < max_value; depth++)
+      if (depth >= 64)
+        break;
     image->depth=depth;
     status=SetImageExtent(image,image->columns,image->rows,exception);
     if (status == MagickFalse)"
CVE-2018-5816,"From 1d8d1b452e5dc74033ee9f846081a0efb616cc39 Mon Sep 17 00:00:00 2001
From: Alex Tutubalin <lexa@lexa.ru>
Date: Mon, 11 Jun 2018 13:05:32 +0300
Subject: [PATCH] reject broken/crafted NOKIARAW files

---
 dcraw/dcraw.c             | 5 ++++-
 internal/dcraw_common.cpp | 5 ++++-
 2 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/dcraw/dcraw.c b/dcraw/dcraw.c
index 364869cf..c22f98a9 100644
--- a/dcraw/dcraw.c
+++ b/dcraw/dcraw.c
@@ -15738,7 +15738,10 @@ void CLASS identify()
 #endif
 	switch (tiff_bps = i*8 / (width * height)) {
 	case  8: load_raw = &CLASS eight_bit_load_raw;  break;
-	case 10: load_raw = &CLASS nokia_load_raw;
+	case 10: load_raw = &CLASS nokia_load_raw; break;
+#ifdef LIBRAW_LIBRARY_BUILD
+        case 0:  throw LIBRAW_EXCEPTION_IO_CORRUPT; break;
+#endif
 	}
 	raw_height = height + (top_margin = i / (width * tiff_bps/8) - height);
 	mask[0][3] = 1;
diff --git a/internal/dcraw_common.cpp b/internal/dcraw_common.cpp
index 041318c5..7cb6c15c 100644
--- a/internal/dcraw_common.cpp
+++ b/internal/dcraw_common.cpp
@@ -14399,7 +14399,10 @@ void CLASS identify()
 #endif
 	switch (tiff_bps = i*8 / (width * height)) {
 	case  8: load_raw = &CLASS eight_bit_load_raw;  break;
-	case 10: load_raw = &CLASS nokia_load_raw;
+	case 10: load_raw = &CLASS nokia_load_raw; break;
+#ifdef LIBRAW_LIBRARY_BUILD
+        case 0:  throw LIBRAW_EXCEPTION_IO_CORRUPT; break;
+#endif
 	}
 	raw_height = height + (top_margin = i / (width * tiff_bps/8) - height);
 	mask[0][3] = 1;"
GHSA-x2mc-8fgj-3wmr,"From 06672828e6fa29ac8551b1b6f36c852a9a3c58a2 Mon Sep 17 00:00:00 2001
From: Mathias Buus <mathiasbuus@gmail.com>
Date: Mon, 30 Apr 2018 13:20:56 +0200
Subject: [PATCH] force hardlink targets to be in the tar

---
 index.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/index.js b/index.js
index 2e1ae6d..4d67485 100644
--- a/index.js
+++ b/index.js
@@ -261,7 +261,7 @@ exports.extract = function (cwd, opts) {
     var onlink = function () {
       if (win32) return next() // skip links on win for now before it can be tested
       xfs.unlink(name, function () {
-        var srcpath = path.resolve(cwd, header.linkname)
+        var srcpath = path.join(cwd, path.join('/', header.linkname))
 
         xfs.link(srcpath, name, function (err) {
           if (err && err.code === 'EPERM' && opts.hardlinkAsFilesFallback) {"
OSV-2020-2251,"From aefd3829af33a7814f76137838d741fd7b1058d4 Mon Sep 17 00:00:00 2001
From: Francesc Alted <faltet@gmail.com>
Date: Mon, 4 Jan 2021 10:29:17 +0100
Subject: [PATCH] Do not free sdata when it is not owned

---
 blosc/blosc2.h | 1 +
 blosc/frame.c  | 3 ++-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/blosc/blosc2.h b/blosc/blosc2.h
index 1f3bcd112..792fc2a2e 100644
--- a/blosc/blosc2.h
+++ b/blosc/blosc2.h
@@ -956,6 +956,7 @@ static const blosc2_storage BLOSC2_STORAGE_DEFAULTS = {false, NULL, NULL, NULL};
 typedef struct {
   char* fname;             //!< The name of the file; if NULL, this is in-memory
   uint8_t* sdata;          //!< The in-memory serialized data
+  bool avoid_sdata_free;   //!< Whether the sdata can be freed (false) or not (true).
   uint8_t* coffsets;       //!< Pointers to the (compressed, on-disk) chunk offsets
   int64_t len;             //!< The current length of the frame in (compressed) bytes
   int64_t maxlen;          //!< The maximum length of the frame; if 0, there is no maximum
diff --git a/blosc/frame.c b/blosc/frame.c
index bc68d5256..006a03b99 100644
--- a/blosc/frame.c
+++ b/blosc/frame.c
@@ -92,7 +92,7 @@ blosc2_frame* blosc2_frame_new(const char* fname) {
 /* Free memory from a frame. */
 int blosc2_frame_free(blosc2_frame *frame) {
 
-  if (frame->sdata != NULL) {
+  if (frame->sdata != NULL && !frame->avoid_sdata_free) {
     free(frame->sdata);
   }
 
@@ -800,6 +800,7 @@ blosc2_frame* blosc2_frame_from_sframe(uint8_t *sframe, int64_t len, bool copy)
   }
   else {
     frame->sdata = sframe;
+    frame->avoid_sdata_free = true;
   }
 
   return frame;"
CVE-2019-17545,"From 148115fcc40f1651a5d15fa34c9a8c528e7147bb Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@spatialys.com>
Date: Sun, 4 Aug 2019 21:00:33 +0200
Subject: [PATCH] OGRExpatRealloc(): fix double-free when size to allocate is
 above the default 10MB threshold. Fixes
 https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=16178. Credit to OSS
 Fuzz

---
 gdal/ogr/ogr_expat.cpp | 1 -
 1 file changed, 1 deletion(-)

diff --git a/gdal/ogr/ogr_expat.cpp b/gdal/ogr/ogr_expat.cpp
index 49e2c73a13b0..0d6c4a9ba7eb 100644
--- a/gdal/ogr/ogr_expat.cpp
+++ b/gdal/ogr/ogr_expat.cpp
@@ -89,7 +89,6 @@ static void* OGRExpatRealloc( void *ptr, size_t size )
     if( CanAlloc(size) )
         return realloc(ptr, size);
 
-    free(ptr);
     return nullptr;
 }"
OSV-2018-417,"From 812a820e234fd3cb1f857d16b6b5c51ed0b1201d Mon Sep 17 00:00:00 2001
From: Automated Commit <automated@calamity.org.uk>
Date: Wed, 29 Aug 2018 03:00:09 +0000
Subject: [PATCH] Update core from master

---
 libs/core | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libs/core b/libs/core
index e128f4e1b890..2d99acd7ec86 160000
--- a/libs/core
+++ b/libs/core
@@ -1 +1 @@
-Subproject commit e128f4e1b8904d47561700892843f07d5d1160db
+Subproject commit 2d99acd7ec8659c65454bd6167aac3e361cef983"
CVE-2018-12322,"From bbb4af56003c1afdad67af0c4339267ca38b1017 Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Mon, 11 Jun 2018 03:03:25 +0200
Subject: [PATCH] Fix #10294 - crash in r2_hoobr__6502_op

---
 libr/anal/p/anal_6502.c | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/libr/anal/p/anal_6502.c b/libr/anal/p/anal_6502.c
index 6d002447722c5..770980f2f2b21 100644
--- a/libr/anal/p/anal_6502.c
+++ b/libr/anal/p/anal_6502.c
@@ -682,9 +682,15 @@ static int _6502_op(RAnal *anal, RAnalOp *op, ut64 addr, const ut8 *data, int le
 		op->cycles = 2;
 		op->failcycles = 3;
 		op->type = R_ANAL_OP_TYPE_CJMP;
-		if (data[1] <= 127)
-			op->jump = addr + data[1] + op->size;
-		else	op->jump = addr - (256 - data[1]) + op->size;
+		if (len > 1) {
+			if (data[1] <= 127) {
+				op->jump = addr + data[1] + op->size;
+			} else {
+				op->jump = addr - (256 - data[1]) + op->size;
+			}
+		} else {
+			op->jump = addr;
+		}
 		op->fail = addr + op->size;
 		// FIXME: add a type of conditional
 		// op->cond = R_ANAL_COND_LE;"
CVE-2019-14672,"From 8717f469b10e9f7e1547c6f70f7d24e1359d28d4 Mon Sep 17 00:00:00 2001
From: James Cole <thegrumpydictator@gmail.com>
Date: Sat, 3 Aug 2019 05:08:20 +0200
Subject: [PATCH] Fix #2370

---
 app/Support/Http/Controllers/UserNavigation.php | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app/Support/Http/Controllers/UserNavigation.php b/app/Support/Http/Controllers/UserNavigation.php
index 66e30c5c02e..1cac4ed6b0f 100644
--- a/app/Support/Http/Controllers/UserNavigation.php
+++ b/app/Support/Http/Controllers/UserNavigation.php
@@ -124,7 +124,7 @@ protected function redirectToOriginalAccount(Account $account)
         /** @var Transaction $transaction */
         $transaction = $account->transactions()->first();
         if (null === $transaction) {
-            app('session')->flash('error', trans('firefly.account_missing_transaction', ['name' => $account->name, 'id' => $account->id]));
+            app('session')->flash('error', trans('firefly.account_missing_transaction', ['name' => e($account->name), 'id' => $account->id]));
             Log::error(sprintf('Expected a transaction. Account #%d has none. BEEP, error.', $account->id));
 
             return redirect(route('index'));
@@ -135,7 +135,7 @@ protected function redirectToOriginalAccount(Account $account)
         $opposingTransaction = $journal->transactions()->where('transactions.id', '!=', $transaction->id)->first();
 
         if (null === $opposingTransaction) {
-            app('session')->flash('error', trans('firefly.account_missing_transaction', ['name' => $account->name, 'id' => $account->id]));
+            app('session')->flash('error', trans('firefly.account_missing_transaction', ['name' => e($account->name), 'id' => $account->id]));
             Log::error(sprintf('Expected an opposing transaction. Account #%d has none. BEEP, error.', $account->id));
         }"
GHSA-79jw-2f46-wv22,"From c393c5ce9ca2c5acc3ed6c9bb0dab5ffd61965fe Mon Sep 17 00:00:00 2001
From: Samuel Georges <sam@daftspunk.com>
Date: Thu, 20 Jan 2022 11:25:32 +1100
Subject: [PATCH] Backport fix from 2.0

---
 src/Halcyon/Processors/SectionParser.php | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/Halcyon/Processors/SectionParser.php b/src/Halcyon/Processors/SectionParser.php
index c07ac4239..ab1c9f53b 100644
--- a/src/Halcyon/Processors/SectionParser.php
+++ b/src/Halcyon/Processors/SectionParser.php
@@ -72,7 +72,8 @@ public static function render($data, $options = [])
             }
         }
 
-        $content[] = $markup;
+        $sections = preg_split('/^'.preg_quote(self::SECTION_SEPARATOR).'\s*$/m', $markup, -1);
+        $content[] = end($sections);
 
         $content = trim(implode(PHP_EOL.self::SECTION_SEPARATOR.PHP_EOL, $content));"
CVE-2014-0072,"From a1d6fc07e8a40c1b2b16f4103c403b30e1089668 Mon Sep 17 00:00:00 2001
From: Andrew Grieve <agrieve@chromium.org>
Date: Tue, 18 Feb 2014 20:58:31 -0500
Subject: [PATCH] Fix default value for trustAllHosts on iOS (YES->NO)

---
 src/ios/CDVFileTransfer.m | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/ios/CDVFileTransfer.m b/src/ios/CDVFileTransfer.m
index e35e2fe7..c5c75028 100644
--- a/src/ios/CDVFileTransfer.m
+++ b/src/ios/CDVFileTransfer.m
@@ -255,7 +255,7 @@ - (CDVFileTransferDelegate*)delegateForUploadCommand:(CDVInvokedUrlCommand*)comm
 {
     NSString* source = [command.arguments objectAtIndex:0];
     NSString* server = [command.arguments objectAtIndex:1];
-    BOOL trustAllHosts = [[command.arguments objectAtIndex:6 withDefault:[NSNumber numberWithBool:YES]] boolValue]; // allow self-signed certs
+    BOOL trustAllHosts = [[command.arguments objectAtIndex:6 withDefault:[NSNumber numberWithBool:NO]] boolValue]; // allow self-signed certs
     NSString* objectId = [command.arguments objectAtIndex:9];
 
     CDVFileTransferDelegate* delegate = [[CDVFileTransferDelegate alloc] init];
@@ -360,7 +360,7 @@ - (void)download:(CDVInvokedUrlCommand*)command
     DLog(@""File Transfer downloading file..."");
     NSString* source = [command.arguments objectAtIndex:0];
     NSString* target = [command.arguments objectAtIndex:1];
-    BOOL trustAllHosts = [[command.arguments objectAtIndex:2 withDefault:[NSNumber numberWithBool:YES]] boolValue]; // allow self-signed certs
+    BOOL trustAllHosts = [[command.arguments objectAtIndex:2 withDefault:[NSNumber numberWithBool:NO]] boolValue]; // allow self-signed certs
     NSString* objectId = [command.arguments objectAtIndex:3];
     NSDictionary* headers = [command.arguments objectAtIndex:4 withDefault:nil];"
GHSA-cph5-m8f7-6c5x,"From 5b457116e31db0e88fede6c428e969e87f290929 Mon Sep 17 00:00:00 2001
From: ready-research <72916209+ready-research@users.noreply.github.com>
Date: Mon, 30 Aug 2021 18:03:43 +0530
Subject: [PATCH] Security fix for ReDoS (#3980)

---
 lib/utils.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/utils.js b/lib/utils.js
index 28ccfff3c0..5d966f4448 100644
--- a/lib/utils.js
+++ b/lib/utils.js
@@ -185,7 +185,7 @@ function isURLSearchParams(val) {
  * @returns {String} The String freed of excess whitespace
  */
 function trim(str) {
-  return str.replace(/^\s*/, '').replace(/\s*$/, '');
+  return str.trim ? str.trim() : str.replace(/^\s+|\s+$/g, '');
 }
 
 /**"
CVE-2015-8898,"From 5b4bebaa91849c592a8448bc353ab25a54ff8c44 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 24 Sep 2015 09:36:17 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/pull/34

---
 MagickCore/constitute.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/MagickCore/constitute.c b/MagickCore/constitute.c
index 24176f0b6ae..dc6ec49c131 100644
--- a/MagickCore/constitute.c
+++ b/MagickCore/constitute.c
@@ -1272,7 +1272,14 @@ MagickExport MagickBooleanType WriteImages(const ImageInfo *image_info,
     (void) CopyMagickString(write_info->magick,images->magick,MagickPathExtent);
   p=images;
   for ( ; GetNextImageInList(p) != (Image *) NULL; p=GetNextImageInList(p))
-    if (p->scene >= GetNextImageInList(p)->scene)
+  {
+    register Image
+      *next;
+    
+    next=GetNextImageInList(p);
+    if (next == (Image *) NULL)
+      break;
+    if (p->scene >= next->scene)
       {
         register ssize_t
           i;
@@ -1285,6 +1292,7 @@ MagickExport MagickBooleanType WriteImages(const ImageInfo *image_info,
           p->scene=(size_t) i++;
         break;
       }
+  }
   /*
     Write images.
   */"
CVE-2017-14341,"From 7d63315a64267c565d1f34b9cb523a14616fed24 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Mon, 7 Aug 2017 14:59:43 -0400
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/654

---
 coders/wpg.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/coders/wpg.c b/coders/wpg.c
index ae43f9cc364..4756dba3f4c 100644
--- a/coders/wpg.c
+++ b/coders/wpg.c
@@ -1035,6 +1035,8 @@ static Image *ReadWPGImage(const ImageInfo *image_info,
           if(i==EOF)
             break;
           Rd_WP_DWORD(image,&Rec.RecordLength);
+          if (Rec.RecordLength > GetBlobSize(image))
+            ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
           if(EOFBlob(image))
             break;"
GHSA-8jxq-75rw-fhj9,"From f8f7019ffdf9b4e05faf95e1f04e204aa4c91f98 Mon Sep 17 00:00:00 2001
From: Nicola Iarocci <nicola@nicolaiarocci.com>
Date: Sun, 14 Jan 2018 17:51:26 +0100
Subject: [PATCH] fix mongo visitor parser

---
 eve/io/mongo/parser.py | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)

diff --git a/eve/io/mongo/parser.py b/eve/io/mongo/parser.py
index 6b751203b..ac633c098 100644
--- a/eve/io/mongo/parser.py
+++ b/eve/io/mongo/parser.py
@@ -122,16 +122,19 @@ def visit_Call(self, node):
         datetime().
         """"""
         if isinstance(node.func, ast.Name):
-            expr = None
             if node.func.id == 'ObjectId':
-                expr = ""('"" + node.args[0].s + ""')""
+                try:
+                    self.current_value = ObjectId(node.args[0].s)
+                except:
+                    pass
             elif node.func.id == 'datetime':
                 values = []
                 for arg in node.args:
-                    values.append(str(arg.n))
-                expr = ""("" + "", "".join(values) + "")""
-            if expr:
-                self.current_value = eval(node.func.id + expr)
+                    values.append(arg.n)
+                try:
+                    self.current_value = datetime(*values)
+                except:
+                    pass
 
     def visit_Attribute(self, node):
         """""" Attribute handler ('Contact.Id')."
GHSA-7r8m-45gc-m2c8,"From c8fea750f8020ace8410c442b2684b33a9fddd3b Mon Sep 17 00:00:00 2001
From: Jan Potoms <potoms.jan@gmail.com>
Date: Wed, 2 Nov 2016 15:19:21 +0100
Subject: [PATCH] use https

---
 install.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/install.js b/install.js
index d70aed1..7a46b74 100644
--- a/install.js
+++ b/install.js
@@ -37,7 +37,7 @@ if (process.platform === 'linux' && process.arch === 'x64') {
 
 
 var downloadUrl = util.format(
-  'http://downloads.mongodb.org/osx/mongodb-%s-%s.%s',
+  'https://fastdl.mongodb.org/osx/mongodb-%s-%s.%s',
   platformPart,
   versionPart,
   extension"
CVE-2016-2038,"From 447c88f4884fe30a25d38c331c31d820a19f8c93 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>
Date: Tue, 26 Jan 2016 14:30:08 +0100
Subject: [PATCH] Can not use PMA_fatalError when including fails
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Michal Čihař <michal@cihar.com>
---
 setup/lib/common.inc.php | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/setup/lib/common.inc.php b/setup/lib/common.inc.php
index 8f64f1136bd9..b2bde37e0f8f 100644
--- a/setup/lib/common.inc.php
+++ b/setup/lib/common.inc.php
@@ -15,7 +15,7 @@
 chdir('..');
 
 if (!file_exists('./libraries/common.inc.php')) {
-    PMA_fatalError('Bad invocation!');
+    die('Bad invocation!');
 }
 
 require_once './libraries/common.inc.php';"
OSV-2020-1123,"From ec2e4544819b2ef0ecd297ba331d4f2172b77245 Mon Sep 17 00:00:00 2001
From: Chen Huitao <h980501427@163.com>
Date: Tue, 14 Jan 2020 10:08:58 +0800
Subject: [PATCH] fix some oss-fuzz (#1188)

* fix oss-fuzz 10419.

* fix oss-fuzz 10427.

* fix oss-fuzz 10421.

* fix oss-fuzz 10422.

* fix oss-fuzz 10425.

* fix oss-fuzz 10426.

* fix oss-fuzz 10426.

* fix oss-fuzz 10422.

* fix oss-fuzz  10426.

* fix oss-fuzz 10456.

* fix oss-fuzz 10428.

* fix oss-fuzz 10429.

* fix oss-fuzz 10431.

* fix oss-fuzz 10435.

* fix oss-fuzz 10430.

* fix oss-fuzz 10436.

* remove unused var.

* fix oss-fuzz 10449.

* fix oss-fuzz 10452.

* fix oss-fuzz 11792.

* fix oss-fuzz 10457.

* fix oss-fuzz 11737.

* fix oss-fuzz 10458.

* fix oss-fuzz 10565.

* fix oss-fuzz 11651.

* fix oss-fuzz 10497.

* fix oss-fuzz 10515.

* fix oss-fuzz 10586.

* fix oss-fuzz 10597.

* fiz oss-fuzz 11721.

* fix oss-fuzz 10718.

* fix oss-fuzz 15610.

* fix oss-fuzz 10512.

* fix oss-fuzz 10545.

* fix oss-fuzz 10598.

* fix oss-fuzz 11112.

* fix oss-fuzz 11589.

* fix oss-fuzz 10674.

* git fix oss-fuzz 19610.

* fix oss-fuzz 19848.

* fix oss-fuzz 19851.

* fix oss-fuzz 19852.

* fix oss-fuzz 10878.

* fix oss-fuzz 11655.

* fix oss-fuzz 19849.

* fix oss-fuzz 11765.

* fix oss-fuzz 10337.

* fix oss-fuzz 10575.

* fix oss-fuzz 19877.

* fix oss-fuzz 19895.

* fix oss-fuzz 19896.

* fix oss-fuzz 19897.

* remove verbose fprintf output.

* fix oss-fuzz 19943.

* fix oss-fuzz 20026.

* fix oss-fuzz 20027.

* fix oss-fuzz 19967.

* fix oss-fuzz 19946.
---
 qemu/fpu/softfloat-macros.h   | 4 ++--
 qemu/target-arm/neon_helper.c | 4 ++--
 qemu/target-arm/translate.c   | 4 ++--
 qemu/target-i386/ops_sse.h    | 2 +-
 qemu/target-mips/cpu.h        | 4 ++--
 5 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/qemu/fpu/softfloat-macros.h b/qemu/fpu/softfloat-macros.h
index 2e3c967dca..2892b4fe09 100644
--- a/qemu/fpu/softfloat-macros.h
+++ b/qemu/fpu/softfloat-macros.h
@@ -301,9 +301,9 @@ static inline void
      uint64_t a0, uint64_t a1, int_fast16_t count, uint64_t *z0Ptr, uint64_t *z1Ptr)
 {
 
-    *z1Ptr = a1<<count;
+    *z1Ptr = a1<<(count & 0x3f);
     *z0Ptr =
-        ( count == 0 ) ? a0 : ( a0<<count ) | ( a1>>( ( - count ) & 63 ) );
+        ( count == 0 ) ? a0 : ( a0<<(count & 0x3f) ) | ( a1>>( ( - count ) & 63 ) );
 
 }
 
diff --git a/qemu/target-arm/neon_helper.c b/qemu/target-arm/neon_helper.c
index f2c05cb45b..1426decd2f 100644
--- a/qemu/target-arm/neon_helper.c
+++ b/qemu/target-arm/neon_helper.c
@@ -867,7 +867,7 @@ uint64_t HELPER(neon_qshl_u64)(CPUARMState *env, uint64_t val, uint64_t shiftop)
     } else if (tmp < 0) { \
         dest = src1 >> -tmp; \
     } else { \
-        dest = src1 << tmp; \
+        dest = (uint32_t)src1 << tmp; \
         if ((dest >> tmp) != src1) { \
             SET_QC(); \
             dest = (uint32_t)(1 << (sizeof(src1) * 8 - 1)); \
@@ -1170,7 +1170,7 @@ NEON_VOP(sub_u8, neon_u8, 4)
 NEON_VOP(sub_u16, neon_u16, 2)
 #undef NEON_FN
 
-#define NEON_FN(dest, src1, src2) dest = src1 * src2
+#define NEON_FN(dest, src1, src2) dest = (int64_t)src1 * src2
 NEON_VOP(mul_u8, neon_u8, 4)
 NEON_VOP(mul_u16, neon_u16, 2)
 #undef NEON_FN
diff --git a/qemu/target-arm/translate.c b/qemu/target-arm/translate.c
index db7aec5990..31f0327a23 100644
--- a/qemu/target-arm/translate.c
+++ b/qemu/target-arm/translate.c
@@ -132,7 +132,7 @@ static void load_reg_var(DisasContext *s, TCGv_i32 var, int reg)
             addr = (long)s->pc + 4;
         tcg_gen_movi_i32(tcg_ctx, var, addr);
     } else {
-        tcg_gen_mov_i32(tcg_ctx, var, tcg_ctx->cpu_R[(reg & 0x0f)]);
+        tcg_gen_mov_i32(tcg_ctx, var, tcg_ctx->cpu_R[reg & 0x0f]);
     }
 }
 
@@ -154,7 +154,7 @@ static void store_reg(DisasContext *s, int reg, TCGv_i32 var)
         tcg_gen_andi_i32(tcg_ctx, var, var, ~1);
         s->is_jmp = DISAS_JUMP;
     }
-    tcg_gen_mov_i32(tcg_ctx, tcg_ctx->cpu_R[reg], var);
+    tcg_gen_mov_i32(tcg_ctx, tcg_ctx->cpu_R[reg & 0x0f], var);
     tcg_temp_free_i32(tcg_ctx, var);
 }
 
diff --git a/qemu/target-i386/ops_sse.h b/qemu/target-i386/ops_sse.h
index 5c0301d8a1..2b009c714d 100644
--- a/qemu/target-i386/ops_sse.h
+++ b/qemu/target-i386/ops_sse.h
@@ -876,7 +876,7 @@ static inline uint64_t helper_insertq(uint64_t src, int shift, int len)
     } else {
         mask = (1ULL << (len & 0x3f)) - 1;
     }
-    return (src & ~(mask << shift)) | ((src & mask) << shift);
+    return (src & ~(mask << (shift & 0x3f))) | ((src & mask) << (shift & 0x3f));
 }
 
 void helper_insertq_r(CPUX86State *env, XMMReg *d, XMMReg *s)
diff --git a/qemu/target-mips/cpu.h b/qemu/target-mips/cpu.h
index 819b944773..df4ec2b584 100644
--- a/qemu/target-mips/cpu.h
+++ b/qemu/target-mips/cpu.h
@@ -113,8 +113,8 @@ struct CPUMIPSFPUContext {
 #define FCR0_REV 0
     /* fcsr */
     uint32_t fcr31;
-#define SET_FP_COND(num,env)     do { ((env).fcr31) |= ((num) ? ((int)(1U << ((num) + 24))) : (1 << 23)); } while(0)
-#define CLEAR_FP_COND(num,env)   do { ((env).fcr31) &= ~((num) ? ((int)(1U << ((num) + 24))) : (1 << 23)); } while(0)
+#define SET_FP_COND(num,env)     do { ((env).fcr31) |= ((num) ? ((int)(1U << (((num) + 24) & 0x1f))) : (1 << 23)); } while(0)
+#define CLEAR_FP_COND(num,env)   do { ((env).fcr31) &= ~((num) ? ((int)(1U << (((num) + 24) & 0x1f))) : (1 << 23)); } while(0)
 #define GET_FP_COND(env)         ((((env).fcr31 >> 24) & 0xfe) | (((env).fcr31 >> 23) & 0x1))
 #define GET_FP_CAUSE(reg)        (((reg) >> 12) & 0x3f)
 #define GET_FP_ENABLE(reg)       (((reg) >>  7) & 0x1f)"
GHSA-j8qc-5fqr-52fp,"From c570e2ecfc822941335ad48f6e10df4e21f11c96 Mon Sep 17 00:00:00 2001
From: Mihai Maruseac <mihaimaruseac@google.com>
Date: Wed, 21 Apr 2021 17:50:10 -0700
Subject: [PATCH] Fix issues in Conv2DBackpropFilter.

PiperOrigin-RevId: 369772454
Change-Id: I49b465f2ae2ce91def61b56cea8000197d5177d8
---
 tensorflow/core/kernels/conv_grad_filter_ops.cc | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/tensorflow/core/kernels/conv_grad_filter_ops.cc b/tensorflow/core/kernels/conv_grad_filter_ops.cc
index fb48e3e285a27c..2645d850ab7cfb 100644
--- a/tensorflow/core/kernels/conv_grad_filter_ops.cc
+++ b/tensorflow/core/kernels/conv_grad_filter_ops.cc
@@ -495,6 +495,14 @@ class Conv2DCustomBackpropFilterOp : public OpKernel {
     const int filter_total_size = dims.spatial_dims[0].filter_size *
                                   dims.spatial_dims[1].filter_size *
                                   dims.in_depth;
+    OP_REQUIRES(
+        context,
+        filter_total_size * dims.out_depth == filter_backprop->NumElements(),
+        errors::InvalidArgument(
+            ""filter_size does not have enough elements, requested "",
+            filter_total_size * dims.out_depth, "", got "",
+            filter_backprop->NumElements()));
+
     // The output image size is the spatial size of the output.
     const int output_image_size =
         dims.spatial_dims[0].output_size * dims.spatial_dims[1].output_size;
@@ -518,6 +526,11 @@ class Conv2DCustomBackpropFilterOp : public OpKernel {
 
     const size_t work_unit_size = size_A + size_B + size_C;
 
+    OP_REQUIRES(
+        context, work_unit_size != 0,
+        errors::InvalidArgument(
+            ""Work size for convolution would be 0, which is not acceptable""));
+
     const size_t shard_size =
         (target_working_set_size + work_unit_size - 1) / work_unit_size;"
GHSA-c4w7-xm78-47vh,"From a9ac604abf756dec9687be3843e2c93bfe581f25 Mon Sep 17 00:00:00 2001
From: ""Benjamin E. Coe"" <bencoe@google.com>
Date: Sun, 25 Oct 2020 10:59:56 -0400
Subject: [PATCH] fix: address prototype pollution issue (#108)

---
 lib/index.ts       |  2 +-
 test/y18n-test.cjs | 18 ++++++++++++++++++
 2 files changed, 19 insertions(+), 1 deletion(-)

diff --git a/lib/index.ts b/lib/index.ts
index 864cbac2..07d99e3b 100644
--- a/lib/index.ts
+++ b/lib/index.ts
@@ -47,7 +47,7 @@ class Y18N {
     this.fallbackToLanguage = typeof opts.fallbackToLanguage === 'boolean' ? opts.fallbackToLanguage : true
 
     // internal stuff.
-    this.cache = {}
+    this.cache = Object.create(null)
     this.writeQueue = []
   }
 
diff --git a/test/y18n-test.cjs b/test/y18n-test.cjs
index d65b14b9..a14941b1 100644
--- a/test/y18n-test.cjs
+++ b/test/y18n-test.cjs
@@ -351,6 +351,24 @@ describe('y18n', function () {
     })
   })
 
+  // See: https://github.com/yargs/y18n/issues/96,
+  // https://github.com/yargs/y18n/pull/107
+  describe('prototype pollution', () => {
+    it('does not pollute prototype, with __proto__ locale', () => {
+      const y = y18n()
+      y.setLocale('__proto__')
+      y.updateLocale({ polluted: '👽' })
+      y.__('polluted').should.equal('👽')
+      ;(typeof polluted).should.equal('undefined')
+    })
+
+    it('does not pollute prototype, when __ is used with __proto__ locale', () => {
+      const __ = y18n({ locale: '__proto__' }).__
+      __('hello')
+      ;(typeof {}.hello).should.equal('undefined')
+    })
+  })
+
   after(function () {
     rimraf.sync('./test/locales/fr.json')
   })"
CVE-2014-4978,"From 9c2cd3c93c05d009a91d84eedbb85873b0cb505d Mon Sep 17 00:00:00 2001
From: Anders Brander <anders@brander.dk>
Date: Wed, 3 Dec 2014 08:01:28 +0100
Subject: [PATCH] Fixes insecure use of temporary file (CVE-2014-4978).

---
 librawstudio/rs-filter.c | 21 ++++++++++++++++++---
 1 file changed, 18 insertions(+), 3 deletions(-)

diff --git a/librawstudio/rs-filter.c b/librawstudio/rs-filter.c
index 4913c13d2..352b23c51 100644
--- a/librawstudio/rs-filter.c
+++ b/librawstudio/rs-filter.c
@@ -772,17 +772,32 @@ void
 rs_filter_graph(RSFilter *filter)
 {
 	g_return_if_fail(RS_IS_FILTER(filter));
+	gchar *dot_filename;
+	gchar *png_filename;
+	gchar *command_line;
 	GString *str = g_string_new(""digraph G {\n"");
 
 	rs_filter_graph_helper(str, filter);
 
 	g_string_append_printf(str, ""}\n"");
-	g_file_set_contents(""/tmp/rs-filter-graph"", str->str, str->len, NULL);
 
-	if (0 != system(""dot -Tpng >/tmp/rs-filter-graph.png </tmp/rs-filter-graph""))
+	/* Here we would like to use g_mkdtemp(), but due to a bug in upstream, that's impossible */
+	dot_filename = g_strdup_printf(""/tmp/rs-filter-graph.%u"", g_random_int());
+	png_filename = g_strdup_printf(""%s.%u.png"", dot_filename, g_random_int());
+
+	g_file_set_contents(dot_filename, str->str, str->len, NULL);
+
+	command_line = g_strdup_printf(""dot -Tpng >%s <%s"", png_filename, dot_filename);
+	if (0 != system(command_line))
 		g_warning(""Calling dot failed"");
-	if (0 != system(""gnome-open /tmp/rs-filter-graph.png""))
+	g_free(command_line);
+
+	command_line = g_strdup_printf(""gnome-open %s"", png_filename);
+	if (0 != system(command_line))
 		g_warning(""Calling gnome-open failed."");
+	g_free(command_line);
 
+	g_free(dot_filename);
+	g_free(png_filename);
 	g_string_free(str, TRUE);
 }"
CVE-2021-37847,"From 0a9f9a7410681e55362f8311537ebc7be9ad0fbe Mon Sep 17 00:00:00 2001
From: Sascha Hauer <s.hauer@pengutronix.de>
Date: Fri, 5 Mar 2021 09:27:22 +0100
Subject: [PATCH] crypto: digest: use crypto_memneq()

When verifying a digest it is important not to leak timing information
through memcmp(). Use crypto_memneq() instead.

Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
---
 crypto/digest.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/crypto/digest.c b/crypto/digest.c
index d23245e15f..621d384168 100644
--- a/crypto/digest.c
+++ b/crypto/digest.c
@@ -22,6 +22,7 @@
 #include <errno.h>
 #include <module.h>
 #include <linux/err.h>
+#include <crypto.h>
 #include <crypto/internal.h>
 
 static LIST_HEAD(digests);
@@ -47,8 +48,10 @@ int digest_generic_verify(struct digest *d, const unsigned char *md)
 	if (ret)
 		goto end;
 
-	ret = memcmp(md, tmp, len);
-	ret = ret ? -EINVAL : 0;
+	if (crypto_memneq(md, tmp, len))
+		ret = -EINVAL;
+	else
+		ret = 0;
 end:
 	free(tmp);
 	return ret;"
OSV-2018-105,"From 2effd8cd21b7cc331a140113b755c9ed879de2b3 Mon Sep 17 00:00:00 2001
From: ""Victor M. Alvarez"" <vmalvarez@virustotal.com>
Date: Tue, 30 Apr 2019 16:55:52 +0200
Subject: [PATCH] Add comments explaining the word_chars and space_chars
 tables.

---
 libyara/re_lexer.l | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/libyara/re_lexer.l b/libyara/re_lexer.l
index d9649ad684..3f42fa982a 100644
--- a/libyara/re_lexer.l
+++ b/libyara/re_lexer.l
@@ -62,12 +62,18 @@ with noyywrap then we can remove this pragma.
 #define snprintf _snprintf
 #endif
 
+// Bitmap with 1 bit for each of the 256 characters in the ASCII table. The bit
+// is set to 1 if the corresponding character is alphanumeric or 0 if otherwise.
 static uint8_t word_chars[] = {
     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x03,
     0xFE, 0xFF, 0xFF, 0x87, 0xFE, 0xFF, 0xFF, 0x07,
     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };
 
+// Bitmap with 1 bit for each of the 256 characters in the ASCII table. The bit
+// is set to 1 if the corresponding character is considered a space. Space
+// characters include horizontal and vertical tabs, carriage return, new line
+// and form feed (\t, \v, \r, \n, \f).
 static uint8_t space_chars[] = {
     0x00, 0x3E, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
     0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,"
CVE-2022-2454,"From faa75edde3dfeba1e2cf6ffa48e45a50f1042096 Mon Sep 17 00:00:00 2001
From: jeanlf <jeanlf@gpac.io>
Date: Tue, 12 Jul 2022 18:00:35 +0200
Subject: [PATCH] fixed #2213

---
 src/laser/lsr_dec.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/laser/lsr_dec.c b/src/laser/lsr_dec.c
index 99d16aaa77..488babb104 100644
--- a/src/laser/lsr_dec.c
+++ b/src/laser/lsr_dec.c
@@ -838,6 +838,8 @@ static void lsr_read_id(GF_LASeRCodec *lsr, GF_Node *n)
 
 static Fixed lsr_translate_coords(GF_LASeRCodec *lsr, u32 val, u32 nb_bits)
 {
+	if (!nb_bits) return 0;
+	
 #ifdef GPAC_FIXED_POINT
 	if (val >> (nb_bits-1) ) {
 		s32 neg = (s32) val - (1<<nb_bits);"
CVE-2020-36420,"From 4d42ca1b5849518762d110f34b6ce2e03d6df9ec Mon Sep 17 00:00:00 2001
From: Juliusz Chroboczek <jch@pps.univ-paris-diderot.fr>
Date: Sun, 6 Nov 2016 19:34:34 +0100
Subject: [PATCH] Rephrase README.

---
 README | 10 +++-------
 1 file changed, 3 insertions(+), 7 deletions(-)

diff --git a/README b/README
index 33d803d0..3c61ff96 100644
--- a/README
+++ b/README
@@ -1,11 +1,7 @@
-Polipo is obsolete
-==================
+Polipo is no longer maintained
+==============================
 
-When it was first written, Polipo was probably the best HTTP proxy
-available.  Since then, the web protocols have changed, and Polipo hasn't
-kept up -- it has no support for HTTP/2.0 or the WebSocket protocol.
-
-Polipo will no longer be maintained.
+Polipo is no longer maintained.  Sorry.
 
 
 Original Polipo README"
CVE-2017-8932,"From 9294fa2749ffee7edbbb817a0ef9fe633136fa9c Mon Sep 17 00:00:00 2001
From: Adam Langley <agl@golang.org>
Date: Wed, 19 Apr 2017 10:00:32 -0700
Subject: [PATCH] crypto/elliptic: fix carry bug in x86-64 P-256
 implementation.

Patch from Vlad Krasnov and confirmed to be under CLA.

Fixes #20040.

Change-Id: Ieb8436c4dcb6669a1620f1e0d257efd047b1b87c
Reviewed-on: https://go-review.googlesource.com/41070
Run-TryBot: Adam Langley <agl@golang.org>
TryBot-Result: Gobot Gobot <gobot@golang.org>
Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
---
 src/crypto/elliptic/elliptic_test.go | 36 ++++++++++++++++++++++++++++
 src/crypto/elliptic/p256_asm_amd64.s | 10 ++++----
 2 files changed, 41 insertions(+), 5 deletions(-)

diff --git a/src/crypto/elliptic/elliptic_test.go b/src/crypto/elliptic/elliptic_test.go
index 902c414383753c..c3e4c17d2509d9 100644
--- a/src/crypto/elliptic/elliptic_test.go
+++ b/src/crypto/elliptic/elliptic_test.go
@@ -300,6 +300,29 @@ var p224BaseMultTests = []baseMultTest{
 	},
 }
 
+type scalarMultTest struct {
+	k          string
+	xIn, yIn   string
+	xOut, yOut string
+}
+
+var p256MultTests = []scalarMultTest{
+	{
+		""2a265f8bcbdcaf94d58519141e578124cb40d64a501fba9c11847b28965bc737"",
+		""023819813ac969847059028ea88a1f30dfbcde03fc791d3a252c6b41211882ea"",
+		""f93e4ae433cc12cf2a43fc0ef26400c0e125508224cdb649380f25479148a4ad"",
+		""4d4de80f1534850d261075997e3049321a0864082d24a917863366c0724f5ae3"",
+		""a22d2b7f7818a3563e0f7a76c9bf0921ac55e06e2e4d11795b233824b1db8cc0"",
+	},
+	{
+		""313f72ff9fe811bf573176231b286a3bdb6f1b14e05c40146590727a71c3bccd"",
+		""cc11887b2d66cbae8f4d306627192522932146b42f01d3c6f92bd5c8ba739b06"",
+		""a2f08a029cd06b46183085bae9248b0ed15b70280c7ef13a457f5af382426031"",
+		""831c3f6b5f762d2f461901577af41354ac5f228c2591f84f8a6e51e2e3f17991"",
+		""93f90934cd0ef2c698cc471c60a93524e87ab31ca2412252337f364513e43684"",
+	},
+}
+
 func TestBaseMult(t *testing.T) {
 	p224 := P224()
 	for i, e := range p224BaseMultTests {
@@ -379,6 +402,19 @@ func TestP256Mult(t *testing.T) {
 			break
 		}
 	}
+
+	for i, e := range p256MultTests {
+		x, _ := new(big.Int).SetString(e.xIn, 16)
+		y, _ := new(big.Int).SetString(e.yIn, 16)
+		k, _ := new(big.Int).SetString(e.k, 16)
+		expectedX, _ := new(big.Int).SetString(e.xOut, 16)
+		expectedY, _ := new(big.Int).SetString(e.yOut, 16)
+
+		xx, yy := p256.ScalarMult(x, y, k.Bytes())
+		if xx.Cmp(expectedX) != 0 || yy.Cmp(expectedY) != 0 {
+			t.Errorf(""#%d: got (%x, %x), want (%x, %x)"", i, xx, yy, expectedX, expectedY)
+		}
+	}
 }
 
 func TestInfinity(t *testing.T) {
diff --git a/src/crypto/elliptic/p256_asm_amd64.s b/src/crypto/elliptic/p256_asm_amd64.s
index 6c7bde16e5ef1b..ea4a6fab9a6100 100644
--- a/src/crypto/elliptic/p256_asm_amd64.s
+++ b/src/crypto/elliptic/p256_asm_amd64.s
@@ -1314,12 +1314,12 @@ TEXT p256SubInternal(SB),NOSPLIT,$0
 	ADCQ p256const0<>(SB), acc5
 	ADCQ $0, acc6
 	ADCQ p256const1<>(SB), acc7
-	ADCQ $0, mul0
+	ANDQ $1, mul0
 
-	CMOVQNE acc0, acc4
-	CMOVQNE acc1, acc5
-	CMOVQNE acc2, acc6
-	CMOVQNE acc3, acc7
+	CMOVQEQ acc0, acc4
+	CMOVQEQ acc1, acc5
+	CMOVQEQ acc2, acc6
+	CMOVQEQ acc3, acc7
 
 	RET
 /* ---------------------------------------*/"
CVE-2013-7225,"From d4b2de81a4d8c1b201482edcb2488ed9280a65fd Mon Sep 17 00:00:00 2001
From: Steve Kenworthy <steveyken@gmail.com>
Date: Fri, 27 Dec 2013 15:41:55 +0800
Subject: [PATCH] Refactor activity_user to remove possible SQL injection
 points.

---
 app/controllers/home_controller.rb       | 10 ++++++----
 spec/controllers/home_controller_spec.rb |  6 ++++--
 2 files changed, 10 insertions(+), 6 deletions(-)

diff --git a/app/controllers/home_controller.rb b/app/controllers/home_controller.rb
index 491fd4dc29..0306f02b53 100644
--- a/app/controllers/home_controller.rb
+++ b/app/controllers/home_controller.rb
@@ -122,6 +122,9 @@ def activity_event
   end
 
   #----------------------------------------------------------------------------
+  # TODO: this is ugly, ugly code. It's being security patched now but urgently
+  # needs refactoring to use user id instead. Permuations based on name or email
+  # yield incorrect results.
   def activity_user
     user = current_user.pref[:activity_user]
     if user && user != ""all_users""
@@ -130,12 +133,11 @@ def activity_user
         else # first_name middle_name last_name any_name
           name_query = if user.include?("" "")
             user.name_permutations.map{ |first, last|
-              ""(upper(first_name) LIKE upper('%#{first}%') AND upper(last_name) LIKE upper('%#{last}%'))""
-            }.join("" OR "")
+              User.where(:first_name => first, :last_name => last)
+            }.map(&:to_a).flatten.first
           else
-            ""upper(first_name) LIKE upper('%#{user}%') OR upper(last_name) LIKE upper('%#{user}%')""
+            [User.where(:first_name => user), User.where(:last_name => user)].map(&:to_a).flatten.first
           end
-          User.where(name_query).first
         end
     end
     user.is_a?(User) ? user.id : nil
diff --git a/spec/controllers/home_controller_spec.rb b/spec/controllers/home_controller_spec.rb
index ed1725d2f8..0095333be7 100644
--- a/spec/controllers/home_controller_spec.rb
+++ b/spec/controllers/home_controller_spec.rb
@@ -171,14 +171,16 @@
     it ""should find a user by first name or last name"" do
       @cur_user.stub(:pref).and_return(:activity_user => 'Billy')
       controller.instance_variable_set(:@current_user, @cur_user)
-      User.should_receive(:where).with(""upper(first_name) LIKE upper('%Billy%') OR upper(last_name) LIKE upper('%Billy%')"").and_return([@user])
+      User.should_receive(:where).with(:first_name => 'Billy').and_return([@user])
+      User.should_receive(:where).with(:last_name => 'Billy').and_return([@user])
       controller.send(:activity_user).should == 1
     end
 
     it ""should find a user by first name and last name"" do
       @cur_user.stub(:pref).and_return(:activity_user => 'Billy Elliot')
       controller.instance_variable_set(:@current_user, @cur_user)
-      User.should_receive(:where).with(""(upper(first_name) LIKE upper('%Billy%') AND upper(last_name) LIKE upper('%Elliot%')) OR (upper(first_name) LIKE upper('%Elliot%') AND upper(last_name) LIKE upper('%Billy%'))"").and_return([@user])
+      User.should_receive(:where).with(:first_name => 'Billy', :last_name => ""Elliot"").and_return([@user])
+      User.should_receive(:where).with(:first_name => 'Elliot', :last_name => ""Billy"").and_return([@user])
       controller.send(:activity_user).should == 1
     end"
CVE-2016-7536,"From 478cce544fdf1de882d78381768458f397964453 Mon Sep 17 00:00:00 2001
From: dirk <dirk@git.imagemagick.org>
Date: Sun, 14 Feb 2016 08:40:26 +0100
Subject: [PATCH] Fixed SEGV reported in
 https://github.com/ImageMagick/ImageMagick/issues/130

---
 magick/profile.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/magick/profile.c b/magick/profile.c
index 76d2ec4baa6..35cdd32ed43 100644
--- a/magick/profile.c
+++ b/magick/profile.c
@@ -1444,7 +1444,8 @@ static void WriteTo8BimProfile(Image *image,const char *name,
     count=(ssize_t) value;
     if ((count & 0x01) != 0)
       count++;
-    if ((p > (datum+length-count)) || (count > (ssize_t) length))
+    if ((count < 0) || (p > (datum+length-count)) ||
+        (count > (ssize_t) length))
       break;
     if (id != profile_id)
       p+=count;"
CVE-2021-37794,"From 201329abce4e92ae9071b9ded81e267aae159fbd Mon Sep 17 00:00:00 2001
From: Oleg Lobanov <oleg@lobanov.me>
Date: Mon, 26 Jul 2021 11:08:39 +0200
Subject: [PATCH] chore: add Content-Security-Policy header

---
 http/http.go | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/http/http.go b/http/http.go
index bc79856125..88acea75b3 100644
--- a/http/http.go
+++ b/http/http.go
@@ -25,6 +25,12 @@ func NewHandler(
 	server.Clean()
 
 	r := mux.NewRouter()
+	r.Use(func(next http.Handler) http.Handler {
+		return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
+			w.Header().Set(""Content-Security-Policy"", `default-src 'self'`)
+			next.ServeHTTP(w, r)
+		})
+	})
 	index, static := getStaticHandlers(store, server, assetsFs)
 
 	// NOTE: This fixes the issue where it would redirect if people did not put a"
CVE-2022-0559,"From b5cb90b28ec71fda3504da04e3cc94a362807f5e Mon Sep 17 00:00:00 2001
From: pancake <pancake@nopcode.org>
Date: Sun, 13 Feb 2022 21:27:58 +0100
Subject: [PATCH] Prefer memleak over usaf in io.bank's rbtree bug ##crash

* That's a workaround, proper fix will come later
* Reproducer: bins/fuzzed/iobank-crash
* Reported by Akyne Choi via huntr.dev
---
 libr/io/io_bank.c      | 8 +++++++-
 libr/util/new_rbtree.c | 4 ++--
 2 files changed, 9 insertions(+), 3 deletions(-)

diff --git a/libr/io/io_bank.c b/libr/io/io_bank.c
index 882dfc48d18f0..91f3bd1764eea 100644
--- a/libr/io/io_bank.c
+++ b/libr/io/io_bank.c
@@ -226,12 +226,18 @@ R_API bool r_io_bank_map_add_top(RIO *io, const ut32 bankid, const ut32 mapid) {
 		r_io_submap_set_to (bd, r_io_submap_from (sm) - 1);
 		entry = r_rbnode_next (entry);
 	}
-	while (entry && r_io_submap_to (((RIOSubMap *)entry->data)) <= r_io_submap_to (sm)) {
+	ut64 smto = r_io_submap_to (sm);
+	while (entry && r_io_submap_to (((RIOSubMap *)entry->data)) <= smto) {
 		//delete all submaps that are completly included in sm
 		RRBNode *next = r_rbnode_next (entry);
 		// this can be optimized, there is no need to do search here
+		// XXX this is a workaround to avoid an UAF in Reproducer: iobank-crash
+		void *smfree = bank->submaps->free;
+		bank->submaps->free = NULL;
 		bool a = r_crbtree_delete (bank->submaps, entry->data, _find_sm_by_from_vaddr_cb, NULL);
+		bank->submaps->free = smfree;
 		if (!a) {
+			entry = NULL;
 			break;
 		}
 		entry = next;
diff --git a/libr/util/new_rbtree.c b/libr/util/new_rbtree.c
index a40c44b00d745..2b720a15db08a 100644
--- a/libr/util/new_rbtree.c
+++ b/libr/util/new_rbtree.c
@@ -138,9 +138,9 @@ R_API bool r_crbtree_insert(RRBTree *tree, void *data, RRBComparator cmp, void *
 	r_return_val_if_fail (tree && data && cmp, false);
 	bool inserted = false;
 
-	if (tree->root == NULL) {
+	if (!tree->root) {
 		tree->root = _node_new (data, NULL);
-		if (tree->root == NULL) {
+		if (!tree->root) {
 			return false;
 		}
 		inserted = true;"
GHSA-68gr-cmcp-g3mj,"From 800c8140884eaa5753a49308f560c925fe97b9a5 Mon Sep 17 00:00:00 2001
From: Rafal Janicki <bloorq@gmail.com>
Date: Mon, 5 Feb 2018 06:47:18 +0000
Subject: [PATCH] HackerOne Node.js Ecosystem Bug Bounty Program - January 2018
 disclosures (#199)

---
 repository/npmrepository.json | 112 +++++++++++++++++++++++++++++++---
 1 file changed, 104 insertions(+), 8 deletions(-)

diff --git a/repository/npmrepository.json b/repository/npmrepository.json
index 6159e62d..8e77515e 100644
--- a/repository/npmrepository.json
+++ b/repository/npmrepository.json
@@ -4461,16 +4461,112 @@
         ]
       }
     ]
+  },
+  ""fastify"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""0.38.0"",
+        ""severity"": ""critical"",
+        ""identifiers"": {
+          ""CVE"": [
+            ""CVE-2018-3711""
+          ],
+          ""summary"": ""denial-of-service vulnerability with large JSON payloads""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/303632""
+        ]
+      }
+    ]
+  },
+  ""serve"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""6.4.9"",
+        ""severity"": ""critical"",
+        ""identifiers"": {
+          ""CVE"": [
+            ""CVE-2018-3712""
+          ],
+          ""summary"": ""Path Traversal""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/307666""
+        ]
+      }
+    ]
+  },
+  ""augustine"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""0.2.4"",
+        ""severity"": ""critical"",
+        ""identifiers"": {
+          ""summary"": ""Path Traversal""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/296282""
+        ]
+      }
+    ]
+  },
+  ""lactate"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""0.13.13"",
+        ""severity"": ""medium"",
+        ""identifiers"": {
+          ""summary"": ""Path Traversal""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/296645""
+        ]
+      }
+    ]
+  },
+  ""redis-commander"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""0.4.6"",
+        ""severity"": ""low"",
+        ""identifiers"": {
+          ""summary"": ""Reflected XSS""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/296377""
+        ]
+      }
+    ]
+  },
+  ""featurebook"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""0.0.33"",
+        ""severity"": ""medium"",
+        ""identifiers"": {
+          ""summary"": ""Path Traversal""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/296305""
+        ]
+      }
+    ]
+  },
+  ""serve-here"": {
+    ""vulnerabilities"": [
+      {
+        ""below"": ""3.2.2"",
+        ""severity"": ""medium"",
+        ""identifiers"": {
+          ""summary"": ""Path Traversal""
+        },
+        ""info"": [
+          ""https://hackerone.com/reports/296254""
+        ]
+      }
+    ]
   }
 
 
 
-
-
-
-
-
-
-
-
 }"
CVE-2019-10254,"From 586cca384be6710b03e14bcbeb7588c1772604ec Mon Sep 17 00:00:00 2001
From: iglocska <andras.iklody@gmail.com>
Date: Thu, 28 Mar 2019 12:05:21 +0100
Subject: [PATCH] fix: [security] Fix to a reflected XSS in the default layout
 template

- as reported by Tuscany Internet eXchange | Misp Team | TIX CyberSecurity
---
 app/View/Layouts/default.ctp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/app/View/Layouts/default.ctp b/app/View/Layouts/default.ctp
index 9b720d2958c..93139d9c03b 100644
--- a/app/View/Layouts/default.ctp
+++ b/app/View/Layouts/default.ctp
@@ -101,9 +101,9 @@
         var baseurl = '<?php echo $baseurl; ?>';
         var here = '<?php
                 if (substr($this->params['action'], 0, 6) === 'admin_') {
-                    echo $baseurl . '/admin/' . $this->params['controller'] . '/' . substr($this->params['action'], 6);
+                    echo $baseurl . '/admin/' . h($this->params['controller']) . '/' . h(substr($this->params['action'], 6));
                 } else {
-                    echo $baseurl . '/' . $this->params['controller'] . '/' . $this->params['action'];
+                    echo $baseurl . '/' . h($this->params['controller']) . '/' . h($this->params['action']);
                 }
             ?>';
         $(document).ready(function(){"
CVE-2015-6252,"From 7932c0bd7740f4cd2aa168d3ce0199e7af7d72d5 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Marc-Andr=C3=A9=20Lureau?= <marcandre.lureau@redhat.com>
Date: Fri, 17 Jul 2015 15:32:03 +0200
Subject: [PATCH] vhost: actually track log eventfd file
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

While reviewing vhost log code, I found out that log_file is never
set. Note: I haven't tested the change (QEMU doesn't use LOG_FD yet).

Cc: stable@vger.kernel.org
Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
---
 drivers/vhost/vhost.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/vhost/vhost.c b/drivers/vhost/vhost.c
index a9fe859f43c874..95bdb90fd7f06a 100644
--- a/drivers/vhost/vhost.c
+++ b/drivers/vhost/vhost.c
@@ -995,6 +995,7 @@ long vhost_dev_ioctl(struct vhost_dev *d, unsigned int ioctl, void __user *argp)
 		}
 		if (eventfp != d->log_file) {
 			filep = d->log_file;
+			d->log_file = eventfp;
 			ctx = d->log_ctx;
 			d->log_ctx = eventfp ?
 				eventfd_ctx_fileget(eventfp) : NULL;"
CVE-2016-7533,"From bef1e4f637d8f665bc133a9c6d30df08d983bc3a Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Fri, 5 Feb 2016 21:20:42 -0500
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/120

---
 coders/wpg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/coders/wpg.c b/coders/wpg.c
index 964530533ea..b01dcf9cc63 100644
--- a/coders/wpg.c
+++ b/coders/wpg.c
@@ -1331,7 +1331,7 @@ static Image *ReadWPGImage(const ImageInfo *image_info,
                   {
                     ldblk=(ssize_t) ((bpp*image->columns+7)/8);
                     BImgBuff=(unsigned char *) AcquireQuantumMemory((size_t)
-                      ldblk,sizeof(*BImgBuff));
+                      ldblk+1,sizeof(*BImgBuff));
                     if (BImgBuff == (unsigned char *) NULL)
                       goto NoMemory;"
CVE-2016-10158,"From 1cda0d7c2ffb62d8331c64e703131d9cabdc03ea Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Sat, 31 Dec 2016 19:31:49 -0800
Subject: [PATCH] Fix bug #73737 FPE when parsing a tag format

---
 ext/exif/exif.c              |   2 +-
 ext/exif/tests/bug73737.phpt |  12 ++++++++++++
 ext/exif/tests/bug73737.tiff | Bin 0 -> 48 bytes
 3 files changed, 13 insertions(+), 1 deletion(-)
 create mode 100644 ext/exif/tests/bug73737.phpt
 create mode 100644 ext/exif/tests/bug73737.tiff

diff --git a/ext/exif/exif.c b/ext/exif/exif.c
index 8b0e34c10dc8a..83daee6f54f5d 100644
--- a/ext/exif/exif.c
+++ b/ext/exif/exif.c
@@ -1303,7 +1303,7 @@ static size_t exif_convert_any_to_int(void *value, int format, int motorola_inte
 			if (s_den == 0) {
 				return 0;
 			} else {
-				return php_ifd_get32s(value, motorola_intel) / s_den;
+				return (size_t)((double)php_ifd_get32s(value, motorola_intel) / s_den);
 			}
 
 		case TAG_FMT_SSHORT:    return php_ifd_get16u(value, motorola_intel);
diff --git a/ext/exif/tests/bug73737.phpt b/ext/exif/tests/bug73737.phpt
new file mode 100644
index 0000000000000..21eaf80585bc5
--- /dev/null
+++ b/ext/exif/tests/bug73737.phpt
@@ -0,0 +1,12 @@
+--TEST--
+Bug #73737 (Crash when parsing a tag format)
+--SKIPIF--
+<?php if (!extension_loaded('exif')) print 'skip exif extension not available';?>
+--FILE--
+<?php
+	$exif = exif_thumbnail(__DIR__ . '/bug73737.tiff');
+	var_dump($exif);
+?>
+--EXPECTF--
+Warning: exif_thumbnail(bug73737.tiff): Error in TIFF: filesize(x0030) less than start of IFD dir(x10102) in %s line %d
+bool(false)
diff --git a/ext/exif/tests/bug73737.tiff b/ext/exif/tests/bug73737.tiff
new file mode 100644
index 0000000000000000000000000000000000000000..2cb036fc4730502a3e8041ab24ab12a2ad0b0327
GIT binary patch
literal 48
ocmebEWzb?^VBlb2Wb|TS2C_gv49H_(-~urlfcQTUfY=}a0A>IMx&QzG

literal 0
HcmV?d00001"
CVE-2016-7534,"From 430403b0029b37decf216d57f810899cab2317dd Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Sun, 7 Feb 2016 15:13:08 -0500
Subject: [PATCH] https://github.com/ImageMagick/ImageMagick/issues/126

---
 MagickCore/quantum-import.c | 2 +-
 MagickCore/quantum.c        | 4 +++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/MagickCore/quantum-import.c b/MagickCore/quantum-import.c
index b04c82e7245..a0085f3b734 100644
--- a/MagickCore/quantum-import.c
+++ b/MagickCore/quantum-import.c
@@ -1421,7 +1421,7 @@ static void ImportCbYCrYQuantum(const Image *image,QuantumInfo *quantum_info,
 
           n=0;
           quantum=0;
-          for (x=0; x < (ssize_t) number_pixels; x+=2)
+          for (x=0; x < (ssize_t) number_pixels; x+=4)
           {
             for (i=0; i < 4; i++)
             {
diff --git a/MagickCore/quantum.c b/MagickCore/quantum.c
index 9d8190a9030..a594bb6fc25 100644
--- a/MagickCore/quantum.c
+++ b/MagickCore/quantum.c
@@ -321,6 +321,9 @@ MagickExport size_t GetQuantumExtent(const Image *image,
     case BGRAQuantum: packet_size=4; break;
     case CMYKQuantum: packet_size=4; break;
     case CMYKAQuantum: packet_size=5; break;
+    case CbYCrAQuantum: packet_size=4; break;
+    case CbYCrQuantum: packet_size=3; break;
+    case CbYCrYQuantum: packet_size=4; break;
     default: break;
   }
   extent=MagickMax(image->columns,image->rows);
@@ -872,7 +875,6 @@ MagickExport void SetQuantumPack(QuantumInfo *quantum_info,
   quantum_info->pack=pack;
 }
 
-
 /*
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %                                                                             %"
CVE-2017-16357,"From 0b973e28166636e0ff1fad80baa0385c9c09c53a Mon Sep 17 00:00:00 2001
From: Khairul Kasmiran <kazarmy@gmail.com>
Date: Sat, 28 Oct 2017 11:56:30 +0800
Subject: [PATCH] Fixed crash in elf.c with 32bit r2 when shdr->sh_size > max
 size_t

---
 libr/bin/format/elf/elf.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/libr/bin/format/elf/elf.c b/libr/bin/format/elf/elf.c
index 2248731b38a2c..b466c312cba49 100644
--- a/libr/bin/format/elf/elf.c
+++ b/libr/bin/format/elf/elf.c
@@ -705,7 +705,7 @@ static Sdb *store_versioninfo_gnu_verdef(ELFOBJ *bin, Elf_(Shdr) *shdr, int sz)
 		return false;
 	}
 	link_shdr = &bin->shdr[shdr->sh_link];
-	if (shdr->sh_size < 1) {
+	if (shdr->sh_size < 1 || shdr->sh_size > SIZE_MAX) {
 		return false;
 	}
 	Elf_(Verdef) *defs = calloc (shdr->sh_size, sizeof (char));
@@ -837,7 +837,7 @@ static Sdb *store_versioninfo_gnu_verneed(ELFOBJ *bin, Elf_(Shdr) *shdr, int sz)
 	if (shdr->sh_link > bin->ehdr.e_shnum) {
 		return NULL;
 	}
-	if (shdr->sh_size < 1) {
+	if (shdr->sh_size < 1 || shdr->sh_size > SIZE_MAX) {
 		return NULL;
 	}
 	sdb = sdb_new0 ();"
CVE-2019-19052,"From fb5be6a7b4863ecc44963bb80ca614584b6c7817 Mon Sep 17 00:00:00 2001
From: Navid Emamdoost <navid.emamdoost@gmail.com>
Date: Thu, 19 Sep 2019 21:44:38 -0500
Subject: [PATCH] can: gs_usb: gs_can_open(): prevent memory leak

In gs_can_open() if usb_submit_urb() fails the allocated urb should be
released.

Fixes: d08e973a77d1 (""can: gs_usb: Added support for the GS_USB CAN devices"")
Cc: linux-stable <stable@vger.kernel.org>
Signed-off-by: Navid Emamdoost <navid.emamdoost@gmail.com>
Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>
---
 drivers/net/can/usb/gs_usb.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/net/can/usb/gs_usb.c b/drivers/net/can/usb/gs_usb.c
index bd6eb9967630b2..2f74f6704c1286 100644
--- a/drivers/net/can/usb/gs_usb.c
+++ b/drivers/net/can/usb/gs_usb.c
@@ -623,6 +623,7 @@ static int gs_can_open(struct net_device *netdev)
 					   rc);
 
 				usb_unanchor_urb(urb);
+				usb_free_urb(urb);
 				break;
 			}"
CVE-2017-13146,"From 79e5dbcdd1fc2f714f9bae548bc55d5073f3ed20 Mon Sep 17 00:00:00 2001
From: Cristy <urban-warrior@imagemagick.org>
Date: Thu, 27 Apr 2017 07:45:09 -0400
Subject: [PATCH] ...

---
 coders/mat.c | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/coders/mat.c b/coders/mat.c
index 1ff235448de..48cde36e27d 100644
--- a/coders/mat.c
+++ b/coders/mat.c
@@ -627,6 +627,7 @@ static Image *ReadMATImageV4(const ImageInfo *image_info,Image *image,
     depth;
 
 
+  quantum_info=(QuantumInfo *) NULL;
   (void) SeekBlob(image,0,SEEK_SET);
   while (EOFBlob(image) != MagickFalse)
   {
@@ -772,7 +773,8 @@ static Image *ReadMATImageV4(const ImageInfo *image_info,Image *image,
         else
           InsertComplexFloatRow(image,(float *) pixels,y,0,0,exception);
       }
-    quantum_info=DestroyQuantumInfo(quantum_info);
+    if (quantum_info != (QuantumInfo *) NULL)
+      quantum_info=DestroyQuantumInfo(quantum_info);
     rotate_image=RotateImage(image,90.0,exception);
     if (rotate_image != (Image *) NULL)
       {
@@ -890,6 +892,7 @@ static Image *ReadMATImage(const ImageInfo *image_info,ExceptionInfo *exception)
   /*
      Read MATLAB image.
    */
+  quantum_info=(QuantumInfo *) NULL;
   clone_info=CloneImageInfo(image_info);
   if (ReadBlob(image,124,(unsigned char *) &MATLAB_HDR.identific) != 124)
     ThrowReaderException(CorruptImageError,""ImproperImageHeader"");
@@ -1290,7 +1293,8 @@ RestoreMSCWarning
   }
 
   RelinquishMagickMemory(BImgBuff);
-  quantum_info=DestroyQuantumInfo(quantum_info);
+  if (quantum_info != (QuantumInfo *) NULL)
+    quantum_info=DestroyQuantumInfo(quantum_info);
 END_OF_READING:
   clone_info=DestroyImageInfo(clone_info);
   CloseBlob(image);"
CVE-2017-5188,"From ba27c91351878bc297ec4baba0bd488a2f3b568d Mon Sep 17 00:00:00 2001
From: Michael Schroeder <mls@suse.de>
Date: Fri, 17 Mar 2017 10:57:58 +0100
Subject: [PATCH] [backend] only allow plain files in cpio_sender

No devices, sockets, directories, symlinks please...
---
 src/backend/BSHTTP.pm | 19 +++++++++++++++----
 1 file changed, 15 insertions(+), 4 deletions(-)

diff --git a/src/backend/BSHTTP.pm b/src/backend/BSHTTP.pm
index d91de76b0a0..928b88a9922 100644
--- a/src/backend/BSHTTP.pm
+++ b/src/backend/BSHTTP.pm
@@ -448,13 +448,24 @@ sub cpio_sender {
       my $filename = $file->{'filename'};
       if (ref($filename)) {
 	*F = $filename;
-      } elsif (!open(F, '<', $filename)) {
-	$errors->{'data'} .= ""$file->{'name'}: $filename: $!\n"";
-	next;
+      } else {
+	@s = lstat($filename);
+	if (!@s) {
+	  $errors->{'data'} .= ""$file->{'name'}: $filename: $!\n"";
+	  next;
+	}
+	if (-l _ || ! -f _) {
+	  $errors->{'data'} .= ""$file->{'name'}: $filename: not a plain file\n"";
+	  next;
+	}
+	if (!open(F, '<', $filename)) {
+	  $errors->{'data'} .= ""$file->{'name'}: $filename: $!\n"";
+	  next;
+	}
       }
       @s = stat(F);
       if (!@s) {
-	$errors->{'data'} .= ""$file->{'name'}: stat: $!\n"";
+	$errors->{'data'} .= ""$file->{'name'}: fstat: $!\n"";
 	close F unless ref $filename;
 	next;
       }"
