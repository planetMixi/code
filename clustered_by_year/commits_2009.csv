vuln_id,code_diff
CVE-2009-3111,"From 860cad9e02ba344edb0038419e415fe05a9a01f4 Mon Sep 17 00:00:00 2001
From: ""Alan T. DeKok"" <aland@freeradius.org>
Date: Mon, 7 Sep 2009 13:14:56 +0200
Subject: [PATCH] Fix crash on Tunnel-Password attributes with zero length

---
 src/lib/radius.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/src/lib/radius.c b/src/lib/radius.c
index 044ed8f53726..a3ab60aad160 100644
--- a/src/lib/radius.c
+++ b/src/lib/radius.c
@@ -1964,6 +1964,11 @@ int rad_decode(RADIUS_PACKET *packet, RADIUS_PACKET *original,
 		 *	over-ride this one.
 		 */
 	create_pair:
+		/*
+		 *	Ignore VSAs that have no data.
+		 */
+		if (attrlen == 0) goto next;
+
 		pair = rad_attr2vp(packet, original, secret,
 				 attribute, attrlen, ptr);
 		if (!pair) {
@@ -1976,6 +1981,7 @@ int rad_decode(RADIUS_PACKET *packet, RADIUS_PACKET *original,
 		*tail = pair;
 		tail = &pair->next;
 
+	next:
 		ptr += attrlen;
 		packet_length -= attrlen;
 	}"
