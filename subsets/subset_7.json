{
    "schema":{
        "fields":[
            {
                "name":"index",
                "type":"integer"
            },
            {
                "name":"vuln_id",
                "type":"string"
            },
            {
                "name":"cwe_id",
                "type":"string"
            },
            {
                "name":"score",
                "type":"number"
            },
            {
                "name":"chain",
                "type":"string"
            },
            {
                "name":"dataset",
                "type":"string"
            },
            {
                "name":"summary",
                "type":"string"
            },
            {
                "name":"published_date",
                "type":"string"
            },
            {
                "name":"chain_len",
                "type":"integer"
            },
            {
                "name":"project",
                "type":"string"
            },
            {
                "name":"commit_href",
                "type":"string"
            },
            {
                "name":"commit_sha",
                "type":"string"
            },
            {
                "name":"patch",
                "type":"string"
            },
            {
                "name":"chain_ord",
                "type":"string"
            },
            {
                "name":"before_first_fix_commit",
                "type":"string"
            },
            {
                "name":"last_fix_commit",
                "type":"string"
            },
            {
                "name":"chain_ord_pos",
                "type":"number"
            },
            {
                "name":"commit_datetime",
                "type":"string"
            },
            {
                "name":"message",
                "type":"string"
            },
            {
                "name":"author",
                "type":"string"
            },
            {
                "name":"comments",
                "type":"string"
            },
            {
                "name":"stats",
                "type":"string"
            },
            {
                "name":"files",
                "type":"string"
            },
            {
                "name":"message_norm",
                "type":"string"
            },
            {
                "name":"language",
                "type":"string"
            },
            {
                "name":"entities",
                "type":"string"
            },
            {
                "name":"classification_level_1",
                "type":"string"
            },
            {
                "name":"classification_level_2",
                "type":"string"
            },
            {
                "name":"list_files",
                "type":"string"
            },
            {
                "name":"num_files",
                "type":"number"
            },
            {
                "name":"patch_content",
                "type":"string"
            }
        ],
        "primaryKey":[
            "index"
        ],
        "pandas_version":"1.4.0"
    },
    "data":[
        {
            "index":795,
            "vuln_id":"GHSA-x2jc-pwfj-h9p3",
            "cwe_id":"{'CWE-89'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/sequelize\/sequelize\/commit\/c876192aa6ce1f67e22b26a4d175b8478615f42d'}",
            "dataset":"osv",
            "summary":"SQL Injection in sequelize Affected versions of `sequelize` use MySQL's backslash-based escape syntax when connecting to SQLite, despite the fact that SQLite uses PostgreSQL's escape syntax, which can result in a SQL Injection vulnerability.\n\n\n## Recommendation\n\nUpdate to version 1.7.0-alpha3 or later.",
            "published_date":"2019-02-18",
            "chain_len":1,
            "project":"https:\/\/github.com\/sequelize\/sequelize",
            "commit_href":"https:\/\/github.com\/sequelize\/sequelize\/commit\/c876192aa6ce1f67e22b26a4d175b8478615f42d",
            "commit_sha":"c876192aa6ce1f67e22b26a4d175b8478615f42d",
            "patch":"SINGLE",
            "chain_ord":"['c876192aa6ce1f67e22b26a4d175b8478615f42d']",
            "before_first_fix_commit":"{'7dc35e3889e3fa0859b96be41092717444cc2a38'}",
            "last_fix_commit":"c876192aa6ce1f67e22b26a4d175b8478615f42d",
            "chain_ord_pos":1.0,
            "commit_datetime":"06\/15\/2013, 03:24:59",
            "message":"Fix string escaping for sqlite\n\nSQLite was defaulting to the MySQL backslash-escaped style, but it uses\npostgres-style escaping. This is a SQL-injection vulnerability, and\nshouldn't be taken lightly (although SQLite is mostly for testing).",
            "author":"Benjamin Woodruff",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
            "files":"{'lib\/sql-string.js': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/sequelize\/sequelize\/raw\/c876192aa6ce1f67e22b26a4d175b8478615f42d\/lib%2Fsql-string.js', 'patch': '@@ -37,8 +37,9 @@ SqlString.escape = function(val, stringifyObjects, timeZone, dialect) {\\n     }\\n   }\\n \\n-  if (dialect == \"postgres\") {\\n+  if (dialect === \"postgres\" || dialect === \"sqlite\") {\\n     \/\/ http:\/\/www.postgresql.org\/docs\/8.2\/static\/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS\\n+    \/\/ http:\/\/stackoverflow.com\/q\/603572\/130598\\n     val = val.replace(\/\\'\/g, \"\\'\\'\");\\n   } else {\\n     val = val.replace(\/[\\\\0\\\\n\\\\r\\\\b\\\\t\\\\\\\\\\\\\\'\\\\\"\\\\x1a]\/g, function(s) {'}}",
            "message_norm":"fix string escaping for sqlite\n\nsqlite was defaulting to the mysql backslash-escaped style, but it uses\npostgres-style escaping. this is a sql-injection vulnerability, and\nshouldn't be taken lightly (although sqlite is mostly for testing).",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('escaping', 'SECWORD', ''), ('escaped', 'SECWORD', ''), ('escaping', 'SECWORD', ''), ('injection', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/sql-string.js'])",
            "num_files":1.0,
            "patch_content":"From c876192aa6ce1f67e22b26a4d175b8478615f42d Mon Sep 17 00:00:00 2001\nFrom: Benjamin Woodruff <benjaminwoodruff@ufl.edu>\nDate: Fri, 14 Jun 2013 23:24:59 -0400\nSubject: [PATCH] Fix string escaping for sqlite\n\nSQLite was defaulting to the MySQL backslash-escaped style, but it uses\npostgres-style escaping. This is a SQL-injection vulnerability, and\nshouldn't be taken lightly (although SQLite is mostly for testing).\n---\n lib\/sql-string.js | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/lib\/sql-string.js b\/lib\/sql-string.js\nindex 96be2c7e6ae4..160dfa428d4d 100644\n--- a\/lib\/sql-string.js\n+++ b\/lib\/sql-string.js\n@@ -37,8 +37,9 @@ SqlString.escape = function(val, stringifyObjects, timeZone, dialect) {\n     }\n   }\n \n-  if (dialect == \"postgres\") {\n+  if (dialect === \"postgres\" || dialect === \"sqlite\") {\n     \/\/ http:\/\/www.postgresql.org\/docs\/8.2\/static\/sql-syntax-lexical.html#SQL-SYNTAX-STRINGS\n+    \/\/ http:\/\/stackoverflow.com\/q\/603572\/130598\n     val = val.replace(\/'\/g, \"''\");\n   } else {\n     val = val.replace(\/[\\0\\n\\r\\b\\t\\\\\\'\\\"\\x1a]\/g, function(s) {"
        },
        {
            "index":329,
            "vuln_id":"GHSA-jppv-gw3r-w3q8",
            "cwe_id":"{'CWE-78'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/ruby\/rake\/commit\/5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee'}",
            "dataset":"osv",
            "summary":"OS Command Injection in Rake There is an OS command injection vulnerability in Ruby Rake before 12.3.3 in Rake::FileList when supplying a filename that begins with the pipe character `|`.",
            "published_date":"2020-02-28",
            "chain_len":1,
            "project":"https:\/\/github.com\/ruby\/rake",
            "commit_href":"https:\/\/github.com\/ruby\/rake\/commit\/5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee",
            "commit_sha":"5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee",
            "patch":"SINGLE",
            "chain_ord":"['5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee']",
            "before_first_fix_commit":"{'6497ba4d94d12c123df48cc8ab40f0a4eb7fb337'}",
            "last_fix_commit":"5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee",
            "chain_ord_pos":1.0,
            "commit_datetime":"07\/22\/2019, 01:23:43",
            "message":"Use File.open explicitly.",
            "author":"Hiroshi SHIBATA",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'lib\/rake\/file_list.rb': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ruby\/rake\/raw\/5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee\/lib%2Frake%2Ffile_list.rb', 'patch': '@@ -294,7 +294,7 @@ def egrep(pattern, *options)\\n       matched = 0\\n       each do |fn|\\n         begin\\n-          open(fn, \"r\", *options) do |inf|\\n+          File.open(fn, \"r\", *options) do |inf|\\n             count = 0\\n             inf.each do |line|\\n               count += 1'}}",
            "message_norm":"use file.open explicitly.",
            "language":"en",
            "entities":null,
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/rake\/file_list.rb'])",
            "num_files":1.0,
            "patch_content":"From 5b8f8fc41a5d7d7d6a5d767e48464c60884d3aee Mon Sep 17 00:00:00 2001\nFrom: Hiroshi SHIBATA <hsbt@ruby-lang.org>\nDate: Mon, 22 Jul 2019 10:23:43 +0900\nSubject: [PATCH] Use File.open explicitly.\n\n---\n lib\/rake\/file_list.rb | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lib\/rake\/file_list.rb b\/lib\/rake\/file_list.rb\nindex 15ea4b36d..22c339f24 100644\n--- a\/lib\/rake\/file_list.rb\n+++ b\/lib\/rake\/file_list.rb\n@@ -294,7 +294,7 @@ def egrep(pattern, *options)\n       matched = 0\n       each do |fn|\n         begin\n-          open(fn, \"r\", *options) do |inf|\n+          File.open(fn, \"r\", *options) do |inf|\n             count = 0\n             inf.each do |line|\n               count += 1"
        },
        {
            "index":46,
            "vuln_id":"GHSA-9959-6p3m-wxpc",
            "cwe_id":"{'CWE-119'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/netty\/netty\/commit\/2fa9400a59d0563a66908aba55c41e7285a04994'}",
            "dataset":"osv",
            "summary":"Denial of service in Netty The SslHandler in Netty before 3.9.2 allows remote attackers to cause a denial of service (infinite loop and CPU consumption) via a crafted SSLv2Hello message.",
            "published_date":"2020-06-30",
            "chain_len":1,
            "project":"https:\/\/github.com\/netty\/netty",
            "commit_href":"https:\/\/github.com\/netty\/netty\/commit\/2fa9400a59d0563a66908aba55c41e7285a04994",
            "commit_sha":"2fa9400a59d0563a66908aba55c41e7285a04994",
            "patch":"SINGLE",
            "chain_ord":"['2fa9400a59d0563a66908aba55c41e7285a04994']",
            "before_first_fix_commit":"{'129c17aaa4ac5c611519ef480c35a12e8282b807'}",
            "last_fix_commit":"2fa9400a59d0563a66908aba55c41e7285a04994",
            "chain_ord_pos":1.0,
            "commit_datetime":"06\/10\/2014, 08:55:19",
            "message":"Fix a bug where SslHandler does not handle SSLv2Hello correctly\n\nMotivation:\n\nWhen a SSLv2Hello message is received, SSLEngine expects the application buffer size to be more than 30KB which is larger than what SslBufferPool can provide.  SSLEngine will always return with BUFFER_OVERFLOW status, blocking the SSL session from continuing the handshake.\n\nModifications:\n\nWhen SSLEngine.getSession().getApplicationBufferSize() returns a value larger than what SslBufferPool provides, allocate a temporary heap buffer.\n\nResult:\n\nSSLv2Hello is handled correctly.",
            "author":"Trustin Lee",
            "comments":"{'com_1': {'author': 'normanmaurer', 'datetime': '06\/10\/2014, 10:12:19', 'body': \"shouldn't this check against remaining() ?\"}, 'com_2': {'author': 'trustin', 'datetime': '06\/10\/2014, 11:07:26', 'body': 'Not really because we always clear the buffer at the finally block below.'}}",
            "stats":"{'additions': 15, 'deletions': 5, 'total': 20}",
            "files":"{'src\/main\/java\/org\/jboss\/netty\/handler\/ssl\/SslHandler.java': {'additions': 15, 'deletions': 5, 'changes': 20, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/netty\/netty\/raw\/2fa9400a59d0563a66908aba55c41e7285a04994\/src%2Fmain%2Fjava%2Forg%2Fjboss%2Fnetty%2Fhandler%2Fssl%2FSslHandler.java', 'patch': '@@ -1268,8 +1268,18 @@ private ChannelBuffer unwrap(\\n                     \/\/ always contain at least one record in decode().  Therefore, if SSLEngine.unwrap() returns\\n                     \/\/ BUFFER_OVERFLOW, it is always resolved by retrying after emptying the application buffer.\\n                     for (;;) {\\n+                        final int outAppBufSize = engine.getSession().getApplicationBufferSize();\\n+                        final ByteBuffer outAppBuf;\\n+                        if (nioOutAppBuf.capacity() < outAppBufSize) {\\n+                            \/\/ SSLEngine wants a buffer larger than what the pool can provide.\\n+                            \/\/ Allocate a temporary heap buffer.\\n+                            outAppBuf = ByteBuffer.allocate(outAppBufSize);\\n+                        } else {\\n+                            outAppBuf = nioOutAppBuf;\\n+                        }\\n+\\n                         try {\\n-                            result = engine.unwrap(nioInNetBuf, nioOutAppBuf);\\n+                            result = engine.unwrap(nioInNetBuf, outAppBuf);\\n                             switch (result.getStatus()) {\\n                                 case CLOSED:\\n                                     \/\/ notify about the CLOSED state of the SSLEngine. See #137\\n@@ -1283,21 +1293,21 @@ private ChannelBuffer unwrap(\\n \\n                             break;\\n                         } finally {\\n-                            nioOutAppBuf.flip();\\n+                            outAppBuf.flip();\\n \\n                             \/\/ Sync the offset of the inbound buffer.\\n                             nettyInNetBuf.readerIndex(\\n                                     nettyInNetBufStartOffset + nioInNetBuf.position() - nioInNetBufStartOffset);\\n \\n                             \/\/ Copy the unwrapped data into a smaller buffer.\\n-                            if (nioOutAppBuf.hasRemaining()) {\\n+                            if (outAppBuf.hasRemaining()) {\\n                                 if (nettyOutAppBuf == null) {\\n                                     ChannelBufferFactory factory = ctx.getChannel().getConfig().getBufferFactory();\\n                                     nettyOutAppBuf = factory.getBuffer(initialNettyOutAppBufCapacity);\\n                                 }\\n-                                nettyOutAppBuf.writeBytes(nioOutAppBuf);\\n+                                nettyOutAppBuf.writeBytes(outAppBuf);\\n                             }\\n-                            nioOutAppBuf.clear();\\n+                            outAppBuf.clear();\\n                         }\\n                     }'}}",
            "message_norm":"fix a bug where sslhandler does not handle sslv2hello correctly\n\nmotivation:\n\nwhen a sslv2hello message is received, sslengine expects the application buffer size to be more than 30kb which is larger than what sslbufferpool can provide.  sslengine will always return with buffer_overflow status, blocking the ssl session from continuing the handshake.\n\nmodifications:\n\nwhen sslengine.getsession().getapplicationbuffersize() returns a value larger than what sslbufferpool provides, allocate a temporary heap buffer.\n\nresult:\n\nsslv2hello is handled correctly.",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('bug', 'FLAW', ''), ('buffer_overflow', 'SECWORD', ''), ('ssl', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/main\/java\/org\/jboss\/netty\/handler\/ssl\/SslHandler.java'])",
            "num_files":1.0,
            "patch_content":"From 2fa9400a59d0563a66908aba55c41e7285a04994 Mon Sep 17 00:00:00 2001\nFrom: Trustin Lee <t@motd.kr>\nDate: Tue, 10 Jun 2014 17:55:19 +0900\nSubject: [PATCH] Fix a bug where SslHandler does not handle SSLv2Hello\n correctly\n\nMotivation:\n\nWhen a SSLv2Hello message is received, SSLEngine expects the application buffer size to be more than 30KB which is larger than what SslBufferPool can provide.  SSLEngine will always return with BUFFER_OVERFLOW status, blocking the SSL session from continuing the handshake.\n\nModifications:\n\nWhen SSLEngine.getSession().getApplicationBufferSize() returns a value larger than what SslBufferPool provides, allocate a temporary heap buffer.\n\nResult:\n\nSSLv2Hello is handled correctly.\n---\n ...\/jboss\/netty\/handler\/ssl\/SslHandler.java   | 20 ++++++++++++++-----\n 1 file changed, 15 insertions(+), 5 deletions(-)\n\ndiff --git a\/src\/main\/java\/org\/jboss\/netty\/handler\/ssl\/SslHandler.java b\/src\/main\/java\/org\/jboss\/netty\/handler\/ssl\/SslHandler.java\nindex 83dfeb999b63..c3bb18d4cb6f 100644\n--- a\/src\/main\/java\/org\/jboss\/netty\/handler\/ssl\/SslHandler.java\n+++ b\/src\/main\/java\/org\/jboss\/netty\/handler\/ssl\/SslHandler.java\n@@ -1268,8 +1268,18 @@ private ChannelBuffer unwrap(\n                     \/\/ always contain at least one record in decode().  Therefore, if SSLEngine.unwrap() returns\n                     \/\/ BUFFER_OVERFLOW, it is always resolved by retrying after emptying the application buffer.\n                     for (;;) {\n+                        final int outAppBufSize = engine.getSession().getApplicationBufferSize();\n+                        final ByteBuffer outAppBuf;\n+                        if (nioOutAppBuf.capacity() < outAppBufSize) {\n+                            \/\/ SSLEngine wants a buffer larger than what the pool can provide.\n+                            \/\/ Allocate a temporary heap buffer.\n+                            outAppBuf = ByteBuffer.allocate(outAppBufSize);\n+                        } else {\n+                            outAppBuf = nioOutAppBuf;\n+                        }\n+\n                         try {\n-                            result = engine.unwrap(nioInNetBuf, nioOutAppBuf);\n+                            result = engine.unwrap(nioInNetBuf, outAppBuf);\n                             switch (result.getStatus()) {\n                                 case CLOSED:\n                                     \/\/ notify about the CLOSED state of the SSLEngine. See #137\n@@ -1283,21 +1293,21 @@ private ChannelBuffer unwrap(\n \n                             break;\n                         } finally {\n-                            nioOutAppBuf.flip();\n+                            outAppBuf.flip();\n \n                             \/\/ Sync the offset of the inbound buffer.\n                             nettyInNetBuf.readerIndex(\n                                     nettyInNetBufStartOffset + nioInNetBuf.position() - nioInNetBufStartOffset);\n \n                             \/\/ Copy the unwrapped data into a smaller buffer.\n-                            if (nioOutAppBuf.hasRemaining()) {\n+                            if (outAppBuf.hasRemaining()) {\n                                 if (nettyOutAppBuf == null) {\n                                     ChannelBufferFactory factory = ctx.getChannel().getConfig().getBufferFactory();\n                                     nettyOutAppBuf = factory.getBuffer(initialNettyOutAppBufCapacity);\n                                 }\n-                                nettyOutAppBuf.writeBytes(nioOutAppBuf);\n+                                nettyOutAppBuf.writeBytes(outAppBuf);\n                             }\n-                            nioOutAppBuf.clear();\n+                            outAppBuf.clear();\n                         }\n                     }"
        },
        {
            "index":38,
            "vuln_id":"GHSA-q4qf-3fc6-8x34",
            "cwe_id":"{'CWE-787', 'CWE-119'}",
            "score":8.7,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/2d88f470dea2671b430884260f3626b1fe99830a'}",
            "dataset":"osv",
            "summary":"Segfault and data corruption in tensorflow-lite ### Impact\nTo mimic Python's indexing with negative values, TFLite uses `ResolveAxis` to convert negative values to positive indices. However, the only check that the converted index is now valid is only present in debug builds:\nhttps:\/\/github.com\/tensorflow\/tensorflow\/blob\/0e68f4d3295eb0281a517c3662f6698992b7b2cf\/tensorflow\/lite\/kernels\/internal\/reference\/reduce.h#L68-L72\n\nIf the `DCHECK` does not trigger, then code execution moves ahead with a negative index. This, in turn, results in accessing data out of bounds which results in segfaults and\/or data corruption.\n### Patches\nWe have patched the issue in 2d88f470dea2671b430884260f3626b1fe99830a and will release patch releases for all versions between 1.15 and 2.3.\n\nWe recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2020-09-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/2d88f470dea2671b430884260f3626b1fe99830a",
            "commit_sha":"2d88f470dea2671b430884260f3626b1fe99830a",
            "patch":"SINGLE",
            "chain_ord":"['2d88f470dea2671b430884260f3626b1fe99830a']",
            "before_first_fix_commit":"{'d487b8c4ca7d77d650fb8dca94b073aad8ff4b5e'}",
            "last_fix_commit":"2d88f470dea2671b430884260f3626b1fe99830a",
            "chain_ord_pos":1.0,
            "commit_datetime":"09\/18\/2020, 21:43:00",
            "message":"[tflite] Ensure `ResolveAxis` properly handles negative inputs.\n\nIn Python, a list `l` of length `n` allows indexing with negative indices, `l[i]`. The only constraint is that `n + i` becomes positive. Code in `ResolveAxis` assumes the constraints and only checks it using a `DCHECK`. But the macro is a no-op in non-debug builds and that can result in reading from negative offsets (buffer underflows).\n\nPiperOrigin-RevId: 332530683\nChange-Id: I464e073fee618054ae3719a3679739007bb3f3bc",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
            "files":"{'tensorflow\/lite\/kernels\/internal\/reference\/reduce.h': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/2d88f470dea2671b430884260f3626b1fe99830a\/tensorflow%2Flite%2Fkernels%2Finternal%2Freference%2Freduce.h', 'patch': '@@ -70,6 +70,9 @@ inline bool ResolveAxis(const int num_dims, const int* axis,\\n     \/\/ eg: For num_dims=3, [0, 1, 2] is the same as [-3, -2, -1]  *\/\\n     int current = axis[idx] < 0 ? (axis[idx] + num_dims) : axis[idx];\\n     TFLITE_DCHECK(current >= 0 && current < num_dims);\\n+    if (current < 0 || current >= num_dims) {\\n+      return false;\\n+    }\\n     bool is_dup = false;\\n     for (int j = 0; j < *out_num_axis; ++j) {\\n       if (out_axis[j] == current) {'}}",
            "message_norm":"[tflite] ensure `resolveaxis` properly handles negative inputs.\n\nin python, a list `l` of length `n` allows indexing with negative indices, `l[i]`. the only constraint is that `n + i` becomes positive. code in `resolveaxis` assumes the constraints and only checks it using a `dcheck`. but the macro is a no-op in non-debug builds and that can result in reading from negative offsets (buffer underflows).\n\npiperorigin-revid: 332530683\nchange-id: i464e073fee618054ae3719a3679739007bb3f3bc",
            "language":"en",
            "entities":"[('ensure', 'ACTION', ''), ('buffer underflows', 'SECWORD', ''), ('332530683', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/kernels\/internal\/reference\/reduce.h'])",
            "num_files":1.0,
            "patch_content":"From 2d88f470dea2671b430884260f3626b1fe99830a Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Fri, 18 Sep 2020 14:43:00 -0700\nSubject: [PATCH] [tflite] Ensure `ResolveAxis` properly handles negative\n inputs.\n\nIn Python, a list `l` of length `n` allows indexing with negative indices, `l[i]`. The only constraint is that `n + i` becomes positive. Code in `ResolveAxis` assumes the constraints and only checks it using a `DCHECK`. But the macro is a no-op in non-debug builds and that can result in reading from negative offsets (buffer underflows).\n\nPiperOrigin-RevId: 332530683\nChange-Id: I464e073fee618054ae3719a3679739007bb3f3bc\n---\n tensorflow\/lite\/kernels\/internal\/reference\/reduce.h | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/tensorflow\/lite\/kernels\/internal\/reference\/reduce.h b\/tensorflow\/lite\/kernels\/internal\/reference\/reduce.h\nindex 7953b4347c6c20..994baa0b254b3b 100644\n--- a\/tensorflow\/lite\/kernels\/internal\/reference\/reduce.h\n+++ b\/tensorflow\/lite\/kernels\/internal\/reference\/reduce.h\n@@ -70,6 +70,9 @@ inline bool ResolveAxis(const int num_dims, const int* axis,\n     \/\/ eg: For num_dims=3, [0, 1, 2] is the same as [-3, -2, -1]  *\/\n     int current = axis[idx] < 0 ? (axis[idx] + num_dims) : axis[idx];\n     TFLITE_DCHECK(current >= 0 && current < num_dims);\n+    if (current < 0 || current >= num_dims) {\n+      return false;\n+    }\n     bool is_dup = false;\n     for (int j = 0; j < *out_num_axis; ++j) {\n       if (out_axis[j] == current) {"
        },
        {
            "index":578,
            "vuln_id":"GHSA-x6rc-54xp-ccxx",
            "cwe_id":"{'CWE-611'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/apache\/activemq-artemis\/commit\/48d9951d879e0c8cbb59d4b64ab59d53ef88310d'}",
            "dataset":"osv",
            "summary":"Improper Restriction of XML External Entity Reference in Apache ActiveMQ XML external entity (XXE) vulnerability in the XPath selector component in Artemis ActiveMQ before commit 48d9951d879e0c8cbb59d4b64ab59d53ef88310d allows remote attackers to have unspecified impact via unknown vectors.",
            "published_date":"2022-05-14",
            "chain_len":1,
            "project":"https:\/\/github.com\/apache\/activemq-artemis",
            "commit_href":"https:\/\/github.com\/apache\/activemq-artemis\/commit\/48d9951d879e0c8cbb59d4b64ab59d53ef88310d",
            "commit_sha":"48d9951d879e0c8cbb59d4b64ab59d53ef88310d",
            "patch":"SINGLE",
            "chain_ord":"['48d9951d879e0c8cbb59d4b64ab59d53ef88310d']",
            "before_first_fix_commit":"{'879f4a6bb3b15dfc3d00bcde2d982194bd2dadc4'}",
            "last_fix_commit":"48d9951d879e0c8cbb59d4b64ab59d53ef88310d",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/21\/2015, 09:49:45",
            "message":"ActiveMQ6-112 Add defaults to the selector parser doc builder",
            "author":"Martyn Taylor",
            "comments":null,
            "stats":"{'additions': 14, 'deletions': 4, 'total': 18}",
            "files":"{'artemis-selector\/src\/main\/java\/org\/apache\/activemq\/artemis\/selector\/filter\/XalanXPathEvaluator.java': {'additions': 14, 'deletions': 4, 'changes': 18, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/activemq-artemis\/raw\/48d9951d879e0c8cbb59d4b64ab59d53ef88310d\/artemis-selector%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fartemis%2Fselector%2Ffilter%2FXalanXPathEvaluator.java', 'patch': '@@ -18,6 +18,7 @@\\n \\n import javax.xml.parsers.DocumentBuilder;\\n import javax.xml.parsers.DocumentBuilderFactory;\\n+import javax.xml.parsers.ParserConfigurationException;\\n import java.io.StringReader;\\n \\n import org.apache.xpath.CachedXPathAPI;\\n@@ -56,9 +57,7 @@ protected boolean evaluate(InputSource inputSource)\\n    {\\n       try\\n       {\\n-         DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n-         factory.setNamespaceAware(true);\\n-         DocumentBuilder dbuilder = factory.newDocumentBuilder();\\n+         DocumentBuilder dbuilder = createDocumentBuilder();\\n          Document doc = dbuilder.parse(inputSource);\\n \\n          \/\/An XPath expression could return a true or false value instead of a node.\\n@@ -75,11 +74,22 @@ protected boolean evaluate(InputSource inputSource)\\n             NodeIterator iterator = cachedXPathAPI.selectNodeIterator(doc, xpath);\\n             return (iterator.nextNode() != null);\\n          }\\n-\\n       }\\n       catch (Throwable e)\\n       {\\n          return false;\\n       }\\n    }\\n+\\n+   private DocumentBuilder createDocumentBuilder() throws ParserConfigurationException\\n+   {\\n+      DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n+      factory.setNamespaceAware(true);\\n+\\n+      factory.setFeature(\"http:\/\/xml.org\/sax\/features\/external-general-entities\", false);\\n+      factory.setFeature(\"http:\/\/xml.org\/sax\/features\/external-parameter-entities\", false);\\n+      factory.setFeature(\"http:\/\/apache.org\/xml\/features\/disallow-doctype-decl\", true);\\n+\\n+      return factory.newDocumentBuilder();\\n+   }\\n }'}}",
            "message_norm":"activemq6-112 add defaults to the selector parser doc builder",
            "language":"en",
            "entities":"[('add', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['artemis-selector\/src\/main\/java\/org\/apache\/activemq\/artemis\/selector\/filter\/XalanXPathEvaluator.java'])",
            "num_files":1.0,
            "patch_content":"From 48d9951d879e0c8cbb59d4b64ab59d53ef88310d Mon Sep 17 00:00:00 2001\nFrom: Martyn Taylor <mtaylor@redhat.com>\nDate: Thu, 21 May 2015 10:49:45 +0100\nSubject: [PATCH] ActiveMQ6-112 Add defaults to the selector parser doc builder\n\n---\n ...\/selector\/filter\/XalanXPathEvaluator.java   | 18 ++++++++++++++----\n 1 file changed, 14 insertions(+), 4 deletions(-)\n\ndiff --git a\/artemis-selector\/src\/main\/java\/org\/apache\/activemq\/artemis\/selector\/filter\/XalanXPathEvaluator.java b\/artemis-selector\/src\/main\/java\/org\/apache\/activemq\/artemis\/selector\/filter\/XalanXPathEvaluator.java\nindex 315773e5e8a..007f5ff13ab 100644\n--- a\/artemis-selector\/src\/main\/java\/org\/apache\/activemq\/artemis\/selector\/filter\/XalanXPathEvaluator.java\n+++ b\/artemis-selector\/src\/main\/java\/org\/apache\/activemq\/artemis\/selector\/filter\/XalanXPathEvaluator.java\n@@ -18,6 +18,7 @@\n \n import javax.xml.parsers.DocumentBuilder;\n import javax.xml.parsers.DocumentBuilderFactory;\n+import javax.xml.parsers.ParserConfigurationException;\n import java.io.StringReader;\n \n import org.apache.xpath.CachedXPathAPI;\n@@ -56,9 +57,7 @@ protected boolean evaluate(InputSource inputSource)\n    {\n       try\n       {\n-         DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n-         factory.setNamespaceAware(true);\n-         DocumentBuilder dbuilder = factory.newDocumentBuilder();\n+         DocumentBuilder dbuilder = createDocumentBuilder();\n          Document doc = dbuilder.parse(inputSource);\n \n          \/\/An XPath expression could return a true or false value instead of a node.\n@@ -75,11 +74,22 @@ protected boolean evaluate(InputSource inputSource)\n             NodeIterator iterator = cachedXPathAPI.selectNodeIterator(doc, xpath);\n             return (iterator.nextNode() != null);\n          }\n-\n       }\n       catch (Throwable e)\n       {\n          return false;\n       }\n    }\n+\n+   private DocumentBuilder createDocumentBuilder() throws ParserConfigurationException\n+   {\n+      DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\n+      factory.setNamespaceAware(true);\n+\n+      factory.setFeature(\"http:\/\/xml.org\/sax\/features\/external-general-entities\", false);\n+      factory.setFeature(\"http:\/\/xml.org\/sax\/features\/external-parameter-entities\", false);\n+      factory.setFeature(\"http:\/\/apache.org\/xml\/features\/disallow-doctype-decl\", true);\n+\n+      return factory.newDocumentBuilder();\n+   }\n }"
        },
        {
            "index":210,
            "vuln_id":"GHSA-pc22-3g76-gm6j",
            "cwe_id":"{'CWE-379', 'CWE-378'}",
            "score":9.3,
            "chain":"{'https:\/\/github.com\/swagger-api\/swagger-codegen\/commit\/987ea7a30b463cc239580d6ad166c707ae942a89'}",
            "dataset":"osv",
            "summary":"Generator Web Application: Local Privilege Escalation Vulnerability via System Temp Directory ### Impact\n\nOn Unix like systems, the system's temporary directory is shared between all users on that system. A collocated user can observe the process of creating a temporary sub directory in the shared temporary directory and race to complete the creation of the temporary subdirectory. \n\nThis vulnerability is local privilege escalation because the contents of the `outputFolder` can be appended to by an attacker. As such, code written to this directory, when executed can be attacker controlled.\n\n#### Java Code\n\nThe method `File.createTempFile` from the JDK is vulnerable to this local information disclosure vulnerability.\n\nhttps:\/\/github.com\/swagger-api\/swagger-codegen\/blob\/068b1ebcb7b04a48ad38f1cadd24bb3810c9f1ab\/modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java#L174-L185\n\n\n### Patches\n\nFix has been applied to the master branch with:\n\n* https:\/\/github.com\/swagger-api\/swagger-codegen\/commit\/987ea7a30b463cc239580d6ad166c707ae942a89\n\nincluded in release: 2.4.19\n\n\n### References\n\n* [CWE-378: Creation of Temporary File With Insecure Permissions](https:\/\/cwe.mitre.org\/data\/definitions\/378.html)\n* [CWE-379: Creation of Temporary File in Directory with Insecure Permissions](https:\/\/cwe.mitre.org\/data\/definitions\/379.html)\n\n### For more information\nIf you have any questions or comments about this advisory:\n\n* Email us at [security@swagger.io](mailto:security@swagger.io)\n\n#### Original vulnerability report\n\n> I'm performing OSS security research under the GitHub Security Lab Bug Bounty program.\n> I've been using a custom CodeQL query to find local temporary directory vulnerabilities in OSS with three custom CodeQL queries.\n> \n> - https:\/\/github.com\/github\/codeql\/pull\/4388\/files#diff-71d36c0f2bd0b08e32866f873f1c906cdc17277e0ad327c0c6cd2c882f30de4f\n> - https:\/\/github.com\/github\/codeql\/pull\/4388\/files#diff-1893a18a8bf43c011d61a7889d0139b998a5a78701a30fe7722eddd4c506aaac\n> - https:\/\/github.com\/github\/codeql\/pull\/4473\n> \n> The code generated by the Swagger Generator contains a local information disclosure vulnerability. The system temporary directory, on unix-like systems is shared between multiple users. Information written to this directory, or directories created under this directory that do not correctly set the posix standard permissions can have these directories read\/modified by other users.\n> \n> ---\n> \n> This vulnerability exists in the maven plugin.\n> \n> This vulnerability is distinctly different. This vulnerability is most likely a local privilege escalation vulnerability.\n> \n> https:\/\/github.com\/swagger-api\/swagger-codegen\/blob\/068b1ebcb7b04a48ad38f1cadd24bb3810c9f1ab\/modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java#L174-L185\n> \n> This vulnerability is very similar to this similar vulnerability I disclosed in the Eclipse Jetty project.\n> \n> https:\/\/github.com\/eclipse\/jetty.project\/security\/advisories\/GHSA-g3wg-6mcf-8jj6\n> \n> This is due to a race condition between the call to `delete` and the call to `mkdirs`.\n> \n> ```java\n> \/\/ ensure file will always be unique by appending random digits\n> File outputFolder = File.createTempFile(\"codegen-\", \"-tmp\"); \/\/ Attacker knows the full path of the file that will be generated\n> \/\/ delete the file that was created\n> outputFolder.delete(); \/\/ Attacker sees file is deleted and begins a race to create their own directory before Swagger Code Generator.\n> \/\/ and make a directory of the same name\n> \/\/ SECURITY VULNERABILITY: Race Condition! - Attacker beats Swagger Code Generator and now owns this directory\n> outputFolder.mkdirs();\n> ```\n> \n> This vulnerability is local privilege escalation because the contents of the `outputFolder` can be appended to by an attacker. As such, code written to this directory, when executed can be attacker controlled.\n> \n> The fix here is to switch to the `Files` API for creating temporary directories. Which does not contain this race condition, and appropriately sets the correct file permissions.\n>",
            "published_date":"2021-03-11",
            "chain_len":1,
            "project":"https:\/\/github.com\/swagger-api\/swagger-codegen",
            "commit_href":"https:\/\/github.com\/swagger-api\/swagger-codegen\/commit\/987ea7a30b463cc239580d6ad166c707ae942a89",
            "commit_sha":"987ea7a30b463cc239580d6ad166c707ae942a89",
            "patch":"SINGLE",
            "chain_ord":"['987ea7a30b463cc239580d6ad166c707ae942a89']",
            "before_first_fix_commit":"{'3b40539b2260fbf1c8198dceb8797599c3944ef7', 'a4b766beb6141ed66dbe1be23bce32366b5f9486'}",
            "last_fix_commit":"987ea7a30b463cc239580d6ad166c707ae942a89",
            "chain_ord_pos":1.0,
            "commit_datetime":"03\/02\/2021, 10:05:49",
            "message":"Merge pull request from GHSA-pc22-3g76-gm6j\n\n security: use java.nio.files in Generator.",
            "author":"Francesco Tumanischvili",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 3, 'total': 5}",
            "files":"{'modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java': {'additions': 2, 'deletions': 3, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/swagger-api\/swagger-codegen\/raw\/987ea7a30b463cc239580d6ad166c707ae942a89\/modules%2Fswagger-generator%2Fsrc%2Fmain%2Fjava%2Fio%2Fswagger%2Fgenerator%2Fonline%2FGenerator.java', 'patch': '@@ -15,6 +15,7 @@\\n import org.slf4j.LoggerFactory;\\n \\n import java.io.File;\\n+import java.nio.file.Files;\\n import java.util.ArrayList;\\n import java.util.LinkedHashMap;\\n import java.util.List;\\n@@ -173,9 +174,7 @@ public static InputOption serverOptions(@SuppressWarnings(\"unused\") String langu\\n \\n     protected static File getTmpFolder() {\\n         try {\\n-            File outputFolder = File.createTempFile(\"codegen-\", \"-tmp\");\\n-            outputFolder.delete();\\n-            outputFolder.mkdir();\\n+            File outputFolder = Files.createTempDirectory(\"codegen-\").toFile();\\n             outputFolder.deleteOnExit();\\n             return outputFolder;\\n         } catch (Exception e) {'}}",
            "message_norm":"merge pull request from ghsa-pc22-3g76-gm6j\n\n security: use java.nio.files in generator.",
            "language":"en",
            "entities":"[('ghsa-pc22-3g76-gm6j', 'VULNID', 'GHSA'), ('security', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java'])",
            "num_files":1.0,
            "patch_content":"From 3b40539b2260fbf1c8198dceb8797599c3944ef7 Mon Sep 17 00:00:00 2001\nFrom: frantuma <frantuma@yahoo.com>\nDate: Tue, 23 Feb 2021 23:08:06 +0100\nSubject: [PATCH]  security: use java.nio.files in Generator.\n\n---\n ...\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java | 5 ++---\n 1 file changed, 2 insertions(+), 3 deletions(-)\n\ndiff --git a\/modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java b\/modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java\nindex 2435a3170ca..2ed426d43ee 100644\n--- a\/modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java\n+++ b\/modules\/swagger-generator\/src\/main\/java\/io\/swagger\/generator\/online\/Generator.java\n@@ -15,6 +15,7 @@\n import org.slf4j.LoggerFactory;\n \n import java.io.File;\n+import java.nio.file.Files;\n import java.util.ArrayList;\n import java.util.LinkedHashMap;\n import java.util.List;\n@@ -173,9 +174,7 @@ public static InputOption serverOptions(@SuppressWarnings(\"unused\") String langu\n \n     protected static File getTmpFolder() {\n         try {\n-            File outputFolder = File.createTempFile(\"codegen-\", \"-tmp\");\n-            outputFolder.delete();\n-            outputFolder.mkdir();\n+            File outputFolder = Files.createTempDirectory(\"codegen-\").toFile();\n             outputFolder.deleteOnExit();\n             return outputFolder;\n         } catch (Exception e) {"
        },
        {
            "index":45,
            "vuln_id":"GHSA-3f8r-4qwm-r7jf",
            "cwe_id":"{'CWE-287'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/apache\/trafficcontrol\/commit\/f780aff77a52d52a37b4d1cc3e8e801c0b557356'}",
            "dataset":"osv",
            "summary":"Improper Authentication in Apache Traffic Control Improper authentication is possible in Apache Traffic Control versions 3.0.0 and 3.0.1 if LDAP is enabled for login in the Traffic Ops API component. Given a username for a user that can be authenticated via LDAP, it is possible to improperly authenticate as that user without that user's correct password.",
            "published_date":"2021-05-18",
            "chain_len":1,
            "project":"https:\/\/github.com\/apache\/trafficcontrol",
            "commit_href":"https:\/\/github.com\/apache\/trafficcontrol\/commit\/f780aff77a52d52a37b4d1cc3e8e801c0b557356",
            "commit_sha":"f780aff77a52d52a37b4d1cc3e8e801c0b557356",
            "patch":"SINGLE",
            "chain_ord":"['f780aff77a52d52a37b4d1cc3e8e801c0b557356']",
            "before_first_fix_commit":"{'85596a08bb12835370895ba20455e5ce998278d1'}",
            "last_fix_commit":"f780aff77a52d52a37b4d1cc3e8e801c0b557356",
            "chain_ord_pos":1.0,
            "commit_datetime":"08\/30\/2019, 20:40:48",
            "message":"Improve ldap error handling",
            "author":"Rawlin Peters",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'traffic_ops\/traffic_ops_golang\/login\/login.go': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/trafficcontrol\/raw\/f780aff77a52d52a37b4d1cc3e8e801c0b557356\/traffic_ops%2Ftraffic_ops_golang%2Flogin%2Flogin.go', 'patch': '@@ -51,6 +51,10 @@ func LoginHandler(db *sqlx.DB, cfg config.Config) http.HandlerFunc {\\n \\t\\t\\thandleErrs(http.StatusBadRequest, err)\\n \\t\\t\\treturn\\n \\t\\t}\\n+\\t\\tif form.Username == \"\" || form.Password == \"\" {\\n+\\t\\t\\tapi.HandleErr(w, r, nil, http.StatusBadRequest, errors.New(\"username and password are required\"), nil)\\n+\\t\\t\\treturn\\n+\\t\\t}\\n \\t\\tresp := struct {\\n \\t\\t\\ttc.Alerts\\n \\t\\t}{}'}}",
            "message_norm":"improve ldap error handling",
            "language":"da",
            "entities":"[('improve', 'ACTION', ''), ('ldap', 'SECWORD', ''), ('error handling', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['traffic_ops\/traffic_ops_golang\/login\/login.go'])",
            "num_files":1.0,
            "patch_content":"From f780aff77a52d52a37b4d1cc3e8e801c0b557356 Mon Sep 17 00:00:00 2001\nFrom: Rawlin Peters <rawlin_peters@comcast.com>\nDate: Fri, 30 Aug 2019 14:40:48 -0600\nSubject: [PATCH] Improve ldap error handling\n\n---\n traffic_ops\/traffic_ops_golang\/login\/login.go | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/traffic_ops\/traffic_ops_golang\/login\/login.go b\/traffic_ops\/traffic_ops_golang\/login\/login.go\nindex 07575f70c5..b873ef109b 100644\n--- a\/traffic_ops\/traffic_ops_golang\/login\/login.go\n+++ b\/traffic_ops\/traffic_ops_golang\/login\/login.go\n@@ -51,6 +51,10 @@ func LoginHandler(db *sqlx.DB, cfg config.Config) http.HandlerFunc {\n \t\t\thandleErrs(http.StatusBadRequest, err)\n \t\t\treturn\n \t\t}\n+\t\tif form.Username == \"\" || form.Password == \"\" {\n+\t\t\tapi.HandleErr(w, r, nil, http.StatusBadRequest, errors.New(\"username and password are required\"), nil)\n+\t\t\treturn\n+\t\t}\n \t\tresp := struct {\n \t\t\ttc.Alerts\n \t\t}{}"
        },
        {
            "index":731,
            "vuln_id":"GHSA-9hr3-j9mc-xmq2",
            "cwe_id":"{'CWE-29', 'CWE-22'}",
            "score":6.9,
            "chain":"{'https:\/\/github.com\/alibaba\/one-java-agent\/pull\/29\/commits\/359603b63fc6c59d8b57e061c171954bab3433bf', 'https:\/\/github.com\/alibaba\/one-java-agent\/pull\/29\/commits\/b5b437f9f4c8cbfe7bdbe266e975a4bd513c13fe'}",
            "dataset":"osv",
            "summary":"Path Traversal in com.alibaba.oneagent:one-java-agent-plugin All versions of package `com.alibaba.oneagent:one-java-agent-plugin` are vulnerable to Arbitrary File Write via Archive Extraction (Zip Slip) using a specially crafted archive that holds directory traversal filenames (e.g. `..\/..\/evil.exe`). The attacker can overwrite executable files and either invoke them remotely or wait for the system or user to call them, thus achieving remote command execution on the victim\u2019s machine.",
            "published_date":"2022-05-03",
            "chain_len":2,
            "project":"https:\/\/github.com\/alibaba\/one-java-agent",
            "commit_href":"https:\/\/github.com\/alibaba\/one-java-agent\/pull\/29\/commits\/359603b63fc6c59d8b57e061c171954bab3433bf",
            "commit_sha":"359603b63fc6c59d8b57e061c171954bab3433bf",
            "patch":"MULTI",
            "chain_ord":"['359603b63fc6c59d8b57e061c171954bab3433bf', 'b5b437f9f4c8cbfe7bdbe266e975a4bd513c13fe']",
            "before_first_fix_commit":"{'52f2506c7cbcfbbe342ddf9d35a915fc49e6fa48'}",
            "last_fix_commit":"b5b437f9f4c8cbfe7bdbe266e975a4bd513c13fe",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/07\/2022, 02:28:31",
            "message":"remove unused IOUtils.unzip",
            "author":"luyanbo",
            "comments":null,
            "stats":"{'additions': 0, 'deletions': 56, 'total': 56}",
            "files":"{'one-java-agent-plugin\/src\/main\/java\/com\/alibaba\/oneagent\/utils\/IOUtils.java': {'additions': 0, 'deletions': 56, 'changes': 56, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/alibaba\/one-java-agent\/raw\/359603b63fc6c59d8b57e061c171954bab3433bf\/one-java-agent-plugin%2Fsrc%2Fmain%2Fjava%2Fcom%2Falibaba%2Foneagent%2Futils%2FIOUtils.java', 'patch': '@@ -103,60 +103,4 @@ public static IOException close(URLClassLoader urlClassLoader) {\\n \\t\\treturn null;\\n \\t}\\n \\n-\\tpublic static void unzip(String zipFile, String extractFolder) throws IOException {\\n-\\t\\tFile file = new File(zipFile);\\n-\\t\\tZipFile zip = null;\\n-\\t\\ttry {\\n-\\t\\t\\tint BUFFER = 1024 * 8;\\n-\\n-\\t\\t\\tzip = new ZipFile(file);\\n-\\t\\t\\tString newPath = extractFolder;\\n-\\n-\\t\\t\\tnew File(newPath).mkdir();\\n-\\t\\t\\tEnumeration<? extends ZipEntry> zipFileEntries = zip.entries();\\n-\\n-\\t\\t\\t\/\/ Process each entry\\n-\\t\\t\\twhile (zipFileEntries.hasMoreElements()) {\\n-\\t\\t\\t\\t\/\/ grab a zip file entry\\n-\\t\\t\\t\\tZipEntry entry = (ZipEntry) zipFileEntries.nextElement();\\n-\\t\\t\\t\\tString currentEntry = entry.getName();\\n-\\n-\\t\\t\\t\\tFile destFile = new File(newPath, currentEntry);\\n-\\t\\t\\t\\t\/\/ destFile = new File(newPath, destFile.getName());\\n-\\t\\t\\t\\tFile destinationParent = destFile.getParentFile();\\n-\\n-\\t\\t\\t\\t\/\/ create the parent directory structure if needed\\n-\\t\\t\\t\\tdestinationParent.mkdirs();\\n-\\n-\\t\\t\\t\\tif (!entry.isDirectory()) {\\n-\\t\\t\\t\\t\\tBufferedInputStream is = null;\\n-\\t\\t\\t\\t\\tBufferedOutputStream dest = null;\\n-\\t\\t\\t\\t\\ttry {\\n-\\t\\t\\t\\t\\t\\tis = new BufferedInputStream(zip.getInputStream(entry));\\n-\\t\\t\\t\\t\\t\\tint currentByte;\\n-\\t\\t\\t\\t\\t\\t\/\/ establish buffer for writing file\\n-\\t\\t\\t\\t\\t\\tbyte data[] = new byte[BUFFER];\\n-\\n-\\t\\t\\t\\t\\t\\t\/\/ write the current file to disk\\n-\\t\\t\\t\\t\\t\\tFileOutputStream fos = new FileOutputStream(destFile);\\n-\\t\\t\\t\\t\\t\\tdest = new BufferedOutputStream(fos, BUFFER);\\n-\\n-\\t\\t\\t\\t\\t\\t\/\/ read and write until last byte is encountered\\n-\\t\\t\\t\\t\\t\\twhile ((currentByte = is.read(data, 0, BUFFER)) != -1) {\\n-\\t\\t\\t\\t\\t\\t\\tdest.write(data, 0, currentByte);\\n-\\t\\t\\t\\t\\t\\t}\\n-\\t\\t\\t\\t\\t\\tdest.flush();\\n-\\t\\t\\t\\t\\t} finally {\\n-\\t\\t\\t\\t\\t\\tclose(dest);\\n-\\t\\t\\t\\t\\t\\tclose(is);\\n-\\t\\t\\t\\t\\t}\\n-\\n-\\t\\t\\t\\t}\\n-\\n-\\t\\t\\t}\\n-\\t\\t} finally {\\n-\\t\\t\\tclose(zip);\\n-\\t\\t}\\n-\\n-\\t}\\n }'}}",
            "message_norm":"remove unused ioutils.unzip",
            "language":"en",
            "entities":"[('remove', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['one-java-agent-plugin\/src\/main\/java\/com\/alibaba\/oneagent\/utils\/IOUtils.java'])",
            "num_files":1.0,
            "patch_content":"From 359603b63fc6c59d8b57e061c171954bab3433bf Mon Sep 17 00:00:00 2001\nFrom: luyanbo <robert.lyb@alibaba-inc.com>\nDate: Thu, 7 Apr 2022 10:28:31 +0800\nSubject: [PATCH] remove unused IOUtils.unzip\n\n---\n ...\/com\/alibaba\/oneagent\/utils\/IOUtils.java   | 56 -------------------\n 1 file changed, 56 deletions(-)\n\ndiff --git a\/one-java-agent-plugin\/src\/main\/java\/com\/alibaba\/oneagent\/utils\/IOUtils.java b\/one-java-agent-plugin\/src\/main\/java\/com\/alibaba\/oneagent\/utils\/IOUtils.java\nindex fb42dc1..eaf2f97 100644\n--- a\/one-java-agent-plugin\/src\/main\/java\/com\/alibaba\/oneagent\/utils\/IOUtils.java\n+++ b\/one-java-agent-plugin\/src\/main\/java\/com\/alibaba\/oneagent\/utils\/IOUtils.java\n@@ -103,60 +103,4 @@ public static IOException close(URLClassLoader urlClassLoader) {\n \t\treturn null;\n \t}\n \n-\tpublic static void unzip(String zipFile, String extractFolder) throws IOException {\n-\t\tFile file = new File(zipFile);\n-\t\tZipFile zip = null;\n-\t\ttry {\n-\t\t\tint BUFFER = 1024 * 8;\n-\n-\t\t\tzip = new ZipFile(file);\n-\t\t\tString newPath = extractFolder;\n-\n-\t\t\tnew File(newPath).mkdir();\n-\t\t\tEnumeration<? extends ZipEntry> zipFileEntries = zip.entries();\n-\n-\t\t\t\/\/ Process each entry\n-\t\t\twhile (zipFileEntries.hasMoreElements()) {\n-\t\t\t\t\/\/ grab a zip file entry\n-\t\t\t\tZipEntry entry = (ZipEntry) zipFileEntries.nextElement();\n-\t\t\t\tString currentEntry = entry.getName();\n-\n-\t\t\t\tFile destFile = new File(newPath, currentEntry);\n-\t\t\t\t\/\/ destFile = new File(newPath, destFile.getName());\n-\t\t\t\tFile destinationParent = destFile.getParentFile();\n-\n-\t\t\t\t\/\/ create the parent directory structure if needed\n-\t\t\t\tdestinationParent.mkdirs();\n-\n-\t\t\t\tif (!entry.isDirectory()) {\n-\t\t\t\t\tBufferedInputStream is = null;\n-\t\t\t\t\tBufferedOutputStream dest = null;\n-\t\t\t\t\ttry {\n-\t\t\t\t\t\tis = new BufferedInputStream(zip.getInputStream(entry));\n-\t\t\t\t\t\tint currentByte;\n-\t\t\t\t\t\t\/\/ establish buffer for writing file\n-\t\t\t\t\t\tbyte data[] = new byte[BUFFER];\n-\n-\t\t\t\t\t\t\/\/ write the current file to disk\n-\t\t\t\t\t\tFileOutputStream fos = new FileOutputStream(destFile);\n-\t\t\t\t\t\tdest = new BufferedOutputStream(fos, BUFFER);\n-\n-\t\t\t\t\t\t\/\/ read and write until last byte is encountered\n-\t\t\t\t\t\twhile ((currentByte = is.read(data, 0, BUFFER)) != -1) {\n-\t\t\t\t\t\t\tdest.write(data, 0, currentByte);\n-\t\t\t\t\t\t}\n-\t\t\t\t\t\tdest.flush();\n-\t\t\t\t\t} finally {\n-\t\t\t\t\t\tclose(dest);\n-\t\t\t\t\t\tclose(is);\n-\t\t\t\t\t}\n-\n-\t\t\t\t}\n-\n-\t\t\t}\n-\t\t} finally {\n-\t\t\tclose(zip);\n-\t\t}\n-\n-\t}\n }"
        },
        {
            "index":261,
            "vuln_id":"GHSA-3h8m-483j-7xxm",
            "cwe_id":"{'CWE-125'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/ef0c008ee84bad91ec6725ddc42091e19a30cf0e'}",
            "dataset":"osv",
            "summary":"Heap out of bounds read in `RequantizationRange` ### Impact\nThe implementation of `tf.raw_ops.MaxPoolGradWithArgmax` can cause reads outside of bounds of heap allocated data if attacker supplies specially crafted inputs:\n\n```python\nimport tensorflow as tf\n\ninput = tf.constant([1], shape=[1], dtype=tf.qint32) \ninput_max = tf.constant([], dtype=tf.float32)\ninput_min = tf.constant([], dtype=tf.float32)\n\ntf.raw_ops.RequantizationRange(input=input, input_min=input_min, input_max=input_max)\n```\n\nThe [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/ac328eaa3870491ababc147822cd04e91a790643\/tensorflow\/core\/kernels\/requantization_range_op.cc#L49-L50) assumes that the `input_min` and `input_max` tensors have at least one element, as it accesses the first element in two arrays:\n\n```cc\nconst float input_min_float = ctx->input(1).flat<float>()(0);\nconst float input_max_float = ctx->input(2).flat<float>()(0);\n```\n\nIf the tensors are empty, `.flat<T>()` is an empty object, backed by an empty array. Hence, accesing even the 0th element is a read outside the bounds.\n\n### Patches\nWe have patched the issue in GitHub commit [ef0c008ee84bad91ec6725ddc42091e19a30cf0e](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/ef0c008ee84bad91ec6725ddc42091e19a30cf0e).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Ying Wang and Yakun Zhang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/ef0c008ee84bad91ec6725ddc42091e19a30cf0e",
            "commit_sha":"ef0c008ee84bad91ec6725ddc42091e19a30cf0e",
            "patch":"SINGLE",
            "chain_ord":"['ef0c008ee84bad91ec6725ddc42091e19a30cf0e']",
            "before_first_fix_commit":"{'ac328eaa3870491ababc147822cd04e91a790643'}",
            "last_fix_commit":"ef0c008ee84bad91ec6725ddc42091e19a30cf0e",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/05\/2021, 15:16:13",
            "message":"Fix out of bound read in requantization_range_op.cc\n\nPiperOrigin-RevId: 372129031\nChange-Id: Ie684ab98a3840c5186ead3eafffc0e0ed0e8030d",
            "author":"Laura Pak",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'tensorflow\/core\/kernels\/requantization_range_op.cc': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/ef0c008ee84bad91ec6725ddc42091e19a30cf0e\/tensorflow%2Fcore%2Fkernels%2Frequantization_range_op.cc', 'patch': '@@ -46,6 +46,10 @@ class RequantizationRangeOp : public OpKernel {\\n \\n   void Compute(OpKernelContext* ctx) override {\\n     const Tensor& input = ctx->input(0);\\n+    OP_REQUIRES(ctx, ctx->input(1).NumElements() > 0,\\n+                errors::InvalidArgument(\"Input min must not be empty.\"));\\n+    OP_REQUIRES(ctx, ctx->input(2).NumElements() > 0,\\n+                errors::InvalidArgument(\"Input max must not be empty.\"));\\n     const float input_min_float = ctx->input(1).flat<float>()(0);\\n     const float input_max_float = ctx->input(2).flat<float>()(0);\\n     Tensor* output_min = nullptr;'}}",
            "message_norm":"fix out of bound read in requantization_range_op.cc\n\npiperorigin-revid: 372129031\nchange-id: ie684ab98a3840c5186ead3eafffc0e0ed0e8030d",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('out of bound read', 'SECWORD', ''), ('372129031', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/requantization_range_op.cc'])",
            "num_files":1.0,
            "patch_content":"From ef0c008ee84bad91ec6725ddc42091e19a30cf0e Mon Sep 17 00:00:00 2001\nFrom: Laura Pak <lpak@google.com>\nDate: Wed, 5 May 2021 08:16:13 -0700\nSubject: [PATCH] Fix out of bound read in requantization_range_op.cc\n\nPiperOrigin-RevId: 372129031\nChange-Id: Ie684ab98a3840c5186ead3eafffc0e0ed0e8030d\n---\n tensorflow\/core\/kernels\/requantization_range_op.cc | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/requantization_range_op.cc b\/tensorflow\/core\/kernels\/requantization_range_op.cc\nindex cc6e891a6b352b..f6e217499d1983 100644\n--- a\/tensorflow\/core\/kernels\/requantization_range_op.cc\n+++ b\/tensorflow\/core\/kernels\/requantization_range_op.cc\n@@ -46,6 +46,10 @@ class RequantizationRangeOp : public OpKernel {\n \n   void Compute(OpKernelContext* ctx) override {\n     const Tensor& input = ctx->input(0);\n+    OP_REQUIRES(ctx, ctx->input(1).NumElements() > 0,\n+                errors::InvalidArgument(\"Input min must not be empty.\"));\n+    OP_REQUIRES(ctx, ctx->input(2).NumElements() > 0,\n+                errors::InvalidArgument(\"Input max must not be empty.\"));\n     const float input_min_float = ctx->input(1).flat<float>()(0);\n     const float input_max_float = ctx->input(2).flat<float>()(0);\n     Tensor* output_min = nullptr;"
        },
        {
            "index":897,
            "vuln_id":"GHSA-c558-5gfm-p2r8",
            "cwe_id":"{'CWE-79'}",
            "score":7.1,
            "chain":"{'https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a'}",
            "dataset":"osv",
            "summary":"JSPUI spellcheck and autocomplete tools vulnerable to Cross Site Scripting ### Impact\nThe JSPUI spellcheck \"Did you mean\" HTML escapes the data-spell attribute in the link, but not the actual displayed text.  Similarly, the JSPUI autocomplete HTML does not properly escape text passed to it. Both are vulnerable to XSS.  This vulnerability only impacts the JSPUI.\n\n_This vulnerability does NOT impact the XMLUI or 7.x._\n\n### Patches\n_DSpace 6.x:_\n* Fixed in 6.4 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7\n* 6.x patch files available (may be applied manually if an immediate upgrade to 6.4 or above is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7.patch\n\n_DSpace 5.x:_\n* Fixed in 5.11 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5\n* 5.x patch files available (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5.patch\n\n#### Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:\n1. Download the appropriate patch file to the machine where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This will copy all updated WARs \/ configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n    3. Restart Tomcat\n\n### References\nDiscovered & reported by Hassan Bhuiyan (Brunel University London)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@dspace.org",
            "published_date":"2022-08-06",
            "chain_len":4,
            "project":"https:\/\/github.com\/DSpace\/DSpace",
            "commit_href":"https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d",
            "commit_sha":"ebb83a75234d3de9be129464013e998dc929b68d",
            "patch":"MULTI",
            "chain_ord":"['ebb83a75234d3de9be129464013e998dc929b68d', '35030a23e48b5946f5853332c797e1c4adea7bb7', 'c89e493e517b424dea6175caba54e91d3847fc3a', '6f75bb084ab1937d094208c55cd84340040bcbb5']",
            "before_first_fix_commit":"{'d1dd7d23329ef055069759df15cfa200c8e32e54'}",
            "last_fix_commit":"6f75bb084ab1937d094208c55cd84340040bcbb5",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/08\/2020, 00:55:36",
            "message":"[DS-4453] Fix XSS handling in JSPUI discovery spellcheck",
            "author":"Kim Shepherd",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DSpace\/DSpace\/raw\/ebb83a75234d3de9be129464013e998dc929b68d\/dspace-jspui%2Fsrc%2Fmain%2Fwebapp%2Fsearch%2Fdiscovery.jsp', 'patch': '@@ -209,7 +209,7 @@\\n         <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\\n         <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\\n-\\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\\n+\\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\\n <% } %>                  \\n         <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\\n         <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>'}}",
            "message_norm":"[ds-4453] fix xss handling in jspui discovery spellcheck",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp'])",
            "num_files":1.0,
            "patch_content":"From ebb83a75234d3de9be129464013e998dc929b68d Mon Sep 17 00:00:00 2001\nFrom: Kim Shepherd <kim@shepherd.nz>\nDate: Wed, 8 Apr 2020 12:55:36 +1200\nSubject: [PATCH] [DS-4453] Fix XSS handling in JSPUI discovery spellcheck\n\n---\n dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\nindex 6cfafd4f3c7d..ac51dbcb1405 100644\n--- a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n+++ b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n@@ -209,7 +209,7 @@\n         <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\n         <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\n-\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\n+\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\n <% } %>                  \n         <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\n         <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>"
        },
        {
            "index":582,
            "vuln_id":"GHSA-75vw-3m5v-fprh",
            "cwe_id":"{'CWE-611'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/stanfordnlp\/corenlp\/commit\/1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd'}",
            "dataset":"osv",
            "summary":"corenlp is vulnerable to Improper Restriction of XML External Entity Reference corenlp is vulnerable to Improper Restriction of XML External Entity Reference",
            "published_date":"2022-01-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/stanfordnlp\/corenlp",
            "commit_href":"https:\/\/github.com\/stanfordnlp\/corenlp\/commit\/1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd",
            "commit_sha":"1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd",
            "patch":"SINGLE",
            "chain_ord":"['1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd']",
            "before_first_fix_commit":"{'820192ce1ad1062057cf6abcb359cd635988bf63'}",
            "last_fix_commit":"1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/16\/2022, 06:10:35",
            "message":"Fix XML schema vulnerability",
            "author":"Haxatron",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
            "files":"{'src\/edu\/stanford\/nlp\/util\/XMLUtils.java': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/stanfordnlp\/CoreNLP\/raw\/1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd\/src%2Fedu%2Fstanford%2Fnlp%2Futil%2FXMLUtils.java', 'patch': '@@ -302,6 +302,7 @@ public static DocumentBuilder getValidatingXmlParser(File schemaFile) {\\n       DocumentBuilderFactory dbf = safeDocumentBuilderFactory();\\n \\n       SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\\n+      factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\\n       Schema schema = factory.newSchema(schemaFile);\\n       dbf.setSchema(schema);'}}",
            "message_norm":"fix xml schema vulnerability",
            "language":"ro",
            "entities":"[('fix', 'ACTION', ''), ('vulnerability', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/edu\/stanford\/nlp\/util\/XMLUtils.java'])",
            "num_files":1.0,
            "patch_content":"From 1940ffb938dc4f3f5bc5f2a2fd8b35aabbbae3dd Mon Sep 17 00:00:00 2001\nFrom: Haxatron <haxatron1@gmail.com>\nDate: Sat, 15 Jan 2022 22:10:35 -0800\nSubject: [PATCH] Fix XML schema vulnerability\n\n---\n src\/edu\/stanford\/nlp\/util\/XMLUtils.java | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/src\/edu\/stanford\/nlp\/util\/XMLUtils.java b\/src\/edu\/stanford\/nlp\/util\/XMLUtils.java\nindex 520990477b..137b85546b 100644\n--- a\/src\/edu\/stanford\/nlp\/util\/XMLUtils.java\n+++ b\/src\/edu\/stanford\/nlp\/util\/XMLUtils.java\n@@ -302,6 +302,7 @@ public static DocumentBuilder getValidatingXmlParser(File schemaFile) {\n       DocumentBuilderFactory dbf = safeDocumentBuilderFactory();\n \n       SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);\n+      factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);\n       Schema schema = factory.newSchema(schemaFile);\n       dbf.setSchema(schema);"
        },
        {
            "index":676,
            "vuln_id":"GHSA-cvgx-3v3q-m36c",
            "cwe_id":"{'CWE-125'}",
            "score":7.1,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a0d64445116c43cf46a5666bd4eee28e7a82f244'}",
            "dataset":"osv",
            "summary":"Heap OOB in shape inference for `QuantizeV2` ### Impact\nThe [shape inference code for `QuantizeV2`](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/8d72537c6abf5a44103b57b9c2e22c14f5f49698\/tensorflow\/core\/framework\/common_shape_fns.cc#L2509-L2530) can trigger a read outside of bounds of heap allocated array:\n\n```python\nimport tensorflow as tf\n\n@tf.function\ndef test():\n  data=tf.raw_ops.QuantizeV2(\n    input=[1.0,1.0],\n    min_range=[1.0,10.0],\n    max_range=[1.0,10.0],\n    T=tf.qint32,\n    mode='MIN_COMBINED',\n    round_mode='HALF_TO_EVEN',\n    narrow_range=False,\n    axis=-100,\n    ensure_minimum_range=10)\n  return data\n\ntest()\n```\n\nThis occurs whenever `axis` is a negative value less than `-1`. In this case, we are accessing data before the start of a heap buffer:\n    \n```cc\nint axis = -1;\nStatus s = c->GetAttr(\"axis\", &axis);\nif (!s.ok() && s.code() != error::NOT_FOUND) {\n  return s;\n}   \n... \nif (axis != -1) {\n  ...\n  TF_RETURN_IF_ERROR(\n      c->Merge(c->Dim(minmax, 0), c->Dim(input, axis), &depth));\n}\n```\n\nThe code allows `axis` to be an optional argument (`s` would contain an `error::NOT_FOUND` error code). Otherwise, it assumes that `axis` is a valid index into the dimensions of the `input` tensor. If `axis` is less than `-1` then this results in a heap OOB read.\n    \n### Patches\nWe have patched the issue in GitHub commit [a0d64445116c43cf46a5666bd4eee28e7a82f244](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a0d64445116c43cf46a5666bd4eee28e7a82f244).\n    \nThe fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, as this version is the only one that is also affected.\n  \n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-11-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a0d64445116c43cf46a5666bd4eee28e7a82f244",
            "commit_sha":"a0d64445116c43cf46a5666bd4eee28e7a82f244",
            "patch":"SINGLE",
            "chain_ord":"['a0d64445116c43cf46a5666bd4eee28e7a82f244']",
            "before_first_fix_commit":"{'4a7c71d60c94ae3bc8149429988eeeb1d5466f00'}",
            "last_fix_commit":"a0d64445116c43cf46a5666bd4eee28e7a82f244",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/01\/2021, 22:52:56",
            "message":"Prevent OOB access in QuantizeV2 shape inference\n\nPiperOrigin-RevId: 400309614\nChange-Id: I31412c71b05b4f21b677f7fa715a61499cbee39d",
            "author":"Yu-Cheng Ling",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
            "files":"{'tensorflow\/core\/framework\/common_shape_fns.cc': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/a0d64445116c43cf46a5666bd4eee28e7a82f244\/tensorflow%2Fcore%2Fframework%2Fcommon_shape_fns.cc', 'patch': '@@ -2559,6 +2559,9 @@ Status QuantizeV2Shape(InferenceContext* c) {\\n   if (!s.ok() && s.code() != error::NOT_FOUND) {\\n     return s;\\n   }\\n+  if (axis < -1) {\\n+    return errors::InvalidArgument(\"axis should be at least -1, got \", axis);\\n+  }\\n   const int minmax_rank = (axis == -1) ? 0 : 1;\\n   TF_RETURN_IF_ERROR(shape_inference::UnchangedShape(c));\\n   ShapeHandle minmax;'}}",
            "message_norm":"prevent oob access in quantizev2 shape inference\n\npiperorigin-revid: 400309614\nchange-id: i31412c71b05b4f21b677f7fa715a61499cbee39d",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('oob', 'SECWORD', ''), ('400309614', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/framework\/common_shape_fns.cc'])",
            "num_files":1.0,
            "patch_content":"From a0d64445116c43cf46a5666bd4eee28e7a82f244 Mon Sep 17 00:00:00 2001\nFrom: Yu-Cheng Ling <ycling@google.com>\nDate: Fri, 1 Oct 2021 15:52:56 -0700\nSubject: [PATCH] Prevent OOB access in QuantizeV2 shape inference\n\nPiperOrigin-RevId: 400309614\nChange-Id: I31412c71b05b4f21b677f7fa715a61499cbee39d\n---\n tensorflow\/core\/framework\/common_shape_fns.cc | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/tensorflow\/core\/framework\/common_shape_fns.cc b\/tensorflow\/core\/framework\/common_shape_fns.cc\nindex 8c1b3bf1d1c9d8..95f2670e0571da 100644\n--- a\/tensorflow\/core\/framework\/common_shape_fns.cc\n+++ b\/tensorflow\/core\/framework\/common_shape_fns.cc\n@@ -2559,6 +2559,9 @@ Status QuantizeV2Shape(InferenceContext* c) {\n   if (!s.ok() && s.code() != error::NOT_FOUND) {\n     return s;\n   }\n+  if (axis < -1) {\n+    return errors::InvalidArgument(\"axis should be at least -1, got \", axis);\n+  }\n   const int minmax_rank = (axis == -1) ? 0 : 1;\n   TF_RETURN_IF_ERROR(shape_inference::UnchangedShape(c));\n   ShapeHandle minmax;"
        },
        {
            "index":424,
            "vuln_id":"GHSA-m9m5-cg5h-r582",
            "cwe_id":"{'CWE-338'}",
            "score":5.1,
            "chain":"{'https:\/\/github.com\/Absolucy\/nanorand-rs\/commit\/5ba218ac29df4786b002d7d12b47fa0c04a331f2'}",
            "dataset":"osv",
            "summary":"Improper random number generation in nanorand An issue was discovered in the nanorand crate before 0.5.1 for Rust. It caused any random number generator (even ChaCha) to return all zeroes because integer truncation was mishandled.",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/Absolucy\/nanorand-rs",
            "commit_href":"https:\/\/github.com\/Absolucy\/nanorand-rs\/commit\/5ba218ac29df4786b002d7d12b47fa0c04a331f2",
            "commit_sha":"5ba218ac29df4786b002d7d12b47fa0c04a331f2",
            "patch":"SINGLE",
            "chain_ord":"['5ba218ac29df4786b002d7d12b47fa0c04a331f2']",
            "before_first_fix_commit":"{'7bf49ecbb254991585c04dd4f4d2a23cb16a1240'}",
            "last_fix_commit":"5ba218ac29df4786b002d7d12b47fa0c04a331f2",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/07\/2020, 12:33:01",
            "message":"fix: Fix random number generation",
            "author":"aspen",
            "comments":null,
            "stats":"{'additions': 7, 'deletions': 7, 'total': 14}",
            "files":"{'nanorand\/src\/gen.rs': {'additions': 7, 'deletions': 7, 'changes': 14, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/Absolucy\/nanorand-rs\/raw\/5ba218ac29df4786b002d7d12b47fa0c04a331f2\/nanorand%2Fsrc%2Fgen.rs', 'patch': '@@ -101,44 +101,44 @@ impl<R: RNG> RandomRange<R> for usize {\\n \\n impl<R: RNG> RandomGen<R> for u32 {\\n \\tfn random(r: &mut R) -> Self {\\n-\\t\\t(r.generate::<u64>() >> 32) as u32\\n+\\t\\tr.generate::<u64>() as u32\\n \\t}\\n }\\n \\n impl<R: RNG> RandomRange<R> for u32 {\\n \\tfn random_range(r: &mut R, lower: u32, upper: u32) -> Self {\\n-\\t\\t(r.generate_range::<u64>(lower as u64, upper as u64) >> 32) as u32\\n+\\t\\tr.generate_range::<u64>(lower as u64, upper as u64) as u32\\n \\t}\\n }\\n \\n impl<R: RNG> RandomGen<R> for u16 {\\n \\tfn random(r: &mut R) -> Self {\\n-\\t\\t(r.generate::<u64>() >> 16) as u16\\n+\\t\\tr.generate::<u64>() as u16\\n \\t}\\n }\\n \\n impl<R: RNG> RandomRange<R> for u16 {\\n \\tfn random_range(r: &mut R, lower: u16, upper: u16) -> Self {\\n-\\t\\t(r.generate_range::<u64>(lower as u64, upper as u64) >> 16) as u16\\n+\\t\\tr.generate_range::<u64>(lower as u64, upper as u64) as u16\\n \\t}\\n }\\n \\n impl<R: RNG> RandomGen<R> for u8 {\\n \\tfn random(r: &mut R) -> Self {\\n-\\t\\t(r.generate::<u64>() >> 8) as u8\\n+\\t\\tr.generate::<u64>() as u8\\n \\t}\\n }\\n \\n impl<R: RNG> RandomRange<R> for u8 {\\n \\tfn random_range(r: &mut R, lower: u8, upper: u8) -> Self {\\n-\\t\\t(r.generate_range::<u64>(lower as u64, upper as u64) >> 8) as u8\\n+\\t\\tr.generate_range::<u64>(lower as u64, upper as u64) as u8\\n \\t}\\n }\\n \\n impl<R: RNG> RandomRange<R> for char {\\n \\tfn random_range(r: &mut R, lower: char, upper: char) -> Self {\\n \\t\\tloop {\\n-\\t\\t\\tlet ret = (r.generate_range::<u64>(lower as u64, upper as u64) >> 32) as u32;\\n+\\t\\t\\tlet ret = r.generate_range::<u64>(lower as u64, upper as u64) as u32;\\n \\t\\t\\tif let Some(c) = core::char::from_u32(ret) {\\n \\t\\t\\t\\tbreak c;\\n \\t\\t\\t}'}}",
            "message_norm":"fix: fix random number generation",
            "language":"en",
            "entities":"[('fix', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['nanorand\/src\/gen.rs'])",
            "num_files":1.0,
            "patch_content":"From 5ba218ac29df4786b002d7d12b47fa0c04a331f2 Mon Sep 17 00:00:00 2001\nFrom: aspen <aspenuwu@protonmail.com>\nDate: Mon, 7 Dec 2020 07:33:01 -0500\nSubject: [PATCH] fix: Fix random number generation\n\n---\n nanorand\/src\/gen.rs | 14 +++++++-------\n 1 file changed, 7 insertions(+), 7 deletions(-)\n\ndiff --git a\/nanorand\/src\/gen.rs b\/nanorand\/src\/gen.rs\nindex 5c2f878..c83651f 100644\n--- a\/nanorand\/src\/gen.rs\n+++ b\/nanorand\/src\/gen.rs\n@@ -101,44 +101,44 @@ impl<R: RNG> RandomRange<R> for usize {\n \n impl<R: RNG> RandomGen<R> for u32 {\n \tfn random(r: &mut R) -> Self {\n-\t\t(r.generate::<u64>() >> 32) as u32\n+\t\tr.generate::<u64>() as u32\n \t}\n }\n \n impl<R: RNG> RandomRange<R> for u32 {\n \tfn random_range(r: &mut R, lower: u32, upper: u32) -> Self {\n-\t\t(r.generate_range::<u64>(lower as u64, upper as u64) >> 32) as u32\n+\t\tr.generate_range::<u64>(lower as u64, upper as u64) as u32\n \t}\n }\n \n impl<R: RNG> RandomGen<R> for u16 {\n \tfn random(r: &mut R) -> Self {\n-\t\t(r.generate::<u64>() >> 16) as u16\n+\t\tr.generate::<u64>() as u16\n \t}\n }\n \n impl<R: RNG> RandomRange<R> for u16 {\n \tfn random_range(r: &mut R, lower: u16, upper: u16) -> Self {\n-\t\t(r.generate_range::<u64>(lower as u64, upper as u64) >> 16) as u16\n+\t\tr.generate_range::<u64>(lower as u64, upper as u64) as u16\n \t}\n }\n \n impl<R: RNG> RandomGen<R> for u8 {\n \tfn random(r: &mut R) -> Self {\n-\t\t(r.generate::<u64>() >> 8) as u8\n+\t\tr.generate::<u64>() as u8\n \t}\n }\n \n impl<R: RNG> RandomRange<R> for u8 {\n \tfn random_range(r: &mut R, lower: u8, upper: u8) -> Self {\n-\t\t(r.generate_range::<u64>(lower as u64, upper as u64) >> 8) as u8\n+\t\tr.generate_range::<u64>(lower as u64, upper as u64) as u8\n \t}\n }\n \n impl<R: RNG> RandomRange<R> for char {\n \tfn random_range(r: &mut R, lower: char, upper: char) -> Self {\n \t\tloop {\n-\t\t\tlet ret = (r.generate_range::<u64>(lower as u64, upper as u64) >> 32) as u32;\n+\t\t\tlet ret = r.generate_range::<u64>(lower as u64, upper as u64) as u32;\n \t\t\tif let Some(c) = core::char::from_u32(ret) {\n \t\t\t\tbreak c;\n \t\t\t}"
        },
        {
            "index":312,
            "vuln_id":"GHSA-qjw2-hr98-qgfh",
            "cwe_id":"{'CWE-502'}",
            "score":8.1,
            "chain":"{'https:\/\/github.com\/FasterXML\/jackson-databind\/commit\/ad5a630174f08d279504bc51ebba8772fd71b86b', 'https:\/\/github.com\/FasterXML\/jackson-databind\/commit\/2118e71325486c68f089a9761c9d8a11b4ddd1cb'}",
            "dataset":"osv",
            "summary":"Unsafe Deserialization in jackson-databind FasterXML jackson-databind 2.x before 2.6.7.5 and from 2.7.x before 2.9.10.6 mishandles the interaction between serialization gadgets and typing, related to com.pastdev.httpcomponents.configuration.JndiConfiguration.",
            "published_date":"2021-12-09",
            "chain_len":2,
            "project":"https:\/\/github.com\/FasterXML\/jackson-databind",
            "commit_href":"https:\/\/github.com\/FasterXML\/jackson-databind\/commit\/ad5a630174f08d279504bc51ebba8772fd71b86b",
            "commit_sha":"ad5a630174f08d279504bc51ebba8772fd71b86b",
            "patch":"MULTI",
            "chain_ord":"['ad5a630174f08d279504bc51ebba8772fd71b86b', '2118e71325486c68f089a9761c9d8a11b4ddd1cb']",
            "before_first_fix_commit":"{'8069e46dd9c288d4a52911ebdc52192cd3d0e96c'}",
            "last_fix_commit":"2118e71325486c68f089a9761c9d8a11b4ddd1cb",
            "chain_ord_pos":1.0,
            "commit_datetime":"09\/18\/2020, 17:17:24",
            "message":"Add cve id for #2798",
            "author":"Tatu Saloranta",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'release-notes\/VERSION-2.x': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/FasterXML\/jackson-databind\/raw\/ad5a630174f08d279504bc51ebba8772fd71b86b\/release-notes%2FVERSION-2.x', 'patch': '@@ -11,7 +11,7 @@ Project: jackson-databind\\n \\n 2.9.10.6 (24-Aug-2020)\\n \\n-#2798: Block one more gadget type (xxx, CVE-xxxx-xxx)\\n+#2798: Block one more gadget type (com.pastdev.httpcomponents, CVE-2020-24750)\\n  (reported by Al1ex@knownsec)\\n #2814: Block one more gadget type (Anteros-DBCP, CVE-2020-24616)\\n  (reported by ChenZhaojun)'}}",
            "message_norm":"add cve id for #2798",
            "language":"cy",
            "entities":"[('add', 'ACTION', ''), ('cve', 'SECWORD', ''), ('#2798', 'ISSUE', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['release-notes\/VERSION-2.x'])",
            "num_files":1.0,
            "patch_content":"From ad5a630174f08d279504bc51ebba8772fd71b86b Mon Sep 17 00:00:00 2001\nFrom: Tatu Saloranta <tatu.saloranta@iki.fi>\nDate: Fri, 18 Sep 2020 10:17:24 -0700\nSubject: [PATCH] Add cve id for #2798\n\n---\n release-notes\/VERSION-2.x | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/release-notes\/VERSION-2.x b\/release-notes\/VERSION-2.x\nindex 55fd50aec7..6a13e3ff79 100644\n--- a\/release-notes\/VERSION-2.x\n+++ b\/release-notes\/VERSION-2.x\n@@ -11,7 +11,7 @@ Project: jackson-databind\n \n 2.9.10.6 (24-Aug-2020)\n \n-#2798: Block one more gadget type (xxx, CVE-xxxx-xxx)\n+#2798: Block one more gadget type (com.pastdev.httpcomponents, CVE-2020-24750)\n  (reported by Al1ex@knownsec)\n #2814: Block one more gadget type (Anteros-DBCP, CVE-2020-24616)\n  (reported by ChenZhaojun)"
        },
        {
            "index":721,
            "vuln_id":"GHSA-8gvg-8vhf-h26g",
            "cwe_id":"{'CWE-787'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/d797e3f00e34c12c8c0ae52f56344325439dccd7', 'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/7827e117753052d479fabe19a25cfece88059bca'}",
            "dataset":"osv",
            "summary":"Out-of-bounds write A remote code execution vulnerability exists in the way that the Chakra scripting engine handles objects in memory in Microsoft Edge, aka 'Chakra Scripting Engine Memory Corruption Vulnerability'. This CVE ID is unique from CVE-2019-0912, CVE-2019-0913, CVE-2019-0914, CVE-2019-0915, CVE-2019-0916, CVE-2019-0917, CVE-2019-0922, CVE-2019-0923, CVE-2019-0924, CVE-2019-0925, CVE-2019-0927, CVE-2019-0933.",
            "published_date":"2021-03-29",
            "chain_len":2,
            "project":"https:\/\/github.com\/chakra-core\/ChakraCore",
            "commit_href":"https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/7827e117753052d479fabe19a25cfece88059bca",
            "commit_sha":"7827e117753052d479fabe19a25cfece88059bca",
            "patch":"MULTI",
            "chain_ord":"['7827e117753052d479fabe19a25cfece88059bca', 'd797e3f00e34c12c8c0ae52f56344325439dccd7']",
            "before_first_fix_commit":"{'ea0491305137183603bf43844b5584d4cc972e28', '4594e340bc9ca9f857010a68e8b562d65b46eed6'}",
            "last_fix_commit":"d797e3f00e34c12c8c0ae52f56344325439dccd7",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/17\/2019, 22:42:35",
            "message":"[CVE-2019-0937]",
            "author":"Paul Leathers",
            "comments":null,
            "stats":"{'additions': 10, 'deletions': 0, 'total': 10}",
            "files":"{'lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp': {'additions': 10, 'deletions': 0, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/chakra-core\/ChakraCore\/raw\/7827e117753052d479fabe19a25cfece88059bca\/lib%2FRuntime%2FByteCode%2FByteCodeEmitter.cpp', 'patch': '@@ -4006,6 +4006,11 @@ void ByteCodeGenerator::StartEmitCatch(ParseNodeCatch *pnodeCatch)\\n                 sym->SetIsGlobalCatch(true);\\n             }\\n \\n+            if (sym->NeedsScopeObject())\\n+            {\\n+                scope->SetIsObject();\\n+            }\\n+\\n             Assert(sym->GetScopeSlot() == Js::Constants::NoProperty);\\n             if (sym->NeedsSlotAlloc(this, funcInfo))\\n             {\\n@@ -4029,6 +4034,11 @@ void ByteCodeGenerator::StartEmitCatch(ParseNodeCatch *pnodeCatch)\\n             sym->SetIsGlobalCatch(true);\\n         }\\n \\n+        if (sym->NeedsScopeObject())\\n+        {\\n+            scope->SetIsObject();\\n+        }\\n+\\n         if (scope->GetMustInstantiate())\\n         {\\n             if (sym->IsInSlot(this, funcInfo))'}}",
            "message_norm":"[cve-2019-0937]",
            "language":"ro",
            "entities":"[('cve-2019-0937', 'VULNID', 'CVE')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp'])",
            "num_files":1.0,
            "patch_content":"From 7827e117753052d479fabe19a25cfece88059bca Mon Sep 17 00:00:00 2001\nFrom: Paul Leathers <pleath@microsoft.com>\nDate: Wed, 17 Apr 2019 15:42:35 -0700\nSubject: [PATCH] [CVE-2019-0937]\n\n---\n lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp | 10 ++++++++++\n 1 file changed, 10 insertions(+)\n\ndiff --git a\/lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp b\/lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp\nindex 5c07982b92b..933a21d385d 100644\n--- a\/lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp\n+++ b\/lib\/Runtime\/ByteCode\/ByteCodeEmitter.cpp\n@@ -4006,6 +4006,11 @@ void ByteCodeGenerator::StartEmitCatch(ParseNodeCatch *pnodeCatch)\n                 sym->SetIsGlobalCatch(true);\n             }\n \n+            if (sym->NeedsScopeObject())\n+            {\n+                scope->SetIsObject();\n+            }\n+\n             Assert(sym->GetScopeSlot() == Js::Constants::NoProperty);\n             if (sym->NeedsSlotAlloc(this, funcInfo))\n             {\n@@ -4029,6 +4034,11 @@ void ByteCodeGenerator::StartEmitCatch(ParseNodeCatch *pnodeCatch)\n             sym->SetIsGlobalCatch(true);\n         }\n \n+        if (sym->NeedsScopeObject())\n+        {\n+            scope->SetIsObject();\n+        }\n+\n         if (scope->GetMustInstantiate())\n         {\n             if (sym->IsInSlot(this, funcInfo))"
        },
        {
            "index":650,
            "vuln_id":"GHSA-3872-f48p-pxqj",
            "cwe_id":"{'CWE-88', 'CWE-77'}",
            "score":8.8,
            "chain":"{'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/d83672a3e7415da1490334e2c9431e5da1966842', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/35d59f1f040541c358cece0a8d4a63183ca919b8'}",
            "dataset":"osv",
            "summary":"Improper Neutralization of Special Elements used in a Command ('Command Injection') in Weblate ### Impact\nWeblate didn't correctly sanitize some arguments passed to Git and Mercurial, which allowed changing their behavior in an unintended way.\n\n### Patches\n\nThe issues were fixed in the 4.11.1 release. The following commits are addressing it:\n\n* 35d59f1f040541c358cece0a8d4a63183ca919b8\n* d83672a3e7415da1490334e2c9431e5da1966842\n\n### Workarounds\n\nInstances in which untrusted users cannot create new components are not affected.\n\n### References\n* [SNYK-PYTHON-WEBLATE-2414088](https:\/\/security.snyk.io\/vuln\/SNYK-PYTHON-WEBLATE-2414088)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open a topic in [discussions](https:\/\/github.com\/WeblateOrg\/weblate\/discussions)\n* Email us at [care@weblate.org](mailto:care@weblate.org)",
            "published_date":"2022-03-04",
            "chain_len":2,
            "project":"https:\/\/github.com\/WeblateOrg\/weblate",
            "commit_href":"https:\/\/github.com\/WeblateOrg\/weblate\/commit\/d83672a3e7415da1490334e2c9431e5da1966842",
            "commit_sha":"d83672a3e7415da1490334e2c9431e5da1966842",
            "patch":"MULTI",
            "chain_ord":"['35d59f1f040541c358cece0a8d4a63183ca919b8', 'd83672a3e7415da1490334e2c9431e5da1966842']",
            "before_first_fix_commit":"{'9a5a09781e5a19ab9a24878afb08c9fcafb21ca7'}",
            "last_fix_commit":"d83672a3e7415da1490334e2c9431e5da1966842",
            "chain_ord_pos":2.0,
            "commit_datetime":"03\/03\/2022, 07:45:16",
            "message":"vcs: Improve git parameters handling\n\nMake sure that all user provided input is handled as expected.",
            "author":"Michal \u010ciha\u0159",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 3, 'total': 8}",
            "files":"{'weblate\/vcs\/git.py': {'additions': 5, 'deletions': 3, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/WeblateOrg\/weblate\/raw\/d83672a3e7415da1490334e2c9431e5da1966842\/weblate%2Fvcs%2Fgit.py', 'patch': '@@ -85,7 +85,7 @@ def get_remote_branch(cls, repo: str):\\n         if not repo:\\n             return super().get_remote_branch(repo)\\n         try:\\n-            result = cls._popen([\"ls-remote\", \"--symref\", repo, \"HEAD\"])\\n+            result = cls._popen([\"ls-remote\", \"--symref\", \"--\", repo, \"HEAD\"])\\n         except RepositoryException:\\n             report_error(cause=\"Listing remote branch\")\\n             return super().get_remote_branch(repo)\\n@@ -149,7 +149,9 @@ def get_depth():\\n     @classmethod\\n     def _clone(cls, source: str, target: str, branch: str):\\n         \"\"\"Clone repository.\"\"\"\\n-        cls._popen([\"clone\"] + cls.get_depth() + [\"--branch\", branch, source, target])\\n+        cls._popen(\\n+            [\"clone\"] + cls.get_depth() + [\"--branch\", branch, \"--\", source, target]\\n+        )\\n \\n     def get_config(self, path):\\n         \"\"\"Read entry from configuration.\"\"\"\\n@@ -572,7 +574,7 @@ def get_last_repo_revision(cls, url):\\n \\n     @classmethod\\n     def get_remote_args(cls, source, target):\\n-        result = [\"--prefix=origin\/\", source, target]\\n+        result = [\"--prefix=origin\/\", \"--\", source, target]\\n         if cls.is_stdlayout(source):\\n             result.insert(0, \"--stdlayout\")\\n             revision = cls.get_last_repo_revision(source + \"\/trunk\/\")'}}",
            "message_norm":"vcs: improve git parameters handling\n\nmake sure that all user provided input is handled as expected.",
            "language":"en",
            "entities":"[('improve', 'ACTION', ''), ('user provided input', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['weblate\/vcs\/git.py'])",
            "num_files":1.0,
            "patch_content":"From d83672a3e7415da1490334e2c9431e5da1966842 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>\nDate: Thu, 3 Mar 2022 08:45:16 +0100\nSubject: [PATCH] vcs: Improve git parameters handling\n\nMake sure that all user provided input is handled as expected.\n---\n weblate\/vcs\/git.py | 8 +++++---\n 1 file changed, 5 insertions(+), 3 deletions(-)\n\ndiff --git a\/weblate\/vcs\/git.py b\/weblate\/vcs\/git.py\nindex ab620b878026..e1b9d6810722 100644\n--- a\/weblate\/vcs\/git.py\n+++ b\/weblate\/vcs\/git.py\n@@ -85,7 +85,7 @@ def get_remote_branch(cls, repo: str):\n         if not repo:\n             return super().get_remote_branch(repo)\n         try:\n-            result = cls._popen([\"ls-remote\", \"--symref\", repo, \"HEAD\"])\n+            result = cls._popen([\"ls-remote\", \"--symref\", \"--\", repo, \"HEAD\"])\n         except RepositoryException:\n             report_error(cause=\"Listing remote branch\")\n             return super().get_remote_branch(repo)\n@@ -149,7 +149,9 @@ def get_depth():\n     @classmethod\n     def _clone(cls, source: str, target: str, branch: str):\n         \"\"\"Clone repository.\"\"\"\n-        cls._popen([\"clone\"] + cls.get_depth() + [\"--branch\", branch, source, target])\n+        cls._popen(\n+            [\"clone\"] + cls.get_depth() + [\"--branch\", branch, \"--\", source, target]\n+        )\n \n     def get_config(self, path):\n         \"\"\"Read entry from configuration.\"\"\"\n@@ -572,7 +574,7 @@ def get_last_repo_revision(cls, url):\n \n     @classmethod\n     def get_remote_args(cls, source, target):\n-        result = [\"--prefix=origin\/\", source, target]\n+        result = [\"--prefix=origin\/\", \"--\", source, target]\n         if cls.is_stdlayout(source):\n             result.insert(0, \"--stdlayout\")\n             revision = cls.get_last_repo_revision(source + \"\/trunk\/\")"
        },
        {
            "index":761,
            "vuln_id":"GHSA-3qxp-qjq7-w4hf",
            "cwe_id":"{'CWE-754'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/26eb323554ffccd173e8a79a8c05c15b685ae4d1'}",
            "dataset":"osv",
            "summary":"CHECK-fail in tf.raw_ops.EncodePng ### Impact\nAn attacker can trigger a `CHECK` fail in PNG encoding by providing an empty input tensor as the pixel data:\n\n```python\nimport tensorflow as tf\n\nimage = tf.zeros([0, 0, 3])\nimage = tf.cast(image, dtype=tf.uint8) \ntf.raw_ops.EncodePng(image=image) \n```\n\nThis is because the [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/e312e0791ce486a80c9d23110841525c6f7c3289\/tensorflow\/core\/kernels\/image\/encode_png_op.cc#L57-L60) only validates that the total number of pixels in the image does not overflow. Thus, an attacker can send an empty matrix for encoding. However, if the tensor is empty, then the associated buffer is `nullptr`. Hence, when [calling `png::WriteImageToBuffer`](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/e312e0791ce486a80c9d23110841525c6f7c3289\/tensorflow\/core\/kernels\/image\/encode_png_op.cc#L79-L93), the first argument (i.e., `image.flat<T>().data()`) is `NULL`. This then triggers the `CHECK_NOTNULL` in the [first line of `png::WriteImageToBuffer`](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/e312e0791ce486a80c9d23110841525c6f7c3289\/tensorflow\/core\/lib\/png\/png_io.cc#L345-L349).\n\n```cc\ntemplate <typename T>\nbool WriteImageToBuffer(\n    const void* image, int width, int height, int row_bytes, int num_channels,\n    int channel_bits, int compression, T* png_string,\n    const std::vector<std::pair<std::string, std::string> >* metadata) {\n  CHECK_NOTNULL(image);\n  ...\n}\n```\n\nSince `image` is null, this results in `abort` being called after printing the stacktrace. Effectively, this allows an attacker to mount a denial of service attack.\n\n### Patches\nWe have patched the issue in GitHub commit [26eb323554ffccd173e8a79a8c05c15b685ae4d1](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/26eb323554ffccd173e8a79a8c05c15b685ae4d1).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang and Ying Wang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/26eb323554ffccd173e8a79a8c05c15b685ae4d1",
            "commit_sha":"26eb323554ffccd173e8a79a8c05c15b685ae4d1",
            "patch":"SINGLE",
            "chain_ord":"['26eb323554ffccd173e8a79a8c05c15b685ae4d1']",
            "before_first_fix_commit":"{'e312e0791ce486a80c9d23110841525c6f7c3289'}",
            "last_fix_commit":"26eb323554ffccd173e8a79a8c05c15b685ae4d1",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/21\/2021, 20:03:47",
            "message":"Fix null CHECK issue with `tf.raw_ops.EncodePng`.\n\nPiperOrigin-RevId: 369717714\nChange-Id: I24136cd99c20b8466671f4f93b670ef6f6dd1250",
            "author":"Amit Patankar",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
            "files":"{'tensorflow\/core\/kernels\/image\/encode_png_op.cc': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/26eb323554ffccd173e8a79a8c05c15b685ae4d1\/tensorflow%2Fcore%2Fkernels%2Fimage%2Fencode_png_op.cc', 'patch': '@@ -54,6 +54,8 @@ class EncodePngOp : public OpKernel {\\n     OP_REQUIRES(context, image.dims() == 3,\\n                 errors::InvalidArgument(\"image must be 3-dimensional\",\\n                                         image.shape().DebugString()));\\n+    OP_REQUIRES(context, image.NumElements() > 0,\\n+                errors::Internal(\"Invalid image provided.\"));\\n     OP_REQUIRES(\\n         context,\\n         FastBoundsCheck(image.NumElements(), std::numeric_limits<int32>::max()),'}}",
            "message_norm":"fix null check issue with `tf.raw_ops.encodepng`.\n\npiperorigin-revid: 369717714\nchange-id: i24136cd99c20b8466671f4f93b670ef6f6dd1250",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('issue', 'FLAW', ''), ('tf.raw_ops.encodepng', 'SECWORD', ''), ('369717714', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/image\/encode_png_op.cc'])",
            "num_files":1.0,
            "patch_content":"From 26eb323554ffccd173e8a79a8c05c15b685ae4d1 Mon Sep 17 00:00:00 2001\nFrom: Amit Patankar <amitpatankar@google.com>\nDate: Wed, 21 Apr 2021 13:03:47 -0700\nSubject: [PATCH] Fix null CHECK issue with `tf.raw_ops.EncodePng`.\n\nPiperOrigin-RevId: 369717714\nChange-Id: I24136cd99c20b8466671f4f93b670ef6f6dd1250\n---\n tensorflow\/core\/kernels\/image\/encode_png_op.cc | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/image\/encode_png_op.cc b\/tensorflow\/core\/kernels\/image\/encode_png_op.cc\nindex 8dbe1d377df5c6..09bcdbe5e3db0b 100644\n--- a\/tensorflow\/core\/kernels\/image\/encode_png_op.cc\n+++ b\/tensorflow\/core\/kernels\/image\/encode_png_op.cc\n@@ -54,6 +54,8 @@ class EncodePngOp : public OpKernel {\n     OP_REQUIRES(context, image.dims() == 3,\n                 errors::InvalidArgument(\"image must be 3-dimensional\",\n                                         image.shape().DebugString()));\n+    OP_REQUIRES(context, image.NumElements() > 0,\n+                errors::Internal(\"Invalid image provided.\"));\n     OP_REQUIRES(\n         context,\n         FastBoundsCheck(image.NumElements(), std::numeric_limits<int32>::max()),"
        },
        {
            "index":374,
            "vuln_id":"GHSA-6f84-42vf-ppwp",
            "cwe_id":"{'CWE-369'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6'}",
            "dataset":"osv",
            "summary":"Division by 0 in `QuantizedMul` ### Impact\nAn attacker can trigger a division by 0 in `tf.raw_ops.QuantizedMul`:\n\n```python\nimport tensorflow as tf\n\nx = tf.zeros([4, 1], dtype=tf.quint8)\ny = tf.constant([], dtype=tf.quint8)\nmin_x = tf.constant(0.0)\nmax_x = tf.constant(0.0010000000474974513)\nmin_y = tf.constant(0.0)\nmax_y = tf.constant(0.0010000000474974513)\n\ntf.raw_ops.QuantizedMul(x=x, y=y, min_x=min_x, max_x=max_x, min_y=min_y, max_y=max_y)\n```                            \n\nThis is because the [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/55900e961ed4a23b438392024912154a2c2f5e85\/tensorflow\/core\/kernels\/quantized_mul_op.cc#L188-L198) does a division by a quantity that is controlled by the caller:\n\n```cc\ntemplate <class T, class Toutput>\nvoid VectorTensorMultiply(const T* vector_data, int32 vector_offset,\n                          int64 vector_num_elements, const T* tensor_data,\n                          int32 tensor_offset, int64 tensor_num_elements,\n                          Toutput* output) {\n  for (int i = 0; i < tensor_num_elements; ++i) {\n    const int64 vector_i = i % vector_num_elements;\n    ...\n  }\n}\n```\n\n### Patches\nWe have patched the issue in GitHub commit [a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Ying Wang and Yakun Zhang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6",
            "commit_sha":"a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6",
            "patch":"SINGLE",
            "chain_ord":"['a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6']",
            "before_first_fix_commit":"{'55900e961ed4a23b438392024912154a2c2f5e85'}",
            "last_fix_commit":"a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/20\/2021, 17:52:46",
            "message":"Fix one division by zero\n\nPiperOrigin-RevId: 369474832\nChange-Id: I1082858ed78d9b2e4738ce30b231955973d49e1e",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
            "files":"{'tensorflow\/core\/kernels\/quantized_mul_op.cc': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6\/tensorflow%2Fcore%2Fkernels%2Fquantized_mul_op.cc', 'patch': '@@ -347,6 +347,11 @@ class QuantizedMulOp : public OpKernel {\\n         tensor_num_elements = x.NumElements();\\n         tensor_offset = offset_x;\\n       }\\n+      if (vector_num_elements == 0) {\\n+        context->SetStatus(\\n+            errors::InvalidArgument(\"vector must have at least 1 element\"));\\n+        return;\\n+      }\\n       VectorTensorMultiply<T, Toutput>(\\n           vector_data, vector_offset, vector_num_elements, tensor_data,\\n           tensor_offset, tensor_num_elements, z_data);'}}",
            "message_norm":"fix one division by zero\n\npiperorigin-revid: 369474832\nchange-id: i1082858ed78d9b2e4738ce30b231955973d49e1e",
            "language":"it",
            "entities":"[('fix', 'ACTION', ''), ('division by zero', 'SECWORD', ''), ('369474832', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/quantized_mul_op.cc'])",
            "num_files":1.0,
            "patch_content":"From a1b11d2fdd1e51bfe18bb1ede804f60abfa92da6 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 20 Apr 2021 10:52:46 -0700\nSubject: [PATCH] Fix one division by zero\n\nPiperOrigin-RevId: 369474832\nChange-Id: I1082858ed78d9b2e4738ce30b231955973d49e1e\n---\n tensorflow\/core\/kernels\/quantized_mul_op.cc | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/quantized_mul_op.cc b\/tensorflow\/core\/kernels\/quantized_mul_op.cc\nindex 4e191f162662bb..fb56f68bf14dbb 100644\n--- a\/tensorflow\/core\/kernels\/quantized_mul_op.cc\n+++ b\/tensorflow\/core\/kernels\/quantized_mul_op.cc\n@@ -347,6 +347,11 @@ class QuantizedMulOp : public OpKernel {\n         tensor_num_elements = x.NumElements();\n         tensor_offset = offset_x;\n       }\n+      if (vector_num_elements == 0) {\n+        context->SetStatus(\n+            errors::InvalidArgument(\"vector must have at least 1 element\"));\n+        return;\n+      }\n       VectorTensorMultiply<T, Toutput>(\n           vector_data, vector_offset, vector_num_elements, tensor_data,\n           tensor_offset, tensor_num_elements, z_data);"
        },
        {
            "index":614,
            "vuln_id":"GHSA-pfxf-wh96-fvjc",
            "cwe_id":"{'CWE-117'}",
            "score":5.3,
            "chain":"{'https:\/\/github.com\/jhipster\/jhipster-kotlin\/commit\/426ccab85e7e0da562643200637b99b6a2a99449'}",
            "dataset":"osv",
            "summary":"Log Forging in generator-jhipster-kotlin ### Impact\n\nWe log the mail for invalid password reset attempts. \nAs the email is provided by a user and the api is public this can be used by an attacker to forge log entries.\nThis is vulnerable to https:\/\/cwe.mitre.org\/data\/definitions\/117.html\n\nThis problem affects only application generated with jwt or session authentication. Applications using oauth are not vulnerable.\n\n### Patches\n\nversion 1.7.0.\n\n### Workarounds\n\nIn `AccountResource.kt` you should change the line\n\n```kotlin\n log.warn(\"Password reset requested for non existing mail '$mail'\");\n```\n\nto \n\n```kotlin\n log.warn(\"Password reset requested for non existing mail\");\n```\n\n### References\n\n* https:\/\/cwe.mitre.org\/data\/definitions\/117.html\n* https:\/\/owasp.org\/www-community\/attacks\/Log_Injection\n* https:\/\/www.baeldung.com\/jvm-log-forging\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [jhipster kotlin](https:\/\/github.com\/jhipster\/jhipster-kotlin)",
            "published_date":"2020-06-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/jhipster\/jhipster-kotlin",
            "commit_href":"https:\/\/github.com\/jhipster\/jhipster-kotlin\/commit\/426ccab85e7e0da562643200637b99b6a2a99449",
            "commit_sha":"426ccab85e7e0da562643200637b99b6a2a99449",
            "patch":"SINGLE",
            "chain_ord":"['426ccab85e7e0da562643200637b99b6a2a99449']",
            "before_first_fix_commit":"{'72d229b48b87c5575c116a8b0ba6c3c9f02ac287'}",
            "last_fix_commit":"426ccab85e7e0da562643200637b99b6a2a99449",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/06\/2020, 20:18:48",
            "message":"prevent log forging when doing password reset init request",
            "author":"Frederik Hahne",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
            "files":"{'generators\/server\/templates\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jhipster\/jhipster-kotlin\/raw\/426ccab85e7e0da562643200637b99b6a2a99449\/generators%2Fserver%2Ftemplates%2Fsrc%2Fmain%2Fkotlin%2Fpackage%2Fweb%2Frest%2FAccountResource.kt.ejs', 'patch': '@@ -406,7 +406,7 @@ class AccountResource(\\n         } else {\\n             \/\/ Pretend the request has been successful to prevent checking which emails really exist\\n             \/\/ but log that an invalid attempt has been made\\n-            log.warn(\"Password reset requested for non existing mail \\'$mail\\'\");\\n+            log.warn(\"Password reset requested for non existing mail\");\\n         }\\n     }\\n     <%_ } else { _%>\\n@@ -418,7 +418,7 @@ class AccountResource(\\n                 } else {\\n                     \/\/ Pretend the request has been successful to prevent checking which emails really exist\\n                     \/\/ but log that an invalid attempt has been made\\n-                    log.warn(\"Password reset request for non existing email \\'$mail\\'\")\\n+                    log.warn(\"Password reset request for non existing email\")\\n                 }\\n             }.then()\\n     <%_ } _%>'}}",
            "message_norm":"prevent log forging when doing password reset init request",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('password', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['generators\/server\/templates\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs'])",
            "num_files":1.0,
            "patch_content":"From 426ccab85e7e0da562643200637b99b6a2a99449 Mon Sep 17 00:00:00 2001\nFrom: Frederik Hahne <atomfrede@gmail.com>\nDate: Wed, 6 May 2020 22:18:48 +0200\nSubject: [PATCH] prevent log forging when doing password reset init request\n\n---\n ...\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs   | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/generators\/server\/templates\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs b\/generators\/server\/templates\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs\nindex cd58f5311..28643482c 100644\n--- a\/generators\/server\/templates\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs\n+++ b\/generators\/server\/templates\/src\/main\/kotlin\/package\/web\/rest\/AccountResource.kt.ejs\n@@ -406,7 +406,7 @@ class AccountResource(\n         } else {\n             \/\/ Pretend the request has been successful to prevent checking which emails really exist\n             \/\/ but log that an invalid attempt has been made\n-            log.warn(\"Password reset requested for non existing mail '$mail'\");\n+            log.warn(\"Password reset requested for non existing mail\");\n         }\n     }\n     <%_ } else { _%>\n@@ -418,7 +418,7 @@ class AccountResource(\n                 } else {\n                     \/\/ Pretend the request has been successful to prevent checking which emails really exist\n                     \/\/ but log that an invalid attempt has been made\n-                    log.warn(\"Password reset request for non existing email '$mail'\")\n+                    log.warn(\"Password reset request for non existing email\")\n                 }\n             }.then()\n     <%_ } _%>"
        },
        {
            "index":666,
            "vuln_id":"GHSA-r659-8xfp-j327",
            "cwe_id":"{'CWE-1321', 'CWE-915'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/Vincit\/objection.js\/commit\/46b842a6bc897198b83f41ac85c92864b991d7e9', 'https:\/\/github.com\/vincit\/objection.js\/commit\/b41aab8dcd78f426f7468dcda541a7aca18a66a6'}",
            "dataset":"osv",
            "summary":"objection.js Prototype Pollution vulnerability before v2.2.16 objection.js prior to version 2.2.16 is vulnerable to Improperly Controlled Modification of Object Prototype Attributes ('Prototype Pollution'). This issue is patched in version 2.2.16.",
            "published_date":"2021-09-07",
            "chain_len":2,
            "project":"https:\/\/github.com\/Vincit\/objection.js",
            "commit_href":"https:\/\/github.com\/Vincit\/objection.js\/commit\/46b842a6bc897198b83f41ac85c92864b991d7e9",
            "commit_sha":"46b842a6bc897198b83f41ac85c92864b991d7e9",
            "patch":"MULTI",
            "chain_ord":"['b41aab8dcd78f426f7468dcda541a7aca18a66a6', '46b842a6bc897198b83f41ac85c92864b991d7e9']",
            "before_first_fix_commit":"{'260b284a1cbfb044991894c5a3cf3dedc8ce7267'}",
            "last_fix_commit":"46b842a6bc897198b83f41ac85c92864b991d7e9",
            "chain_ord_pos":2.0,
            "commit_datetime":"09\/03\/2021, 09:24:20",
            "message":"Security Fix for Prototype Pollution\n\nFix prototype pollution when path components are not strings",
            "author":"ready-research",
            "comments":null,
            "stats":"{'additions': 7, 'deletions': 1, 'total': 8}",
            "files":"{'lib\/utils\/objectUtils.js': {'additions': 7, 'deletions': 1, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/Vincit\/objection.js\/raw\/46b842a6bc897198b83f41ac85c92864b991d7e9\/lib%2Futils%2FobjectUtils.js', 'patch': \"@@ -225,6 +225,9 @@ function set(obj, path, value) {\\n \\n   for (let i = 0, l = path.length - 1; i < l; ++i) {\\n     const key = path[i];\\n+    if (key === '__proto__') {\\n+      return false;\\n+    }\\n     let child = obj[key];\\n \\n     if (!isObject(child)) {\\n@@ -252,7 +255,10 @@ function set(obj, path, value) {\\n function zipObject(keys, values) {\\n   const out = {};\\n \\n-  for (let i = 0, l = keys.length; i < l; ++i) {\\n+  for (let i = 0, l = keys.length; i < l; ++i) {    \\n+    if (keys[i] === '__proto__') {\\n+      return false;\\n+    }\\n     out[keys[i]] = values[i];\\n   }\"}}",
            "message_norm":"security fix for prototype pollution\n\nfix prototype pollution when path components are not strings",
            "language":"en",
            "entities":"[('security', 'SECWORD', ''), ('prototype pollution', 'SECWORD', ''), ('prototype pollution', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/utils\/objectUtils.js'])",
            "num_files":1.0,
            "patch_content":"From 46b842a6bc897198b83f41ac85c92864b991d7e9 Mon Sep 17 00:00:00 2001\nFrom: ready-research <72916209+ready-research@users.noreply.github.com>\nDate: Fri, 3 Sep 2021 14:54:20 +0530\nSubject: [PATCH] Security Fix for Prototype Pollution\n\nFix prototype pollution when path components are not strings\n---\n lib\/utils\/objectUtils.js | 8 +++++++-\n 1 file changed, 7 insertions(+), 1 deletion(-)\n\ndiff --git a\/lib\/utils\/objectUtils.js b\/lib\/utils\/objectUtils.js\nindex d7e908533..9930eaf40 100644\n--- a\/lib\/utils\/objectUtils.js\n+++ b\/lib\/utils\/objectUtils.js\n@@ -225,6 +225,9 @@ function set(obj, path, value) {\n \n   for (let i = 0, l = path.length - 1; i < l; ++i) {\n     const key = path[i];\n+    if (key === '__proto__') {\n+      return false;\n+    }\n     let child = obj[key];\n \n     if (!isObject(child)) {\n@@ -252,7 +255,10 @@ function set(obj, path, value) {\n function zipObject(keys, values) {\n   const out = {};\n \n-  for (let i = 0, l = keys.length; i < l; ++i) {\n+  for (let i = 0, l = keys.length; i < l; ++i) {    \n+    if (keys[i] === '__proto__') {\n+      return false;\n+    }\n     out[keys[i]] = values[i];\n   }"
        },
        {
            "index":125,
            "vuln_id":"GHSA-6296-mvgp-27hp",
            "cwe_id":"{'CWE-611'}",
            "score":4.2,
            "chain":"{'https:\/\/github.com\/eclipse\/lyo\/commit\/a8b15b7f49ca15e55f6699749c39705d21367c6e'}",
            "dataset":"osv",
            "summary":"XML External Entity Reference in Eclipse Lyo In Eclipse Lyo versions 1.0.0 to 4.1.0, a TransformerFactory is initialized with the defaults that do not restrict DTD loading when working with RDF\/XML. This allows an attacker to cause an external DTD to be retrieved.",
            "published_date":"2022-07-08",
            "chain_len":1,
            "project":"https:\/\/github.com\/eclipse\/lyo",
            "commit_href":"https:\/\/github.com\/eclipse\/lyo\/commit\/a8b15b7f49ca15e55f6699749c39705d21367c6e",
            "commit_sha":"a8b15b7f49ca15e55f6699749c39705d21367c6e",
            "patch":"SINGLE",
            "chain_ord":"['a8b15b7f49ca15e55f6699749c39705d21367c6e']",
            "before_first_fix_commit":"{'5c07867c6fb4076f0177a28abc48cb83598197de'}",
            "last_fix_commit":"a8b15b7f49ca15e55f6699749c39705d21367c6e",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/06\/2022, 12:03:44",
            "message":"Improve Transformer init\n\nSigned-off-by: Andrew Berezovskyi <andriib@kth.se>",
            "author":"Andrew Berezovskyi",
            "comments":null,
            "stats":"{'additions': 10, 'deletions': 14, 'total': 24}",
            "files":"{'core\/oslc4j-jena-provider\/src\/main\/java\/org\/eclipse\/lyo\/oslc4j\/provider\/jena\/JenaModelHelper.java': {'additions': 10, 'deletions': 14, 'changes': 24, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/eclipse\/lyo\/raw\/a8b15b7f49ca15e55f6699749c39705d21367c6e\/core%2Foslc4j-jena-provider%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Flyo%2Foslc4j%2Fprovider%2Fjena%2FJenaModelHelper.java', 'patch': '@@ -52,6 +52,7 @@\\n import org.slf4j.LoggerFactory;\\n import org.w3c.dom.Element;\\n \\n+import javax.xml.XMLConstants;\\n import javax.xml.datatype.DatatypeConfigurationException;\\n import javax.xml.datatype.DatatypeFactory;\\n import javax.xml.namespace.QName;\\n@@ -119,7 +120,7 @@ static Model createJenaModel(final String descriptionAbout, final String respons\\n             final ResponseInfo<?> responseInfo, final Object[] objects, final Map<String, Object> properties)\\n             throws DatatypeConfigurationException, IllegalAccessException, IllegalArgumentException,\\n             InvocationTargetException, OslcCoreApplicationException {\\n-        \\n+\\n         Instant start = Instant.now();\\n \\n         final Model model = ModelFactory.createDefaultModel();\\n@@ -402,7 +403,7 @@ public static Object[] fromJenaModel(final Model model, final Class<?> beanClass\\n             IllegalArgumentException,\\n             InstantiationException, InvocationTargetException, OslcCoreApplicationException,\\n             URISyntaxException, SecurityException, NoSuchMethodException {\\n-        \\n+\\n         Instant start = Instant.now();\\n \\n         final List<Object> results = new ArrayList<>();\\n@@ -664,10 +665,7 @@ else if (!(bean instanceof AbstractResource))\\n                 {\\n                     if (extendedProperties == null)\\n                     {\\n-                        logger.debug(\"Set method not found for object type:\\t\" +\\n-                                beanClass.getName() +\\n-                                \", uri:\\t\" +\\n-                                uri);\\n+                        logger.debug(\"Set method not found for object type: {}, uri: {}\", beanClass.getName(), uri);\\n                     }\\n                     else\\n                     {\\n@@ -2270,20 +2268,18 @@ private static String getVisitedResourceName(Resource resource)\\n         return visitedResourceName;\\n     }\\n \\n-    private static Transformer createTransformer()\\n-    {\\n-        try\\n-        {\\n-            Transformer transformer = TransformerFactory.newInstance().newTransformer();\\n+    private static Transformer createTransformer() {\\n+        try {\\n+            TransformerFactory factory = TransformerFactory.newInstance();\\n+            factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\\n+            factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\\n \\n+            Transformer transformer = factory.newTransformer();\\n             transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, \"yes\");\\n \\n             return transformer;\\n-\\n         } catch (TransformerException e) {\\n-\\n             throw new RuntimeException(e);\\n-\\n         }\\n     }'}}",
            "message_norm":"improve transformer init\n\nsigned-off-by: andrew berezovskyi <andriib@kth.se>",
            "language":"en",
            "entities":"[('improve', 'ACTION', ''), ('andriib@kth.se', 'EMAIL', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['core\/oslc4j-jena-provider\/src\/main\/java\/org\/eclipse\/lyo\/oslc4j\/provider\/jena\/JenaModelHelper.java'])",
            "num_files":1.0,
            "patch_content":"From a8b15b7f49ca15e55f6699749c39705d21367c6e Mon Sep 17 00:00:00 2001\nFrom: Andrew Berezovskyi <andriib@kth.se>\nDate: Fri, 6 May 2022 14:03:44 +0200\nSubject: [PATCH] Improve Transformer init\n\nSigned-off-by: Andrew Berezovskyi <andriib@kth.se>\n---\n ...\/oslc4j\/provider\/jena\/JenaModelHelper.java | 24 ++++++++-----------\n 1 file changed, 10 insertions(+), 14 deletions(-)\n\ndiff --git a\/core\/oslc4j-jena-provider\/src\/main\/java\/org\/eclipse\/lyo\/oslc4j\/provider\/jena\/JenaModelHelper.java b\/core\/oslc4j-jena-provider\/src\/main\/java\/org\/eclipse\/lyo\/oslc4j\/provider\/jena\/JenaModelHelper.java\nindex 2bde1ef7..31d1b8b7 100644\n--- a\/core\/oslc4j-jena-provider\/src\/main\/java\/org\/eclipse\/lyo\/oslc4j\/provider\/jena\/JenaModelHelper.java\n+++ b\/core\/oslc4j-jena-provider\/src\/main\/java\/org\/eclipse\/lyo\/oslc4j\/provider\/jena\/JenaModelHelper.java\n@@ -52,6 +52,7 @@\n import org.slf4j.LoggerFactory;\n import org.w3c.dom.Element;\n \n+import javax.xml.XMLConstants;\n import javax.xml.datatype.DatatypeConfigurationException;\n import javax.xml.datatype.DatatypeFactory;\n import javax.xml.namespace.QName;\n@@ -119,7 +120,7 @@ static Model createJenaModel(final String descriptionAbout, final String respons\n             final ResponseInfo<?> responseInfo, final Object[] objects, final Map<String, Object> properties)\n             throws DatatypeConfigurationException, IllegalAccessException, IllegalArgumentException,\n             InvocationTargetException, OslcCoreApplicationException {\n-        \n+\n         Instant start = Instant.now();\n \n         final Model model = ModelFactory.createDefaultModel();\n@@ -402,7 +403,7 @@ public static Object[] fromJenaModel(final Model model, final Class<?> beanClass\n             IllegalArgumentException,\n             InstantiationException, InvocationTargetException, OslcCoreApplicationException,\n             URISyntaxException, SecurityException, NoSuchMethodException {\n-        \n+\n         Instant start = Instant.now();\n \n         final List<Object> results = new ArrayList<>();\n@@ -664,10 +665,7 @@ else if (!(bean instanceof AbstractResource))\n                 {\n                     if (extendedProperties == null)\n                     {\n-                        logger.debug(\"Set method not found for object type:\t\" +\n-                                beanClass.getName() +\n-                                \", uri:\t\" +\n-                                uri);\n+                        logger.debug(\"Set method not found for object type: {}, uri: {}\", beanClass.getName(), uri);\n                     }\n                     else\n                     {\n@@ -2270,20 +2268,18 @@ private static String getVisitedResourceName(Resource resource)\n         return visitedResourceName;\n     }\n \n-    private static Transformer createTransformer()\n-    {\n-        try\n-        {\n-            Transformer transformer = TransformerFactory.newInstance().newTransformer();\n+    private static Transformer createTransformer() {\n+        try {\n+            TransformerFactory factory = TransformerFactory.newInstance();\n+            factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, \"\");\n+            factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, \"\");\n \n+            Transformer transformer = factory.newTransformer();\n             transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, \"yes\");\n \n             return transformer;\n-\n         } catch (TransformerException e) {\n-\n             throw new RuntimeException(e);\n-\n         }\n     }"
        },
        {
            "index":574,
            "vuln_id":"GHSA-ph87-fvjr-v33w",
            "cwe_id":"{'CWE-617'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/31bd5026304677faa8a0b77602c6154171b9aec1'}",
            "dataset":"osv",
            "summary":"CHECK-fail in `tf.raw_ops.RFFT` ### Impact\nAn attacker can cause a denial of service by exploiting a `CHECK`-failure coming from the implementation of `tf.raw_ops.RFFT`:\n    \n```python\nimport tensorflow as tf\n\ninputs = tf.constant([1], shape=[1], dtype=tf.float32)\nfft_length = tf.constant([0], shape=[1], dtype=tf.int32)\n\ntf.raw_ops.RFFT(input=inputs, fft_length=fft_length)\n```\n\nThe above example causes Eigen code to operate on an empty matrix. This triggers on an assertion and causes program termination.\n    \n### Patches\nWe have patched the issue in GitHub commit [31bd5026304677faa8a0b77602c6154171b9aec1](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/31bd5026304677faa8a0b77602c6154171b9aec1).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions. \n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang and Ying Wang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/31bd5026304677faa8a0b77602c6154171b9aec1",
            "commit_sha":"31bd5026304677faa8a0b77602c6154171b9aec1",
            "patch":"SINGLE",
            "chain_ord":"['31bd5026304677faa8a0b77602c6154171b9aec1']",
            "before_first_fix_commit":"{'1c56f53be0b722ca657cbc7df461ed676c8642a2'}",
            "last_fix_commit":"31bd5026304677faa8a0b77602c6154171b9aec1",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/05\/2021, 00:42:54",
            "message":"Prevent check fail in FFT\n\nPiperOrigin-RevId: 372031044\nChange-Id: I50994e3e8a5d1342d01bde80256f6bf2730ca299",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
            "files":"{'tensorflow\/core\/kernels\/fft_ops.cc': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/31bd5026304677faa8a0b77602c6154171b9aec1\/tensorflow%2Fcore%2Fkernels%2Ffft_ops.cc', 'patch': '@@ -222,6 +222,9 @@ class FFTCPU : public FFTBase {\\n       input_slice_sizes[i] = fft_shape[i - 1];\\n       temp_shape.AddDim(fft_shape[i - 1]);\\n     }\\n+    OP_REQUIRES(ctx, temp_shape.num_elements() > 0,\\n+                errors::InvalidArgument(\"Obtained a FFT shape of 0 elements: \",\\n+                                        temp_shape.DebugString()));\\n \\n     auto output = out->flat_inner_dims<ComplexT, FFTRank + 1>();\\n     const Eigen::DSizes<Eigen::DenseIndex, FFTRank + 1> zero_start_indices;'}}",
            "message_norm":"prevent check fail in fft\n\npiperorigin-revid: 372031044\nchange-id: i50994e3e8a5d1342d01bde80256f6bf2730ca299",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('372031044', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/fft_ops.cc'])",
            "num_files":1.0,
            "patch_content":"From 31bd5026304677faa8a0b77602c6154171b9aec1 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 4 May 2021 17:42:54 -0700\nSubject: [PATCH] Prevent check fail in FFT\n\nPiperOrigin-RevId: 372031044\nChange-Id: I50994e3e8a5d1342d01bde80256f6bf2730ca299\n---\n tensorflow\/core\/kernels\/fft_ops.cc | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/fft_ops.cc b\/tensorflow\/core\/kernels\/fft_ops.cc\nindex 29ca0d2f546a08..fc29f49d223be3 100644\n--- a\/tensorflow\/core\/kernels\/fft_ops.cc\n+++ b\/tensorflow\/core\/kernels\/fft_ops.cc\n@@ -222,6 +222,9 @@ class FFTCPU : public FFTBase {\n       input_slice_sizes[i] = fft_shape[i - 1];\n       temp_shape.AddDim(fft_shape[i - 1]);\n     }\n+    OP_REQUIRES(ctx, temp_shape.num_elements() > 0,\n+                errors::InvalidArgument(\"Obtained a FFT shape of 0 elements: \",\n+                                        temp_shape.DebugString()));\n \n     auto output = out->flat_inner_dims<ComplexT, FFTRank + 1>();\n     const Eigen::DSizes<Eigen::DenseIndex, FFTRank + 1> zero_start_indices;"
        },
        {
            "index":735,
            "vuln_id":"GHSA-52q8-877j-gghq",
            "cwe_id":"{'CWE-22'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/moinwiki\/moin-1.9\/commit\/6b96a9060069302996b5af47fd4a388fc80172b7'}",
            "dataset":"osv",
            "summary":"remote code execution via cache action in MoinMoin ### Impact\nThe cache action in action\/cache.py allows directory traversal through a crafted HTTP request. An attacker who can upload attachments to\nthe wiki can use this to achieve remote code execution.\n\n### Patches\nUsers are strongly advised to upgrade to a patched version.\n\nMoinMoin Wiki 1.9.11 has the necessary fixes and also contains other important fixes.\n\n### Workarounds\nIt is not advised to work around this, but to upgrade MoinMoin to a patched version.\n\nThat said, a work around via disabling the `cache` or the `AttachFile` action might be possible.\n\nAlso, it is of course helpful if you give `write` permissions (which include uploading attachments) only to trusted users.\n\n### Credits\n\nThis vulnerability was discovered by Michael Chapman.\n\n### For more information\nIf you have any questions or comments about this advisory, email me at [twaldmann@thinkmo.de](mailto:twaldmann@thinkmo.de).",
            "published_date":"2020-11-11",
            "chain_len":1,
            "project":"https:\/\/github.com\/moinwiki\/moin-1.9",
            "commit_href":"https:\/\/github.com\/moinwiki\/moin-1.9\/commit\/6b96a9060069302996b5af47fd4a388fc80172b7",
            "commit_sha":"6b96a9060069302996b5af47fd4a388fc80172b7",
            "patch":"SINGLE",
            "chain_ord":"['6b96a9060069302996b5af47fd4a388fc80172b7']",
            "before_first_fix_commit":"{'d1e5fc7d3708d877353ca64dd4aa7cfd1cde4cb4', '31de9139d0aabc171e94032168399b4a0b2a88a2'}",
            "last_fix_commit":"6b96a9060069302996b5af47fd4a388fc80172b7",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/08\/2020, 16:21:56",
            "message":"Merge pull request from GHSA-52q8-877j-gghq\n\nsecurity: fix remote code execution via cache action, CVE-2020-25074",
            "author":"TW",
            "comments":null,
            "stats":"{'additions': 20, 'deletions': 7, 'total': 27}",
            "files":"{'MoinMoin\/action\/cache.py': {'additions': 20, 'deletions': 7, 'changes': 27, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/moinwiki\/moin-1.9\/raw\/6b96a9060069302996b5af47fd4a388fc80172b7\/MoinMoin%2Faction%2Fcache.py', 'patch': \"@@ -103,6 +103,19 @@ def key(request, wikiname=None, itemname=None, attachname=None, content=None, se\\n     return key\\n \\n \\n+def valid_key(key):\\n+    # make sure the key looks like keys generated by key()\\n+    if not isinstance(key, unicode):\\n+        # key is None (not given in url args) or something unexpected\\n+        return False\\n+    try:\\n+        int(key, 16)  # try to evaluate as hex number\\n+    except ValueError:\\n+        # was not a hex number\\n+        return False\\n+    return len(key) == 40  # hmac-sha1 hexdigest == 40 hex chars\\n+\\n+\\n def put(request, key, data,\\n         filename=None,\\n         content_type=None,\\n@@ -234,14 +247,14 @@ def _do_remove(request, key):\\n     remove(request, key)\\n \\n \\n-def _do(request, do, key):\\n-    if do == 'get':\\n-        _do_get(request, key)\\n-    elif do == 'remove':\\n-        _do_remove(request, key)\\n-\\n def execute(pagename, request):\\n     do = request.values.get('do')\\n     key = request.values.get('key')\\n-    _do(request, do, key)\\n+    valid = valid_key(key)  # validate untrusted input\\n+    if valid and do == 'get':\\n+        _do_get(request, key)\\n+    elif valid and do == 'remove':\\n+        _do_remove(request, key)\\n+    else:\\n+        request.status_code = 404\"}}",
            "message_norm":"merge pull request from ghsa-52q8-877j-gghq\n\nsecurity: fix remote code execution via cache action, cve-2020-25074",
            "language":"en",
            "entities":"[('ghsa-52q8-877j-gghq', 'VULNID', 'GHSA'), ('security', 'SECWORD', ''), ('fix', 'ACTION', ''), ('remote code execution', 'SECWORD', ''), ('cve-2020-25074', 'VULNID', 'CVE')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['MoinMoin\/action\/cache.py'])",
            "num_files":1.0,
            "patch_content":"From d1e5fc7d3708d877353ca64dd4aa7cfd1cde4cb4 Mon Sep 17 00:00:00 2001\nFrom: Thomas Waldmann <tw@waldmann-edv.de>\nDate: Mon, 26 Oct 2020 22:06:28 +0100\nSubject: [PATCH] security: fix remote code execution via cache action,\n CVE-2020-25074\n\nAn attacker with \"write\" permissions can upload specifically made\nmalicious code via the normal wiki attachment upload functionality and\nlater execute it on the server (as the same uid\/gid as the wiki server\nprocess) by using the vulnerable MoinMoin cache action.\n---\n MoinMoin\/action\/cache.py | 27 ++++++++++++++++++++-------\n 1 file changed, 20 insertions(+), 7 deletions(-)\n\ndiff --git a\/MoinMoin\/action\/cache.py b\/MoinMoin\/action\/cache.py\nindex a38967e8c..f0bb23ee0 100644\n--- a\/MoinMoin\/action\/cache.py\n+++ b\/MoinMoin\/action\/cache.py\n@@ -103,6 +103,19 @@ def key(request, wikiname=None, itemname=None, attachname=None, content=None, se\n     return key\n \n \n+def valid_key(key):\n+    # make sure the key looks like keys generated by key()\n+    if not isinstance(key, unicode):\n+        # key is None (not given in url args) or something unexpected\n+        return False\n+    try:\n+        int(key, 16)  # try to evaluate as hex number\n+    except ValueError:\n+        # was not a hex number\n+        return False\n+    return len(key) == 40  # hmac-sha1 hexdigest == 40 hex chars\n+\n+\n def put(request, key, data,\n         filename=None,\n         content_type=None,\n@@ -234,14 +247,14 @@ def _do_remove(request, key):\n     remove(request, key)\n \n \n-def _do(request, do, key):\n-    if do == 'get':\n-        _do_get(request, key)\n-    elif do == 'remove':\n-        _do_remove(request, key)\n-\n def execute(pagename, request):\n     do = request.values.get('do')\n     key = request.values.get('key')\n-    _do(request, do, key)\n+    valid = valid_key(key)  # validate untrusted input\n+    if valid and do == 'get':\n+        _do_get(request, key)\n+    elif valid and do == 'remove':\n+        _do_remove(request, key)\n+    else:\n+        request.status_code = 404"
        },
        {
            "index":241,
            "vuln_id":"GHSA-rv62-4pmj-xw6h",
            "cwe_id":"{'CWE-601'}",
            "score":6.1,
            "chain":"{'https:\/\/github.com\/jupyter\/notebook\/commit\/08c4c898182edbe97aadef1815cce50448f975cb', 'https:\/\/github.com\/jupyter\/notebook\/commit\/70fe9f0ddb3023162ece21fbb77d5564306b913b', 'https:\/\/github.com\/jupyter\/notebook\/commit\/d65328d4841892b412aef9015165db1eb029a8ed'}",
            "dataset":"osv",
            "summary":"Moderate severity vulnerability that affects jupyterhub and notebook An Open Redirect vulnerability for all browsers in Jupyter Notebook before 5.7.8 and some browsers (Chrome, Firefox) in JupyterHub before 0.9.6 allows crafted links to the login page, which will redirect to a malicious site after successful login. Servers running on a base_url prefix are not affected.",
            "published_date":"2019-04-02",
            "chain_len":3,
            "project":"https:\/\/github.com\/jupyter\/notebook",
            "commit_href":"https:\/\/github.com\/jupyter\/notebook\/commit\/08c4c898182edbe97aadef1815cce50448f975cb",
            "commit_sha":"08c4c898182edbe97aadef1815cce50448f975cb",
            "patch":"MULTI",
            "chain_ord":"['70fe9f0ddb3023162ece21fbb77d5564306b913b', 'd65328d4841892b412aef9015165db1eb029a8ed', '08c4c898182edbe97aadef1815cce50448f975cb']",
            "before_first_fix_commit":"{'d65328d4841892b412aef9015165db1eb029a8ed'}",
            "last_fix_commit":"08c4c898182edbe97aadef1815cce50448f975cb",
            "chain_ord_pos":3.0,
            "commit_datetime":"03\/27\/2019, 20:43:40",
            "message":"protect against chrome mishandling backslash as slash in URLs",
            "author":"Min RK",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'notebook\/auth\/login.py': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jupyter\/notebook\/raw\/08c4c898182edbe97aadef1815cce50448f975cb\/notebook%2Fauth%2Flogin.py', 'patch': '@@ -39,6 +39,10 @@ def _redirect_safe(self, url, default=None):\\n         \"\"\"\\n         if default is None:\\n             default = self.base_url\\n+        # protect chrome users from mishandling unescaped backslashes.\\n+        # \\\\ is not valid in urls, but some browsers treat it as \/\\n+        # instead of %5C, causing `\\\\\\\\` to behave as `\/\/`\\n+        url = url.replace(\"\\\\\\\\\", \"%5C\")\\n         parsed = urlparse(url)\\n         if parsed.netloc or not (parsed.path + \\'\/\\').startswith(self.base_url):\\n             # require that next_url be absolute path within our path'}}",
            "message_norm":"protect against chrome mishandling backslash as slash in urls",
            "language":"en",
            "entities":"[('protect', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['notebook\/auth\/login.py'])",
            "num_files":1.0,
            "patch_content":"From 08c4c898182edbe97aadef1815cce50448f975cb Mon Sep 17 00:00:00 2001\nFrom: Min RK <benjaminrk@gmail.com>\nDate: Wed, 27 Mar 2019 21:43:40 +0100\nSubject: [PATCH] protect against chrome mishandling backslash as slash in URLs\n\n---\n notebook\/auth\/login.py | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/notebook\/auth\/login.py b\/notebook\/auth\/login.py\nindex d8289d7329..8dbd6112fc 100644\n--- a\/notebook\/auth\/login.py\n+++ b\/notebook\/auth\/login.py\n@@ -39,6 +39,10 @@ def _redirect_safe(self, url, default=None):\n         \"\"\"\n         if default is None:\n             default = self.base_url\n+        # protect chrome users from mishandling unescaped backslashes.\n+        # \\ is not valid in urls, but some browsers treat it as \/\n+        # instead of %5C, causing `\\\\` to behave as `\/\/`\n+        url = url.replace(\"\\\\\", \"%5C\")\n         parsed = urlparse(url)\n         if parsed.netloc or not (parsed.path + '\/').startswith(self.base_url):\n             # require that next_url be absolute path within our path"
        },
        {
            "index":575,
            "vuln_id":"GHSA-4q97-fh3f-j294",
            "cwe_id":"{'CWE-1321'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/tiny-conf\/tiny-conf\/commit\/1f7be78bc68927996647cd45b4367f8975a3ea05'}",
            "dataset":"osv",
            "summary":"Prototype Pollution in tiny-conf All versions of package tiny-conf up to and including version 1.1.0 are vulnerable to Prototype Pollution via the set function.",
            "published_date":"2021-05-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/tiny-conf\/tiny-conf",
            "commit_href":"https:\/\/github.com\/tiny-conf\/tiny-conf\/commit\/1f7be78bc68927996647cd45b4367f8975a3ea05",
            "commit_sha":"1f7be78bc68927996647cd45b4367f8975a3ea05",
            "patch":"SINGLE",
            "chain_ord":"['1f7be78bc68927996647cd45b4367f8975a3ea05']",
            "before_first_fix_commit":"{'c4d8b44ab53b9810b76a04caec249762d8c7fbc7', 'c1f4181bc3583fff49fe6e34c6e745479c569eb2'}",
            "last_fix_commit":"1f7be78bc68927996647cd45b4367f8975a3ea05",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/01\/2020, 08:21:02",
            "message":"Merge pull request #1 from d3m0n-r00t\/master\n\nFixed prototype pollution",
            "author":"Maxime Tricoire",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
            "files":"{'tiny-conf.js': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tiny-conf\/tiny-conf\/raw\/1f7be78bc68927996647cd45b4367f8975a3ea05\/tiny-conf.js', 'patch': \"@@ -44,6 +44,9 @@ Store.prototype = {\\n    * @return {boolean} true if set; false otherwise\\n    *\/\\n   set: function (key, val) {\\n+    if (key.includes('__proto__') || key.includes('prototype') || key.includes('constructor')){\\n+      return undefined;\\n+    }\\n     if (val === undefined) {\\n       val = key;\\n       key = null;\"}}",
            "message_norm":"merge pull request #1 from d3m0n-r00t\/master\n\nfixed prototype pollution",
            "language":"en",
            "entities":"[('#1', 'ISSUE', ''), ('fixed', 'ACTION', ''), ('prototype pollution', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tiny-conf.js'])",
            "num_files":1.0,
            "patch_content":"From c1f4181bc3583fff49fe6e34c6e745479c569eb2 Mon Sep 17 00:00:00 2001\nFrom: sreekanth <sreekanthroot@gmail.com>\nDate: Thu, 1 Oct 2020 11:53:10 +0530\nSubject: [PATCH] Fixed prototype pollution\n\n---\n tiny-conf.js | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/tiny-conf.js b\/tiny-conf.js\nindex 55ff92b..96cc272 100644\n--- a\/tiny-conf.js\n+++ b\/tiny-conf.js\n@@ -44,6 +44,9 @@ Store.prototype = {\n    * @return {boolean} true if set; false otherwise\n    *\/\n   set: function (key, val) {\n+    if (key.includes('__proto__') || key.includes('prototype') || key.includes('constructor')){\n+      return undefined;\n+    }\n     if (val === undefined) {\n       val = key;\n       key = null;"
        },
        {
            "index":258,
            "vuln_id":"GHSA-8p9r-f949-699g",
            "cwe_id":"{'CWE-22'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/browserless\/chrome\/commit\/848b87e5bea4f8473eea85261a5ff922d6ebd2b6'}",
            "dataset":"osv",
            "summary":"Path Traversal in browserless-chrome This affects all versions of browserless-chrome before 1.43.0. User input flowing from the workspace endpoint gets used to create a file path filePath and this is fetched and then sent back to a user. This can be escaped to fetch arbitrary files from a server.",
            "published_date":"2021-05-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/browserless\/chrome",
            "commit_href":"https:\/\/github.com\/browserless\/chrome\/commit\/848b87e5bea4f8473eea85261a5ff922d6ebd2b6",
            "commit_sha":"848b87e5bea4f8473eea85261a5ff922d6ebd2b6",
            "patch":"SINGLE",
            "chain_ord":"['848b87e5bea4f8473eea85261a5ff922d6ebd2b6']",
            "before_first_fix_commit":"{'6a195ab11d393cefcecf9940b38cf6921e3d38d0'}",
            "last_fix_commit":"848b87e5bea4f8473eea85261a5ff922d6ebd2b6",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/26\/2020, 17:28:01",
            "message":"Ensure workspace files are _in_ the workspace DIR",
            "author":"Joel Griffith",
            "comments":null,
            "stats":"{'additions': 8, 'deletions': 1, 'total': 9}",
            "files":"{'src\/routes.ts': {'additions': 8, 'deletions': 1, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/browserless\/chrome\/raw\/848b87e5bea4f8473eea85261a5ff922d6ebd2b6\/src%2Froutes.ts', 'patch': '@@ -157,9 +157,12 @@ export const getRoutes = ({\\n       }\\n \\n       const filePath = path.join(workspaceDir, file);\\n-\\n       const hasFile = await exists(filePath);\\n \\n+      if (!filePath.includes(workspaceDir)) {\\n+        return res.sendStatus(404);\\n+      }\\n+\\n       if (!hasFile) {\\n         return res.sendStatus(404);\\n       }\\n@@ -185,6 +188,10 @@ export const getRoutes = ({\\n       const filePath = path.join(workspaceDir, file);\\n       const hasFile = await exists(filePath);\\n \\n+      if (!filePath.includes(workspaceDir)) {\\n+        return res.sendStatus(404);\\n+      }\\n+\\n       if (!hasFile) {\\n         return res.sendStatus(404);\\n       }'}}",
            "message_norm":"ensure workspace files are _in_ the workspace dir",
            "language":"en",
            "entities":"[('ensure', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/routes.ts'])",
            "num_files":1.0,
            "patch_content":"From 848b87e5bea4f8473eea85261a5ff922d6ebd2b6 Mon Sep 17 00:00:00 2001\nFrom: Joel Griffith <joel.griffith@elastic.co>\nDate: Mon, 26 Oct 2020 10:28:01 -0700\nSubject: [PATCH] Ensure workspace files are _in_ the workspace DIR\n\n---\n src\/routes.ts | 9 ++++++++-\n 1 file changed, 8 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/routes.ts b\/src\/routes.ts\nindex e426faa6b78..031fc4b1194 100644\n--- a\/src\/routes.ts\n+++ b\/src\/routes.ts\n@@ -157,9 +157,12 @@ export const getRoutes = ({\n       }\n \n       const filePath = path.join(workspaceDir, file);\n-\n       const hasFile = await exists(filePath);\n \n+      if (!filePath.includes(workspaceDir)) {\n+        return res.sendStatus(404);\n+      }\n+\n       if (!hasFile) {\n         return res.sendStatus(404);\n       }\n@@ -185,6 +188,10 @@ export const getRoutes = ({\n       const filePath = path.join(workspaceDir, file);\n       const hasFile = await exists(filePath);\n \n+      if (!filePath.includes(workspaceDir)) {\n+        return res.sendStatus(404);\n+      }\n+\n       if (!hasFile) {\n         return res.sendStatus(404);\n       }"
        },
        {
            "index":484,
            "vuln_id":"GHSA-r5jw-62xg-j433",
            "cwe_id":"{'CWE-79'}",
            "score":6.4,
            "chain":"{'https:\/\/github.com\/kaminari\/kaminari\/commit\/8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8'}",
            "dataset":"osv",
            "summary":"Cross-Site Scripting in Kaminari ### Impact\nIn Kaminari before 1.2.1, there is a vulnerability that would allow an attacker to inject arbitrary code into pages with pagination links. This has been fixed in 1.2.1.\n\n### Releases\nThe 1.2.1 gem including the patch has already been released.\nAll past released versions are affected by this vulnerability.\n\n### Workarounds\nApplication developers who can't update the gem can workaround by overriding the `PARAM_KEY_EXCEPT_LIST` constant.\n\n```ruby\nmodule Kaminari::Helpers\n  PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\nend\n```\n\n### Credits\nThanks to Daniel Mircea for finding the issue and sending a patch via GitHub. Also thanks to Aditya Prakash for reporting the vulnerability.",
            "published_date":"2020-05-28",
            "chain_len":1,
            "project":"https:\/\/github.com\/kaminari\/kaminari",
            "commit_href":"https:\/\/github.com\/kaminari\/kaminari\/commit\/8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8",
            "commit_sha":"8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8",
            "patch":"SINGLE",
            "chain_ord":"['8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8']",
            "before_first_fix_commit":"{'04d86ed3f2537aff620941413e5fca254e87aebe'}",
            "last_fix_commit":"8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/21\/2020, 21:02:59",
            "message":"Blacklist \"original_script_name\" get param",
            "author":"Daniel Mircea",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'kaminari-core\/lib\/kaminari\/helpers\/tags.rb': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/kaminari\/kaminari\/raw\/8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8\/kaminari-core%2Flib%2Fkaminari%2Fhelpers%2Ftags.rb', 'patch': '@@ -2,7 +2,7 @@\\n \\n module Kaminari\\n   module Helpers\\n-    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name].freeze\\n+    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\\n \\n     # A tag stands for an HTML tag inside the paginator.\\n     # Basically, a tag has its own partial template file, so every tag can be'}}",
            "message_norm":"blacklist \"original_script_name\" get param",
            "language":"ca",
            "entities":"[('blacklist', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['kaminari-core\/lib\/kaminari\/helpers\/tags.rb'])",
            "num_files":1.0,
            "patch_content":"From 8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8 Mon Sep 17 00:00:00 2001\nFrom: Daniel Mircea <daniel@viseztrance.com>\nDate: Tue, 21 Apr 2020 22:02:59 +0100\nSubject: [PATCH] Blacklist \"original_script_name\" get param\n\n---\n kaminari-core\/lib\/kaminari\/helpers\/tags.rb | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb b\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb\nindex 076bd4310..702e66e5b 100644\n--- a\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb\n+++ b\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb\n@@ -2,7 +2,7 @@\n \n module Kaminari\n   module Helpers\n-    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name].freeze\n+    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\n \n     # A tag stands for an HTML tag inside the paginator.\n     # Basically, a tag has its own partial template file, so every tag can be"
        },
        {
            "index":615,
            "vuln_id":"GHSA-8948-ffc6-jg52",
            "cwe_id":"{'CWE-20'}",
            "score":4.2,
            "chain":"{'https:\/\/github.com\/OptimalBits\/redbird\/commit\/39c7a2da84a2ddddfe046ea80e98800518920516'}",
            "dataset":"osv",
            "summary":"Insecure Default Configuration in redbird Versions of `redbird` prior to 0.9.1 have a vulnerable default configuration of allowing TLS 1.0 connections on `lib\/proxy.js`. The package does not provide an option to disable TLS 1.0 which is deprecated and vulnerable.\n\n\n## Recommendation\n\nUpgrade to version 0.9.1 or later.",
            "published_date":"2019-06-06",
            "chain_len":1,
            "project":"https:\/\/github.com\/OptimalBits\/redbird",
            "commit_href":"https:\/\/github.com\/OptimalBits\/redbird\/commit\/39c7a2da84a2ddddfe046ea80e98800518920516",
            "commit_sha":"39c7a2da84a2ddddfe046ea80e98800518920516",
            "patch":"SINGLE",
            "chain_ord":"['39c7a2da84a2ddddfe046ea80e98800518920516']",
            "before_first_fix_commit":"{'b0ba23a53e881204e4bca4cef75305edb4f9e8b4'}",
            "last_fix_commit":"39c7a2da84a2ddddfe046ea80e98800518920516",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/17\/2019, 16:07:54",
            "message":"Adding option to disable older SSL\/TLS versions\n\nSimply pass in \"secureOptions\" as you normally would to an https config object, and redbird will pass it along into the https proxy server.",
            "author":"James Thomas",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
            "files":"{'lib\/proxy.js': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/OptimalBits\/redbird\/raw\/39c7a2da84a2ddddfe046ea80e98800518920516\/lib%2Fproxy.js', 'patch': '@@ -252,6 +252,11 @@ ReverseProxy.prototype.setupHttpsProxy = function (proxy, websocketsUpgrade, log\\n     key: getCertData(sslOpts.key),\\n     cert: getCertData(sslOpts.cert)\\n   };\\n+  \\n+  \/\/ Allows the option to disable older SSL\/TLS versions\\n+  if(sslOpts.secureOptions) {\\n+    ssl.secureOptions = sslOpts.secureOptions;\\n+  }\\n \\n   if (sslOpts.ca) {\\n     ssl.ca = getCertData(sslOpts.ca, true);'}}",
            "message_norm":"adding option to disable older ssl\/tls versions\n\nsimply pass in \"secureoptions\" as you normally would to an https config object, and redbird will pass it along into the https proxy server.",
            "language":"en",
            "entities":"[('adding', 'ACTION', ''), ('ssl', 'SECWORD', ''), ('tls', 'SECWORD', ''), ('secureoptions', 'SECWORD', ''), ('https proxy', 'SECWORD', ''), ('server', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/proxy.js'])",
            "num_files":1.0,
            "patch_content":"From 39c7a2da84a2ddddfe046ea80e98800518920516 Mon Sep 17 00:00:00 2001\nFrom: James Thomas <james9074@gmail.com>\nDate: Wed, 17 Apr 2019 12:07:54 -0400\nSubject: [PATCH] Adding option to disable older SSL\/TLS versions\n\nSimply pass in \"secureOptions\" as you normally would to an https config object, and redbird will pass it along into the https proxy server.\n---\n lib\/proxy.js | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/lib\/proxy.js b\/lib\/proxy.js\nindex 7227f59..5980458 100755\n--- a\/lib\/proxy.js\n+++ b\/lib\/proxy.js\n@@ -252,6 +252,11 @@ ReverseProxy.prototype.setupHttpsProxy = function (proxy, websocketsUpgrade, log\n     key: getCertData(sslOpts.key),\n     cert: getCertData(sslOpts.cert)\n   };\n+  \n+  \/\/ Allows the option to disable older SSL\/TLS versions\n+  if(sslOpts.secureOptions) {\n+    ssl.secureOptions = sslOpts.secureOptions;\n+  }\n \n   if (sslOpts.ca) {\n     ssl.ca = getCertData(sslOpts.ca, true);"
        },
        {
            "index":894,
            "vuln_id":"GHSA-xfhp-gmh8-r8v2",
            "cwe_id":"{'CWE-400'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/adaltas\/node-printf\/commit\/a8502e7c9b0b22555696a2d8ef67722086413a68'}",
            "dataset":"osv",
            "summary":"Regular Expression Denial of Service (ReDoS) The package printf before 0.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the regex string \/\\%(?:\\(([\\w_.]+)\\)|([1-9]\\d*)\\$)?([0 +\\-\\]*)(\\*|\\d+)?(\\.)?(\\*|\\d+)?[hlL]?([\\%bscdeEfFgGioOuxX])\/g in lib\/printf.js. The vulnerable regular expression has cubic worst-case time complexity.",
            "published_date":"2021-03-19",
            "chain_len":1,
            "project":"https:\/\/github.com\/adaltas\/node-printf",
            "commit_href":"https:\/\/github.com\/adaltas\/node-printf\/commit\/a8502e7c9b0b22555696a2d8ef67722086413a68",
            "commit_sha":"a8502e7c9b0b22555696a2d8ef67722086413a68",
            "patch":"SINGLE",
            "chain_ord":"['a8502e7c9b0b22555696a2d8ef67722086413a68']",
            "before_first_fix_commit":"{'1456b115685791329c6fa6ca4237b7965f10cf82'}",
            "last_fix_commit":"a8502e7c9b0b22555696a2d8ef67722086413a68",
            "chain_ord_pos":1.0,
            "commit_datetime":"02\/10\/2021, 13:28:56",
            "message":"Fix ReDoS",
            "author":"Yeting Li",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'lib\/printf.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/adaltas\/node-printf\/raw\/a8502e7c9b0b22555696a2d8ef67722086413a68\/lib%2Fprintf.js', 'patch': '@@ -41,7 +41,7 @@ var Formatter = function(\/*String*\/ format){\\n   this._tokens = tokenize(format, this._re, this._parseDelim, this);\\n };\\n \\n-Formatter.prototype._re = \/\\\\%(?:\\\\(([\\\\w_.]+)\\\\)|([1-9]\\\\d*)\\\\$)?([0 +\\\\-\\\\#]*)([\\\\*1-9]0*)*(?:(\\\\.)(\\\\*|\\\\d+)?)?[hlL]?([\\\\%bscdeEfFgGioOuxX])\/g;\\n+Formatter.prototype._re = \/\\\\%(?:\\\\(([\\\\w_.]+)\\\\)|([1-9]\\\\d*)\\\\$)?([0 +\\\\-\\\\#]*)(\\\\*|\\\\d+)?(?:(\\\\.)(\\\\*|\\\\d+)?)?[hlL]?([\\\\%bscdeEfFgGioOuxX])\/g;\\n Formatter.prototype._parseDelim = function(mapping, intmapping, flags, minWidth, period, precision, specifier){\\n   if(mapping){\\n     this._mapped = true;'}}",
            "message_norm":"fix redos",
            "language":"pt",
            "entities":"[('fix', 'ACTION', ''), ('redos', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/printf.js'])",
            "num_files":1.0,
            "patch_content":"From a8502e7c9b0b22555696a2d8ef67722086413a68 Mon Sep 17 00:00:00 2001\nFrom: Yeting Li <liyt@ios.ac.cn>\nDate: Wed, 10 Feb 2021 21:28:56 +0800\nSubject: [PATCH] Fix ReDoS\n\n---\n lib\/printf.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lib\/printf.js b\/lib\/printf.js\nindex 34afd6f..c263acf 100755\n--- a\/lib\/printf.js\n+++ b\/lib\/printf.js\n@@ -41,7 +41,7 @@ var Formatter = function(\/*String*\/ format){\n   this._tokens = tokenize(format, this._re, this._parseDelim, this);\n };\n \n-Formatter.prototype._re = \/\\%(?:\\(([\\w_.]+)\\)|([1-9]\\d*)\\$)?([0 +\\-\\#]*)([\\*1-9]0*)*(?:(\\.)(\\*|\\d+)?)?[hlL]?([\\%bscdeEfFgGioOuxX])\/g;\n+Formatter.prototype._re = \/\\%(?:\\(([\\w_.]+)\\)|([1-9]\\d*)\\$)?([0 +\\-\\#]*)(\\*|\\d+)?(?:(\\.)(\\*|\\d+)?)?[hlL]?([\\%bscdeEfFgGioOuxX])\/g;\n Formatter.prototype._parseDelim = function(mapping, intmapping, flags, minWidth, period, precision, specifier){\n   if(mapping){\n     this._mapped = true;"
        },
        {
            "index":410,
            "vuln_id":"GHSA-j4f2-536g-r55m",
            "cwe_id":"{'CWE-400'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/socketio\/engine.io\/commit\/734f9d1268840722c41219e69eb58318e0b2ac6b'}",
            "dataset":"osv",
            "summary":"Resource exhaustion in engine.io  Engine.IO before 4.0.0 and 3.6.0 allows attackers to cause a denial of service (resource consumption) via a POST request to the long polling transport.",
            "published_date":"2022-02-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/socketio\/engine.io",
            "commit_href":"https:\/\/github.com\/socketio\/engine.io\/commit\/734f9d1268840722c41219e69eb58318e0b2ac6b",
            "commit_sha":"734f9d1268840722c41219e69eb58318e0b2ac6b",
            "patch":"SINGLE",
            "chain_ord":"['734f9d1268840722c41219e69eb58318e0b2ac6b']",
            "before_first_fix_commit":"{'61b949259ed966ef6fc8bfd61f14d1a2ef06d319'}",
            "last_fix_commit":"734f9d1268840722c41219e69eb58318e0b2ac6b",
            "chain_ord_pos":1.0,
            "commit_datetime":"02\/11\/2020, 06:57:29",
            "message":"feat: decrease the default value of maxHttpBufferSize\n\nThis change reduces the default value from 100 mb to a more sane 1 mb.\n\nThis helps protect the server against denial of service attacks by\nmalicious clients sending huge amounts of data.",
            "author":"Damien Arrachequesne",
            "comments":"{'com_1': {'author': 'abergmann', 'datetime': '01\/08\/2021, 09:14:06', 'body': '[CVE-2020-36048](https:\/\/nvd.nist.gov\/vuln\/detail\/CVE-2020-36048) was assigned to this commit.'}, 'com_2': {'author': 'ixevix', 'datetime': '05\/11\/2022, 18:37:43', 'body': 'Any luck getting this into an official release on some version of engine.io that socket.io v2.4.x depends on?'}, 'com_3': {'author': 'darrachequesne', 'datetime': '06\/27\/2022, 05:35:10', 'body': '@ixevix here we go:\\r\\n\\r\\n- https:\/\/github.com\/socketio\/engine.io\/releases\/tag\/3.6.0\\r\\n- https:\/\/github.com\/socketio\/socket.io\/releases\/tag\/2.5.0'}}",
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'lib\/server.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/socketio\/engine.io\/raw\/734f9d1268840722c41219e69eb58318e0b2ac6b\/lib%2Fserver.js', 'patch': '@@ -26,7 +26,7 @@ class Server extends EventEmitter {\\n         pingTimeout: 5000,\\n         pingInterval: 25000,\\n         upgradeTimeout: 10000,\\n-        maxHttpBufferSize: 10e7,\\n+        maxHttpBufferSize: 1e6,\\n         transports: Object.keys(transports),\\n         allowUpgrades: true,\\n         perMessageDeflate: {'}}",
            "message_norm":"feat: decrease the default value of maxhttpbuffersize\n\nthis change reduces the default value from 100 mb to a more sane 1 mb.\n\nthis helps protect the server against denial of service attacks by\nmalicious clients sending huge amounts of data.",
            "language":"en",
            "entities":"[('protect', 'SECWORD', ''), ('server', 'SECWORD', ''), ('denial of service', 'SECWORD', ''), ('attacks', 'SECWORD', ''), ('malicious', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/server.js'])",
            "num_files":1.0,
            "patch_content":"From 734f9d1268840722c41219e69eb58318e0b2ac6b Mon Sep 17 00:00:00 2001\nFrom: Damien Arrachequesne <damien.arrachequesne@gmail.com>\nDate: Tue, 11 Feb 2020 07:57:29 +0100\nSubject: [PATCH] feat: decrease the default value of maxHttpBufferSize\n\nThis change reduces the default value from 100 mb to a more sane 1 mb.\n\nThis helps protect the server against denial of service attacks by\nmalicious clients sending huge amounts of data.\n---\n lib\/server.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lib\/server.js b\/lib\/server.js\nindex 527c7a0f9..9b30a4abe 100644\n--- a\/lib\/server.js\n+++ b\/lib\/server.js\n@@ -26,7 +26,7 @@ class Server extends EventEmitter {\n         pingTimeout: 5000,\n         pingInterval: 25000,\n         upgradeTimeout: 10000,\n-        maxHttpBufferSize: 10e7,\n+        maxHttpBufferSize: 1e6,\n         transports: Object.keys(transports),\n         allowUpgrades: true,\n         perMessageDeflate: {"
        },
        {
            "index":854,
            "vuln_id":"GHSA-4j82-5ccr-4r8v",
            "cwe_id":"{'CWE-617'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c2426bba00a01de6913738df8fa78e0215fcce02'}",
            "dataset":"osv",
            "summary":"`CHECK`-failures in `TensorByteSize` in Tensorflow ### Impact\nA malicious user can cause a denial of service by altering a `SavedModel` such that [`TensorByteSize`](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/a1320ec1eac186da1d03f033109191f715b2b130\/tensorflow\/core\/framework\/attr_value_util.cc#L46-L50) would trigger `CHECK` failures.\n\n```cc\nint64_t TensorByteSize(const TensorProto& t) {\n  \/\/ num_elements returns -1 if shape is not fully defined.\n  int64_t num_elems = TensorShape(t.tensor_shape()).num_elements();\n  return num_elems < 0 ? -1 : num_elems * DataTypeSize(t.dtype());\n}\n```\n`TensorShape` constructor throws a `CHECK`-fail if shape is partial or has a number of elements that would overflow the size of an `int`. The `PartialTensorShape` constructor instead does not cause a `CHECK`-abort if the shape is partial, which is exactly what this function needs to be able to return `-1`.\n\n### Patches\nWe have patched the issue in GitHub commit [c2426bba00a01de6913738df8fa78e0215fcce02](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c2426bba00a01de6913738df8fa78e0215fcce02).\n\nThe fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.",
            "published_date":"2022-02-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c2426bba00a01de6913738df8fa78e0215fcce02",
            "commit_sha":"c2426bba00a01de6913738df8fa78e0215fcce02",
            "patch":"SINGLE",
            "chain_ord":"['c2426bba00a01de6913738df8fa78e0215fcce02']",
            "before_first_fix_commit":"{'31d8f8035f559fc6f03516f18ca3afea652d69b0'}",
            "last_fix_commit":"c2426bba00a01de6913738df8fa78e0215fcce02",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/11\/2021, 19:50:53",
            "message":"Use `PartialTensorShape` instead of `TensorShape`.\n\n`TensorShape` constructor throws a CHECK-fail if shape is partial\/overflows which the other doesn't. We are only determining the number of elements in the shape and partial shape should be used as it returns negative number when needed.\n\nPiperOrigin-RevId: 409205384\nChange-Id: Ia56542ff9ec758f2c9ffc7e4dcc9fa7eecd86e7b",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'tensorflow\/core\/framework\/attr_value_util.cc': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/c2426bba00a01de6913738df8fa78e0215fcce02\/tensorflow%2Fcore%2Fframework%2Fattr_value_util.cc', 'patch': '@@ -45,7 +45,7 @@ constexpr int kMaxTensorNestDepth = 100;\\n \/\/ not fully defined return -1.\\n int64_t TensorByteSize(const TensorProto& t) {\\n   \/\/ num_elements returns -1 if shape is not fully defined.\\n-  int64_t num_elems = TensorShape(t.tensor_shape()).num_elements();\\n+  int64_t num_elems = PartialTensorShape(t.tensor_shape()).num_elements();\\n   return num_elems < 0 ? -1 : num_elems * DataTypeSize(t.dtype());\\n }'}}",
            "message_norm":"use `partialtensorshape` instead of `tensorshape`.\n\n`tensorshape` constructor throws a check-fail if shape is partial\/overflows which the other doesn't. we are only determining the number of elements in the shape and partial shape should be used as it returns negative number when needed.\n\npiperorigin-revid: 409205384\nchange-id: ia56542ff9ec758f2c9ffc7e4dcc9fa7eecd86e7b",
            "language":"en",
            "entities":"[('overflows', 'SECWORD', ''), ('409205384', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/framework\/attr_value_util.cc'])",
            "num_files":1.0,
            "patch_content":"From c2426bba00a01de6913738df8fa78e0215fcce02 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Thu, 11 Nov 2021 11:50:53 -0800\nSubject: [PATCH] Use `PartialTensorShape` instead of `TensorShape`.\n\n`TensorShape` constructor throws a CHECK-fail if shape is partial\/overflows which the other doesn't. We are only determining the number of elements in the shape and partial shape should be used as it returns negative number when needed.\n\nPiperOrigin-RevId: 409205384\nChange-Id: Ia56542ff9ec758f2c9ffc7e4dcc9fa7eecd86e7b\n---\n tensorflow\/core\/framework\/attr_value_util.cc | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/tensorflow\/core\/framework\/attr_value_util.cc b\/tensorflow\/core\/framework\/attr_value_util.cc\nindex 20f34cc46c8294..019063e22d3c62 100644\n--- a\/tensorflow\/core\/framework\/attr_value_util.cc\n+++ b\/tensorflow\/core\/framework\/attr_value_util.cc\n@@ -45,7 +45,7 @@ constexpr int kMaxTensorNestDepth = 100;\n \/\/ not fully defined return -1.\n int64_t TensorByteSize(const TensorProto& t) {\n   \/\/ num_elements returns -1 if shape is not fully defined.\n-  int64_t num_elems = TensorShape(t.tensor_shape()).num_elements();\n+  int64_t num_elems = PartialTensorShape(t.tensor_shape()).num_elements();\n   return num_elems < 0 ? -1 : num_elems * DataTypeSize(t.dtype());\n }"
        },
        {
            "index":584,
            "vuln_id":"GHSA-rww7-2gpw-fv6j",
            "cwe_id":"{'CWE-754'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/cb164786dc891ea11d3a900e90367c339305dc7b'}",
            "dataset":"osv",
            "summary":"Crash when type cannot be specialized in Tensorflow ### Impact\nUnder certain scenarios, TensorFlow can fail to specialize a type during [shape inference](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/a1320ec1eac186da1d03f033109191f715b2b130\/tensorflow\/core\/framework\/shape_inference.cc#L168-L174):\n\n```cc\nvoid InferenceContext::PreInputInit(\n    const OpDef& op_def, const std::vector<const Tensor*>& input_tensors,\n    const std::vector<ShapeHandle>& input_tensors_as_shapes) {\n  const auto ret = full_type::SpecializeType(attrs_, op_def);\n  DCHECK(ret.status().ok()) << \"while instantiating types: \" << ret.status();\n  ret_types_ = ret.ValueOrDie();\n  \/\/ ... \n}\n```\n\nHowever, `DCHECK` is a no-op in production builds and an assertion failure in debug builds. In the first case execution proceeds to the `ValueOrDie` line. This results in an assertion failure as `ret` contains an error `Status`, not a value. In the second case we also get a crash due to the assertion failure.\n### Patches\nWe have patched the issue in GitHub commit [cb164786dc891ea11d3a900e90367c339305dc7b](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/cb164786dc891ea11d3a900e90367c339305dc7b).\n\nThe fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, and TensorFlow 2.6.3, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.",
            "published_date":"2022-02-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/cb164786dc891ea11d3a900e90367c339305dc7b",
            "commit_sha":"cb164786dc891ea11d3a900e90367c339305dc7b",
            "patch":"SINGLE",
            "chain_ord":"['cb164786dc891ea11d3a900e90367c339305dc7b']",
            "before_first_fix_commit":"{'c2b31ff2d3151acb230edc3f5b1832d2c713a9e0'}",
            "last_fix_commit":"cb164786dc891ea11d3a900e90367c339305dc7b",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/08\/2021, 18:28:34",
            "message":"Properly handle the case where `SpecializeType()` returns an error `Status`.\n\nIf the error case in `SpecializeType()` is reached, then we would get a crash when trying to access the value of an errorenous `StatusOr` object\n\nPiperOrigin-RevId: 408380069\nChange-Id: If3c3fc876dcf9384d5ec7a4985adc68c23ea7318",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 1, 'total': 5}",
            "files":"{'tensorflow\/core\/framework\/shape_inference.cc': {'additions': 4, 'deletions': 1, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/cb164786dc891ea11d3a900e90367c339305dc7b\/tensorflow%2Fcore%2Fframework%2Fshape_inference.cc', 'patch': '@@ -170,7 +170,10 @@ void InferenceContext::PreInputInit(\\n     const std::vector<ShapeHandle>& input_tensors_as_shapes) {\\n   \/\/ TODO(mdan): This is also done at graph construction. Run only here instead?\\n   const auto ret = full_type::SpecializeType(attrs_, op_def);\\n-  DCHECK(ret.status().ok()) << \"while instantiating types: \" << ret.status();\\n+  if (!ret.status().ok()) {\\n+    construction_status_ = ret.status();\\n+    return;\\n+  }\\n   ret_types_ = ret.ValueOrDie();\\n \\n   input_tensors_ = input_tensors;'}}",
            "message_norm":"properly handle the case where `specializetype()` returns an error `status`.\n\nif the error case in `specializetype()` is reached, then we would get a crash when trying to access the value of an errorenous `statusor` object\n\npiperorigin-revid: 408380069\nchange-id: if3c3fc876dcf9384d5ec7a4985adc68c23ea7318",
            "language":"en",
            "entities":"[('error', 'FLAW', ''), ('error', 'FLAW', ''), ('408380069', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/framework\/shape_inference.cc'])",
            "num_files":1.0,
            "patch_content":"From cb164786dc891ea11d3a900e90367c339305dc7b Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Mon, 8 Nov 2021 10:28:34 -0800\nSubject: [PATCH] Properly handle the case where `SpecializeType()` returns an\n error `Status`.\n\nIf the error case in `SpecializeType()` is reached, then we would get a crash when trying to access the value of an errorenous `StatusOr` object\n\nPiperOrigin-RevId: 408380069\nChange-Id: If3c3fc876dcf9384d5ec7a4985adc68c23ea7318\n---\n tensorflow\/core\/framework\/shape_inference.cc | 5 ++++-\n 1 file changed, 4 insertions(+), 1 deletion(-)\n\ndiff --git a\/tensorflow\/core\/framework\/shape_inference.cc b\/tensorflow\/core\/framework\/shape_inference.cc\nindex 04185dfba2e90c..077837721ae4fa 100644\n--- a\/tensorflow\/core\/framework\/shape_inference.cc\n+++ b\/tensorflow\/core\/framework\/shape_inference.cc\n@@ -170,7 +170,10 @@ void InferenceContext::PreInputInit(\n     const std::vector<ShapeHandle>& input_tensors_as_shapes) {\n   \/\/ TODO(mdan): This is also done at graph construction. Run only here instead?\n   const auto ret = full_type::SpecializeType(attrs_, op_def);\n-  DCHECK(ret.status().ok()) << \"while instantiating types: \" << ret.status();\n+  if (!ret.status().ok()) {\n+    construction_status_ = ret.status();\n+    return;\n+  }\n   ret_types_ = ret.ValueOrDie();\n \n   input_tensors_ = input_tensors;"
        },
        {
            "index":653,
            "vuln_id":"GHSA-w77p-8cfg-2x43",
            "cwe_id":"{'CWE-284'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/qos-ch\/slf4j\/commit\/d2b27fba88e983f921558da27fc29b5f5d269405'}",
            "dataset":"osv",
            "summary":"Improper Access Control in SLF4J org.slf4j.ext.EventData in the slf4j-ext module in QOS.CH SLF4J before `1.8.0-beta4` allows remote attackers to bypass intended access restrictions via crafted data. EventData in the slf4j-ext module in QOS.CH SLF4J, has been fixed in SLF4J version `1.7.26` and later and in the `2.0.x` series.\n\nNote that while the [fix commit](https:\/\/github.com\/qos-ch\/slf4j\/commit\/d2b27fba88e983f921558da27fc29b5f5d269405) is associated with the tag `1.8.0-beta3`, the versions in [Maven](https:\/\/mvnrepository.com\/artifact\/org.slf4j\/slf4j-ext) go directly from `1.8.0-beta2` to `1.8.0-beta4`.",
            "published_date":"2022-05-13",
            "chain_len":1,
            "project":"https:\/\/github.com\/qos-ch\/slf4j",
            "commit_href":"https:\/\/github.com\/qos-ch\/slf4j\/commit\/d2b27fba88e983f921558da27fc29b5f5d269405",
            "commit_sha":"d2b27fba88e983f921558da27fc29b5f5d269405",
            "patch":"SINGLE",
            "chain_ord":"['d2b27fba88e983f921558da27fc29b5f5d269405']",
            "before_first_fix_commit":"{'0ec1f6aac8648e87a7dda2f5730fef6db3b4fa33'}",
            "last_fix_commit":"d2b27fba88e983f921558da27fc29b5f5d269405",
            "chain_ord_pos":1.0,
            "commit_datetime":"03\/14\/2018, 00:09:26",
            "message":"fix SLF4J-431",
            "author":"Ceki Gulcu",
            "comments":"{'com_1': {'author': 'kbabioch', 'datetime': '03\/20\/2018, 08:48:11', 'body': 'What exactly is the issue here? Unfortunately there seem to be no details available on this, and marking a class \"deprecated\" is not necessarily a real fix.'}, 'com_2': {'author': 'ceki', 'datetime': '03\/20\/2018, 08:50:32', 'body': '@kbabioch  Are you using the EventData class?'}, 'com_3': {'author': 'kbabioch', 'datetime': '03\/20\/2018, 09:10:00', 'body': \"@ceki I'm evaluating this issue, and realized that basically no details are available yet :-\/.\"}, 'com_4': {'author': 'ceki', 'datetime': '03\/20\/2018, 09:18:17', 'body': 'SLF4J-431 is a subtask of SLF4J-430. EventData is slated to be removed due to a security vulnerability.'}, 'com_5': {'author': 'adioss', 'datetime': '12\/14\/2018, 16:02:22', 'body': 'Regarding http:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2018-8088, as far as I understand, solution is to update to version to 1.8.0-beta2.\\r\\nHowever, on https:\/\/jira.qos.ch\/browse\/SLF4J-430, you can see that fix version is 1.8.0-beta3.\\r\\nSo, what could we advice in order to fix the threat?'}, 'com_6': {'author': 'ceki', 'datetime': '12\/14\/2018, 21:07:48', 'body': 'As far as I know, org.slf4j.ext.EventData is not widely used.'}, 'com_7': {'author': 'areguru', 'datetime': '12\/20\/2018, 17:28:49', 'body': \"@adioss \\r\\nI suppose you use the OWASP dependency-checker or similar and got a warning about CVE-2018-8088.\\r\\n(In that case same as us)\\r\\n\\r\\nMy understanding after analyzing this is that only the slf4j-ext module has the vulnerability, and only the EventData-class is affected. Most users of SLF4J doesn't use this. \\r\\nhttps:\/\/nvd.nist.gov\/vuln\/detail\/CVE-2018-8088\\r\\nhttps:\/\/mvnrepository.com\/artifact\/org.slf4j\/slf4j-ext\\r\\n   groupId: org.slf4j\\r\\n   artifactId: slf4j-ext\\r\\n   version: 1.7.25\\r\\n\\r\\nSLF4J extensions are packaged within slf4j-ext.jar\\r\\nhttps:\/\/www.slf4j.org\/extensions.html\\r\\n\\r\\nIf you use maven \\r\\nmvn dependency:tree\\r\\nwill generate the dependencies tree of your maven project.\\r\\n\\r\\nFor us the flagging of slf4j-api as vulnerable was a false positive.\\r\\nhttps:\/\/mvnrepository.com\/artifact\/org.slf4j\/slf4j-api\\r\\n   groupId: org.slf4j\\r\\n   artifactId: slf4j-api\\r\\n   version: 1.7.25\\r\\n\\r\\nYou have to check if your application actually use slf4j-ext (and org.slf4j.ext.EventData)\"}, 'com_8': {'author': 'adioss', 'datetime': '12\/20\/2018, 23:42:45', 'body': '@areguru yep exactly that, you\\'ve got it: CVE is \"badly\" declared so, although only slf4j-ext is sensitive, cpe declaration is too large so slf4j-* are detected by sca tools like dependency-check.\\r\\n\\r\\nAlthough I have no dependencies on slf4j-ext on my projects, for other people that have slf4j-ext in the classpath, I was wandering if \"mark as deprecated\" was enough and if they is no other way to exploit the threat than using the constructor directly (using deserialization for example) but finally I\\'m not sure it\\'s possible.\\r\\nThanks a lot @areguru  and @ceki for feedback.'}, 'com_9': {'author': 'sepe81', 'datetime': '01\/09\/2019, 09:47:27', 'body': 'According to https:\/\/www.slf4j.org\/download.html version 1.8.0-beta2 is EXPERIMENTAL. Are there any plans to backport this to the STABLE branch 1.7.x and release a version 1.7.26?'}, 'com_10': {'author': 'cowwoc', 'datetime': '01\/09\/2019, 14:50:50', 'body': '@adioss I emailed nvd@nist.gov asking them to fix the CVE but got back this nice auto-reply: `Due to a lapse in appropriations, I will be out of the office and unable to reply to e-mail until further notice.` :)'}, 'com_11': {'author': 'cowwoc', 'datetime': '01\/09\/2019, 15:22:45', 'body': \"Looking again, it looks like I was supposed to email mitre.org instead of nist.gov. I did now and they seem to be active. I'll let you know once I hear back from them.\"}, 'com_12': {'author': 'cowwoc', 'datetime': '01\/10\/2019, 16:42:30', 'body': \"Hey guys. I've just heard back from nist.gov. They will be updating the CVE for slf4j (and 700 others) within the next 24 hours to fix this kind of error (overly-broad warnings). If you guys run across this kind of error in the future, I recommend reporting it to them. They were extremely responsive and helpful. Have a great day :)\"}, 'com_13': {'author': 'markkolich', 'datetime': '01\/25\/2019, 20:02:29', 'body': \"@ceki following up on @sepe81's comment above, according to slf4j.org [0], version `1.8.0-beta2` is marked experimental but this version has been available for almost a year [1].\\r\\n\\r\\nIf I can gently ask, what is the plan\/timeline for releasing a non-beta version of `1.8.0`?\\r\\n\\r\\n[0] https:\/\/www.slf4j.org\/download.html\\r\\n[1] https:\/\/github.com\/qos-ch\/slf4j\/releases\/tag\/v_1.8.0_beta2\"}, 'com_14': {'author': 'cowwoc', 'datetime': '01\/25\/2019, 20:42:43', 'body': 'I am hoping https:\/\/jira.qos.ch\/browse\/SLF4J-428 gets fixed before 1.8.0 is released because it will affect the Java module name.'}, 'com_15': {'author': 'Neustradamus', 'datetime': '01\/13\/2022, 20:30:30', 'body': 'Dear @kbabioch, @adioss, @areguru, @sepe81, @cowwoc, @markkolich,\\r\\n\\r\\nIn first, I wish you a Happy New Year 2022!\\r\\n\\r\\nToday, there was a progress by @ceki, and a correction about my old requests:\\r\\n- https:\/\/jira.qos.ch\/browse\/SLF4J-455\\r\\n\\r\\nIt has been solved in 1.7.26 and 1.8.0-beta4.\\r\\n\\r\\nI have requested the update of:\\r\\n- https:\/\/jira.qos.ch\/browse\/SLF4J-430\\r\\n- https:\/\/jira.qos.ch\/browse\/SLF4J-431\\r\\n\\r\\nAnd about CVE-2018-8088:\\r\\n- https:\/\/cve.mitre.org\/cgi-bin\/cvekey.cgi?keyword=slf4j+slf4j+log4j12\\r\\n- https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2018-8088\\r\\n- https:\/\/www.google.com\/search?q=CVE-2018-8088\\r\\n\\r\\nLinked to:\\r\\n- https:\/\/github.com\/qos-ch\/reload4j\/issues\/10'}}",
            "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
            "files":"{'slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/qos-ch\/slf4j\/raw\/d2b27fba88e983f921558da27fc29b5f5d269405\/slf4j-ext%2Fsrc%2Fmain%2Fjava%2Forg%2Fslf4j%2Fext%2FEventData.java', 'patch': '@@ -40,6 +40,8 @@\\n  * event. Users may extend this class for each EventType they want to log.\\n  * \\n  * @author Ralph Goers\\n+ * \\n+ * @deprecated Due to a security vulnerability, this class will be removed without replacement.\\n  *\/\\n public class EventData implements Serializable {'}}",
            "message_norm":"fix slf4j-431",
            "language":"sv",
            "entities":"[('fix', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java'])",
            "num_files":1.0,
            "patch_content":"From d2b27fba88e983f921558da27fc29b5f5d269405 Mon Sep 17 00:00:00 2001\nFrom: Ceki Gulcu <ceki@qos.ch>\nDate: Wed, 14 Mar 2018 01:09:26 +0100\nSubject: [PATCH] fix SLF4J-431\n\n---\n slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java b\/slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java\nindex cdfbb04ce..42467905f 100755\n--- a\/slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java\n+++ b\/slf4j-ext\/src\/main\/java\/org\/slf4j\/ext\/EventData.java\n@@ -40,6 +40,8 @@\n  * event. Users may extend this class for each EventType they want to log.\n  * \n  * @author Ralph Goers\n+ * \n+ * @deprecated Due to a security vulnerability, this class will be removed without replacement.\n  *\/\n public class EventData implements Serializable {"
        },
        {
            "index":226,
            "vuln_id":"GHSA-hrmm-f4j8-8vxc",
            "cwe_id":"{'CWE-787'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/d797e3f00e34c12c8c0ae52f56344325439dccd7', 'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/a9ab1aae31078e80593b9227db11d316c2239ef3'}",
            "dataset":"osv",
            "summary":"Out-of-bounds write A remote code execution vulnerability exists in the way that the Chakra scripting engine handles objects in memory in Microsoft Edge, aka 'Chakra Scripting Engine Memory Corruption Vulnerability'. This CVE ID is unique from CVE-2019-0912, CVE-2019-0913, CVE-2019-0914, CVE-2019-0915, CVE-2019-0916, CVE-2019-0917, CVE-2019-0923, CVE-2019-0924, CVE-2019-0925, CVE-2019-0927, CVE-2019-0933, CVE-2019-0937.",
            "published_date":"2021-03-29",
            "chain_len":2,
            "project":"https:\/\/github.com\/chakra-core\/ChakraCore",
            "commit_href":"https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/a9ab1aae31078e80593b9227db11d316c2239ef3",
            "commit_sha":"a9ab1aae31078e80593b9227db11d316c2239ef3",
            "patch":"MULTI",
            "chain_ord":"['a9ab1aae31078e80593b9227db11d316c2239ef3', 'd797e3f00e34c12c8c0ae52f56344325439dccd7']",
            "before_first_fix_commit":"{'ea0491305137183603bf43844b5584d4cc972e28', '4594e340bc9ca9f857010a68e8b562d65b46eed6'}",
            "last_fix_commit":"d797e3f00e34c12c8c0ae52f56344325439dccd7",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/12\/2019, 23:15:50",
            "message":"[CVE-2019-0922] Type confusion in Edge - Individual",
            "author":"Meghana Gupta",
            "comments":null,
            "stats":"{'additions': 8, 'deletions': 1, 'total': 9}",
            "files":"{'lib\/Backend\/GlobOptArrays.cpp': {'additions': 8, 'deletions': 1, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/chakra-core\/ChakraCore\/raw\/a9ab1aae31078e80593b9227db11d316c2239ef3\/lib%2FBackend%2FGlobOptArrays.cpp', 'patch': '@@ -1736,7 +1736,14 @@ void GlobOpt::ArraySrcOpt::Optimize()\\n     {\\n         if (newBaseValueType != baseValueType)\\n         {\\n-            UpdateValue(nullptr, nullptr, nullptr);\\n+            if (globOpt->IsSafeToTransferInPrePass(baseOpnd, baseValue))\\n+            {\\n+                UpdateValue(nullptr, nullptr, nullptr);\\n+            }\\n+            else if (globOpt->IsOperationThatLikelyKillsJsArraysWithNoMissingValues(instr) && baseValueInfo->HasNoMissingValues())\\n+            {\\n+                globOpt->ChangeValueType(nullptr, baseValue, baseValueInfo->Type().SetHasNoMissingValues(false), true);\\n+            }\\n         }\\n \\n         \/\/ For javascript arrays and objects with javascript arrays:'}}",
            "message_norm":"[cve-2019-0922] type confusion in edge - individual",
            "language":"en",
            "entities":"[('cve-2019-0922', 'VULNID', 'CVE'), ('type confusion', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/Backend\/GlobOptArrays.cpp'])",
            "num_files":1.0,
            "patch_content":"From a9ab1aae31078e80593b9227db11d316c2239ef3 Mon Sep 17 00:00:00 2001\nFrom: Meghana Gupta <megupta@microsoft.com>\nDate: Fri, 12 Apr 2019 16:15:50 -0700\nSubject: [PATCH] [CVE-2019-0922] Type confusion in Edge - Individual\n\n---\n lib\/Backend\/GlobOptArrays.cpp | 9 ++++++++-\n 1 file changed, 8 insertions(+), 1 deletion(-)\n\ndiff --git a\/lib\/Backend\/GlobOptArrays.cpp b\/lib\/Backend\/GlobOptArrays.cpp\nindex 135fcf5c108..9ac28c59c12 100644\n--- a\/lib\/Backend\/GlobOptArrays.cpp\n+++ b\/lib\/Backend\/GlobOptArrays.cpp\n@@ -1736,7 +1736,14 @@ void GlobOpt::ArraySrcOpt::Optimize()\n     {\n         if (newBaseValueType != baseValueType)\n         {\n-            UpdateValue(nullptr, nullptr, nullptr);\n+            if (globOpt->IsSafeToTransferInPrePass(baseOpnd, baseValue))\n+            {\n+                UpdateValue(nullptr, nullptr, nullptr);\n+            }\n+            else if (globOpt->IsOperationThatLikelyKillsJsArraysWithNoMissingValues(instr) && baseValueInfo->HasNoMissingValues())\n+            {\n+                globOpt->ChangeValueType(nullptr, baseValue, baseValueInfo->Type().SetHasNoMissingValues(false), true);\n+            }\n         }\n \n         \/\/ For javascript arrays and objects with javascript arrays:"
        },
        {
            "index":253,
            "vuln_id":"GHSA-5rqg-jm4f-cqx7",
            "cwe_id":"{'CWE-835'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/Marak\/colors.js\/commit\/5d2d242f656103ac38086d6b26433a09f1c38c75', 'https:\/\/github.com\/Marak\/colors.js\/commit\/137c6dae3339e97f4bbc838c221803c363b0a9fd', 'https:\/\/github.com\/Marak\/colors.js\/commit\/6bc50e79eeaa1d87369bb3e7e608ebed18c5cf26'}",
            "dataset":"osv",
            "summary":"Infinite loop causing Denial of Service in colors colors is a library for including colored text in node.js consoles. Between 07 and 09 January 2022, colors versions 1.4.1, 1.4.2, and 1.4.44-liberty-2 were published including malicious code that caused a Denial of Service due to an infinite loop. Software dependent on these versions experienced the printing of randomized characters to console and an infinite loop resulting in unbound system resource consumption.\n\nUsers of colors relying on these specific versions should downgrade to version 1.4.0.",
            "published_date":"2022-01-10",
            "chain_len":3,
            "project":"https:\/\/github.com\/Marak\/colors.js",
            "commit_href":"https:\/\/github.com\/Marak\/colors.js\/commit\/137c6dae3339e97f4bbc838c221803c363b0a9fd",
            "commit_sha":"137c6dae3339e97f4bbc838c221803c363b0a9fd",
            "patch":"MULTI",
            "chain_ord":"['137c6dae3339e97f4bbc838c221803c363b0a9fd', '5d2d242f656103ac38086d6b26433a09f1c38c75', '6bc50e79eeaa1d87369bb3e7e608ebed18c5cf26']",
            "before_first_fix_commit":"{'5d2d242f656103ac38086d6b26433a09f1c38c75'}",
            "last_fix_commit":"6bc50e79eeaa1d87369bb3e7e608ebed18c5cf26",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/08\/2022, 04:19:44",
            "message":"Bump to `v1.4.44-liberty`",
            "author":"Marak",
            "comments":"{'com_1': {'author': 'LeviPesin', 'datetime': '01\/12\/2022, 06:18:26', 'body': 'No one have commented on this commit yet :-)'}, 'com_2': {'author': 'hello-smile6', 'datetime': '01\/14\/2022, 04:57:47', 'body': '> No one have commented on this commit yet :-)\\r\\n\\r\\nMake that 2 people'}, 'com_3': {'author': 'hello-smile6', 'datetime': '01\/14\/2022, 04:57:52', 'body': '@LeviPesin'}, 'com_4': {'author': 'TechStudent10', 'datetime': '01\/20\/2022, 14:09:20', 'body': '`liberty-1`'}, 'com_5': {'author': 'Fabrisdev', 'datetime': '01\/23\/2022, 22:51:03', 'body': 'now 5'}}",
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'package.json': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/Marak\/colors.js\/raw\/137c6dae3339e97f4bbc838c221803c363b0a9fd\/package.json', 'patch': '@@ -1,7 +1,7 @@\\n {\\n     \"name\": \"colors\",\\n     \"description\": \"get colors in your node.js console\",\\n-    \"version\": \"1.4.0\",\\n+    \"version\": \"1.4.44-liberty\",\\n     \"author\": \"Marak Squires\",\\n     \"contributors\": [\\n         {'}}",
            "message_norm":"bump to `v1.4.44-liberty`",
            "language":"en",
            "entities":"[('v1.4.44', 'VERSION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['package.json'])",
            "num_files":1.0,
            "patch_content":"From 137c6dae3339e97f4bbc838c221803c363b0a9fd Mon Sep 17 00:00:00 2001\nFrom: Marak <marak.squires@gmail.com>\nDate: Fri, 7 Jan 2022 23:19:44 -0500\nSubject: [PATCH] Bump to `v1.4.44-liberty`\n\n---\n package.json | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/package.json b\/package.json\nindex dbd71ba5..429a7b70 100644\n--- a\/package.json\n+++ b\/package.json\n@@ -1,7 +1,7 @@\n {\n     \"name\": \"colors\",\n     \"description\": \"get colors in your node.js console\",\n-    \"version\": \"1.4.0\",\n+    \"version\": \"1.4.44-liberty\",\n     \"author\": \"Marak Squires\",\n     \"contributors\": [\n         {"
        },
        {
            "index":728,
            "vuln_id":"GHSA-5crj-c72x-m7gq",
            "cwe_id":"{'CWE-476'}",
            "score":5.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/05cbebd3c6bb8f517a158b0155debb8df79017ff'}",
            "dataset":"osv",
            "summary":"Null pointer exception when `Exit` node is not preceded by `Enter` op ### Impact\nThe [process of building the control flow graph](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/8d72537c6abf5a44103b57b9c2e22c14f5f49698\/tensorflow\/core\/common_runtime\/immutable_executor_state.cc#L284-L346) for a TensorFlow model is vulnerable to a null pointer exception when nodes that should be paired are not:\n  \n```python\nimport tensorflow as tf\n  \n@tf.function\ndef func():\n  return tf.raw_ops.Exit(data=[False,False])\n    \nfunc()\n```\n\nThis occurs because the code assumes that the first node in the pairing (e.g., an `Enter` node) always exists when encountering the second node (e.g., an `Exit` node):\n  \n```cc\n  ...\n} else if (IsExit(curr_node)) {\n  \/\/ Exit to the parent frame.\n  parent = parent_nodes[curr_id];         \n  frame_name = cf_info->frame_names[parent->id()];\n  ...                \n```\n\nWhen this is not the case, `parent` is `nullptr` so dereferencing it causes a crash.\n\n### Patches\nWe have patched the issue in GitHub commit [05cbebd3c6bb8f517a158b0155debb8df79017ff](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/05cbebd3c6bb8f517a158b0155debb8df79017ff).\n\nThe fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-11-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/05cbebd3c6bb8f517a158b0155debb8df79017ff",
            "commit_sha":"05cbebd3c6bb8f517a158b0155debb8df79017ff",
            "patch":"SINGLE",
            "chain_ord":"['05cbebd3c6bb8f517a158b0155debb8df79017ff']",
            "before_first_fix_commit":"{'3586950728a5e7cda93d9eeeedfec59ddb30883c'}",
            "last_fix_commit":"05cbebd3c6bb8f517a158b0155debb8df79017ff",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/18\/2021, 23:17:46",
            "message":"Fix a NPE issue in invalid Exit op. Now it will report an error instead of crash.\n\nPiperOrigin-RevId: 404089902\nChange-Id: Ia6ec55445ea70ad045a4d339d354959ad0618f2a",
            "author":"Xiao Yu",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'tensorflow\/core\/common_runtime\/immutable_executor_state.cc': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/05cbebd3c6bb8f517a158b0155debb8df79017ff\/tensorflow%2Fcore%2Fcommon_runtime%2Fimmutable_executor_state.cc', 'patch': '@@ -316,6 +316,10 @@ Status ImmutableExecutorState::BuildControlFlowInfo(const Graph* g,\\n     } else if (IsExit(curr_node)) {\\n       \/\/ Exit to the parent frame.\\n       parent = parent_nodes[curr_id];\\n+      if (!parent) {\\n+        return errors::InvalidArgument(\\n+            \"Invalid Exit op: Cannot find a corresponding Enter op.\");\\n+      }\\n       frame_name = cf_info->frame_names[parent->id()];\\n       parent = parent_nodes[parent->id()];\\n     } else {'}}",
            "message_norm":"fix a npe issue in invalid exit op. now it will report an error instead of crash.\n\npiperorigin-revid: 404089902\nchange-id: ia6ec55445ea70ad045a4d339d354959ad0618f2a",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('npe issue', 'SECWORD', ''), ('error', 'FLAW', ''), ('404089902', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/common_runtime\/immutable_executor_state.cc'])",
            "num_files":1.0,
            "patch_content":"From 05cbebd3c6bb8f517a158b0155debb8df79017ff Mon Sep 17 00:00:00 2001\nFrom: Xiao Yu <fishx@google.com>\nDate: Mon, 18 Oct 2021 16:17:46 -0700\nSubject: [PATCH] Fix a NPE issue in invalid Exit op. Now it will report an\n error instead of crash.\n\nPiperOrigin-RevId: 404089902\nChange-Id: Ia6ec55445ea70ad045a4d339d354959ad0618f2a\n---\n tensorflow\/core\/common_runtime\/immutable_executor_state.cc | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/tensorflow\/core\/common_runtime\/immutable_executor_state.cc b\/tensorflow\/core\/common_runtime\/immutable_executor_state.cc\nindex 3f90d027cf4363..1f728334e2b7ee 100644\n--- a\/tensorflow\/core\/common_runtime\/immutable_executor_state.cc\n+++ b\/tensorflow\/core\/common_runtime\/immutable_executor_state.cc\n@@ -316,6 +316,10 @@ Status ImmutableExecutorState::BuildControlFlowInfo(const Graph* g,\n     } else if (IsExit(curr_node)) {\n       \/\/ Exit to the parent frame.\n       parent = parent_nodes[curr_id];\n+      if (!parent) {\n+        return errors::InvalidArgument(\n+            \"Invalid Exit op: Cannot find a corresponding Enter op.\");\n+      }\n       frame_name = cf_info->frame_names[parent->id()];\n       parent = parent_nodes[parent->id()];\n     } else {"
        },
        {
            "index":729,
            "vuln_id":"GHSA-hwj9-h5mp-3pm3",
            "cwe_id":"{'CWE-400'}",
            "score":5.3,
            "chain":"{'https:\/\/github.com\/postcss\/postcss\/commit\/54cbf3c4847eb0fb1501b9d2337465439e849734', 'https:\/\/github.com\/postcss\/postcss\/commit\/b6f3e4d5a8d7504d553267f80384373af3a3dec5', 'https:\/\/github.com\/postcss\/postcss\/commit\/8682b1e4e328432ba692bed52326e84439cec9e4'}",
            "dataset":"osv",
            "summary":"Regular Expression Denial of Service in postcss The npm package `postcss` from 7.0.0 and before versions 7.0.36 and 8.2.10 is vulnerable to Regular Expression Denial of Service (ReDoS) during source map parsing.",
            "published_date":"2021-05-10",
            "chain_len":3,
            "project":"https:\/\/github.com\/postcss\/postcss",
            "commit_href":"https:\/\/github.com\/postcss\/postcss\/commit\/b6f3e4d5a8d7504d553267f80384373af3a3dec5",
            "commit_sha":"b6f3e4d5a8d7504d553267f80384373af3a3dec5",
            "patch":"MULTI",
            "chain_ord":"['8682b1e4e328432ba692bed52326e84439cec9e4', 'b6f3e4d5a8d7504d553267f80384373af3a3dec5', '54cbf3c4847eb0fb1501b9d2337465439e849734']",
            "before_first_fix_commit":"{'12832f3d203474bd273bd06bd3b2407567bfe09e'}",
            "last_fix_commit":"54cbf3c4847eb0fb1501b9d2337465439e849734",
            "chain_ord_pos":2.0,
            "commit_datetime":"04\/11\/2021, 13:03:12",
            "message":"Fix unsafe regexp in getAnnotationURL() too",
            "author":"Andrey Sitnik",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 3, 'total': 4}",
            "files":"{'lib\/previous-map.js': {'additions': 1, 'deletions': 3, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/postcss\/postcss\/raw\/b6f3e4d5a8d7504d553267f80384373af3a3dec5\/lib%2Fprevious-map.js', 'patch': '@@ -48,9 +48,7 @@ class PreviousMap {\\n   }\\n \\n   getAnnotationURL(sourceMapString) {\\n-    return sourceMapString\\n-      .match(\/\\\\\/\\\\*\\\\s*# sourceMappingURL=(.*)\\\\s*\\\\*\\\\\/\/)[1]\\n-      .trim()\\n+    return sourceMapString.match(\/\\\\\/\\\\*\\\\s*# sourceMappingURL=(.*)\\\\*\\\\\/\/)[1].trim()\\n   }\\n \\n   loadAnnotation(css) {'}}",
            "message_norm":"fix unsafe regexp in getannotationurl() too",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('unsafe', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/previous-map.js'])",
            "num_files":1.0,
            "patch_content":"From b6f3e4d5a8d7504d553267f80384373af3a3dec5 Mon Sep 17 00:00:00 2001\nFrom: Andrey Sitnik <andrey@sitnik.ru>\nDate: Sun, 11 Apr 2021 09:03:12 -0400\nSubject: [PATCH] Fix unsafe regexp in getAnnotationURL() too\n\n---\n lib\/previous-map.js | 4 +---\n 1 file changed, 1 insertion(+), 3 deletions(-)\n\ndiff --git a\/lib\/previous-map.js b\/lib\/previous-map.js\nindex ff474a2bf..d9308ff26 100644\n--- a\/lib\/previous-map.js\n+++ b\/lib\/previous-map.js\n@@ -48,9 +48,7 @@ class PreviousMap {\n   }\n \n   getAnnotationURL(sourceMapString) {\n-    return sourceMapString\n-      .match(\/\\\/\\*\\s*# sourceMappingURL=(.*)\\s*\\*\\\/\/)[1]\n-      .trim()\n+    return sourceMapString.match(\/\\\/\\*\\s*# sourceMappingURL=(.*)\\*\\\/\/)[1].trim()\n   }\n \n   loadAnnotation(css) {"
        },
        {
            "index":620,
            "vuln_id":"GHSA-gwp4-hfv6-p7hw",
            "cwe_id":"{'CWE-502'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/FasterXML\/jackson-databind\/commit\/ad418eeb974e357f2797aef64aa0e3ffaaa6125b'}",
            "dataset":"osv",
            "summary":"Deserialization of untrusted data in FasterXML jackson-databind A Polymorphic Typing issue was discovered in FasterXML jackson-databind 2.x before 2.9.9.2. This occurs when Default Typing is enabled (either globally or for a specific property) for an externally exposed JSON endpoint and the service has the logback jar in the classpath.",
            "published_date":"2019-08-01",
            "chain_len":1,
            "project":"https:\/\/github.com\/FasterXML\/jackson-databind",
            "commit_href":"https:\/\/github.com\/FasterXML\/jackson-databind\/commit\/ad418eeb974e357f2797aef64aa0e3ffaaa6125b",
            "commit_sha":"ad418eeb974e357f2797aef64aa0e3ffaaa6125b",
            "patch":"SINGLE",
            "chain_ord":"['ad418eeb974e357f2797aef64aa0e3ffaaa6125b']",
            "before_first_fix_commit":"{'322ae225cbcd07178a634e548d991b0aec6b47bf'}",
            "last_fix_commit":"ad418eeb974e357f2797aef64aa0e3ffaaa6125b",
            "chain_ord_pos":1.0,
            "commit_datetime":"07\/26\/2019, 04:58:11",
            "message":"Backport #2387, #2389 fixes",
            "author":"Tatu Saloranta",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 0, 'total': 6}",
            "files":"{'src\/main\/java\/com\/fasterxml\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java': {'additions': 6, 'deletions': 0, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/FasterXML\/jackson-databind\/raw\/ad418eeb974e357f2797aef64aa0e3ffaaa6125b\/src%2Fmain%2Fjava%2Fcom%2Ffasterxml%2Fjackson%2Fdatabind%2Fjsontype%2Fimpl%2FSubTypeValidator.java', 'patch': '@@ -89,6 +89,12 @@\\n         s.add(\"org.jdom.transform.XSLTransformer\");\\n         s.add(\"org.jdom2.transform.XSLTransformer\");\\n \\n+        \/\/ [databind#2387]: EHCache\\n+        s.add(\"net.sf.ehcache.transaction.manager.DefaultTransactionManagerLookup\");\\n+\\n+        \/\/ [databind#2389]: logback\/jndi\\n+        s.add(\"ch.qos.logback.core.db.JNDIConnectionSource\");\\n+\\n         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);\\n     }'}}",
            "message_norm":"backport #2387, #2389 fixes",
            "language":"en",
            "entities":"[('#2387', 'ISSUE', ''), ('#2389', 'ISSUE', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/main\/java\/com\/fasterxml\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java'])",
            "num_files":1.0,
            "patch_content":"From ad418eeb974e357f2797aef64aa0e3ffaaa6125b Mon Sep 17 00:00:00 2001\nFrom: Tatu Saloranta <tatu.saloranta@iki.fi>\nDate: Thu, 25 Jul 2019 21:58:11 -0700\nSubject: [PATCH] Backport #2387, #2389 fixes\n\n---\n ...\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java    | 6 ++++++\n 1 file changed, 6 insertions(+)\n\ndiff --git a\/src\/main\/java\/com\/fasterxml\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java b\/src\/main\/java\/com\/fasterxml\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java\nindex c4d7f38272..fa7ff2368b 100644\n--- a\/src\/main\/java\/com\/fasterxml\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java\n+++ b\/src\/main\/java\/com\/fasterxml\/jackson\/databind\/jsontype\/impl\/SubTypeValidator.java\n@@ -89,6 +89,12 @@ public class SubTypeValidator\n         s.add(\"org.jdom.transform.XSLTransformer\");\n         s.add(\"org.jdom2.transform.XSLTransformer\");\n \n+        \/\/ [databind#2387]: EHCache\n+        s.add(\"net.sf.ehcache.transaction.manager.DefaultTransactionManagerLookup\");\n+\n+        \/\/ [databind#2389]: logback\/jndi\n+        s.add(\"ch.qos.logback.core.db.JNDIConnectionSource\");\n+\n         DEFAULT_NO_DESER_CLASS_NAMES = Collections.unmodifiableSet(s);\n     }"
        },
        {
            "index":709,
            "vuln_id":"GHSA-mjvc-j6rv-9xj8",
            "cwe_id":"{'CWE-215'}",
            "score":8.8,
            "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/b12e1a490c79460bff019f34b2e17112249b16ec'}",
            "dataset":"osv",
            "summary":"Insertion of Sensitive Information Into Debugging Code in Microweber Microweber prior to 1.3 may expose sensitive information about a server and a user when running the server in debug mode.",
            "published_date":"2022-02-24",
            "chain_len":1,
            "project":"https:\/\/github.com\/microweber\/microweber",
            "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/b12e1a490c79460bff019f34b2e17112249b16ec",
            "commit_sha":"b12e1a490c79460bff019f34b2e17112249b16ec",
            "patch":"SINGLE",
            "chain_ord":"['b12e1a490c79460bff019f34b2e17112249b16ec']",
            "before_first_fix_commit":"{'a5925f74d39775771d4c37c8d4c1acbb762fda0a'}",
            "last_fix_commit":"b12e1a490c79460bff019f34b2e17112249b16ec",
            "chain_ord_pos":1.0,
            "commit_datetime":"02\/22\/2022, 10:35:12",
            "message":"Update Handler.php",
            "author":"Bozhidar Slaveykov",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 5, 'total': 10}",
            "files":"{'src\/MicroweberPackages\/App\/Exceptions\/Handler.php': {'additions': 5, 'deletions': 5, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/b12e1a490c79460bff019f34b2e17112249b16ec\/src%2FMicroweberPackages%2FApp%2FExceptions%2FHandler.php', 'patch': '@@ -12,9 +12,9 @@ class Handler extends ExceptionHandler\\n      *\\n      * @var array\\n      *\/\\n-\/\/    protected $dontReport = [\\n-\/\/        \/\/\\n-\/\/    ];\\n+    protected $dontReport = [\\n+        \\\\BadMethodCallException::class,\\n+    ];\\n \\n     \/**\\n      * A list of the inputs that are never flashed for validation exceptions.\\n@@ -102,10 +102,10 @@ private function getMicroweberErrorBarHtml()\\n                  <a href=\"\\' . api_url(\\'mw_post_update\\') . \\'?redirect_to=\\'.url_current().\\'\" class=\"btn\">Reload database<\/a>\\n                  <a href=\"\\' . api_url(\\'mw_reload_modules\\') . \\'?redirect_to=\\'.url_current().\\'\" class=\"btn\">Reload modules<\/a>\\n                  <a href=\"\\' . api_url(\\'clearcache\\') . \\'?redirect_to=\\'.url_current().\\'\" class=\"btn\">Clear cache<\/a>\\n-                 \\n+\\n                  <a href=\"\" class=\"btn\">Refresh<\/a>\\n             <\/div>\\n         <\/div>\\n         \\';\\n     }\\n-}\\n\\\\ No newline at end of file\\n+}'}}",
            "message_norm":"update handler.php",
            "language":"da",
            "entities":"[('update', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/MicroweberPackages\/App\/Exceptions\/Handler.php'])",
            "num_files":1.0,
            "patch_content":"From b12e1a490c79460bff019f34b2e17112249b16ec Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Tue, 22 Feb 2022 12:35:12 +0200\nSubject: [PATCH] Update Handler.php\n\n---\n src\/MicroweberPackages\/App\/Exceptions\/Handler.php | 10 +++++-----\n 1 file changed, 5 insertions(+), 5 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/App\/Exceptions\/Handler.php b\/src\/MicroweberPackages\/App\/Exceptions\/Handler.php\nindex b0efd1123e6..29d48e8b048 100644\n--- a\/src\/MicroweberPackages\/App\/Exceptions\/Handler.php\n+++ b\/src\/MicroweberPackages\/App\/Exceptions\/Handler.php\n@@ -12,9 +12,9 @@ class Handler extends ExceptionHandler\n      *\n      * @var array\n      *\/\n-\/\/    protected $dontReport = [\n-\/\/        \/\/\n-\/\/    ];\n+    protected $dontReport = [\n+        \\BadMethodCallException::class,\n+    ];\n \n     \/**\n      * A list of the inputs that are never flashed for validation exceptions.\n@@ -102,10 +102,10 @@ private function getMicroweberErrorBarHtml()\n                  <a href=\"' . api_url('mw_post_update') . '?redirect_to='.url_current().'\" class=\"btn\">Reload database<\/a>\n                  <a href=\"' . api_url('mw_reload_modules') . '?redirect_to='.url_current().'\" class=\"btn\">Reload modules<\/a>\n                  <a href=\"' . api_url('clearcache') . '?redirect_to='.url_current().'\" class=\"btn\">Clear cache<\/a>\n-                 \n+\n                  <a href=\"\" class=\"btn\">Refresh<\/a>\n             <\/div>\n         <\/div>\n         ';\n     }\n-}\n\\ No newline at end of file\n+}"
        },
        {
            "index":375,
            "vuln_id":"GHSA-7fvx-3jfc-2cpc",
            "cwe_id":"{'CWE-125'}",
            "score":7.3,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/01cff3f986259d661103412a20745928c727326f'}",
            "dataset":"osv",
            "summary":"Heap OOB in `ResourceScatterUpdate` ### Impact\nAn attacker can trigger a read from outside of bounds of heap allocated data by sending invalid arguments to `tf.raw_ops.ResourceScatterUpdate`:\n\n```python\nimport tensorflow as tf\n\nv = tf.Variable([b'vvv'])\ntf.raw_ops.ResourceScatterUpdate(\n  resource=v.handle,\n  indices=[0],\n  updates=['1', '2', '3', '4', '5'])\n```\n  \nThe [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/f24faa153ad31a4b51578f8181d3aaab77a1ddeb\/tensorflow\/core\/kernels\/resource_variable_ops.cc#L919-L923) has an incomplete validation of the relationship between the shapes of `indices` and `updates`: instead of checking that the shape of `indices` is a prefix of the shape of `updates` (so that broadcasting can happen), code only checks that the number of elements in these two tensors are in a divisibility relationship.\n\n### Patches \nWe have patched the issue in GitHub commit [01cff3f986259d661103412a20745928c727326f](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/01cff3f986259d661103412a20745928c727326f).\n\nThe fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.\n    \n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n    \n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/01cff3f986259d661103412a20745928c727326f",
            "commit_sha":"01cff3f986259d661103412a20745928c727326f",
            "patch":"SINGLE",
            "chain_ord":"['01cff3f986259d661103412a20745928c727326f']",
            "before_first_fix_commit":"{'96f364a1ca3009f98980021c4b32be5fdcca33a1'}",
            "last_fix_commit":"01cff3f986259d661103412a20745928c727326f",
            "chain_ord_pos":1.0,
            "commit_datetime":"08\/02\/2021, 20:33:05",
            "message":"Fix heap OOB due to dimension mismatch in `ResourceScatterUpdate`\n\nPiperOrigin-RevId: 388292801\nChange-Id: Id9bd7244d98d41b1517d4771850b32782c0cc949",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 5, 'total': 11}",
            "files":"{'tensorflow\/core\/kernels\/resource_variable_ops.cc': {'additions': 6, 'deletions': 5, 'changes': 11, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/01cff3f986259d661103412a20745928c727326f\/tensorflow%2Fcore%2Fkernels%2Fresource_variable_ops.cc', 'patch': '@@ -955,11 +955,12 @@ class ResourceScatterUpdateOp : public OpKernel {\\n                         params->dim_size(0), \")\"));\\n       } else {\\n         int64_t num_updates = updates.NumElements();\\n-        OP_REQUIRES(c, num_updates % N == 0,\\n-                    errors::InvalidArgument(\\n-                        \"shape of indices (\", indices.shape().DebugString(),\\n-                        \") is not compatible with the shape of updates (\",\\n-                        updates.shape().DebugString(), \")\"));\\n+        OP_REQUIRES(\\n+            c, TensorShapeUtils::StartsWith(updates.shape(), indices.shape()),\\n+            errors::InvalidArgument(\\n+                \"The shape of indices (\", indices.shape().DebugString(),\\n+                \") must be a prefix of the shape of updates (\",\\n+                updates.shape().DebugString(), \")\"));\\n         auto updates_flat = updates.shaped<T, 2>({N, num_updates \/ N});\\n \\n         functor::ScatterFunctor<Device, T, Index, op> functor;'}}",
            "message_norm":"fix heap oob due to dimension mismatch in `resourcescatterupdate`\n\npiperorigin-revid: 388292801\nchange-id: id9bd7244d98d41b1517d4771850b32782c0cc949",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('heap oob', 'SECWORD', ''), ('388292801', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/resource_variable_ops.cc'])",
            "num_files":1.0,
            "patch_content":"From 01cff3f986259d661103412a20745928c727326f Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Mon, 2 Aug 2021 13:33:05 -0700\nSubject: [PATCH] Fix heap OOB due to dimension mismatch in\n `ResourceScatterUpdate`\n\nPiperOrigin-RevId: 388292801\nChange-Id: Id9bd7244d98d41b1517d4771850b32782c0cc949\n---\n tensorflow\/core\/kernels\/resource_variable_ops.cc | 11 ++++++-----\n 1 file changed, 6 insertions(+), 5 deletions(-)\n\ndiff --git a\/tensorflow\/core\/kernels\/resource_variable_ops.cc b\/tensorflow\/core\/kernels\/resource_variable_ops.cc\nindex 8b9610724e5826..b81a7a517ea6d2 100644\n--- a\/tensorflow\/core\/kernels\/resource_variable_ops.cc\n+++ b\/tensorflow\/core\/kernels\/resource_variable_ops.cc\n@@ -955,11 +955,12 @@ class ResourceScatterUpdateOp : public OpKernel {\n                         params->dim_size(0), \")\"));\n       } else {\n         int64_t num_updates = updates.NumElements();\n-        OP_REQUIRES(c, num_updates % N == 0,\n-                    errors::InvalidArgument(\n-                        \"shape of indices (\", indices.shape().DebugString(),\n-                        \") is not compatible with the shape of updates (\",\n-                        updates.shape().DebugString(), \")\"));\n+        OP_REQUIRES(\n+            c, TensorShapeUtils::StartsWith(updates.shape(), indices.shape()),\n+            errors::InvalidArgument(\n+                \"The shape of indices (\", indices.shape().DebugString(),\n+                \") must be a prefix of the shape of updates (\",\n+                updates.shape().DebugString(), \")\"));\n         auto updates_flat = updates.shaped<T, 2>({N, num_updates \/ N});\n \n         functor::ScatterFunctor<Device, T, Index, op> functor;"
        },
        {
            "index":300,
            "vuln_id":"GHSA-hj5v-574p-mj7c",
            "cwe_id":"{'CWE-400'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/pytest-dev\/py\/pull\/257\/commits\/4a9017dc6199d2a564b6e4b0aa39d6d8870e4144'}",
            "dataset":"osv",
            "summary":"Regular expression deinal of service in py A denial of service via regular expression in the py.path.svnwc component of py (aka python-py) through 1.9.0 could be used by attackers to cause a compute-time denial of service attack by supplying malicious input to the blame functionality.",
            "published_date":"2021-04-20",
            "chain_len":1,
            "project":"https:\/\/github.com\/pytest-dev\/py",
            "commit_href":"https:\/\/github.com\/pytest-dev\/py\/pull\/257\/commits\/4a9017dc6199d2a564b6e4b0aa39d6d8870e4144",
            "commit_sha":"4a9017dc6199d2a564b6e4b0aa39d6d8870e4144",
            "patch":"SINGLE",
            "chain_ord":"['4a9017dc6199d2a564b6e4b0aa39d6d8870e4144']",
            "before_first_fix_commit":"{'2da2caea38812eaa3ce09dd5292e3635ce9b16c8'}",
            "last_fix_commit":"4a9017dc6199d2a564b6e4b0aa39d6d8870e4144",
            "chain_ord_pos":1.0,
            "commit_datetime":"09\/04\/2020, 10:57:26",
            "message":"svnwc: fix regular expression vulnerable to DoS in blame functionality\n\nThe subpattern `\\d+\\s*\\S+` is ambiguous which makes the pattern subject\nto catastrophic backtracing given a string like `\"1\" * 5000`.\n\nSVN blame output seems to always have at least one space between the\nrevision number and the user name, so the ambiguity can be fixed by\nchanging the `*` to `+`.\n\nFixes #256.",
            "author":"Ran Benita",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'py\/_path\/svnwc.py': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pytest-dev\/py\/raw\/4a9017dc6199d2a564b6e4b0aa39d6d8870e4144\/py%2F_path%2Fsvnwc.py', 'patch': '@@ -396,7 +396,7 @@ def makecmdoptions(self):\\n     def __str__(self):\\n         return \"<SvnAuth username=%s ...>\" %(self.username,)\\n \\n-rex_blame = re.compile(r\\'\\\\s*(\\\\d+)\\\\s*(\\\\S+) (.*)\\')\\n+rex_blame = re.compile(r\\'\\\\s*(\\\\d+)\\\\s+(\\\\S+) (.*)\\')\\n \\n class SvnWCCommandPath(common.PathBase):\\n     \"\"\" path implementation offering access\/modification to svn working copies.'}}",
            "message_norm":"svnwc: fix regular expression vulnerable to dos in blame functionality\n\nthe subpattern `\\d+\\s*\\s+` is ambiguous which makes the pattern subject\nto catastrophic backtracing given a string like `\"1\" * 5000`.\n\nsvn blame output seems to always have at least one space between the\nrevision number and the user name, so the ambiguity can be fixed by\nchanging the `*` to `+`.\n\nfixes #256.",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('vulnerable', 'SECWORD', ''), ('dos', 'SECWORD', ''), ('user name', 'SECWORD', ''), ('fixed', 'ACTION', ''), ('changing', 'ACTION', ''), ('fixes', 'ACTION', ''), ('#256', 'ISSUE', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['py\/_path\/svnwc.py'])",
            "num_files":1.0,
            "patch_content":"From 4a9017dc6199d2a564b6e4b0aa39d6d8870e4144 Mon Sep 17 00:00:00 2001\nFrom: Ran Benita <ran@unusedvar.com>\nDate: Fri, 4 Sep 2020 13:57:26 +0300\nSubject: [PATCH] svnwc: fix regular expression vulnerable to DoS in blame\n functionality\n\nThe subpattern `\\d+\\s*\\S+` is ambiguous which makes the pattern subject\nto catastrophic backtracing given a string like `\"1\" * 5000`.\n\nSVN blame output seems to always have at least one space between the\nrevision number and the user name, so the ambiguity can be fixed by\nchanging the `*` to `+`.\n\nFixes #256.\n---\n py\/_path\/svnwc.py | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/py\/_path\/svnwc.py b\/py\/_path\/svnwc.py\nindex 3138dd85..b5b9d8d5 100644\n--- a\/py\/_path\/svnwc.py\n+++ b\/py\/_path\/svnwc.py\n@@ -396,7 +396,7 @@ def makecmdoptions(self):\n     def __str__(self):\n         return \"<SvnAuth username=%s ...>\" %(self.username,)\n \n-rex_blame = re.compile(r'\\s*(\\d+)\\s*(\\S+) (.*)')\n+rex_blame = re.compile(r'\\s*(\\d+)\\s+(\\S+) (.*)')\n \n class SvnWCCommandPath(common.PathBase):\n     \"\"\" path implementation offering access\/modification to svn working copies."
        },
        {
            "index":122,
            "vuln_id":"GHSA-79fv-9865-4qcv",
            "cwe_id":"{'CWE-787', 'CWE-119'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a74768f8e4efbda4def9f16ee7e13cf3922ac5f7'}",
            "dataset":"osv",
            "summary":"Heap buffer overflow in `MaxPoolGrad` ### Impact\nThe implementation of `tf.raw_ops.MaxPoolGrad` is vulnerable to a heap buffer overflow:\n  \n```python\nimport tensorflow as tf\n\norig_input = tf.constant([0.0], shape=[1, 1, 1, 1], dtype=tf.float32)\norig_output = tf.constant([0.0], shape=[1, 1, 1, 1], dtype=tf.float32)\ngrad = tf.constant([], shape=[0, 0, 0, 0], dtype=tf.float32)\nksize = [1, 1, 1, 1] \nstrides = [1, 1, 1, 1]\npadding = \"SAME\"\n\ntf.raw_ops.MaxPoolGrad(\n  orig_input=orig_input, orig_output=orig_output, grad=grad, ksize=ksize,\n  strides=strides, padding=padding, explicit_paddings=[])\n```\n\nThe [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/ab1e644b48c82cb71493f4362b4dd38f4577a1cf\/tensorflow\/core\/kernels\/maxpooling_op.cc#L194-L203) fails to validate that indices used to access elements of input\/output arrays are valid:\n\n```cc\nfor (int index = out_start; index < out_end; ++index) {\n  int input_backprop_index = out_arg_max_flat(index);\n  FastBoundsCheck(input_backprop_index - in_start, in_end - in_start);\n  input_backprop_flat(input_backprop_index) += out_backprop_flat(index);\n}\n```\n\nWhereas accesses to `input_backprop_flat` are guarded by `FastBoundsCheck`, the indexing in `out_backprop_flat` can result in OOB access.\n\n### Patches\nWe have patched the issue in GitHub commit [a74768f8e4efbda4def9f16ee7e13cf3922ac5f7](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a74768f8e4efbda4def9f16ee7e13cf3922ac5f7).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Ying Wang and Yakun Zhang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a74768f8e4efbda4def9f16ee7e13cf3922ac5f7",
            "commit_sha":"a74768f8e4efbda4def9f16ee7e13cf3922ac5f7",
            "patch":"SINGLE",
            "chain_ord":"['a74768f8e4efbda4def9f16ee7e13cf3922ac5f7']",
            "before_first_fix_commit":"{'ab1e644b48c82cb71493f4362b4dd38f4577a1cf'}",
            "last_fix_commit":"a74768f8e4efbda4def9f16ee7e13cf3922ac5f7",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/06\/2021, 21:24:09",
            "message":"Prevent heap OOB error in `MaxPoolGrad`\n\nPiperOrigin-RevId: 372424854\nChange-Id: Idac0f23867ad8b0601cafbaaa52d5e64269e63a7",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 1, 'total': 4}",
            "files":"{'tensorflow\/core\/kernels\/maxpooling_op.cc': {'additions': 3, 'deletions': 1, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/a74768f8e4efbda4def9f16ee7e13cf3922ac5f7\/tensorflow%2Fcore%2Fkernels%2Fmaxpooling_op.cc', 'patch': '@@ -199,7 +199,9 @@ static void SpatialMaxPoolWithArgMaxHelper(\\n         \/\/ CHECK(input_backprop_index >= in_start && input_backprop_index <\\n         \/\/ in_end)\\n         FastBoundsCheck(input_backprop_index - in_start, in_end - in_start);\\n-        input_backprop_flat(input_backprop_index) += out_backprop_flat(index);\\n+        if (index < out_backprop.NumElements()) {\\n+          input_backprop_flat(input_backprop_index) += out_backprop_flat(index);\\n+        }\\n       }\\n     }\\n   };'}}",
            "message_norm":"prevent heap oob error in `maxpoolgrad`\n\npiperorigin-revid: 372424854\nchange-id: idac0f23867ad8b0601cafbaaa52d5e64269e63a7",
            "language":"nl",
            "entities":"[('prevent', 'ACTION', ''), ('heap oob', 'SECWORD', ''), ('error', 'FLAW', ''), ('372424854', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/maxpooling_op.cc'])",
            "num_files":1.0,
            "patch_content":"From a74768f8e4efbda4def9f16ee7e13cf3922ac5f7 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Thu, 6 May 2021 14:24:09 -0700\nSubject: [PATCH] Prevent heap OOB error in `MaxPoolGrad`\n\nPiperOrigin-RevId: 372424854\nChange-Id: Idac0f23867ad8b0601cafbaaa52d5e64269e63a7\n---\n tensorflow\/core\/kernels\/maxpooling_op.cc | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a\/tensorflow\/core\/kernels\/maxpooling_op.cc b\/tensorflow\/core\/kernels\/maxpooling_op.cc\nindex ceb6694ed665d8..01f303eb26980f 100644\n--- a\/tensorflow\/core\/kernels\/maxpooling_op.cc\n+++ b\/tensorflow\/core\/kernels\/maxpooling_op.cc\n@@ -199,7 +199,9 @@ static void SpatialMaxPoolWithArgMaxHelper(\n         \/\/ CHECK(input_backprop_index >= in_start && input_backprop_index <\n         \/\/ in_end)\n         FastBoundsCheck(input_backprop_index - in_start, in_end - in_start);\n-        input_backprop_flat(input_backprop_index) += out_backprop_flat(index);\n+        if (index < out_backprop.NumElements()) {\n+          input_backprop_flat(input_backprop_index) += out_backprop_flat(index);\n+        }\n       }\n     }\n   };"
        },
        {
            "index":164,
            "vuln_id":"GHSA-2v7p-f4qm-r5pc",
            "cwe_id":"{'CWE-89'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/523a735ab94f004459b84ffdfd3db784586bbd82'}",
            "dataset":"osv",
            "summary":"SQL Injection found in Pimcore Pimcore is an open source data & experience management platform. A SQL injection was discovered in GridHelperService.php in GitHub repository pimcore\/pimcore prior to 10.3.6.",
            "published_date":"2022-04-23",
            "chain_len":1,
            "project":"https:\/\/github.com\/pimcore\/pimcore",
            "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/523a735ab94f004459b84ffdfd3db784586bbd82",
            "commit_sha":"523a735ab94f004459b84ffdfd3db784586bbd82",
            "patch":"SINGLE",
            "chain_ord":"['523a735ab94f004459b84ffdfd3db784586bbd82']",
            "before_first_fix_commit":"{'f29d3b2f305865c6e9884c460fb35bcf21bcf29f'}",
            "last_fix_commit":"523a735ab94f004459b84ffdfd3db784586bbd82",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/22\/2022, 09:05:32",
            "message":"Fixed column quoting in GridHelperService",
            "author":"Bernhard Rusch",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 2, 'total': 7}",
            "files":"{'bundles\/AdminBundle\/Helper\/GridHelperService.php': {'additions': 5, 'deletions': 2, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/523a735ab94f004459b84ffdfd3db784586bbd82\/bundles%2FAdminBundle%2FHelper%2FGridHelperService.php', 'patch': \"@@ -332,12 +332,13 @@ public function getFilterCondition($filterJson, ClassDefinition $class, $tablePr\\n                         } elseif ($filterField == 'id') {\\n                             $conditionPartsFilters[] = 'oo_id ' . $operator . ' ' . $db->quote($filter['value']);\\n                         } else {\\n+                            $filterField = $db->quoteIdentifier('o_' . $filterField);\\n                             if ($filter['type'] == 'date' && $operator == '=') {\\n                                 \/\/if the equal operator is chosen with the date type, condition has to be changed\\n                                 $maxTime = $filter['value'] + (86400 - 1); \/\/specifies the top point of the range used in the condition\\n-                                $conditionPartsFilters[] = '`o_' . $filterField . '` BETWEEN ' . $db->quote($filter['value']) . ' AND ' . $db->quote($maxTime);\\n+                                $conditionPartsFilters[] = $filterField . ' BETWEEN ' . $db->quote($filter['value']) . ' AND ' . $db->quote($maxTime);\\n                             } else {\\n-                                $conditionPartsFilters[] = '`o_' . $filterField . '` ' . $operator . ' ' . $db->quote($filter['value']);\\n+                                $conditionPartsFilters[] = $filterField . ' ' . $operator . ' ' . $db->quote($filter['value']);\\n                             }\\n                         }\\n                     }\\n@@ -780,6 +781,8 @@ public function prepareAssetListingForGrid($allParams, $adminUser)\\n \\n                 if ($filterField == 'fullpath') {\\n                     $filterField = 'CONCAT(path,filename)';\\n+                }else {\\n+                    $filterField = $db->quoteIdentifier($filterField);\\n                 }\\n \\n                 if (isset($filterDef[1]) && $filterDef[1] == 'system') {\"}}",
            "message_norm":"fixed column quoting in gridhelperservice",
            "language":"en",
            "entities":"[('fixed', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['bundles\/AdminBundle\/Helper\/GridHelperService.php'])",
            "num_files":1.0,
            "patch_content":"From 523a735ab94f004459b84ffdfd3db784586bbd82 Mon Sep 17 00:00:00 2001\nFrom: Bernhard Rusch <bernhard.rusch@elements.at>\nDate: Fri, 22 Apr 2022 11:05:32 +0200\nSubject: [PATCH] Fixed column quoting in GridHelperService\n\n---\n bundles\/AdminBundle\/Helper\/GridHelperService.php | 7 +++++--\n 1 file changed, 5 insertions(+), 2 deletions(-)\n\ndiff --git a\/bundles\/AdminBundle\/Helper\/GridHelperService.php b\/bundles\/AdminBundle\/Helper\/GridHelperService.php\nindex 13b6541eced..1ccfe6407fb 100644\n--- a\/bundles\/AdminBundle\/Helper\/GridHelperService.php\n+++ b\/bundles\/AdminBundle\/Helper\/GridHelperService.php\n@@ -332,12 +332,13 @@ public function getFilterCondition($filterJson, ClassDefinition $class, $tablePr\n                         } elseif ($filterField == 'id') {\n                             $conditionPartsFilters[] = 'oo_id ' . $operator . ' ' . $db->quote($filter['value']);\n                         } else {\n+                            $filterField = $db->quoteIdentifier('o_' . $filterField);\n                             if ($filter['type'] == 'date' && $operator == '=') {\n                                 \/\/if the equal operator is chosen with the date type, condition has to be changed\n                                 $maxTime = $filter['value'] + (86400 - 1); \/\/specifies the top point of the range used in the condition\n-                                $conditionPartsFilters[] = '`o_' . $filterField . '` BETWEEN ' . $db->quote($filter['value']) . ' AND ' . $db->quote($maxTime);\n+                                $conditionPartsFilters[] = $filterField . ' BETWEEN ' . $db->quote($filter['value']) . ' AND ' . $db->quote($maxTime);\n                             } else {\n-                                $conditionPartsFilters[] = '`o_' . $filterField . '` ' . $operator . ' ' . $db->quote($filter['value']);\n+                                $conditionPartsFilters[] = $filterField . ' ' . $operator . ' ' . $db->quote($filter['value']);\n                             }\n                         }\n                     }\n@@ -780,6 +781,8 @@ public function prepareAssetListingForGrid($allParams, $adminUser)\n \n                 if ($filterField == 'fullpath') {\n                     $filterField = 'CONCAT(path,filename)';\n+                }else {\n+                    $filterField = $db->quoteIdentifier($filterField);\n                 }\n \n                 if (isset($filterDef[1]) && $filterDef[1] == 'system') {"
        },
        {
            "index":421,
            "vuln_id":"GHSA-qg48-85hg-mqc5",
            "cwe_id":"{'CWE-369'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/da5ff2daf618591f64b2b62d9d9803951b945e9f'}",
            "dataset":"osv",
            "summary":"Division by 0 in `DenseCountSparseOutput` ### Impact\nAn attacker can cause a denial of service via a FPE runtime error in `tf.raw_ops.DenseCountSparseOutput`:\n\n```python\nimport tensorflow as tf\n\nvalues = tf.constant([], shape=[0, 0], dtype=tf.int64)\nweights = tf.constant([])\n\ntf.raw_ops.DenseCountSparseOutput(\n  values=values, weights=weights,\n  minlength=-1, maxlength=58, binary_output=True)\n```\n  \nThis is because the [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/efff014f3b2d8ef6141da30c806faf141297eca1\/tensorflow\/core\/kernels\/count_ops.cc#L123-L127) computes a divisor value from user data but does not check that the result is 0 before doing the division:\n\n```cc\nint num_batch_elements = 1;\nfor (int i = 0; i < num_batch_dimensions; ++i) {\n  num_batch_elements *= data.shape().dim_size(i);\n}\nint num_value_elements = data.shape().num_elements() \/ num_batch_elements;\n```\n\nSince `data` is given by the `values` argument, `num_batch_elements` is 0.\n\n### Patches\nWe have patched the issue in GitHub commit [da5ff2daf618591f64b2b62d9d9803951b945e9f](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/da5ff2daf618591f64b2b62d9d9803951b945e9f).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, and TensorFlow 2.3.3, as these are also affected.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang and Ying Wang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/da5ff2daf618591f64b2b62d9d9803951b945e9f",
            "commit_sha":"da5ff2daf618591f64b2b62d9d9803951b945e9f",
            "patch":"SINGLE",
            "chain_ord":"['da5ff2daf618591f64b2b62d9d9803951b945e9f']",
            "before_first_fix_commit":"{'efff014f3b2d8ef6141da30c806faf141297eca1'}",
            "last_fix_commit":"da5ff2daf618591f64b2b62d9d9803951b945e9f",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/28\/2021, 18:24:45",
            "message":"Fix FPE issue with `tf.raw_ops.DenseCountSparseOutput`.\n\nPiperOrigin-RevId: 370946862\nChange-Id: I3752584ad04aaecb327ff6793a9640ac56acfe7a",
            "author":"Amit Patankar",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
            "files":"{'tensorflow\/core\/kernels\/count_ops.cc': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/da5ff2daf618591f64b2b62d9d9803951b945e9f\/tensorflow%2Fcore%2Fkernels%2Fcount_ops.cc', 'patch': '@@ -122,6 +122,9 @@ class DenseCount : public OpKernel {\\n \\n     int num_batch_elements = 1;\\n     for (int i = 0; i < num_batch_dimensions; ++i) {\\n+      OP_REQUIRES(context, data.shape().dim_size(i) != 0,\\n+                  errors::InvalidArgument(\\n+                      \"Invalid input: Shapes dimension cannot be 0.\"));\\n       num_batch_elements *= data.shape().dim_size(i);\\n     }\\n     int num_value_elements = data.shape().num_elements() \/ num_batch_elements;'}}",
            "message_norm":"fix fpe issue with `tf.raw_ops.densecountsparseoutput`.\n\npiperorigin-revid: 370946862\nchange-id: i3752584ad04aaecb327ff6793a9640ac56acfe7a",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('fpe', 'SECWORD', ''), ('issue', 'FLAW', ''), ('370946862', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/count_ops.cc'])",
            "num_files":1.0,
            "patch_content":"From da5ff2daf618591f64b2b62d9d9803951b945e9f Mon Sep 17 00:00:00 2001\nFrom: Amit Patankar <amitpatankar@google.com>\nDate: Wed, 28 Apr 2021 11:24:45 -0700\nSubject: [PATCH] Fix FPE issue with `tf.raw_ops.DenseCountSparseOutput`.\n\nPiperOrigin-RevId: 370946862\nChange-Id: I3752584ad04aaecb327ff6793a9640ac56acfe7a\n---\n tensorflow\/core\/kernels\/count_ops.cc | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/count_ops.cc b\/tensorflow\/core\/kernels\/count_ops.cc\nindex eeb0b853c7aad2..40aa1fe458c1ee 100644\n--- a\/tensorflow\/core\/kernels\/count_ops.cc\n+++ b\/tensorflow\/core\/kernels\/count_ops.cc\n@@ -122,6 +122,9 @@ class DenseCount : public OpKernel {\n \n     int num_batch_elements = 1;\n     for (int i = 0; i < num_batch_dimensions; ++i) {\n+      OP_REQUIRES(context, data.shape().dim_size(i) != 0,\n+                  errors::InvalidArgument(\n+                      \"Invalid input: Shapes dimension cannot be 0.\"));\n       num_batch_elements *= data.shape().dim_size(i);\n     }\n     int num_value_elements = data.shape().num_elements() \/ num_batch_elements;"
        },
        {
            "index":597,
            "vuln_id":"GHSA-59q2-x2qc-4c97",
            "cwe_id":"{'CWE-125'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/51300ba1cc2f487aefec6e6631fef03b0e08b298'}",
            "dataset":"osv",
            "summary":"Heap OOB access in unicode ops ### Impact\nAn attacker can access data outside of bounds of heap allocated array in `tf.raw_ops.UnicodeEncode`:\n\n```python\nimport tensorflow as tf\n\ninput_values = tf.constant([58], shape=[1], dtype=tf.int32)\ninput_splits = tf.constant([[81, 101, 0]], shape=[3], dtype=tf.int32)\noutput_encoding = \"UTF-8\"\n\ntf.raw_ops.UnicodeEncode(\n    input_values=input_values, input_splits=input_splits,\n    output_encoding=output_encoding)\n```\n\nThis is because the [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/472c1f12ad9063405737679d4f6bd43094e1d36d\/tensorflow\/core\/kernels\/unicode_ops.cc)\nassumes that the `input_value`\/`input_splits` pair specify a valid sparse tensor.\n\n### Patches\nWe have patched the issue in GitHub commit [51300ba1cc2f487aefec6e6631fef03b0e08b298](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/51300ba1cc2f487aefec6e6631fef03b0e08b298).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Ying Wang and Yakun Zhang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/51300ba1cc2f487aefec6e6631fef03b0e08b298",
            "commit_sha":"51300ba1cc2f487aefec6e6631fef03b0e08b298",
            "patch":"SINGLE",
            "chain_ord":"['51300ba1cc2f487aefec6e6631fef03b0e08b298']",
            "before_first_fix_commit":"{'472c1f12ad9063405737679d4f6bd43094e1d36d'}",
            "last_fix_commit":"51300ba1cc2f487aefec6e6631fef03b0e08b298",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/03\/2021, 16:53:26",
            "message":"Fix heap buffer overflow in tf.raw_ops.UnicodeEncode.\n\nPiperOrigin-RevId: 371717714\nChange-Id: If33443b28f158e58078f1268f6b92f2728d219e0",
            "author":"Laura Pak",
            "comments":null,
            "stats":"{'additions': 19, 'deletions': 0, 'total': 19}",
            "files":"{'tensorflow\/core\/kernels\/unicode_ops.cc': {'additions': 19, 'deletions': 0, 'changes': 19, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/51300ba1cc2f487aefec6e6631fef03b0e08b298\/tensorflow%2Fcore%2Fkernels%2Funicode_ops.cc', 'patch': '@@ -533,6 +533,17 @@ class UnicodeEncodeOp : public OpKernel {\\n     const Tensor& input_splits = context->input(1);\\n     const auto input_splits_flat = input_splits.flat<SPLITS_TYPE>();\\n \\n+    \/\/ Operation will treat first argument in input_splits as if it were zero\\n+    \/\/ regardless of its actual value since splits should begin with zero and\\n+    \/\/ end with the length of the input values vector.\\n+    OP_REQUIRES(\\n+        context, input_splits_flat(0) == 0,\\n+        errors::InvalidArgument(\"First value in input_splits must be zero.\"));\\n+    OP_REQUIRES(context,\\n+                input_splits_flat(input_splits_flat.size() - 1) ==\\n+                    input_tensor_flat.size(),\\n+                errors::InvalidArgument(\"Last value in input_splits must be \"\\n+                                        \"equal to length of input_tensor.\"));\\n     \/\/ Since we limit to a 2-D input (flat_values of rank 1 and a single splits\\n     \/\/ tensor), our output dimension will be 1 with it\\'s size equal to the\\n     \/\/ number of splits (outer dimension or ragged tensor).\\n@@ -548,6 +559,14 @@ class UnicodeEncodeOp : public OpKernel {\\n     for (int i = 1; i < input_splits_flat.size(); ++i) {\\n       icu::UnicodeString unicode_string;\\n       icu::UnicodeStringAppendable appendable_unicode_string(unicode_string);\\n+      OP_REQUIRES(\\n+          context, input_splits_flat(i - 1) <= input_splits_flat(i),\\n+          errors::InvalidArgument(\\n+              \"Values in input_splits must be equal or in ascending order.\"));\\n+      OP_REQUIRES(\\n+          context, input_splits_flat(i) <= input_tensor_flat.size(),\\n+          errors::InvalidArgument(\"Values in input_splits must be less than or \"\\n+                                  \"equal to input_tensor length.\"));\\n       for (; idx < input_splits_flat(i); ++idx) {\\n         int32 code_point = input_tensor_flat(idx);\\n         \/\/ Check for invalid code point'}}",
            "message_norm":"fix heap buffer overflow in tf.raw_ops.unicodeencode.\n\npiperorigin-revid: 371717714\nchange-id: if33443b28f158e58078f1268f6b92f2728d219e0",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('buffer overflow', 'SECWORD', ''), ('tf.raw_ops.unicodeencode', 'SECWORD', ''), ('371717714', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/unicode_ops.cc'])",
            "num_files":1.0,
            "patch_content":"From 51300ba1cc2f487aefec6e6631fef03b0e08b298 Mon Sep 17 00:00:00 2001\nFrom: Laura Pak <lpak@google.com>\nDate: Mon, 3 May 2021 09:53:26 -0700\nSubject: [PATCH] Fix heap buffer overflow in tf.raw_ops.UnicodeEncode.\n\nPiperOrigin-RevId: 371717714\nChange-Id: If33443b28f158e58078f1268f6b92f2728d219e0\n---\n tensorflow\/core\/kernels\/unicode_ops.cc | 19 +++++++++++++++++++\n 1 file changed, 19 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/unicode_ops.cc b\/tensorflow\/core\/kernels\/unicode_ops.cc\nindex d3a7ad7b2866f7..e6c8f4dfc42284 100644\n--- a\/tensorflow\/core\/kernels\/unicode_ops.cc\n+++ b\/tensorflow\/core\/kernels\/unicode_ops.cc\n@@ -533,6 +533,17 @@ class UnicodeEncodeOp : public OpKernel {\n     const Tensor& input_splits = context->input(1);\n     const auto input_splits_flat = input_splits.flat<SPLITS_TYPE>();\n \n+    \/\/ Operation will treat first argument in input_splits as if it were zero\n+    \/\/ regardless of its actual value since splits should begin with zero and\n+    \/\/ end with the length of the input values vector.\n+    OP_REQUIRES(\n+        context, input_splits_flat(0) == 0,\n+        errors::InvalidArgument(\"First value in input_splits must be zero.\"));\n+    OP_REQUIRES(context,\n+                input_splits_flat(input_splits_flat.size() - 1) ==\n+                    input_tensor_flat.size(),\n+                errors::InvalidArgument(\"Last value in input_splits must be \"\n+                                        \"equal to length of input_tensor.\"));\n     \/\/ Since we limit to a 2-D input (flat_values of rank 1 and a single splits\n     \/\/ tensor), our output dimension will be 1 with it's size equal to the\n     \/\/ number of splits (outer dimension or ragged tensor).\n@@ -548,6 +559,14 @@ class UnicodeEncodeOp : public OpKernel {\n     for (int i = 1; i < input_splits_flat.size(); ++i) {\n       icu::UnicodeString unicode_string;\n       icu::UnicodeStringAppendable appendable_unicode_string(unicode_string);\n+      OP_REQUIRES(\n+          context, input_splits_flat(i - 1) <= input_splits_flat(i),\n+          errors::InvalidArgument(\n+              \"Values in input_splits must be equal or in ascending order.\"));\n+      OP_REQUIRES(\n+          context, input_splits_flat(i) <= input_tensor_flat.size(),\n+          errors::InvalidArgument(\"Values in input_splits must be less than or \"\n+                                  \"equal to input_tensor length.\"));\n       for (; idx < input_splits_flat(i); ++idx) {\n         int32 code_point = input_tensor_flat(idx);\n         \/\/ Check for invalid code point"
        },
        {
            "index":173,
            "vuln_id":"GHSA-vcjj-9vg7-vf68",
            "cwe_id":"{'CWE-476'}",
            "score":7.8,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/15691e456c7dc9bd6be203b09765b063bf4a380c'}",
            "dataset":"osv",
            "summary":"Null pointer dereference in TFLite ### Impact\nAn attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:\n\n```python\nimport tensorflow as tf\n\nmodel = tf.keras.models.Sequential()\nmodel.add(tf.keras.Input(shape=(1, 2, 3)))\nmodel.add(tf.keras.layers.Dense(0, activation='relu'))\n\nconverter = tf.lite.TFLiteConverter.from_keras_model(model)\ntflite_model = converter.convert()\n\ninterpreter = tf.lite.Interpreter(model_content=tflite_model)\ninterpreter.allocate_tensors()\n\ninterpreter.invoke()\n```\n\nThe [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/149562d49faa709ea80df1d99fc41d005b81082a\/tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h#L268-L285) unconditionally dereferences a pointer.\n\n```cc\n  if (y4 > 1) {\n    \/\/ ...\n  } else {\n    for (int i0 = 0; i0 < y0; ++i0) {\n      const T* input2_data_ptr = nullptr;\n      for (int i1 = 0; i1 < y1; ++i1) {\n        input2_data_ptr = input2_data_reset;\n        for (int i2 = 0; i2 < y2; ++i2) {\n          scalar_broadcast_f(y3, params, *input1_data_ptr, input2_data_ptr,\n                             output_data_ptr);\n        }\n      }\n    }\n  }\n```\n\n### Patches\nWe have patched the issue in GitHub commit [15691e456c7dc9bd6be203b09765b063bf4a380c](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/15691e456c7dc9bd6be203b09765b063bf4a380c).\n\nThe fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang of Baidu Security.",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/15691e456c7dc9bd6be203b09765b063bf4a380c",
            "commit_sha":"15691e456c7dc9bd6be203b09765b063bf4a380c",
            "patch":"SINGLE",
            "chain_ord":"['15691e456c7dc9bd6be203b09765b063bf4a380c']",
            "before_first_fix_commit":"{'c107c1a6cee9afe5f718a48b70ffaa44bece42a2'}",
            "last_fix_commit":"15691e456c7dc9bd6be203b09765b063bf4a380c",
            "chain_ord_pos":1.0,
            "commit_datetime":"07\/28\/2021, 01:40:39",
            "message":"Prevent dereferencing of null pointers in TFLite's `add.cc`.\n\nPiperOrigin-RevId: 387244946\nChange-Id: I56094233327fbd8439b92e1dbb1262176e00eeb9",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/15691e456c7dc9bd6be203b09765b063bf4a380c\/tensorflow%2Flite%2Fkernels%2Finternal%2Foptimized%2Foptimized_ops.h', 'patch': '@@ -265,7 +265,7 @@ inline void BinaryBroadcastFiveFold(const ArithmeticParams& unswitched_params,\\n       \/\/ We have broadcast y2*y3*y4 of input2 data y1 times, and now move on.\\n       input2_data_reset = input2_data_ptr;\\n     }\\n-  } else {\\n+  } else if (input1_data_ptr != nullptr) {\\n     \/\/ Special case of y4 == 1, in which the innermost loop is a single\\n     \/\/ element and can be combined with the next (y3) as an inner broadcast.\\n     \/\/'}}",
            "message_norm":"prevent dereferencing of null pointers in tflite's `add.cc`.\n\npiperorigin-revid: 387244946\nchange-id: i56094233327fbd8439b92e1dbb1262176e00eeb9",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('387244946', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h'])",
            "num_files":1.0,
            "patch_content":"From 15691e456c7dc9bd6be203b09765b063bf4a380c Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 27 Jul 2021 18:40:39 -0700\nSubject: [PATCH] Prevent dereferencing of null pointers in TFLite's `add.cc`.\n\nPiperOrigin-RevId: 387244946\nChange-Id: I56094233327fbd8439b92e1dbb1262176e00eeb9\n---\n tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h b\/tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h\nindex 241405a6bbae19..296b3923a257a9 100644\n--- a\/tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h\n+++ b\/tensorflow\/lite\/kernels\/internal\/optimized\/optimized_ops.h\n@@ -265,7 +265,7 @@ inline void BinaryBroadcastFiveFold(const ArithmeticParams& unswitched_params,\n       \/\/ We have broadcast y2*y3*y4 of input2 data y1 times, and now move on.\n       input2_data_reset = input2_data_ptr;\n     }\n-  } else {\n+  } else if (input1_data_ptr != nullptr) {\n     \/\/ Special case of y4 == 1, in which the innermost loop is a single\n     \/\/ element and can be combined with the next (y3) as an inner broadcast.\n     \/\/"
        },
        {
            "index":514,
            "vuln_id":"GHSA-w2pm-r78h-4m7v",
            "cwe_id":"{'CWE-78'}",
            "score":8.8,
            "chain":"{'https:\/\/github.com\/laravel\/framework\/commit\/44c3feb604944599ad1c782a9942981c3991fa31'}",
            "dataset":"osv",
            "summary":"OS Command Injection in Laravel Framework OS Command injection vulnerability in function link in Filesystem.php in Laravel Framework before 5.8.17.",
            "published_date":"2022-01-06",
            "chain_len":1,
            "project":"https:\/\/github.com\/laravel\/framework",
            "commit_href":"https:\/\/github.com\/laravel\/framework\/commit\/44c3feb604944599ad1c782a9942981c3991fa31",
            "commit_sha":"44c3feb604944599ad1c782a9942981c3991fa31",
            "patch":"SINGLE",
            "chain_ord":"['44c3feb604944599ad1c782a9942981c3991fa31']",
            "before_first_fix_commit":"{'c7a3ca1c6df547a807807ffc782c13b92d44a1ad'}",
            "last_fix_commit":"44c3feb604944599ad1c782a9942981c3991fa31",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/14\/2019, 15:58:33",
            "message":"use escapeshellarg on windows symlink",
            "author":"Taylor Otwell",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'src\/Illuminate\/Filesystem\/Filesystem.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/laravel\/framework\/raw\/44c3feb604944599ad1c782a9942981c3991fa31\/src%2FIlluminate%2FFilesystem%2FFilesystem.php', 'patch': '@@ -254,7 +254,7 @@ public function link($target, $link)\\n \\n         $mode = $this->isDirectory($target) ? \\'J\\' : \\'H\\';\\n \\n-        exec(\"mklink \/{$mode} \\\\\"{$link}\\\\\" \\\\\"{$target}\\\\\"\");\\n+        exec(\"mklink \/{$mode} \".escapeshellarg($link).\" \".escapeshellarg($target));\\n     }\\n \\n     \/**'}}",
            "message_norm":"use escapeshellarg on windows symlink",
            "language":"en",
            "entities":"[('escapeshellarg', 'SECWORD', ''), ('symlink', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/Illuminate\/Filesystem\/Filesystem.php'])",
            "num_files":1.0,
            "patch_content":"From 44c3feb604944599ad1c782a9942981c3991fa31 Mon Sep 17 00:00:00 2001\nFrom: Taylor Otwell <taylor@laravel.com>\nDate: Tue, 14 May 2019 10:58:33 -0500\nSubject: [PATCH] use escapeshellarg on windows symlink\n\n---\n src\/Illuminate\/Filesystem\/Filesystem.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/Illuminate\/Filesystem\/Filesystem.php b\/src\/Illuminate\/Filesystem\/Filesystem.php\nindex d9e3cf77e24..1f99029f7a8 100644\n--- a\/src\/Illuminate\/Filesystem\/Filesystem.php\n+++ b\/src\/Illuminate\/Filesystem\/Filesystem.php\n@@ -254,7 +254,7 @@ public function link($target, $link)\n \n         $mode = $this->isDirectory($target) ? 'J' : 'H';\n \n-        exec(\"mklink \/{$mode} \\\"{$link}\\\" \\\"{$target}\\\"\");\n+        exec(\"mklink \/{$mode} \".escapeshellarg($link).\" \".escapeshellarg($target));\n     }\n \n     \/**"
        },
        {
            "index":649,
            "vuln_id":"GHSA-q485-j897-qc27",
            "cwe_id":"{'CWE-611'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/zhutougg\/c3p0\/commit\/2eb0ea97f745740b18dd45e4a909112d4685f87b'}",
            "dataset":"osv",
            "summary":"Moderate severity vulnerability that affects com.mchange:c3p0 c3p0 0.9.5.2 allows XXE in extractXmlConfigFromInputStream in com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java during initialization.",
            "published_date":"2019-01-07",
            "chain_len":1,
            "project":"https:\/\/github.com\/zhutougg\/c3p0",
            "commit_href":"https:\/\/github.com\/zhutougg\/c3p0\/commit\/2eb0ea97f745740b18dd45e4a909112d4685f87b",
            "commit_sha":"2eb0ea97f745740b18dd45e4a909112d4685f87b",
            "patch":"SINGLE",
            "chain_ord":"['2eb0ea97f745740b18dd45e4a909112d4685f87b']",
            "before_first_fix_commit":"{'6796e1d0951b52897531e4ea62252191dacb17b5'}",
            "last_fix_commit":"2eb0ea97f745740b18dd45e4a909112d4685f87b",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/20\/2018, 13:11:13",
            "message":"Repair XXE vulnerability at initialization",
            "author":"zhutougg",
            "comments":"{'com_1': {'author': 'crazyguyonabike', 'datetime': '01\/09\/2019, 23:26:09', 'body': 'If this actually fixes the CVE, can you do a PR to the original source and\/or make a release?'}, 'com_2': {'author': 'mprins', 'datetime': '02\/21\/2019, 11:17:44', 'body': 'this is resolved in v.0.9.5.3 in a more elegant way, see: https:\/\/github.com\/swaldman\/c3p0\/commit\/7dfdda63f42759a5ec9b63d725b7412f74adb3e1'}}",
            "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
            "files":"{'src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/zhutougg\/c3p0\/raw\/2eb0ea97f745740b18dd45e4a909112d4685f87b\/src%2Fjava%2Fcom%2Fmchange%2Fv2%2Fc3p0%2Fcfg%2FC3P0ConfigXmlUtils.java', 'patch': '@@ -144,6 +144,7 @@ public static C3P0Config extractXmlConfigFromDefaultResource() throws Exception\\n     public static C3P0Config extractXmlConfigFromInputStream(InputStream is) throws Exception\\n     {\\n         DocumentBuilderFactory fact = DocumentBuilderFactory.newInstance();\\n+\\tfact.setExpandEntityReferences(false);\\n         DocumentBuilder db = fact.newDocumentBuilder();\\n         Document doc = db.parse( is );'}}",
            "message_norm":"repair xxe vulnerability at initialization",
            "language":"en",
            "entities":"[('xxe', 'SECWORD', ''), ('vulnerability', 'SECWORD', ''), ('initialization', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java'])",
            "num_files":1.0,
            "patch_content":"From 2eb0ea97f745740b18dd45e4a909112d4685f87b Mon Sep 17 00:00:00 2001\nFrom: zhutougg <zhutougg@secbug.org>\nDate: Thu, 20 Dec 2018 21:11:13 +0800\nSubject: [PATCH] Repair XXE vulnerability at initialization\n\n---\n src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java b\/src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java\nindex 7a0cad0d..bab251ec 100644\n--- a\/src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java\n+++ b\/src\/java\/com\/mchange\/v2\/c3p0\/cfg\/C3P0ConfigXmlUtils.java\n@@ -144,6 +144,7 @@ public static C3P0Config extractXmlConfigFromDefaultResource() throws Exception\n     public static C3P0Config extractXmlConfigFromInputStream(InputStream is) throws Exception\n     {\n         DocumentBuilderFactory fact = DocumentBuilderFactory.newInstance();\n+\tfact.setExpandEntityReferences(false);\n         DocumentBuilder db = fact.newDocumentBuilder();\n         Document doc = db.parse( is );"
        },
        {
            "index":691,
            "vuln_id":"GHSA-cjc7-49v2-jp64",
            "cwe_id":"{'CWE-787', 'CWE-665'}",
            "score":5.3,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/6fd02f44810754ae7481838b6a67c5df7f909ca3', 'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/41727ff06111117bdf86b37db198217fd7a143cc'}",
            "dataset":"osv",
            "summary":"Incomplete validation in `SparseAdd` ### Impact\nIncomplete validation in `SparseAdd` results in allowing attackers to exploit undefined behavior (dereferencing null pointers) as well as write outside of bounds of heap allocated data:\n\n```python\nimport tensorflow as tf\n\na_indices = tf.zeros([10, 97], dtype=tf.int64)\na_values = tf.zeros([10], dtype=tf.int64)\na_shape = tf.zeros([0], dtype=tf.int64)\n\nb_indices = tf.zeros([0, 0], dtype=tf.int64)\nb_values = tf.zeros([0], dtype=tf.int64)\nb_shape = tf.zeros([0], dtype=tf.int64)\n  \nthresh = 0\n\ntf.raw_ops.SparseAdd(a_indices=a_indices,\n                    a_values=a_values,\n                    a_shape=a_shape,\n                    b_indices=b_indices,\n                    b_values=b_values,\n                    b_shape=b_shape,\n                    thresh=thresh)\n```\n\nThe [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/656e7673b14acd7835dc778867f84916c6d1cac2\/tensorflow\/core\/kernels\/sparse_add_op.cc) has a large set of validation for the two sparse tensor inputs (6 tensors in total), but does not validate that the tensors are not empty or that the second dimension of `*_indices` matches the size of corresponding `*_shape`. This allows attackers to send tensor triples that represent invalid sparse tensors to abuse code assumptions that are not protected by validation.\n\n### Patches\nWe have patched the issue in GitHub commit [6fd02f44810754ae7481838b6a67c5df7f909ca3](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/6fd02f44810754ae7481838b6a67c5df7f909ca3) followed by GitHub commit  [41727ff06111117bdf86b37db198217fd7a143cc](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/41727ff06111117bdf86b37db198217fd7a143cc).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang and Ying Wang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":2,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/6fd02f44810754ae7481838b6a67c5df7f909ca3",
            "commit_sha":"6fd02f44810754ae7481838b6a67c5df7f909ca3",
            "patch":"MULTI",
            "chain_ord":"['6fd02f44810754ae7481838b6a67c5df7f909ca3', '41727ff06111117bdf86b37db198217fd7a143cc']",
            "before_first_fix_commit":"{'6f432d6334edc93fd5af0070170def56b0413e8a'}",
            "last_fix_commit":"41727ff06111117bdf86b37db198217fd7a143cc",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/26\/2021, 23:40:49",
            "message":"Fix `tf.raw_ops.SparseAdd ` invalid memory access failure.\n\nPiperOrigin-RevId: 370568774\nChange-Id: I5f73b31c865f2948a1c8dfb7ebd22b3cfb6405bf",
            "author":"Amit Patankar",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
            "files":"{'tensorflow\/core\/kernels\/sparse_add_op.cc': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/6fd02f44810754ae7481838b6a67c5df7f909ca3\/tensorflow%2Fcore%2Fkernels%2Fsparse_add_op.cc', 'patch': '@@ -14,6 +14,7 @@ limitations under the License.\\n ==============================================================================*\/\\n \\n #include \"tensorflow\/core\/framework\/op_kernel.h\"\\n+#include \"tensorflow\/core\/framework\/op_requires.h\"\\n #include \"tensorflow\/core\/framework\/register_types.h\"\\n #include \"tensorflow\/core\/framework\/tensor.h\"\\n #include \"tensorflow\/core\/framework\/tensor_util.h\"\\n@@ -101,6 +102,10 @@ class SparseAddOp : public OpKernel {\\n     std::vector<T> out_values;\\n     const int num_dims = a_shape->dim_size(0);\\n \\n+    OP_REQUIRES(ctx, num_dims > 0,\\n+                errors::InvalidArgument(\"Invalid input_a shape. Received: \",\\n+                                        a_shape->DebugString()));\\n+\\n     \/\/ The input and output sparse tensors are assumed to be ordered along\\n     \/\/ increasing dimension number.\\n     int64 i = 0, j = 0;'}}",
            "message_norm":"fix `tf.raw_ops.sparseadd ` invalid memory access failure.\n\npiperorigin-revid: 370568774\nchange-id: i5f73b31c865f2948a1c8dfb7ebd22b3cfb6405bf",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('invalid memory access', 'SECWORD', ''), ('370568774', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/sparse_add_op.cc'])",
            "num_files":1.0,
            "patch_content":"From 6fd02f44810754ae7481838b6a67c5df7f909ca3 Mon Sep 17 00:00:00 2001\nFrom: Amit Patankar <amitpatankar@google.com>\nDate: Mon, 26 Apr 2021 16:40:49 -0700\nSubject: [PATCH] Fix `tf.raw_ops.SparseAdd ` invalid memory access failure.\n\nPiperOrigin-RevId: 370568774\nChange-Id: I5f73b31c865f2948a1c8dfb7ebd22b3cfb6405bf\n---\n tensorflow\/core\/kernels\/sparse_add_op.cc | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/tensorflow\/core\/kernels\/sparse_add_op.cc b\/tensorflow\/core\/kernels\/sparse_add_op.cc\nindex 0cf40a709a39a7..346206365af8d5 100644\n--- a\/tensorflow\/core\/kernels\/sparse_add_op.cc\n+++ b\/tensorflow\/core\/kernels\/sparse_add_op.cc\n@@ -14,6 +14,7 @@ limitations under the License.\n ==============================================================================*\/\n \n #include \"tensorflow\/core\/framework\/op_kernel.h\"\n+#include \"tensorflow\/core\/framework\/op_requires.h\"\n #include \"tensorflow\/core\/framework\/register_types.h\"\n #include \"tensorflow\/core\/framework\/tensor.h\"\n #include \"tensorflow\/core\/framework\/tensor_util.h\"\n@@ -101,6 +102,10 @@ class SparseAddOp : public OpKernel {\n     std::vector<T> out_values;\n     const int num_dims = a_shape->dim_size(0);\n \n+    OP_REQUIRES(ctx, num_dims > 0,\n+                errors::InvalidArgument(\"Invalid input_a shape. Received: \",\n+                                        a_shape->DebugString()));\n+\n     \/\/ The input and output sparse tensors are assumed to be ordered along\n     \/\/ increasing dimension number.\n     int64 i = 0, j = 0;"
        },
        {
            "index":868,
            "vuln_id":"GHSA-934w-hvj4-7fr6",
            "cwe_id":"{'CWE-22'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/jsreport\/jsreport-chrome-pdf\/commit\/6750b2f77d05cb843aefc1c4a98097a3bd33a6a2'}",
            "dataset":"osv",
            "summary":"Path Traversal in jsreport-chrome-pdf This affects the package jsreport-chrome-pdf before 1.10.0.",
            "published_date":"2021-04-13",
            "chain_len":1,
            "project":"https:\/\/github.com\/jsreport\/jsreport-chrome-pdf",
            "commit_href":"https:\/\/github.com\/jsreport\/jsreport-chrome-pdf\/commit\/6750b2f77d05cb843aefc1c4a98097a3bd33a6a2",
            "commit_sha":"6750b2f77d05cb843aefc1c4a98097a3bd33a6a2",
            "patch":"SINGLE",
            "chain_ord":"['6750b2f77d05cb843aefc1c4a98097a3bd33a6a2']",
            "before_first_fix_commit":"{'ba51764dae68403893f9f0e0ce7d060b78ee26c4'}",
            "last_fix_commit":"6750b2f77d05cb843aefc1c4a98097a3bd33a6a2",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/30\/2020, 16:09:42",
            "message":"block file requests",
            "author":"BJR Matos",
            "comments":null,
            "stats":"{'additions': 19, 'deletions': 0, 'total': 19}",
            "files":"{'lib\/conversion.js': {'additions': 19, 'deletions': 0, 'changes': 19, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jsreport\/jsreport-chrome-pdf\/raw\/6750b2f77d05cb843aefc1c4a98097a3bd33a6a2\/lib%2Fconversion.js', 'patch': \"@@ -38,6 +38,12 @@ module.exports = async ({ reporter, getBrowser, htmlUrl, strategy, timeout, req,\\n       return\\n     }\\n \\n+    await page.setRequestInterception(true)\\n+\\n+    if (executionInfo.error) {\\n+      return\\n+    }\\n+\\n     page.on('pageerror', (err) => {\\n       pageLog('warn', `Page error: ${err.message}${err.stack ? ` , stack: ${err.stack}` : ''}`)\\n     })\\n@@ -64,6 +70,19 @@ module.exports = async ({ reporter, getBrowser, htmlUrl, strategy, timeout, req,\\n       }\\n \\n       pageLog('debug', `Page request: ${r.method()} (${r.resourceType()}) ${trimUrl(r.url())}${detail}`)\\n+\\n+      const isRelativeToHtmlUrl = r.url().lastIndexOf(htmlUrl, 0) === 0\\n+\\n+      if (\\n+        !isRelativeToHtmlUrl &&\\n+        \/\/ potentially dangerous request to local file\\n+        r.url().lastIndexOf('file:\/\/\/', 0) === 0\\n+      ) {\\n+        r.abort('accessdenied')\\n+        return\\n+      }\\n+\\n+      r.continue()\\n     })\\n \\n     page.on('requestfinished', (r) => {\"}}",
            "message_norm":"block file requests",
            "language":"fr",
            "entities":null,
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/conversion.js'])",
            "num_files":1.0,
            "patch_content":"From 6750b2f77d05cb843aefc1c4a98097a3bd33a6a2 Mon Sep 17 00:00:00 2001\nFrom: BJR Matos <bjrmatos@gmail.com>\nDate: Fri, 30 Oct 2020 11:09:42 -0500\nSubject: [PATCH] block file requests\n\n---\n lib\/conversion.js | 19 +++++++++++++++++++\n 1 file changed, 19 insertions(+)\n\ndiff --git a\/lib\/conversion.js b\/lib\/conversion.js\nindex 3a76d3b..747256d 100644\n--- a\/lib\/conversion.js\n+++ b\/lib\/conversion.js\n@@ -38,6 +38,12 @@ module.exports = async ({ reporter, getBrowser, htmlUrl, strategy, timeout, req,\n       return\n     }\n \n+    await page.setRequestInterception(true)\n+\n+    if (executionInfo.error) {\n+      return\n+    }\n+\n     page.on('pageerror', (err) => {\n       pageLog('warn', `Page error: ${err.message}${err.stack ? ` , stack: ${err.stack}` : ''}`)\n     })\n@@ -64,6 +70,19 @@ module.exports = async ({ reporter, getBrowser, htmlUrl, strategy, timeout, req,\n       }\n \n       pageLog('debug', `Page request: ${r.method()} (${r.resourceType()}) ${trimUrl(r.url())}${detail}`)\n+\n+      const isRelativeToHtmlUrl = r.url().lastIndexOf(htmlUrl, 0) === 0\n+\n+      if (\n+        !isRelativeToHtmlUrl &&\n+        \/\/ potentially dangerous request to local file\n+        r.url().lastIndexOf('file:\/\/\/', 0) === 0\n+      ) {\n+        r.abort('accessdenied')\n+        return\n+      }\n+\n+      r.continue()\n     })\n \n     page.on('requestfinished', (r) => {"
        },
        {
            "index":662,
            "vuln_id":"GHSA-jx5q-g37m-h5hj",
            "cwe_id":"{'CWE-74', 'CWE-1321'}",
            "score":5.3,
            "chain":"{'https:\/\/github.com\/oroinc\/platform\/commit\/62c26936b3adee9c20255dcd9f8ee5c299b464a9'}",
            "dataset":"osv",
            "summary":"Client-Side JavaScript Prototype Pollution in oro\/platform ### Summary\n\nBy sending a specially crafted request, an attacker could inject properties into existing JavaScript language construct prototypes, such as objects. Later this injection may lead to JS code execution by libraries that are vulnerable to Prototype Pollution.\n\n### Workarounds\n\nConfigure WAF to drop requests containing next strings: `__proto__` , `constructor[prototype]`, `constructor.prototype`",
            "published_date":"2022-01-06",
            "chain_len":1,
            "project":"https:\/\/github.com\/oroinc\/platform",
            "commit_href":"https:\/\/github.com\/oroinc\/platform\/commit\/62c26936b3adee9c20255dcd9f8ee5c299b464a9",
            "commit_sha":"62c26936b3adee9c20255dcd9f8ee5c299b464a9",
            "patch":"SINGLE",
            "chain_ord":"['62c26936b3adee9c20255dcd9f8ee5c299b464a9']",
            "before_first_fix_commit":"{'d9929d4085f4e38d05c4e4b02c7d4c15de84f88c'}",
            "last_fix_commit":"62c26936b3adee9c20255dcd9f8ee5c299b464a9",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/24\/2021, 15:40:19",
            "message":"BAP-21092: JavaScript Prototype Pollution (#31464)",
            "author":"Hryhorii Hrebiniuk",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/oroinc\/platform\/raw\/62c26936b3adee9c20255dcd9f8ee5c299b464a9\/src%2FOro%2FBundle%2FUIBundle%2FResources%2Fpublic%2Fjs%2Ftools.js', 'patch': \"@@ -85,6 +85,10 @@ define(function(require) {\\n                 query = query.slice(1);\\n             }\\n             const setValue = function(root, path, value) {\\n+                if (path[0] === '__proto__') {\\n+                    \/\/ Prevent Object.prototype pollution\\n+                    return;\\n+                }\\n                 if (path.length > 1) {\\n                     const dir = path.shift();\\n                     if (typeof root[dir] === 'undefined') {\"}}",
            "message_norm":"bap-21092: javascript prototype pollution (#31464)",
            "language":"fr",
            "entities":"[('prototype pollution', 'SECWORD', ''), ('#31464', 'ISSUE', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js'])",
            "num_files":1.0,
            "patch_content":"From 62c26936b3adee9c20255dcd9f8ee5c299b464a9 Mon Sep 17 00:00:00 2001\nFrom: Hryhorii Hrebiniuk <hhrebiniuk@oroinc.com>\nDate: Fri, 24 Dec 2021 17:40:19 +0200\nSubject: [PATCH] BAP-21092: JavaScript Prototype Pollution (#31464)\n\n---\n src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js b\/src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js\nindex ededa96a81a..93096aa748c 100644\n--- a\/src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js\n+++ b\/src\/Oro\/Bundle\/UIBundle\/Resources\/public\/js\/tools.js\n@@ -85,6 +85,10 @@ define(function(require) {\n                 query = query.slice(1);\n             }\n             const setValue = function(root, path, value) {\n+                if (path[0] === '__proto__') {\n+                    \/\/ Prevent Object.prototype pollution\n+                    return;\n+                }\n                 if (path.length > 1) {\n                     const dir = path.shift();\n                     if (typeof root[dir] === 'undefined') {"
        },
        {
            "index":529,
            "vuln_id":"GHSA-428x-9xc2-m8mj",
            "cwe_id":"{'CWE-369'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/e5b0eec199c2d03de54fd6a7fd9275692218e2bc'}",
            "dataset":"osv",
            "summary":"Division by zero in TFLite ### Impact \nAn attacker can craft a TFLite model that would trigger a division by zero in [the implementation of depthwise convolutions](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/5100e359aef5c8021f2e71c7b986420b85ce7b3d\/tensorflow\/lite\/kernels\/depthwise_conv.cc#L96).\n\nThe parameters of the convolution can be user controlled and are also used within a division operation to determine the size of the padding that needs to be added before applying the convolution. There is no check before this division that the divisor is stricly positive.\n\n### Patches              \nWe have patched the issue in GitHub commit [e5b0eec199c2d03de54fd6a7fd9275692218e2bc](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/e5b0eec199c2d03de54fd6a7fd9275692218e2bc).\n  \nThe fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.\n  \n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n  \n### Attribution\nThis vulnerability has been reported by Wang Xuan of Qihoo 360 AIVul Team.",
            "published_date":"2022-02-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/e5b0eec199c2d03de54fd6a7fd9275692218e2bc",
            "commit_sha":"e5b0eec199c2d03de54fd6a7fd9275692218e2bc",
            "patch":"SINGLE",
            "chain_ord":"['e5b0eec199c2d03de54fd6a7fd9275692218e2bc']",
            "before_first_fix_commit":"{'ece78f4001dd87f50daab1d1b43f70a51726b8fb'}",
            "last_fix_commit":"e5b0eec199c2d03de54fd6a7fd9275692218e2bc",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/15\/2021, 01:04:19",
            "message":"[lite] Add validation check for dilation height\/width to be positive integers.\n\nPiperOrigin-RevId: 416429178\nChange-Id: If7cdcddca54486434d9b2f06e7e2b401d7c3ee25",
            "author":"Karim Nosir",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
            "files":"{'tensorflow\/lite\/kernels\/depthwise_conv.cc': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/e5b0eec199c2d03de54fd6a7fd9275692218e2bc\/tensorflow%2Flite%2Fkernels%2Fdepthwise_conv.cc', 'patch': '@@ -115,6 +115,8 @@ TfLiteStatus Prepare(TfLiteContext* context, TfLiteNode* node) {\\n \\n   TF_LITE_ENSURE_EQ(context, NumDimensions(input), 4);\\n   TF_LITE_ENSURE_EQ(context, NumDimensions(filter), 4);\\n+  TF_LITE_ENSURE(context, params->dilation_height_factor > 0);\\n+  TF_LITE_ENSURE(context, params->dilation_width_factor > 0);\\n \\n   const TfLiteType data_type = input->type;'}}",
            "message_norm":"[lite] add validation check for dilation height\/width to be positive integers.\n\npiperorigin-revid: 416429178\nchange-id: if7cdcddca54486434d9b2f06e7e2b401d7c3ee25",
            "language":"en",
            "entities":"[('add', 'ACTION', ''), ('416429178', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/kernels\/depthwise_conv.cc'])",
            "num_files":1.0,
            "patch_content":"From e5b0eec199c2d03de54fd6a7fd9275692218e2bc Mon Sep 17 00:00:00 2001\nFrom: Karim Nosir <karimnosseir@google.com>\nDate: Tue, 14 Dec 2021 17:04:19 -0800\nSubject: [PATCH] [lite] Add validation check for dilation height\/width to be\n positive integers.\n\nPiperOrigin-RevId: 416429178\nChange-Id: If7cdcddca54486434d9b2f06e7e2b401d7c3ee25\n---\n tensorflow\/lite\/kernels\/depthwise_conv.cc | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/tensorflow\/lite\/kernels\/depthwise_conv.cc b\/tensorflow\/lite\/kernels\/depthwise_conv.cc\nindex 060b0827dafa74..e1a54adcc7fd05 100644\n--- a\/tensorflow\/lite\/kernels\/depthwise_conv.cc\n+++ b\/tensorflow\/lite\/kernels\/depthwise_conv.cc\n@@ -115,6 +115,8 @@ TfLiteStatus Prepare(TfLiteContext* context, TfLiteNode* node) {\n \n   TF_LITE_ENSURE_EQ(context, NumDimensions(input), 4);\n   TF_LITE_ENSURE_EQ(context, NumDimensions(filter), 4);\n+  TF_LITE_ENSURE(context, params->dilation_height_factor > 0);\n+  TF_LITE_ENSURE(context, params->dilation_width_factor > 0);\n \n   const TfLiteType data_type = input->type;"
        },
        {
            "index":814,
            "vuln_id":"GHSA-r626-fc64-3q28",
            "cwe_id":"{'CWE-362', 'CWE-119'}",
            "score":8.1,
            "chain":"{'https:\/\/github.com\/SonicFrog\/abox\/commit\/34c2b9e51cd7b85a3366104092ca4e5e9fab227d'}",
            "dataset":"osv",
            "summary":"Data race in abox An issue was discovered in the abox crate before 0.4.1 for Rust. \n\nAffected versions of this crate implements `Send`\/`Sync` for `AtomicBox<T>` without requiring `T: Send`\/`T: Sync`. This allows to create data races to `T: !Sync` and send `T: !Send` to another thread.\n\nSuch behavior breaks the compile-time thread safety guarantees of Rust, and allows users to incur undefined behavior using safe Rust (e.g. memory corruption from data race).\n\nThe flaw was corrected in commit 34c2b9e by adding trait bound `T: Send` to `Send` impl for `AtomicBox<T>` and trait bound `T: Sync` to `Sync` impl for `AtomicBox<T>`.",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/SonicFrog\/abox",
            "commit_href":"https:\/\/github.com\/SonicFrog\/abox\/commit\/34c2b9e51cd7b85a3366104092ca4e5e9fab227d",
            "commit_sha":"34c2b9e51cd7b85a3366104092ca4e5e9fab227d",
            "patch":"SINGLE",
            "chain_ord":"['34c2b9e51cd7b85a3366104092ca4e5e9fab227d']",
            "before_first_fix_commit":"{'5abe75222bc49af6b62ea37f87d7be0c56973310'}",
            "last_fix_commit":"34c2b9e51cd7b85a3366104092ca4e5e9fab227d",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/23\/2021, 02:40:32",
            "message":"send\/sync fix to prevent misuse",
            "author":"JOE1994",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
            "files":"{'src\/lib.rs': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/SonicFrog\/abox\/raw\/34c2b9e51cd7b85a3366104092ca4e5e9fab227d\/src%2Flib.rs', 'patch': '@@ -89,8 +89,8 @@ impl<T: Sized> Drop for AtomicBox<T> {\\n     }\\n }\\n \\n-unsafe impl<T: Sized> Sync for AtomicBox<T> {}\\n-unsafe impl<T: Sized> Send for AtomicBox<T> {}\\n+unsafe impl<T: Sized + Sync> Sync for AtomicBox<T> {}\\n+unsafe impl<T: Sized + Send> Send for AtomicBox<T> {}\\n \\n #[cfg(test)]\\n mod tests {'}}",
            "message_norm":"send\/sync fix to prevent misuse",
            "language":"en",
            "entities":"[('prevent', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/lib.rs'])",
            "num_files":1.0,
            "patch_content":"From 34c2b9e51cd7b85a3366104092ca4e5e9fab227d Mon Sep 17 00:00:00 2001\nFrom: JOE1994 <joseph942010@gmail.com>\nDate: Fri, 22 Jan 2021 21:40:32 -0500\nSubject: [PATCH] send\/sync fix to prevent misuse\n\n---\n src\/lib.rs | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/lib.rs b\/src\/lib.rs\nindex c4f1cbe..c5a1c11 100755\n--- a\/src\/lib.rs\n+++ b\/src\/lib.rs\n@@ -89,8 +89,8 @@ impl<T: Sized> Drop for AtomicBox<T> {\n     }\n }\n \n-unsafe impl<T: Sized> Sync for AtomicBox<T> {}\n-unsafe impl<T: Sized> Send for AtomicBox<T> {}\n+unsafe impl<T: Sized + Sync> Sync for AtomicBox<T> {}\n+unsafe impl<T: Sized + Send> Send for AtomicBox<T> {}\n \n #[cfg(test)]\n mod tests {"
        },
        {
            "index":29,
            "vuln_id":"GHSA-8w3x-r6x7-c5r5",
            "cwe_id":"{'CWE-79'}",
            "score":6.1,
            "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/3c2a14e676a57e5d77a16255965988eef48f9065'}",
            "dataset":"osv",
            "summary":"Cross-site Scripting in pimcore pimcore is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
            "published_date":"2021-12-16",
            "chain_len":1,
            "project":"https:\/\/github.com\/pimcore\/pimcore",
            "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/3c2a14e676a57e5d77a16255965988eef48f9065",
            "commit_sha":"3c2a14e676a57e5d77a16255965988eef48f9065",
            "patch":"SINGLE",
            "chain_ord":"['3c2a14e676a57e5d77a16255965988eef48f9065']",
            "before_first_fix_commit":"{'a5e13bea6315b7bee8fb44f83a38029d065f97a3'}",
            "last_fix_commit":"3c2a14e676a57e5d77a16255965988eef48f9065",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/09\/2021, 11:53:00",
            "message":"[Admin UI] DataObject Class - escape general settings input values (#10991)\n\n* [Admin UI] DataObject Class - escape general settings input values\r\n\r\n* Update bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\r\n\r\n* [Admin UI] DataObject Class - escape general settings input values\r\n\r\n* [Admin UI] DataObject Class - escape general settings input values",
            "author":"Divesh Pahuja",
            "comments":null,
            "stats":"{'additions': 20, 'deletions': 1, 'total': 21}",
            "files":"{'bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js': {'additions': 20, 'deletions': 1, 'changes': 21, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/3c2a14e676a57e5d77a16255965988eef48f9065\/bundles%2FAdminBundle%2FResources%2Fpublic%2Fjs%2Fpimcore%2Fobject%2Fclasses%2Fclass.js', 'patch': '@@ -607,7 +607,12 @@ pimcore.object.classes.klass = Class.create({\\n                 for (var i = 0; i < items.length; i++) {\\n                     var item = items[i];\\n                     if (typeof item.getValue == \"function\") {\\n-                        this.data[item.name] = item.getValue();\\n+                        let value = item.getValue();\\n+                        if (typeof item.config.xtype !== \\'undefined\\' && item.config.xtype === \\'textfield\\') {\\n+                            value = Ext.util.Format.htmlEncode(value);\\n+                        }\\n+\\n+                        this.data[item.name] = value;\\n                     }\\n                 }\\n \\n@@ -705,6 +710,7 @@ pimcore.object.classes.klass = Class.create({\\n             id: \"iconfield-\" + this.getId(),\\n             name: \"icon\",\\n             width: 396,\\n+            renderer: Ext.util.Format.htmlEncode,\\n             value: this.data.icon,\\n             listeners: {\\n                 \"afterrender\": function (el) {\\n@@ -752,6 +758,7 @@ pimcore.object.classes.klass = Class.create({\\n                     width: 500,\\n                     enableKeyEvents: true,\\n                     value: this.data.name,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     listeners: {\\n                         keyup: function (el) {\\n                             this.rootPanel.getComponent(\"phpClassName\").setValue(getPhpClassName(el.getValue()))\\n@@ -763,12 +770,14 @@ pimcore.object.classes.klass = Class.create({\\n                     fieldLabel: t(\"description\"),\\n                     name: \"description\",\\n                     width: 500,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.description\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"unique_identifier\"),\\n                     disabled: true,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.id,\\n                     width: 500\\n                 },\\n@@ -779,62 +788,71 @@ pimcore.object.classes.klass = Class.create({\\n                     itemId: \"phpClassName\",\\n                     width: 500,\\n                     disabled: true,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: getPhpClassName(this.data.name)\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"parent_php_class\"),\\n                     name: \"parentClass\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.parentClass\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     width: 600,\\n                     name: \"implementsInterfaces\",\\n                     fieldLabel: t(\"implements_interfaces\"),\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.implementsInterfaces\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"use_traits\"),\\n                     name: \"useTraits\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.useTraits\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"listing_parent_php_class\"),\\n                     name: \"listingParentClass\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.listingParentClass\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"listing_use_traits\"),\\n                     name: \"listingUseTraits\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.listingUseTraits\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"link_generator_reference\"),\\n                     name: \"linkGeneratorReference\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.linkGeneratorReference\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"preview_generator_reference\"),\\n                     name: \"previewGeneratorReference\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.previewGeneratorReference\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"preview_url\"),\\n                     name: \"previewUrl\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.previewUrl\\n                 },\\n                 {\\n@@ -885,6 +903,7 @@ pimcore.object.classes.klass = Class.create({\\n                     fieldLabel: t(\"group\"),\\n                     name: \"group\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.group\\n                 },\\n                 this.allowInheritance,'}}",
            "message_norm":"[admin ui] dataobject class - escape general settings input values (#10991)\n\n* [admin ui] dataobject class - escape general settings input values\r\n\r\n* update bundles\/adminbundle\/resources\/public\/js\/pimcore\/object\/classes\/class.js\r\n\r\n* [admin ui] dataobject class - escape general settings input values\r\n\r\n* [admin ui] dataobject class - escape general settings input values",
            "language":"ca",
            "entities":"[('admin', 'SECWORD', ''), ('escape', 'SECWORD', ''), ('#10991', 'ISSUE', ''), ('admin', 'SECWORD', ''), ('escape', 'SECWORD', ''), ('update', 'ACTION', ''), ('adminbundle', 'SECWORD', ''), ('admin', 'SECWORD', ''), ('escape', 'SECWORD', ''), ('admin', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js'])",
            "num_files":1.0,
            "patch_content":"From 3c2a14e676a57e5d77a16255965988eef48f9065 Mon Sep 17 00:00:00 2001\nFrom: Divesh Pahuja <divesh.pahuja@pimcore.com>\nDate: Thu, 9 Dec 2021 12:53:00 +0100\nSubject: [PATCH] [Admin UI] DataObject Class - escape general settings input\n values (#10991)\n\n* [Admin UI] DataObject Class - escape general settings input values\n\n* Update bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\n\n* [Admin UI] DataObject Class - escape general settings input values\n\n* [Admin UI] DataObject Class - escape general settings input values\n---\n ...\/public\/js\/pimcore\/object\/classes\/class.js | 21 ++++++++++++++++++-\n 1 file changed, 20 insertions(+), 1 deletion(-)\n\ndiff --git a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\nindex a712aa67ce3..ad66b07cb57 100644\n--- a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\n+++ b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\n@@ -607,7 +607,12 @@ pimcore.object.classes.klass = Class.create({\n                 for (var i = 0; i < items.length; i++) {\n                     var item = items[i];\n                     if (typeof item.getValue == \"function\") {\n-                        this.data[item.name] = item.getValue();\n+                        let value = item.getValue();\n+                        if (typeof item.config.xtype !== 'undefined' && item.config.xtype === 'textfield') {\n+                            value = Ext.util.Format.htmlEncode(value);\n+                        }\n+\n+                        this.data[item.name] = value;\n                     }\n                 }\n \n@@ -705,6 +710,7 @@ pimcore.object.classes.klass = Class.create({\n             id: \"iconfield-\" + this.getId(),\n             name: \"icon\",\n             width: 396,\n+            renderer: Ext.util.Format.htmlEncode,\n             value: this.data.icon,\n             listeners: {\n                 \"afterrender\": function (el) {\n@@ -752,6 +758,7 @@ pimcore.object.classes.klass = Class.create({\n                     width: 500,\n                     enableKeyEvents: true,\n                     value: this.data.name,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     listeners: {\n                         keyup: function (el) {\n                             this.rootPanel.getComponent(\"phpClassName\").setValue(getPhpClassName(el.getValue()))\n@@ -763,12 +770,14 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"description\"),\n                     name: \"description\",\n                     width: 500,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.description\n                 },\n                 {\n                     xtype: \"textfield\",\n                     fieldLabel: t(\"unique_identifier\"),\n                     disabled: true,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.id,\n                     width: 500\n                 },\n@@ -779,6 +788,7 @@ pimcore.object.classes.klass = Class.create({\n                     itemId: \"phpClassName\",\n                     width: 500,\n                     disabled: true,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: getPhpClassName(this.data.name)\n                 },\n                 {\n@@ -786,6 +796,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"parent_php_class\"),\n                     name: \"parentClass\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.parentClass\n                 },\n                 {\n@@ -793,6 +804,7 @@ pimcore.object.classes.klass = Class.create({\n                     width: 600,\n                     name: \"implementsInterfaces\",\n                     fieldLabel: t(\"implements_interfaces\"),\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.implementsInterfaces\n                 },\n                 {\n@@ -800,6 +812,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"use_traits\"),\n                     name: \"useTraits\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.useTraits\n                 },\n                 {\n@@ -807,6 +820,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"listing_parent_php_class\"),\n                     name: \"listingParentClass\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.listingParentClass\n                 },\n                 {\n@@ -814,6 +828,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"listing_use_traits\"),\n                     name: \"listingUseTraits\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.listingUseTraits\n                 },\n                 {\n@@ -821,6 +836,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"link_generator_reference\"),\n                     name: \"linkGeneratorReference\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.linkGeneratorReference\n                 },\n                 {\n@@ -828,6 +844,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"preview_generator_reference\"),\n                     name: \"previewGeneratorReference\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.previewGeneratorReference\n                 },\n                 {\n@@ -835,6 +852,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"preview_url\"),\n                     name: \"previewUrl\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.previewUrl\n                 },\n                 {\n@@ -885,6 +903,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"group\"),\n                     name: \"group\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.group\n                 },\n                 this.allowInheritance,"
        },
        {
            "index":233,
            "vuln_id":"GHSA-hf2m-j98r-4fqw",
            "cwe_id":"{'CWE-287'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/NodeBB\/NodeBB\/commit\/04dab1d550cdebf4c1567bca9a51f8b9ca48a500'}",
            "dataset":"osv",
            "summary":"API token verification can be bypassed in NodeBB  ### Impact\nIncorrect logic present in the token verification step unintentionally allowed master token access to the API.\n\n### Patches\nThe vulnerability has been patch as of v1.18.5.\n\n### Workarounds\nCherry-pick commit hash 04dab1d550cdebf4c1567bca9a51f8b9ca48a500 to receive this patch in lieu of a full upgrade.\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at [security@nodebb.org](mailto:security@nodebb.org)",
            "published_date":"2021-11-30",
            "chain_len":1,
            "project":"https:\/\/github.com\/NodeBB\/NodeBB",
            "commit_href":"https:\/\/github.com\/NodeBB\/NodeBB\/commit\/04dab1d550cdebf4c1567bca9a51f8b9ca48a500",
            "commit_sha":"04dab1d550cdebf4c1567bca9a51f8b9ca48a500",
            "patch":"SINGLE",
            "chain_ord":"['04dab1d550cdebf4c1567bca9a51f8b9ca48a500']",
            "before_first_fix_commit":"{'1783f918bc19568f421473824461ff2ed7755e4c'}",
            "last_fix_commit":"04dab1d550cdebf4c1567bca9a51f8b9ca48a500",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/25\/2021, 17:23:54",
            "message":"fix: token verify",
            "author":"Bar\u0131\u015f Soner U\u015fakl\u0131",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 7, 'total': 10}",
            "files":"{'src\/routes\/authentication.js': {'additions': 3, 'deletions': 7, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/NodeBB\/NodeBB\/raw\/04dab1d550cdebf4c1567bca9a51f8b9ca48a500\/src%2Froutes%2Fauthentication.js', 'patch': \"@@ -44,13 +44,9 @@ Auth.getLoginStrategies = function () {\\n };\\n \\n Auth.verifyToken = async function (token, done) {\\n-\\tlet { tokens = [] } = await meta.settings.get('core.api');\\n-\\ttokens = tokens.reduce((memo, cur) => {\\n-\\t\\tmemo[cur.token] = cur.uid;\\n-\\t\\treturn memo;\\n-\\t}, {});\\n-\\n-\\tconst uid = tokens[token];\\n+\\tconst { tokens = [] } = await meta.settings.get('core.api');\\n+\\tconst tokenObj = tokens.find(t => t.token === token);\\n+\\tconst uid = tokenObj ? tokenObj.uid : undefined;\\n \\n \\tif (uid !== undefined) {\\n \\t\\tif (parseInt(uid, 10) > 0) {\"}}",
            "message_norm":"fix: token verify",
            "language":"no",
            "entities":null,
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/routes\/authentication.js'])",
            "num_files":1.0,
            "patch_content":"From 04dab1d550cdebf4c1567bca9a51f8b9ca48a500 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Bar=C4=B1=C5=9F=20Soner=20U=C5=9Fakl=C4=B1?=\n <barisusakli@gmail.com>\nDate: Mon, 25 Oct 2021 13:23:54 -0400\nSubject: [PATCH] fix: token verify\n\n---\n src\/routes\/authentication.js | 10 +++-------\n 1 file changed, 3 insertions(+), 7 deletions(-)\n\ndiff --git a\/src\/routes\/authentication.js b\/src\/routes\/authentication.js\nindex d6b98aa0573c..6d7a36e03710 100644\n--- a\/src\/routes\/authentication.js\n+++ b\/src\/routes\/authentication.js\n@@ -44,13 +44,9 @@ Auth.getLoginStrategies = function () {\n };\n \n Auth.verifyToken = async function (token, done) {\n-\tlet { tokens = [] } = await meta.settings.get('core.api');\n-\ttokens = tokens.reduce((memo, cur) => {\n-\t\tmemo[cur.token] = cur.uid;\n-\t\treturn memo;\n-\t}, {});\n-\n-\tconst uid = tokens[token];\n+\tconst { tokens = [] } = await meta.settings.get('core.api');\n+\tconst tokenObj = tokens.find(t => t.token === token);\n+\tconst uid = tokenObj ? tokenObj.uid : undefined;\n \n \tif (uid !== undefined) {\n \t\tif (parseInt(uid, 10) > 0) {"
        },
        {
            "index":385,
            "vuln_id":"GHSA-7q4h-pj78-j7vg",
            "cwe_id":"{'CWE-400', 'CWE-918'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/apache\/cxf\/commit\/aa789c5c4686597a7bdef2443909ab491fc2bc04', 'https:\/\/github.com\/apache\/cxf\/commit\/40503a53914758759894f704bbf139ae89ace286'}",
            "dataset":"osv",
            "summary":"Authorization service vulnerable to DDos attacks in Apache CFX CXF supports (via JwtRequestCodeFilter) passing OAuth 2 parameters via a JWT token as opposed to query parameters (see: The OAuth 2.0 Authorization Framework: JWT Secured Authorization Request (JAR)). Instead of sending a JWT token as a \"request\" parameter, the spec also supports specifying a URI from which to retrieve a JWT token from via the \"request_uri\" parameter. CXF was not validating the \"request_uri\" parameter (apart from ensuring it uses \"https) and was making a REST request to the parameter in the request to retrieve a token. This means that CXF was vulnerable to DDos attacks on the authorization server, as specified in section 10.4.1 of the spec. This issue affects Apache CXF versions prior to 3.4.3; Apache CXF versions prior to 3.3.10.",
            "published_date":"2021-05-13",
            "chain_len":2,
            "project":"https:\/\/github.com\/apache\/cxf",
            "commit_href":"https:\/\/github.com\/apache\/cxf\/commit\/40503a53914758759894f704bbf139ae89ace286",
            "commit_sha":"40503a53914758759894f704bbf139ae89ace286",
            "patch":"MULTI",
            "chain_ord":"['40503a53914758759894f704bbf139ae89ace286', 'aa789c5c4686597a7bdef2443909ab491fc2bc04']",
            "before_first_fix_commit":"{'40503a53914758759894f704bbf139ae89ace286'}",
            "last_fix_commit":"aa789c5c4686597a7bdef2443909ab491fc2bc04",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/06\/2021, 09:30:08",
            "message":"Disallow OAuth2 request_uri by default",
            "author":"Colm O hEigeartaigh",
            "comments":null,
            "stats":"{'additions': 13, 'deletions': 4, 'total': 17}",
            "files":"{'rt\/rs\/security\/oauth-parent\/oauth2\/src\/main\/java\/org\/apache\/cxf\/rs\/security\/oauth2\/grants\/code\/JwtRequestCodeFilter.java': {'additions': 13, 'deletions': 4, 'changes': 17, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/cxf\/raw\/40503a53914758759894f704bbf139ae89ace286\/rt%2Frs%2Fsecurity%2Foauth-parent%2Foauth2%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fcxf%2Frs%2Fsecurity%2Foauth2%2Fgrants%2Fcode%2FJwtRequestCodeFilter.java', 'patch': '@@ -42,6 +42,7 @@\\n import org.apache.cxf.rt.security.crypto.CryptoUtils;\\n \\n public class JwtRequestCodeFilter extends OAuthJoseJwtConsumer implements AuthorizationRequestFilter {\\n+    private static final String REQUEST_URI_CONTENT_TYPE = \"application\/oauth-authz-req+jwt\";\\n     private static final String REQUEST_PARAM = \"request\";\\n     private static final String REQUEST_URI_PARAM = \"request_uri\";\\n     private boolean verifyWithClientCertificates;\\n@@ -55,7 +56,7 @@ public MultivaluedMap<String, String> process(MultivaluedMap<String, String> par\\n         if (requestToken == null) {\\n             String requestUri = params.getFirst(REQUEST_URI_PARAM);\\n             if (isRequestUriValid(client, requestUri)) {\\n-                requestToken = WebClient.create(requestUri).get(String.class);\\n+                requestToken = WebClient.create(requestUri).accept(REQUEST_URI_CONTENT_TYPE).get(String.class);\\n             }\\n         }\\n         if (requestToken != null) {\\n@@ -101,9 +102,17 @@ public MultivaluedMap<String, String> process(MultivaluedMap<String, String> par\\n         }\\n         return params;\\n     }\\n-    private boolean isRequestUriValid(Client client, String requestUri) {\\n-        \/\/TODO: consider restricting to specific hosts\\n-        return requestUri != null && requestUri.startsWith(\"https:\/\/\");\\n+\\n+    \/**\\n+     * This method must be overridden to support request_uri. Take care to validate the request_uri properly,\\n+     * as otherwise it could lead to a security problem\\n+     * (https:\/\/tools.ietf.org\/html\/draft-ietf-oauth-jwsreq-30#section-10.4)\\n+     * @param client the Client object\\n+     * @param requestUri the request_uri parameter to validate\\n+     * @return whether the requestUri is permitted or not\\n+     *\/\\n+    protected boolean isRequestUriValid(Client client, String requestUri) {\\n+        return false;\\n     }\\n     protected JwsSignatureVerifier getInitializedSigVerifier(Client c) {\\n         if (verifyWithClientCertificates) {'}}",
            "message_norm":"disallow oauth2 request_uri by default",
            "language":"en",
            "entities":null,
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['rt\/rs\/security\/oauth-parent\/oauth2\/src\/main\/java\/org\/apache\/cxf\/rs\/security\/oauth2\/grants\/code\/JwtRequestCodeFilter.java'])",
            "num_files":1.0,
            "patch_content":"From 40503a53914758759894f704bbf139ae89ace286 Mon Sep 17 00:00:00 2001\nFrom: Colm O hEigeartaigh <coheigea@apache.org>\nDate: Wed, 6 Jan 2021 09:30:08 +0000\nSubject: [PATCH] Disallow OAuth2 request_uri by default\n\n---\n ...\/grants\/code\/JwtRequestCodeFilter.java       | 17 +++++++++++++----\n 1 file changed, 13 insertions(+), 4 deletions(-)\n\ndiff --git a\/rt\/rs\/security\/oauth-parent\/oauth2\/src\/main\/java\/org\/apache\/cxf\/rs\/security\/oauth2\/grants\/code\/JwtRequestCodeFilter.java b\/rt\/rs\/security\/oauth-parent\/oauth2\/src\/main\/java\/org\/apache\/cxf\/rs\/security\/oauth2\/grants\/code\/JwtRequestCodeFilter.java\nindex 4ef8dc96439..29ac00020d4 100644\n--- a\/rt\/rs\/security\/oauth-parent\/oauth2\/src\/main\/java\/org\/apache\/cxf\/rs\/security\/oauth2\/grants\/code\/JwtRequestCodeFilter.java\n+++ b\/rt\/rs\/security\/oauth-parent\/oauth2\/src\/main\/java\/org\/apache\/cxf\/rs\/security\/oauth2\/grants\/code\/JwtRequestCodeFilter.java\n@@ -42,6 +42,7 @@\n import org.apache.cxf.rt.security.crypto.CryptoUtils;\n \n public class JwtRequestCodeFilter extends OAuthJoseJwtConsumer implements AuthorizationRequestFilter {\n+    private static final String REQUEST_URI_CONTENT_TYPE = \"application\/oauth-authz-req+jwt\";\n     private static final String REQUEST_PARAM = \"request\";\n     private static final String REQUEST_URI_PARAM = \"request_uri\";\n     private boolean verifyWithClientCertificates;\n@@ -55,7 +56,7 @@ public MultivaluedMap<String, String> process(MultivaluedMap<String, String> par\n         if (requestToken == null) {\n             String requestUri = params.getFirst(REQUEST_URI_PARAM);\n             if (isRequestUriValid(client, requestUri)) {\n-                requestToken = WebClient.create(requestUri).get(String.class);\n+                requestToken = WebClient.create(requestUri).accept(REQUEST_URI_CONTENT_TYPE).get(String.class);\n             }\n         }\n         if (requestToken != null) {\n@@ -101,9 +102,17 @@ public MultivaluedMap<String, String> process(MultivaluedMap<String, String> par\n         }\n         return params;\n     }\n-    private boolean isRequestUriValid(Client client, String requestUri) {\n-        \/\/TODO: consider restricting to specific hosts\n-        return requestUri != null && requestUri.startsWith(\"https:\/\/\");\n+\n+    \/**\n+     * This method must be overridden to support request_uri. Take care to validate the request_uri properly,\n+     * as otherwise it could lead to a security problem\n+     * (https:\/\/tools.ietf.org\/html\/draft-ietf-oauth-jwsreq-30#section-10.4)\n+     * @param client the Client object\n+     * @param requestUri the request_uri parameter to validate\n+     * @return whether the requestUri is permitted or not\n+     *\/\n+    protected boolean isRequestUriValid(Client client, String requestUri) {\n+        return false;\n     }\n     protected JwsSignatureVerifier getInitializedSigVerifier(Client c) {\n         if (verifyWithClientCertificates) {"
        },
        {
            "index":777,
            "vuln_id":"GHSA-9722-rr68-rfpg",
            "cwe_id":"{'CWE-610', 'CWE-73'}",
            "score":3.4,
            "chain":"{'https:\/\/github.com\/octobercms\/october\/commit\/6711dae8ef70caf0e94cec434498012a2ccd86b8'}",
            "dataset":"osv",
            "summary":"Upload whitelisted files to any directory in OctoberCMS ### Impact\nAn attacker can exploit this vulnerability to upload jpg, jpeg, bmp, png, webp, gif, ico, css, js, woff, woff2, svg, ttf, eot, json, md, less, sass, scss, xml files to any directory of an October CMS server. The vulnerability is only exploitable by an authenticated backend user with the `cms.manage_assets` permission.\n\n### Patches\nIssue has been patched in Build 466 (v1.0.466).\n\n### Workarounds\nApply https:\/\/github.com\/octobercms\/october\/commit\/6711dae8ef70caf0e94cec434498012a2ccd86b8 to your installation manually if unable to upgrade to Build 466.\n\n### References\nReported by [Sivanesh Ashok](https:\/\/stazot.com\/)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at [hello@octobercms.com](mailto:hello@octobercms.com)\n\n### Threat assessment:\n<img width=\"1241\" alt=\"Screen Shot 2020-03-31 at 12 21 10 PM\" src=\"https:\/\/user-images.githubusercontent.com\/7253840\/78061230-255f5400-734a-11ea-92b4-1120f6960505.png\">",
            "published_date":"2020-06-03",
            "chain_len":1,
            "project":"https:\/\/github.com\/octobercms\/october",
            "commit_href":"https:\/\/github.com\/octobercms\/october\/commit\/6711dae8ef70caf0e94cec434498012a2ccd86b8",
            "commit_sha":"6711dae8ef70caf0e94cec434498012a2ccd86b8",
            "patch":"SINGLE",
            "chain_ord":"['6711dae8ef70caf0e94cec434498012a2ccd86b8']",
            "before_first_fix_commit":"{'2b8939cc8b5b6fe81e093fe2c9f883ada4e3c8cc'}",
            "last_fix_commit":"6711dae8ef70caf0e94cec434498012a2ccd86b8",
            "chain_ord_pos":1.0,
            "commit_datetime":"03\/31\/2020, 10:09:18",
            "message":"Improve asset file path handling when moving assets",
            "author":"Luke Towers",
            "comments":null,
            "stats":"{'additions': 8, 'deletions': 1, 'total': 9}",
            "files":"{'modules\/cms\/widgets\/AssetList.php': {'additions': 8, 'deletions': 1, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/octobercms\/october\/raw\/6711dae8ef70caf0e94cec434498012a2ccd86b8\/modules%2Fcms%2Fwidgets%2FAssetList.php', 'patch': \"@@ -333,13 +333,20 @@ public function onMove()\\n \\n             $basename = basename($path);\\n             $originalFullPath = $this->getFullPath($path);\\n-            $newFullPath = rtrim($destinationFullPath, '\/').'\/'.$basename;\\n+            $newFullPath = realpath(rtrim($destinationFullPath, '\/')) . '\/' . $basename;\\n             $safeDir = $this->getAssetsPath();\\n \\n             if ($originalFullPath == $newFullPath) {\\n                 continue;\\n             }\\n \\n+            if (!starts_with($newFullPath, $safeDir)) {\\n+                throw new ApplicationException(Lang::get(\\n+                    'cms::lang.asset.error_moving_file',\\n+                    ['file' => $basename]\\n+                ));\\n+            }\\n+\\n             if (is_file($originalFullPath)) {\\n                 if (!@File::move($originalFullPath, $newFullPath)) {\\n                     throw new ApplicationException(Lang::get(\"}}",
            "message_norm":"improve asset file path handling when moving assets",
            "language":"en",
            "entities":"[('improve', 'ACTION', ''), ('asset', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['modules\/cms\/widgets\/AssetList.php'])",
            "num_files":1.0,
            "patch_content":"From 6711dae8ef70caf0e94cec434498012a2ccd86b8 Mon Sep 17 00:00:00 2001\nFrom: Luke Towers <github@luketowers.ca>\nDate: Tue, 31 Mar 2020 04:09:18 -0600\nSubject: [PATCH] Improve asset file path handling when moving assets\n\n---\n modules\/cms\/widgets\/AssetList.php | 9 ++++++++-\n 1 file changed, 8 insertions(+), 1 deletion(-)\n\ndiff --git a\/modules\/cms\/widgets\/AssetList.php b\/modules\/cms\/widgets\/AssetList.php\nindex 0fcd63c730..3dda5d1b35 100644\n--- a\/modules\/cms\/widgets\/AssetList.php\n+++ b\/modules\/cms\/widgets\/AssetList.php\n@@ -333,13 +333,20 @@ public function onMove()\n \n             $basename = basename($path);\n             $originalFullPath = $this->getFullPath($path);\n-            $newFullPath = rtrim($destinationFullPath, '\/').'\/'.$basename;\n+            $newFullPath = realpath(rtrim($destinationFullPath, '\/')) . '\/' . $basename;\n             $safeDir = $this->getAssetsPath();\n \n             if ($originalFullPath == $newFullPath) {\n                 continue;\n             }\n \n+            if (!starts_with($newFullPath, $safeDir)) {\n+                throw new ApplicationException(Lang::get(\n+                    'cms::lang.asset.error_moving_file',\n+                    ['file' => $basename]\n+                ));\n+            }\n+\n             if (is_file($originalFullPath)) {\n                 if (!@File::move($originalFullPath, $newFullPath)) {\n                     throw new ApplicationException(Lang::get("
        },
        {
            "index":32,
            "vuln_id":"GHSA-5wpj-c6f7-24x8",
            "cwe_id":"{'CWE-475', 'CWE-20'}",
            "score":5.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a5b89cd68c02329d793356bda85d079e9e69b4e7', 'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/dbdd98c37bc25249e8f288bd30d01e118a7b4498'}",
            "dataset":"osv",
            "summary":"Undefined behavior when users supply invalid resource handles ### Impact\nMultiple TensorFlow operations misbehave in eager mode when the resource handle provided to them is invalid:\n\n```python\nimport tensorflow as tf\n\ntf.raw_ops.QueueIsClosedV2(handle=[])\n```\n\n```python\nimport tensorflow as tf\n\ntf.summary.flush(writer=())\n```\n  \nIn graph mode, it would have been impossible to perform these API calls, but migration to TF 2.x eager mode opened up this vulnerability. If the resource handle is empty, then a reference is bound to a null pointer inside TensorFlow codebase (various codepaths). This is undefined behavior.\n\n### Patches\nWe have patched the issue in GitHub commit [a5b89cd68c02329d793356bda85d079e9e69b4e7](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a5b89cd68c02329d793356bda85d079e9e69b4e7) and GitHub commit [dbdd98c37bc25249e8f288bd30d01e118a7b4498](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/dbdd98c37bc25249e8f288bd30d01e118a7b4498).\n\nThe fix will be included in TensorFlow 2.9.0. We will also cherrypick this commit on TensorFlow 2.8.1, TensorFlow 2.7.2, and TensorFlow 2.6.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Hong Jin from Singapore Management University.",
            "published_date":"2022-05-24",
            "chain_len":2,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/a5b89cd68c02329d793356bda85d079e9e69b4e7",
            "commit_sha":"a5b89cd68c02329d793356bda85d079e9e69b4e7",
            "patch":"MULTI",
            "chain_ord":"['dbdd98c37bc25249e8f288bd30d01e118a7b4498', 'a5b89cd68c02329d793356bda85d079e9e69b4e7']",
            "before_first_fix_commit":"{'c2ce4c72fdc9658e23dd9d42cb9ed30bdd60c2a6'}",
            "last_fix_commit":"a5b89cd68c02329d793356bda85d079e9e69b4e7",
            "chain_ord_pos":2.0,
            "commit_datetime":"04\/30\/2022, 04:07:06",
            "message":"Fix empty resource handle vulnerability.\n\nSome ops that attempt to extract a resource handle from user input\ncan lead to nullptr dereferences.  This returns an error in such\na case.\n\nPiperOrigin-RevId: 445571938",
            "author":"Antonio Sanchez",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
            "files":"{'tensorflow\/core\/common_runtime\/eager\/execute.cc': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/a5b89cd68c02329d793356bda85d079e9e69b4e7\/tensorflow%2Fcore%2Fcommon_runtime%2Feager%2Fexecute.cc', 'patch': '@@ -304,6 +304,9 @@ Status GetDeviceForInput(const EagerOperation& op, const EagerContext& ctx,\\n     const Tensor* tensor;\\n     \/\/ TODO(fishx): Avoid blocking here.\\n     TF_RETURN_IF_ERROR(tensor_handle->Tensor(&tensor));\\n+    if (tensor->NumElements() == 0) {\\n+      return errors::InvalidArgument(\"Empty resource handle\");\\n+    }\\n     const ResourceHandle& handle = tensor->flat<ResourceHandle>()(0);\\n     device_name = handle.device();'}}",
            "message_norm":"fix empty resource handle vulnerability.\n\nsome ops that attempt to extract a resource handle from user input\ncan lead to nullptr dereferences.  this returns an error in such\na case.\n\npiperorigin-revid: 445571938",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('vulnerability', 'SECWORD', ''), ('nullptr', 'SECWORD', ''), ('error', 'FLAW', ''), ('445571938', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/common_runtime\/eager\/execute.cc'])",
            "num_files":1.0,
            "patch_content":"From a5b89cd68c02329d793356bda85d079e9e69b4e7 Mon Sep 17 00:00:00 2001\nFrom: Antonio Sanchez <cantonios@google.com>\nDate: Fri, 29 Apr 2022 21:07:06 -0700\nSubject: [PATCH] Fix empty resource handle vulnerability.\n\nSome ops that attempt to extract a resource handle from user input\ncan lead to nullptr dereferences.  This returns an error in such\na case.\n\nPiperOrigin-RevId: 445571938\n---\n tensorflow\/core\/common_runtime\/eager\/execute.cc | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/tensorflow\/core\/common_runtime\/eager\/execute.cc b\/tensorflow\/core\/common_runtime\/eager\/execute.cc\nindex dd64174a4ddeff..904996c7e64652 100644\n--- a\/tensorflow\/core\/common_runtime\/eager\/execute.cc\n+++ b\/tensorflow\/core\/common_runtime\/eager\/execute.cc\n@@ -304,6 +304,9 @@ Status GetDeviceForInput(const EagerOperation& op, const EagerContext& ctx,\n     const Tensor* tensor;\n     \/\/ TODO(fishx): Avoid blocking here.\n     TF_RETURN_IF_ERROR(tensor_handle->Tensor(&tensor));\n+    if (tensor->NumElements() == 0) {\n+      return errors::InvalidArgument(\"Empty resource handle\");\n+    }\n     const ResourceHandle& handle = tensor->flat<ResourceHandle>()(0);\n     device_name = handle.device();"
        },
        {
            "index":713,
            "vuln_id":"GHSA-694p-xrhg-x3wm",
            "cwe_id":"{'CWE-444'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1', 'https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/6deb60b75517f80c57b42d935f07955c773b766d', 'https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/bc855e439c4a5ced3d83195bb59d0679cbd95add'}",
            "dataset":"osv",
            "summary":"CWE-113: Improper Neutralization of CRLF Sequences in HTTP Headers ('HTTP Request Header Injection') ### Vulnerability\n\nMicronaut's HTTP client is vulnerable to \"HTTP Request Header Injection\" due to not validating request headers passed to the client.\n\nExample of vulnerable code:\n\n```java\n@Controller(\"\/hello\")\npublic class HelloController {\n\n    @Inject\n    @Client(\"\/\")\n    RxHttpClient client;\n\n    @Get(\"\/external-exploit\")\n    @Produces(MediaType.TEXT_PLAIN)\n    public String externalExploit(@QueryValue(\"header-value\") String headerValue) {\n        return client.toBlocking().retrieve(\n            HttpRequest.GET(\"\/hello\")\n                .header(\"Test\", headerValue)\n        );\n    }\n}\n```\n\nIn the above case a query value received from a user is passed as a header value to the client. Since the client doesn't validate the header value the request headers and body have the potential to be manipulated.\n\nFor example, a user that supplies the following payload, can force the client to make multiple attacker-controlled HTTP requests.\n\n```java\nList<String> headerData = List.of(\n    \"Connection: Keep-Alive\", \/\/ This keeps the connection open so another request can be stuffed in.\n    \"\",\n    \"\",\n    \"POST \/hello\/super-secret HTTP\/1.1\",\n    \"Host: 127.0.0.1\",\n    \"Content-Length: 31\",\n    \"\",\n    \"{\\\"new\\\":\\\"json\\\",\\\"content\\\":\\\"here\\\"}\",\n    \"\",\n    \"\"\n);\nString headerValue = \"H\\r\\n\" + String.join(\"\\r\\n\", headerData);;\nURI theURI =\n    UriBuilder\n        .of(\"\/hello\/external-exploit\")\n        .queryParam(\"header-value\", headerValue) \/\/ Automatically URL encodes data\n        .build();\nHttpRequest<String> request = HttpRequest.GET(theURI);\nString body = client.toBlocking().retrieve(request);\n```\n\nNote that using `@HeaderValue` instead of `@QueryValue` is not vulnerable since Micronaut's HTTP server does validate the headers passed to the server, so the exploit can only be triggered by using user data that is not an HTTP header (query values, form data etc.).\n\n### Impact\n\nThe attacker is able to control the entirety of the HTTP body for their custom requests.\nAs such, this vulnerability enables attackers to perform a variant of [Server Side Request Forgery](https:\/\/cwe.mitre.org\/data\/definitions\/918.html).\n\n### Patches\n\nThe problem has been patched in the `micronaut-http-client` versions 1.2.11 and 1.3.2 and above.\n\n### Workarounds\n\nDo not pass user data directly received from HTTP request parameters as headers in the HTTP client.\n\n### References\n\nFix commits\n- https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1\n- https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/6deb60b75517f80c57b42d935f07955c773b766d\n- https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/bc855e439c4a5ced3d83195bb59d0679cbd95add\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n\n* Open an issue in [micronaut-core](https:\/\/github.com\/micronaut-projects\/micronaut-core)\n* Email us at [info@micronaut.io](mailto:info@micronaut.io)\n\n### Credit\n\nOriginally reported by @JLLeitschuh",
            "published_date":"2020-03-30",
            "chain_len":3,
            "project":"https:\/\/github.com\/micronaut-projects\/micronaut-core",
            "commit_href":"https:\/\/github.com\/micronaut-projects\/micronaut-core\/commit\/9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1",
            "commit_sha":"9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1",
            "patch":"MULTI",
            "chain_ord":"['6deb60b75517f80c57b42d935f07955c773b766d', 'bc855e439c4a5ced3d83195bb59d0679cbd95add', '9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1']",
            "before_first_fix_commit":"{'a2392f4289f7777c4a310c3ae3bb4bc0ce5a65c2'}",
            "last_fix_commit":"9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1",
            "chain_ord_pos":3.0,
            "commit_datetime":"03\/09\/2020, 18:20:28",
            "message":"Validate client headers",
            "author":"jameskleeh",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'http-netty\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/micronaut-projects\/micronaut-core\/raw\/9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1\/http-netty%2Fsrc%2Fmain%2Fjava%2Fio%2Fmicronaut%2Fhttp%2Fnetty%2FNettyHttpHeaders.java', 'patch': '@@ -53,7 +53,7 @@ public NettyHttpHeaders(io.netty.handler.codec.http.HttpHeaders nettyHeaders, Co\\n      * Default constructor.\\n      *\/\\n     public NettyHttpHeaders() {\\n-        this.nettyHeaders = new DefaultHttpHeaders(false);\\n+        this.nettyHeaders = new DefaultHttpHeaders();\\n         this.conversionService = ConversionService.SHARED;\\n     }'}}",
            "message_norm":"validate client headers",
            "language":"nl",
            "entities":"[('validate', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['http-netty\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java'])",
            "num_files":1.0,
            "patch_content":"From 9d1eff5c8df1d6cda1fe00ef046729b2a6abe7f1 Mon Sep 17 00:00:00 2001\nFrom: jameskleeh <james.kleeh@gmail.com>\nDate: Mon, 9 Mar 2020 14:20:28 -0400\nSubject: [PATCH] Validate client headers\n\n---\n ...\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/http-netty\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java b\/http-netty\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java\nindex 97956bef102..35d6a191d31 100644\n--- a\/http-netty\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java\n+++ b\/http-netty\/src\/main\/java\/io\/micronaut\/http\/netty\/NettyHttpHeaders.java\n@@ -53,7 +53,7 @@ public NettyHttpHeaders(io.netty.handler.codec.http.HttpHeaders nettyHeaders, Co\n      * Default constructor.\n      *\/\n     public NettyHttpHeaders() {\n-        this.nettyHeaders = new DefaultHttpHeaders(false);\n+        this.nettyHeaders = new DefaultHttpHeaders();\n         this.conversionService = ConversionService.SHARED;\n     }"
        },
        {
            "index":143,
            "vuln_id":"GHSA-qfpc-5pjr-mh26",
            "cwe_id":"{'CWE-20'}",
            "score":5.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/da857cfa0fde8f79ad0afdbc94e88b5d4bbec764'}",
            "dataset":"osv",
            "summary":"Missing validation in shape inference for `Dequantize` ### Impact\nThe shape inference code for `tf.raw_ops.Dequantize` has a vulnerability that could trigger a denial of service via a segfault if an attacker provides invalid arguments:\n\n```python\nimport tensorflow as tf\n\ntf.compat.v1.disable_v2_behavior()\ntf.raw_ops.Dequantize(\n  input_tensor = tf.constant(-10.0, dtype=tf.float32),\n  input_tensor = tf.cast(input_tensor, dtype=tf.quint8),\n  min_range = tf.constant([], shape=[0], dtype=tf.float32),\n  max_range = tf.constant([], shape=[0], dtype=tf.float32),\n  mode  = 'MIN_COMBINED',\n  narrow_range=False,\n  axis=-10,\n  dtype=tf.dtypes.float32)\n```\n\nThe shape inference [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/460e000de3a83278fb00b61a16d161b1964f15f4\/tensorflow\/core\/ops\/array_ops.cc#L2999-L3014) uses `axis` to select between two different values for `minmax_rank` which is then used to retrieve tensor dimensions. However, code assumes that `axis` can be either `-1` or a value greater than `-1`, with no validation for the other values.\n\n### Patches\nWe have patched the issue in GitHub commit [da857cfa0fde8f79ad0afdbc94e88b5d4bbec764](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/da857cfa0fde8f79ad0afdbc94e88b5d4bbec764).\n\nThe fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang of Baidu Security.",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/da857cfa0fde8f79ad0afdbc94e88b5d4bbec764",
            "commit_sha":"da857cfa0fde8f79ad0afdbc94e88b5d4bbec764",
            "patch":"SINGLE",
            "chain_ord":"['da857cfa0fde8f79ad0afdbc94e88b5d4bbec764']",
            "before_first_fix_commit":"{'8a793b5d7f59e37ac7f3cd0954a750a2fe76bad4'}",
            "last_fix_commit":"da857cfa0fde8f79ad0afdbc94e88b5d4bbec764",
            "chain_ord_pos":1.0,
            "commit_datetime":"07\/30\/2021, 01:24:18",
            "message":"Fix a shape inference issue leading to nullptr deref.\n\nPiperOrigin-RevId: 387712259\nChange-Id: I7e670772b259c068a501a187cd89f18773bb95a1",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'tensorflow\/core\/ops\/array_ops.cc': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/da857cfa0fde8f79ad0afdbc94e88b5d4bbec764\/tensorflow%2Fcore%2Fops%2Farray_ops.cc', 'patch': '@@ -2990,6 +2990,10 @@ REGISTER_OP(\"Dequantize\")\\n       if (!s.ok() && s.code() != error::NOT_FOUND) {\\n         return s;\\n       }\\n+      if (axis < -1) {\\n+        return errors::InvalidArgument(\"axis should be at least -1, got \",\\n+                                       axis);\\n+      }\\n       const int minmax_rank = (axis == -1) ? 0 : 1;\\n       TF_RETURN_IF_ERROR(shape_inference::UnchangedShape(c));\\n       ShapeHandle minmax;'}}",
            "message_norm":"fix a shape inference issue leading to nullptr deref.\n\npiperorigin-revid: 387712259\nchange-id: i7e670772b259c068a501a187cd89f18773bb95a1",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('issue', 'FLAW', ''), ('nullptr', 'SECWORD', ''), ('387712259', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/ops\/array_ops.cc'])",
            "num_files":1.0,
            "patch_content":"From da857cfa0fde8f79ad0afdbc94e88b5d4bbec764 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Thu, 29 Jul 2021 18:24:18 -0700\nSubject: [PATCH] Fix a shape inference issue leading to nullptr deref.\n\nPiperOrigin-RevId: 387712259\nChange-Id: I7e670772b259c068a501a187cd89f18773bb95a1\n---\n tensorflow\/core\/ops\/array_ops.cc | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/tensorflow\/core\/ops\/array_ops.cc b\/tensorflow\/core\/ops\/array_ops.cc\nindex 626afd58603705..3bd6f8a1038721 100644\n--- a\/tensorflow\/core\/ops\/array_ops.cc\n+++ b\/tensorflow\/core\/ops\/array_ops.cc\n@@ -2990,6 +2990,10 @@ REGISTER_OP(\"Dequantize\")\n       if (!s.ok() && s.code() != error::NOT_FOUND) {\n         return s;\n       }\n+      if (axis < -1) {\n+        return errors::InvalidArgument(\"axis should be at least -1, got \",\n+                                       axis);\n+      }\n       const int minmax_rank = (axis == -1) ? 0 : 1;\n       TF_RETURN_IF_ERROR(shape_inference::UnchangedShape(c));\n       ShapeHandle minmax;"
        },
        {
            "index":389,
            "vuln_id":"GHSA-j8qh-3xrq-c825",
            "cwe_id":"{'CWE-369'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/3ebedd7e345453d68e279cfc3e4072648e5e12e5'}",
            "dataset":"osv",
            "summary":"Division by zero in TFLite's implementation of `OneHot` ### Impact\nThe implementation of the `OneHot` TFLite operator is [vulnerable to a division by zero error](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/f61c57bd425878be108ec787f4d96390579fb83e\/tensorflow\/lite\/kernels\/one_hot.cc#L68-L72):\n\n```cc\nint prefix_dim_size = 1;\nfor (int i = 0; i < op_context.axis; ++i) {\n  prefix_dim_size *= op_context.indices->dims->data[i];\n}\nconst int suffix_dim_size = NumElements(op_context.indices) \/ prefix_dim_size;\n```\n\nAn attacker can craft a model such that at least one of the dimensions of `indices` would be 0. In turn, the `prefix_dim_size` value would become 0.\n\n### Patches\nWe have patched the issue in GitHub commit [3ebedd7e345453d68e279cfc3e4072648e5e12e5](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/3ebedd7e345453d68e279cfc3e4072648e5e12e5).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/3ebedd7e345453d68e279cfc3e4072648e5e12e5",
            "commit_sha":"3ebedd7e345453d68e279cfc3e4072648e5e12e5",
            "patch":"SINGLE",
            "chain_ord":"['3ebedd7e345453d68e279cfc3e4072648e5e12e5']",
            "before_first_fix_commit":"{'f61c57bd425878be108ec787f4d96390579fb83e'}",
            "last_fix_commit":"3ebedd7e345453d68e279cfc3e4072648e5e12e5",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/28\/2021, 19:58:07",
            "message":"Prevent division by 0 in OneHot implementation\n\nIf input indices is degenerate, the implementation would do a divide by zero. See https:\/\/github.com\/tensorflow\/tensorflow\/blob\/745d57df6d5e9bc568666a2a48ed8dd629c27241\/tensorflow\/lite\/kernels\/one_hot.cc#L68-L72\n\nPiperOrigin-RevId: 370966870\nChange-Id: Ie018337811c8016b5a1d3a277d00d5f2e19a2058",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
            "files":"{'tensorflow\/lite\/kernels\/one_hot.cc': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/3ebedd7e345453d68e279cfc3e4072648e5e12e5\/tensorflow%2Flite%2Fkernels%2Fone_hot.cc', 'patch': '@@ -69,6 +69,11 @@ void OneHotComputeImpl(const OneHotContext& op_context) {\\n   for (int i = 0; i < op_context.axis; ++i) {\\n     prefix_dim_size *= op_context.indices->dims->data[i];\\n   }\\n+  if (prefix_dim_size == 0) {\\n+    \/\/ If indices tensor is degenerate, return a degenerate tensor, just like\\n+    \/\/ TensorFlow does.\\n+    return;\\n+  }\\n   const int suffix_dim_size = NumElements(op_context.indices) \/ prefix_dim_size;\\n   const int depth = *op_context.depth->data.i32;'}}",
            "message_norm":"prevent division by 0 in onehot implementation\n\nif input indices is degenerate, the implementation would do a divide by zero. see https:\/\/github.com\/tensorflow\/tensorflow\/blob\/745d57df6d5e9bc568666a2a48ed8dd629c27241\/tensorflow\/lite\/kernels\/one_hot.cc#l68-l72\n\npiperorigin-revid: 370966870\nchange-id: ie018337811c8016b5a1d3a277d00d5f2e19a2058",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('division by 0', 'SECWORD', ''), ('divide by zero', 'SECWORD', ''), ('https:\/\/github.com\/tensorflow\/tensorflow\/blob\/745d57df6d5e9bc568666a2a48ed8dd629c27241\/tensorflow\/lite\/kernels\/one_hot.cc#l68-l72', 'URL', ''), ('370966870', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/kernels\/one_hot.cc'])",
            "num_files":1.0,
            "patch_content":"From 3ebedd7e345453d68e279cfc3e4072648e5e12e5 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Wed, 28 Apr 2021 12:58:07 -0700\nSubject: [PATCH] Prevent division by 0 in OneHot implementation\n\nIf input indices is degenerate, the implementation would do a divide by zero. See https:\/\/github.com\/tensorflow\/tensorflow\/blob\/745d57df6d5e9bc568666a2a48ed8dd629c27241\/tensorflow\/lite\/kernels\/one_hot.cc#L68-L72\n\nPiperOrigin-RevId: 370966870\nChange-Id: Ie018337811c8016b5a1d3a277d00d5f2e19a2058\n---\n tensorflow\/lite\/kernels\/one_hot.cc | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/tensorflow\/lite\/kernels\/one_hot.cc b\/tensorflow\/lite\/kernels\/one_hot.cc\nindex f7b4e8e7e19d57..75bfb48d6b19c8 100644\n--- a\/tensorflow\/lite\/kernels\/one_hot.cc\n+++ b\/tensorflow\/lite\/kernels\/one_hot.cc\n@@ -69,6 +69,11 @@ void OneHotComputeImpl(const OneHotContext& op_context) {\n   for (int i = 0; i < op_context.axis; ++i) {\n     prefix_dim_size *= op_context.indices->dims->data[i];\n   }\n+  if (prefix_dim_size == 0) {\n+    \/\/ If indices tensor is degenerate, return a degenerate tensor, just like\n+    \/\/ TensorFlow does.\n+    return;\n+  }\n   const int suffix_dim_size = NumElements(op_context.indices) \/ prefix_dim_size;\n   const int depth = *op_context.depth->data.i32;"
        },
        {
            "index":760,
            "vuln_id":"GHSA-8cxv-76p7-jxwr",
            "cwe_id":"{'CWE-476'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/4f38b1ac8e42727e18a2f0bde06d3bee8e77b250'}",
            "dataset":"osv",
            "summary":"Null-dereference in Tensorflow ### Impact\nThe [implementation of `GetInitOp`](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/a1320ec1eac186da1d03f033109191f715b2b130\/tensorflow\/cc\/saved_model\/loader_util.cc#L31-L61) is vulnerable to a crash caused by dereferencing a null pointer:\n\n```cc\nconst auto& init_op_sig_it =\n    meta_graph_def.signature_def().find(kSavedModelInitOpSignatureKey);\nif (init_op_sig_it != sig_def_map.end()) {\n  *init_op_name = init_op_sig_it->second.outputs()\n                      .find(kSavedModelInitOpSignatureKey)\n                      ->second.name();\n  return Status::OK();\n}\n```\n\nHere, we have a nested map and we assume that if the first `.find` succeeds then so would be the search in the internal map. However, the maps are built based on the `SavedModel` protobuf format and a malicious user can alter that on disk before loading to cause the second `.find` to return `nullptr`.\n### Patches\nWe have patched the issue in GitHub commit [4f38b1ac8e42727e18a2f0bde06d3bee8e77b250](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/4f38b1ac8e42727e18a2f0bde06d3bee8e77b250).\n\nThe fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.",
            "published_date":"2022-02-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/4f38b1ac8e42727e18a2f0bde06d3bee8e77b250",
            "commit_sha":"4f38b1ac8e42727e18a2f0bde06d3bee8e77b250",
            "patch":"SINGLE",
            "chain_ord":"['4f38b1ac8e42727e18a2f0bde06d3bee8e77b250']",
            "before_first_fix_commit":"{'7b84b7c651dc2ecc1e28f2acc65bfe371a04ecfc'}",
            "last_fix_commit":"4f38b1ac8e42727e18a2f0bde06d3bee8e77b250",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/10\/2021, 00:56:28",
            "message":"Prevent null dereference read in `GetInitOp`.\n\nWe have a map of maps. We test that the key exists in the first map but then we don't have any validation that this also means the second map has the needed key. In the scenarios where this is not the case, we'll dereference a nullptr, if we don't have this check\n\nPiperOrigin-RevId: 408739325\nChange-Id: If9bb7ed759aba1f3b56a34913f209508dbaf65ce",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 8, 'deletions': 3, 'total': 11}",
            "files":"{'tensorflow\/cc\/saved_model\/loader_util.cc': {'additions': 8, 'deletions': 3, 'changes': 11, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/4f38b1ac8e42727e18a2f0bde06d3bee8e77b250\/tensorflow%2Fcc%2Fsaved_model%2Floader_util.cc', 'patch': '@@ -34,9 +34,14 @@ Status GetInitOp(const string& export_dir, const MetaGraphDef& meta_graph_def,\\n   const auto& init_op_sig_it =\\n       meta_graph_def.signature_def().find(kSavedModelInitOpSignatureKey);\\n   if (init_op_sig_it != sig_def_map.end()) {\\n-    *init_op_name = init_op_sig_it->second.outputs()\\n-                        .find(kSavedModelInitOpSignatureKey)\\n-                        ->second.name();\\n+    const auto& sig_def_outputs = init_op_sig_it->second.outputs();\\n+    const auto& sig_def_outputs_it =\\n+        sig_def_outputs.find(kSavedModelInitOpSignatureKey);\\n+    if (sig_def_outputs_it == sig_def_outputs.end()) {\\n+      return errors::FailedPrecondition(\"Could not find output \",\\n+                                        kSavedModelInitOpSignatureKey);\\n+    }\\n+    *init_op_name = sig_def_outputs_it->second.name();\\n     return Status::OK();\\n   }'}}",
            "message_norm":"prevent null dereference read in `getinitop`.\n\nwe have a map of maps. we test that the key exists in the first map but then we don't have any validation that this also means the second map has the needed key. in the scenarios where this is not the case, we'll dereference a nullptr, if we don't have this check\n\npiperorigin-revid: 408739325\nchange-id: if9bb7ed759aba1f3b56a34913f209508dbaf65ce",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('null dereference', 'SECWORD', ''), ('key', 'SECWORD', ''), ('key', 'SECWORD', ''), ('nullptr', 'SECWORD', ''), ('408739325', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/cc\/saved_model\/loader_util.cc'])",
            "num_files":1.0,
            "patch_content":"From 4f38b1ac8e42727e18a2f0bde06d3bee8e77b250 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 9 Nov 2021 16:56:28 -0800\nSubject: [PATCH] Prevent null dereference read in `GetInitOp`.\n\nWe have a map of maps. We test that the key exists in the first map but then we don't have any validation that this also means the second map has the needed key. In the scenarios where this is not the case, we'll dereference a nullptr, if we don't have this check\n\nPiperOrigin-RevId: 408739325\nChange-Id: If9bb7ed759aba1f3b56a34913f209508dbaf65ce\n---\n tensorflow\/cc\/saved_model\/loader_util.cc | 11 ++++++++---\n 1 file changed, 8 insertions(+), 3 deletions(-)\n\ndiff --git a\/tensorflow\/cc\/saved_model\/loader_util.cc b\/tensorflow\/cc\/saved_model\/loader_util.cc\nindex 100cae2291333f..411dc41fd44837 100644\n--- a\/tensorflow\/cc\/saved_model\/loader_util.cc\n+++ b\/tensorflow\/cc\/saved_model\/loader_util.cc\n@@ -34,9 +34,14 @@ Status GetInitOp(const string& export_dir, const MetaGraphDef& meta_graph_def,\n   const auto& init_op_sig_it =\n       meta_graph_def.signature_def().find(kSavedModelInitOpSignatureKey);\n   if (init_op_sig_it != sig_def_map.end()) {\n-    *init_op_name = init_op_sig_it->second.outputs()\n-                        .find(kSavedModelInitOpSignatureKey)\n-                        ->second.name();\n+    const auto& sig_def_outputs = init_op_sig_it->second.outputs();\n+    const auto& sig_def_outputs_it =\n+        sig_def_outputs.find(kSavedModelInitOpSignatureKey);\n+    if (sig_def_outputs_it == sig_def_outputs.end()) {\n+      return errors::FailedPrecondition(\"Could not find output \",\n+                                        kSavedModelInitOpSignatureKey);\n+    }\n+    *init_op_name = sig_def_outputs_it->second.name();\n     return Status::OK();\n   }"
        },
        {
            "index":23,
            "vuln_id":"GHSA-cjg2-2fjg-fph4",
            "cwe_id":"{'CWE-191'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/paritytech\/frontier\/commit\/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664'}",
            "dataset":"osv",
            "summary":"Integer underflow in Frontier ### Impact\n\nA bug in Frontier's MODEXP precompile implementation can cause an integer underflow in certain conditions. This will cause a node crash for debug builds. For release builds (and production WebAssembly binaries), the impact is limited as it can only cause a normal EVM out-of-gas. It is recommended that you apply the patch as soon as possible.\n\nIf you do not use MODEXP precompile in your runtime, then you are not impacted.\n\n### Patches\n\nPatches are applied in PR #549.\n\n### Workarounds\n\nNone.\n\n### References\n\nPatch PR: #549\n\n### Credits\n\nThanks to SR-Labs for discovering the security vulnerability, and thanks to PureStake team for the patches.\n\n### For more information\n\nIf you have any questions or comments about this advisory:\n* Open an issue in the [Frontier repo](https:\/\/github.com\/paritytech\/frontier)",
            "published_date":"2022-01-14",
            "chain_len":1,
            "project":"https:\/\/github.com\/paritytech\/frontier",
            "commit_href":"https:\/\/github.com\/paritytech\/frontier\/commit\/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664",
            "commit_sha":"8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664",
            "patch":"SINGLE",
            "chain_ord":"['8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664']",
            "before_first_fix_commit":"{'6dd07a4d581a4c00bb2a2238a81997fc75bc2127'}",
            "last_fix_commit":"8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/13\/2022, 16:23:07",
            "message":"Handle 0 exponent with fudged length correctly in ModExp (#549)\n\n* Handle 0 exponent with fudged length correctly in ModExp\r\n\r\n* cargo fmt\r\n\r\n* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow\r\n\r\n* Update frame\/evm\/precompile\/modexp\/src\/lib.rs\r\n\r\nClean up test case\r\n\r\nCo-authored-by: Wei Tang <accounts@that.world>\r\n\r\n* More revert\r\n\r\n* cargo fmt\r\n\r\n* Prefer expect to match\r\n\r\nCo-authored-by: Wei Tang <accounts@that.world>",
            "author":"Stephen Shelton",
            "comments":null,
            "stats":"{'additions': 51, 'deletions': 5, 'total': 56}",
            "files":"{'frame\/evm\/precompile\/modexp\/src\/lib.rs': {'additions': 51, 'deletions': 5, 'changes': 56, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/paritytech\/frontier\/raw\/8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664\/frame%2Fevm%2Fprecompile%2Fmodexp%2Fsrc%2Flib.rs', 'patch': '@@ -47,7 +47,10 @@ fn calculate_gas_cost(\\n \\t\\t\\twords += 1;\\n \\t\\t}\\n \\n-\\t\\t\/\/ TODO: prevent\/handle overflow\\n+\\t\\t\/\/ Note: can\\'t overflow because we take words to be some u64 value \/ 8, which is\\n+\\t\\t\/\/ necessarily less than sqrt(u64::MAX).\\n+\\t\\t\/\/ Additionally, both base_length and mod_length are bounded to 1024, so this has\\n+\\t\\t\/\/ an upper bound of roughly (1024 \/ 8) squared\\n \\t\\twords * words\\n \\t}\\n \\n@@ -63,8 +66,17 @@ fn calculate_gas_cost(\\n \\t\\t\\tlet bytes: [u8; 32] = [0xFF; 32];\\n \\t\\t\\tlet max_256_bit_uint = BigUint::from_bytes_be(&bytes);\\n \\n+\\t\\t\\t\/\/ from the EIP spec:\\n+\\t\\t\\t\/\/ (8 * (exp_length - 32)) + ((exponent & (2**256 - 1)).bit_length() - 1)\\n+\\t\\t\\t\/\/\\n+\\t\\t\\t\/\/ Notes:\\n+\\t\\t\\t\/\/ * exp_length is bounded to 1024 and is > 32\\n+\\t\\t\\t\/\/ * exponent can be zero, so we subtract 1 after adding the other terms (whose sum\\n+\\t\\t\\t\/\/   must be > 0)\\n+\\t\\t\\t\/\/ * the addition can\\'t overflow because the terms are both capped at roughly\\n+\\t\\t\\t\/\/   8 * max size of exp_length (1024)\\n \\t\\t\\titeration_count =\\n-\\t\\t\\t\\t(8 * (exp_length - 32)) + ((exponent.bitand(max_256_bit_uint)).bits() - 1);\\n+\\t\\t\\t\\t(8 * (exp_length - 32)) + exponent.bitand(max_256_bit_uint).bits() - 1;\\n \\t\\t}\\n \\n \\t\\tmax(iteration_count, 1)\\n@@ -89,7 +101,7 @@ fn calculate_gas_cost(\\n \/\/ 6) modulus, size as described above\\n \/\/\\n \/\/\\n-\/\/ NOTE: input sizes are arbitrarily large (up to 256 bits), with the expectation\\n+\/\/ NOTE: input sizes are bound to 1024 bytes, with the expectation\\n \/\/       that gas limits would be applied before actual computation.\\n \/\/\\n \/\/       maximum stack size will also prevent abuse.\\n@@ -133,7 +145,7 @@ impl Precompile for Modexp {\\n \\t\\tlet mod_len_big = BigUint::from_bytes_be(&buf);\\n \\t\\tif mod_len_big > max_size_big {\\n \\t\\t\\treturn Err(PrecompileFailure::Error {\\n-\\t\\t\\t\\texit_status: ExitError::Other(\"unreasonably large exponent length\".into()),\\n+\\t\\t\\t\\texit_status: ExitError::Other(\"unreasonably large modulus length\".into()),\\n \\t\\t\\t});\\n \\t\\t}\\n \\n@@ -162,7 +174,6 @@ impl Precompile for Modexp {\\n \\t\\t\\tlet exponent = BigUint::from_bytes_be(&input[exp_start..exp_start + exp_len]);\\n \\n \\t\\t\\t\/\/ do our gas accounting\\n-\\t\\t\\t\/\/ TODO: we could technically avoid reading base first...\\n \\t\\t\\tlet gas_cost =\\n \\t\\t\\t\\tcalculate_gas_cost(base_len as u64, exp_len as u64, mod_len as u64, &exponent);\\n \\t\\t\\tif let Some(gas_left) = target_gas {\\n@@ -423,4 +434,39 @@ mod tests {\\n \\t\\t\\t}\\n \\t\\t}\\n \\t}\\n+\\n+\\t#[test]\\n+\\tfn test_zero_exp_with_33_length() {\\n+\\t\\t\/\/ This is a regression test which ensures that the \\'iteration_count\\' calculation\\n+\\t\\t\/\/ in \\'calculate_iteration_count\\' cannot underflow.\\n+\\t\\t\/\/\\n+\\t\\t\/\/ In debug mode, this underflow could cause a panic. Otherwise, it causes N**0 to\\n+\\t\\t\/\/ be calculated at more-than-normal expense.\\n+\\t\\t\/\/\\n+\\t\\t\/\/ TODO: cite security advisory\\n+\\n+\\t\\tlet input = vec![\\n+\\t\\t\\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\\n+\\t\\t\\t0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\\n+\\t\\t\\t0, 0, 0, 0, 0, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\\n+\\t\\t\\t0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\\n+\\t\\t\\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,\\n+\\t\\t];\\n+\\n+\\t\\tlet cost: u64 = 100000;\\n+\\n+\\t\\tlet context: Context = Context {\\n+\\t\\t\\taddress: Default::default(),\\n+\\t\\t\\tcaller: Default::default(),\\n+\\t\\t\\tapparent_value: From::from(0),\\n+\\t\\t};\\n+\\n+\\t\\tlet precompile_result = Modexp::execute(&input, Some(cost), &context, false)\\n+\\t\\t\\t.expect(\"Modexp::execute() returned error\");\\n+\\n+\\t\\tassert_eq!(precompile_result.output.len(), 1); \/\/ should be same length as mod\\n+\\t\\tlet result = BigUint::from_bytes_be(&precompile_result.output[..]);\\n+\\t\\tlet expected = BigUint::parse_bytes(b\"0\", 10).unwrap();\\n+\\t\\tassert_eq!(result, expected);\\n+\\t}\\n }'}}",
            "message_norm":"handle 0 exponent with fudged length correctly in modexp (#549)\n\n* handle 0 exponent with fudged length correctly in modexp\r\n\r\n* cargo fmt\r\n\r\n* revert to following eip-2565 strictly, subtract after adding terms to prevent underflow\r\n\r\n* update frame\/evm\/precompile\/modexp\/src\/lib.rs\r\n\r\nclean up test case\r\n\r\nco-authored-by: wei tang <accounts@that.world>\r\n\r\n* more revert\r\n\r\n* cargo fmt\r\n\r\n* prefer expect to match\r\n\r\nco-authored-by: wei tang <accounts@that.world>",
            "language":"en",
            "entities":"[('#549', 'ISSUE', ''), ('adding', 'ACTION', ''), ('prevent', 'ACTION', ''), ('underflow', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['frame\/evm\/precompile\/modexp\/src\/lib.rs'])",
            "num_files":1.0,
            "patch_content":"From 8a93fdc6c9f4eb1d2f2a11b7ff1d12d70bf5a664 Mon Sep 17 00:00:00 2001\nFrom: Stephen Shelton <steve@brewcraft.org>\nDate: Thu, 13 Jan 2022 09:23:07 -0700\nSubject: [PATCH] Handle 0 exponent with fudged length correctly in ModExp\n (#549)\n\n* Handle 0 exponent with fudged length correctly in ModExp\n\n* cargo fmt\n\n* Revert to following EIP-2565 strictly, subtract after adding terms to prevent underflow\n\n* Update frame\/evm\/precompile\/modexp\/src\/lib.rs\n\nClean up test case\n\nCo-authored-by: Wei Tang <accounts@that.world>\n\n* More revert\n\n* cargo fmt\n\n* Prefer expect to match\n\nCo-authored-by: Wei Tang <accounts@that.world>\n---\n frame\/evm\/precompile\/modexp\/src\/lib.rs | 56 +++++++++++++++++++++++---\n 1 file changed, 51 insertions(+), 5 deletions(-)\n\ndiff --git a\/frame\/evm\/precompile\/modexp\/src\/lib.rs b\/frame\/evm\/precompile\/modexp\/src\/lib.rs\nindex a7ae46e544..2aaad31bd4 100644\n--- a\/frame\/evm\/precompile\/modexp\/src\/lib.rs\n+++ b\/frame\/evm\/precompile\/modexp\/src\/lib.rs\n@@ -47,7 +47,10 @@ fn calculate_gas_cost(\n \t\t\twords += 1;\n \t\t}\n \n-\t\t\/\/ TODO: prevent\/handle overflow\n+\t\t\/\/ Note: can't overflow because we take words to be some u64 value \/ 8, which is\n+\t\t\/\/ necessarily less than sqrt(u64::MAX).\n+\t\t\/\/ Additionally, both base_length and mod_length are bounded to 1024, so this has\n+\t\t\/\/ an upper bound of roughly (1024 \/ 8) squared\n \t\twords * words\n \t}\n \n@@ -63,8 +66,17 @@ fn calculate_gas_cost(\n \t\t\tlet bytes: [u8; 32] = [0xFF; 32];\n \t\t\tlet max_256_bit_uint = BigUint::from_bytes_be(&bytes);\n \n+\t\t\t\/\/ from the EIP spec:\n+\t\t\t\/\/ (8 * (exp_length - 32)) + ((exponent & (2**256 - 1)).bit_length() - 1)\n+\t\t\t\/\/\n+\t\t\t\/\/ Notes:\n+\t\t\t\/\/ * exp_length is bounded to 1024 and is > 32\n+\t\t\t\/\/ * exponent can be zero, so we subtract 1 after adding the other terms (whose sum\n+\t\t\t\/\/   must be > 0)\n+\t\t\t\/\/ * the addition can't overflow because the terms are both capped at roughly\n+\t\t\t\/\/   8 * max size of exp_length (1024)\n \t\t\titeration_count =\n-\t\t\t\t(8 * (exp_length - 32)) + ((exponent.bitand(max_256_bit_uint)).bits() - 1);\n+\t\t\t\t(8 * (exp_length - 32)) + exponent.bitand(max_256_bit_uint).bits() - 1;\n \t\t}\n \n \t\tmax(iteration_count, 1)\n@@ -89,7 +101,7 @@ fn calculate_gas_cost(\n \/\/ 6) modulus, size as described above\n \/\/\n \/\/\n-\/\/ NOTE: input sizes are arbitrarily large (up to 256 bits), with the expectation\n+\/\/ NOTE: input sizes are bound to 1024 bytes, with the expectation\n \/\/       that gas limits would be applied before actual computation.\n \/\/\n \/\/       maximum stack size will also prevent abuse.\n@@ -133,7 +145,7 @@ impl Precompile for Modexp {\n \t\tlet mod_len_big = BigUint::from_bytes_be(&buf);\n \t\tif mod_len_big > max_size_big {\n \t\t\treturn Err(PrecompileFailure::Error {\n-\t\t\t\texit_status: ExitError::Other(\"unreasonably large exponent length\".into()),\n+\t\t\t\texit_status: ExitError::Other(\"unreasonably large modulus length\".into()),\n \t\t\t});\n \t\t}\n \n@@ -162,7 +174,6 @@ impl Precompile for Modexp {\n \t\t\tlet exponent = BigUint::from_bytes_be(&input[exp_start..exp_start + exp_len]);\n \n \t\t\t\/\/ do our gas accounting\n-\t\t\t\/\/ TODO: we could technically avoid reading base first...\n \t\t\tlet gas_cost =\n \t\t\t\tcalculate_gas_cost(base_len as u64, exp_len as u64, mod_len as u64, &exponent);\n \t\t\tif let Some(gas_left) = target_gas {\n@@ -423,4 +434,39 @@ mod tests {\n \t\t\t}\n \t\t}\n \t}\n+\n+\t#[test]\n+\tfn test_zero_exp_with_33_length() {\n+\t\t\/\/ This is a regression test which ensures that the 'iteration_count' calculation\n+\t\t\/\/ in 'calculate_iteration_count' cannot underflow.\n+\t\t\/\/\n+\t\t\/\/ In debug mode, this underflow could cause a panic. Otherwise, it causes N**0 to\n+\t\t\/\/ be calculated at more-than-normal expense.\n+\t\t\/\/\n+\t\t\/\/ TODO: cite security advisory\n+\n+\t\tlet input = vec![\n+\t\t\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n+\t\t\t0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n+\t\t\t0, 0, 0, 0, 0, 33, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n+\t\t\t0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,\n+\t\t\t0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,\n+\t\t];\n+\n+\t\tlet cost: u64 = 100000;\n+\n+\t\tlet context: Context = Context {\n+\t\t\taddress: Default::default(),\n+\t\t\tcaller: Default::default(),\n+\t\t\tapparent_value: From::from(0),\n+\t\t};\n+\n+\t\tlet precompile_result = Modexp::execute(&input, Some(cost), &context, false)\n+\t\t\t.expect(\"Modexp::execute() returned error\");\n+\n+\t\tassert_eq!(precompile_result.output.len(), 1); \/\/ should be same length as mod\n+\t\tlet result = BigUint::from_bytes_be(&precompile_result.output[..]);\n+\t\tlet expected = BigUint::parse_bytes(b\"0\", 10).unwrap();\n+\t\tassert_eq!(result, expected);\n+\t}\n }"
        },
        {
            "index":899,
            "vuln_id":"GHSA-3wfj-vh84-732p",
            "cwe_id":"{'CWE-78'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/apache\/activemq\/commit\/00921f22ff9a8792d7663ef8fadd4823402a6324'}",
            "dataset":"osv",
            "summary":"Improper Neutralization of Special Elements used in an OS Command in Apache ActiveMQ The processControlCommand function in broker\/TransportConnection.java in Apache ActiveMQ before 5.11.0 allows remote attackers to cause a denial of service (shutdown) via a shutdown command.",
            "published_date":"2022-05-14",
            "chain_len":1,
            "project":"https:\/\/github.com\/apache\/activemq",
            "commit_href":"https:\/\/github.com\/apache\/activemq\/commit\/00921f22ff9a8792d7663ef8fadd4823402a6324",
            "commit_sha":"00921f22ff9a8792d7663ef8fadd4823402a6324",
            "patch":"SINGLE",
            "chain_ord":"['00921f22ff9a8792d7663ef8fadd4823402a6324']",
            "before_first_fix_commit":"{'9a6d444e0a492231ad1f4833448b3bbacd839bce'}",
            "last_fix_commit":"00921f22ff9a8792d7663ef8fadd4823402a6324",
            "chain_ord_pos":1.0,
            "commit_datetime":"08\/13\/2014, 15:15:29",
            "message":"Remove unused ConnectionControl handling.",
            "author":"Timothy Bish",
            "comments":"{'com_1': {'author': 'tritschler', 'datetime': '11\/10\/2015, 09:33:23', 'body': 'No more shutdown ?'}, 'com_2': {'author': 'Hvnt3r', 'datetime': '07\/18\/2019, 08:46:59', 'body': '> No more shutdown ?\\r\\n\\r\\nyes'}}",
            "stats":"{'additions': 0, 'deletions': 4, 'total': 4}",
            "files":"{'activemq-broker\/src\/main\/java\/org\/apache\/activemq\/broker\/TransportConnection.java': {'additions': 0, 'deletions': 4, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/activemq\/raw\/00921f22ff9a8792d7663ef8fadd4823402a6324\/activemq-broker%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Factivemq%2Fbroker%2FTransportConnection.java', 'patch': '@@ -1534,10 +1534,6 @@ public int getProtocolVersion() {\\n \\n     @Override\\n     public Response processControlCommand(ControlCommand command) throws Exception {\\n-        String control = command.getCommand();\\n-        if (control != null && control.equals(\"shutdown\")) {\\n-            System.exit(0);\\n-        }\\n         return null;\\n     }'}}",
            "message_norm":"remove unused connectioncontrol handling.",
            "language":"en",
            "entities":"[('remove', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['activemq-broker\/src\/main\/java\/org\/apache\/activemq\/broker\/TransportConnection.java'])",
            "num_files":1.0,
            "patch_content":"From 00921f22ff9a8792d7663ef8fadd4823402a6324 Mon Sep 17 00:00:00 2001\nFrom: Timothy Bish <tabish121@gmail.com>\nDate: Wed, 13 Aug 2014 11:15:29 -0400\nSubject: [PATCH] Remove unused ConnectionControl handling.\n\n---\n ...\/java\/org\/apache\/activemq\/broker\/TransportConnection.java  | 4 ----\n 1 file changed, 4 deletions(-)\n\ndiff --git a\/activemq-broker\/src\/main\/java\/org\/apache\/activemq\/broker\/TransportConnection.java b\/activemq-broker\/src\/main\/java\/org\/apache\/activemq\/broker\/TransportConnection.java\nindex 22a63b8cf9b..5bb7ec1ec0b 100755\n--- a\/activemq-broker\/src\/main\/java\/org\/apache\/activemq\/broker\/TransportConnection.java\n+++ b\/activemq-broker\/src\/main\/java\/org\/apache\/activemq\/broker\/TransportConnection.java\n@@ -1534,10 +1534,6 @@ public int getProtocolVersion() {\n \n     @Override\n     public Response processControlCommand(ControlCommand command) throws Exception {\n-        String control = command.getCommand();\n-        if (control != null && control.equals(\"shutdown\")) {\n-            System.exit(0);\n-        }\n         return null;\n     }"
        },
        {
            "index":278,
            "vuln_id":"GHSA-2363-cqg2-863c",
            "cwe_id":"{'CWE-611'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/hunterhacker\/jdom\/commit\/dd4f3c2fc7893edd914954c73eb577f925a7d361'}",
            "dataset":"osv",
            "summary":"XML External Entity (XXE) Injection in JDOM An XXE issue in SAXBuilder in JDOM through 2.0.6 allows attackers to cause a denial of service via a crafted HTTP request.  At this time there is not released fixed version of JDOM.  As a workaround, to avoid external entities being expanded, one can call `builder.setExpandEntities(false)` and they won't be expanded.",
            "published_date":"2021-07-27",
            "chain_len":1,
            "project":"https:\/\/github.com\/hunterhacker\/jdom",
            "commit_href":"https:\/\/github.com\/hunterhacker\/jdom\/commit\/dd4f3c2fc7893edd914954c73eb577f925a7d361",
            "commit_sha":"dd4f3c2fc7893edd914954c73eb577f925a7d361",
            "patch":"SINGLE",
            "chain_ord":"['dd4f3c2fc7893edd914954c73eb577f925a7d361']",
            "before_first_fix_commit":"{'1f81562b5cc813bfbacb7e2842b5be17eb34896b'}",
            "last_fix_commit":"dd4f3c2fc7893edd914954c73eb577f925a7d361",
            "chain_ord_pos":1.0,
            "commit_datetime":"07\/02\/2021, 03:42:05",
            "message":"Addresses #189 - synchronizes external entity expansion setting",
            "author":"Rolf Lear",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 0, 'total': 6}",
            "files":"{'core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java': {'additions': 6, 'deletions': 0, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/hunterhacker\/jdom\/raw\/dd4f3c2fc7893edd914954c73eb577f925a7d361\/core%2Fsrc%2Fjava%2Forg%2Fjdom2%2Finput%2FSAXBuilder.java', 'patch': '@@ -82,6 +82,7 @@ OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\\n import org.jdom2.DocType;\\n import org.jdom2.Document;\\n import org.jdom2.EntityRef;\\n+import org.jdom2.JDOMConstants;\\n import org.jdom2.JDOMException;\\n import org.jdom2.JDOMFactory;\\n import org.jdom2.Verifier;\\n@@ -797,6 +798,11 @@ public void setFastReconfigure(final boolean fastReconfigure) {\\n \\tpublic void setFeature(final String name, final boolean value) {\\n \\t\\t\/\/ Save the specified feature for later.\\n \\t\\tfeatures.put(name, value ? Boolean.TRUE : Boolean.FALSE);\\n+\\t\\tif (JDOMConstants.SAX_FEATURE_EXTERNAL_ENT.equals(name)) {\\n+\\t\\t\\t\/\/ See issue https:\/\/github.com\/hunterhacker\/jdom\/issues\/189\\n+\\t\\t\\t\/\/ And PR https:\/\/github.com\/hunterhacker\/jdom\/pull\/188\\n+\\t\\t\\tsetExpandEntities(value);\\n+\\t\\t}\\n \\t\\tengine = null;\\n \\t}'}}",
            "message_norm":"addresses #189 - synchronizes external entity expansion setting",
            "language":"en",
            "entities":"[('#189', 'ISSUE', ''), ('external entity', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java'])",
            "num_files":1.0,
            "patch_content":"From dd4f3c2fc7893edd914954c73eb577f925a7d361 Mon Sep 17 00:00:00 2001\nFrom: Rolf Lear <rolf@tuis.net>\nDate: Thu, 1 Jul 2021 23:42:05 -0400\nSubject: [PATCH] Addresses #189 - synchronizes external entity expansion\n setting\n\n---\n core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java | 6 ++++++\n 1 file changed, 6 insertions(+)\n\ndiff --git a\/core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java b\/core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java\nindex a1462334..514b026d 100644\n--- a\/core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java\n+++ b\/core\/src\/java\/org\/jdom2\/input\/SAXBuilder.java\n@@ -82,6 +82,7 @@ OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n import org.jdom2.DocType;\n import org.jdom2.Document;\n import org.jdom2.EntityRef;\n+import org.jdom2.JDOMConstants;\n import org.jdom2.JDOMException;\n import org.jdom2.JDOMFactory;\n import org.jdom2.Verifier;\n@@ -797,6 +798,11 @@ public void setFastReconfigure(final boolean fastReconfigure) {\n \tpublic void setFeature(final String name, final boolean value) {\n \t\t\/\/ Save the specified feature for later.\n \t\tfeatures.put(name, value ? Boolean.TRUE : Boolean.FALSE);\n+\t\tif (JDOMConstants.SAX_FEATURE_EXTERNAL_ENT.equals(name)) {\n+\t\t\t\/\/ See issue https:\/\/github.com\/hunterhacker\/jdom\/issues\/189\n+\t\t\t\/\/ And PR https:\/\/github.com\/hunterhacker\/jdom\/pull\/188\n+\t\t\tsetExpandEntities(value);\n+\t\t}\n \t\tengine = null;\n \t}"
        },
        {
            "index":50,
            "vuln_id":"GHSA-7jh9-6cpf-h4m7",
            "cwe_id":"{'CWE-79'}",
            "score":0.0,
            "chain":"{'https:\/\/github.com\/MrSwitch\/hello.js\/commit\/d6f5137f30de6e0ef7048191ee6ae575fdc2f669'}",
            "dataset":"osv",
            "summary":"XSS in hello.js This affects the package hello.js before 1.18.6. The code get the param oauth_redirect from url and pass it to location.assign without any check and sanitisation. So we can simply pass some XSS payloads into the url param oauth_redirect, such as javascript:alert(1).",
            "published_date":"2021-01-13",
            "chain_len":1,
            "project":"https:\/\/github.com\/MrSwitch\/hello.js",
            "commit_href":"https:\/\/github.com\/MrSwitch\/hello.js\/commit\/d6f5137f30de6e0ef7048191ee6ae575fdc2f669",
            "commit_sha":"d6f5137f30de6e0ef7048191ee6ae575fdc2f669",
            "patch":"SINGLE",
            "chain_ord":"['d6f5137f30de6e0ef7048191ee6ae575fdc2f669']",
            "before_first_fix_commit":"{'3b79ec93781b3d7b9c0b56f598e060301d1f3e73'}",
            "last_fix_commit":"d6f5137f30de6e0ef7048191ee6ae575fdc2f669",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/06\/2020, 11:20:56",
            "message":"fix(xss): oauth_redirect should be a valid url",
            "author":"Andrew Dodson",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 1, 'total': 6}",
            "files":"{'src\/hello.js': {'additions': 5, 'deletions': 1, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/MrSwitch\/hello.js\/raw\/d6f5137f30de6e0ef7048191ee6ae575fdc2f669\/src%2Fhello.js', 'patch': \"@@ -1388,8 +1388,12 @@ hello.utils.extend(hello.utils, {\\n \\t\\t\/\/ (URI Fragments within 302 Location URI are lost over HTTPS)\\n \\t\\t\/\/ Loading the redirect.html before triggering the OAuth Flow seems to fix it.\\n \\t\\telse if ('oauth_redirect' in p) {\\n+\\t\\t\\tvar url = decodeURIComponent(p.oauth_redirect);\\n+\\n+\\t\\t\\tif (isValidUrl(url)) {\\n+\\t\\t\\t\\tlocation.assign(url);\\n+\\t\\t\\t}\\n \\n-\\t\\t\\tlocation.assign(decodeURIComponent(p.oauth_redirect));\\n \\t\\t\\treturn;\\n \\t\\t}\"}}",
            "message_norm":"fix(xss): oauth_redirect should be a valid url",
            "language":"en",
            "entities":"[('fix(xss', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/hello.js'])",
            "num_files":1.0,
            "patch_content":"From d6f5137f30de6e0ef7048191ee6ae575fdc2f669 Mon Sep 17 00:00:00 2001\nFrom: Andrew Dodson <andrew@5app.com>\nDate: Tue, 6 Oct 2020 12:20:56 +0100\nSubject: [PATCH] fix(xss): oauth_redirect should be a valid url\n\n---\n src\/hello.js | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/hello.js b\/src\/hello.js\nindex e2c57a73..e8618d17 100644\n--- a\/src\/hello.js\n+++ b\/src\/hello.js\n@@ -1388,8 +1388,12 @@ hello.utils.extend(hello.utils, {\n \t\t\/\/ (URI Fragments within 302 Location URI are lost over HTTPS)\n \t\t\/\/ Loading the redirect.html before triggering the OAuth Flow seems to fix it.\n \t\telse if ('oauth_redirect' in p) {\n+\t\t\tvar url = decodeURIComponent(p.oauth_redirect);\n+\n+\t\t\tif (isValidUrl(url)) {\n+\t\t\t\tlocation.assign(url);\n+\t\t\t}\n \n-\t\t\tlocation.assign(decodeURIComponent(p.oauth_redirect));\n \t\t\treturn;\n \t\t}"
        },
        {
            "index":306,
            "vuln_id":"GHSA-8r7q-r9mx-35rh",
            "cwe_id":"{'CWE-134'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/rusqlite\/rusqlite\/commit\/2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0'}",
            "dataset":"osv",
            "summary":"Mishandling of format strings in rusqlite An issue was discovered in the rusqlite crate before 0.23.0 for Rust. Memory safety can be violated because rusqlite::trace::log mishandles format strings.",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/rusqlite\/rusqlite",
            "commit_href":"https:\/\/github.com\/rusqlite\/rusqlite\/commit\/2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0",
            "commit_sha":"2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0",
            "patch":"SINGLE",
            "chain_ord":"['2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0']",
            "before_first_fix_commit":"{'abbab7216a8b47108a0e1b7a26e429d6a990d7a6'}",
            "last_fix_commit":"2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/14\/2020, 19:08:26",
            "message":"Fix format string error in rusqlite::trace::log",
            "author":"Thom Chiovoloni",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'src\/trace.rs': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/rusqlite\/rusqlite\/raw\/2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0\/src%2Ftrace.rs', 'patch': '@@ -61,7 +61,7 @@ pub unsafe fn config_log(callback: Option<fn(c_int, &str)>) -> Result<()> {\\n pub fn log(err_code: c_int, msg: &str) {\\n     let msg = CString::new(msg).expect(\"SQLite log messages cannot contain embedded zeroes\");\\n     unsafe {\\n-        ffi::sqlite3_log(err_code, msg.as_ptr());\\n+        ffi::sqlite3_log(err_code, b\"%s\\\\0\" as *const _ as *const c_char, msg.as_ptr());\\n     }\\n }'}}",
            "message_norm":"fix format string error in rusqlite::trace::log",
            "language":"en",
            "entities":"[('error', 'FLAW', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/trace.rs'])",
            "num_files":1.0,
            "patch_content":"From 2327d3b774927fdf48903c0bdc1ca7ec93c7c8d0 Mon Sep 17 00:00:00 2001\nFrom: Thom Chiovoloni <tchiovoloni@mozilla.com>\nDate: Tue, 14 Apr 2020 12:08:26 -0700\nSubject: [PATCH] Fix format string error in rusqlite::trace::log\n\n---\n src\/trace.rs | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/trace.rs b\/src\/trace.rs\nindex c03435503..39ef69ff3 100644\n--- a\/src\/trace.rs\n+++ b\/src\/trace.rs\n@@ -61,7 +61,7 @@ pub unsafe fn config_log(callback: Option<fn(c_int, &str)>) -> Result<()> {\n pub fn log(err_code: c_int, msg: &str) {\n     let msg = CString::new(msg).expect(\"SQLite log messages cannot contain embedded zeroes\");\n     unsafe {\n-        ffi::sqlite3_log(err_code, msg.as_ptr());\n+        ffi::sqlite3_log(err_code, b\"%s\\0\" as *const _ as *const c_char, msg.as_ptr());\n     }\n }"
        },
        {
            "index":237,
            "vuln_id":"GHSA-rf3h-xgv5-2q39",
            "cwe_id":"{'CWE-369'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0'}",
            "dataset":"osv",
            "summary":"Division by zero in TFLite's implementation of `DepthwiseConv` ### Impact\nThe implementation of the `DepthwiseConv` TFLite operator is [vulnerable to a division by zero error](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/1a8e885b864c818198a5b2c0cbbeca5a1e833bc8\/tensorflow\/lite\/kernels\/depthwise_conv.cc#L287-L288):\n\n```cc\nint num_input_channels = SizeOfDimension(input, 3);\nTF_LITE_ENSURE_EQ(context, num_filter_channels % num_input_channels, 0);\n```\n\nAn attacker can craft a model such that `input`'s fourth dimension would be 0.\n\n### Patches\nWe have patched the issue in GitHub commit [cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information \nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0",
            "commit_sha":"cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0",
            "patch":"SINGLE",
            "chain_ord":"['cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0']",
            "before_first_fix_commit":"{'1a8e885b864c818198a5b2c0cbbeca5a1e833bc8'}",
            "last_fix_commit":"cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/28\/2021, 22:53:48",
            "message":"Prevent divisions by 0\n\nPiperOrigin-RevId: 371003153\nChange-Id: Idef56c95b9fcaeb97f87e18c7a674dbeb5173204",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 2, 'total': 5}",
            "files":"{'tensorflow\/lite\/kernels\/depthwise_conv.cc': {'additions': 3, 'deletions': 2, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0\/tensorflow%2Flite%2Fkernels%2Fdepthwise_conv.cc', 'patch': '@@ -285,8 +285,8 @@ TfLiteStatus ComputeDepthMultiplier(TfLiteContext* context,\\n                                     int16* depth_multiplier) {\\n   int num_filter_channels = SizeOfDimension(filter, 3);\\n   int num_input_channels = SizeOfDimension(input, 3);\\n+  TF_LITE_ENSURE(context, num_input_channels != 0);\\n   TF_LITE_ENSURE_EQ(context, num_filter_channels % num_input_channels, 0);\\n-\\n   *depth_multiplier = num_filter_channels \/ num_input_channels;\\n   return kTfLiteOk;\\n }\\n@@ -455,8 +455,9 @@ TfLiteStatus EvalHybridPerChannel(TfLiteContext* context, TfLiteNode* node,\\n   float output_activation_min, output_activation_max;\\n   CalculateActivationRange(params->activation, &output_activation_min,\\n                            &output_activation_max);\\n-  const int input_size = NumElements(input) \/ SizeOfDimension(input, 0);\\n   const int batch_size = SizeOfDimension(input, 0);\\n+  TF_LITE_ENSURE(context, batch_size != 0);\\n+  const int input_size = NumElements(input) \/ batch_size;\\n   TfLiteTensor* input_quantized;\\n   TF_LITE_ENSURE_OK(context,\\n                     GetTemporarySafe(context, node, data->input_quantized_index,'}}",
            "message_norm":"prevent divisions by 0\n\npiperorigin-revid: 371003153\nchange-id: idef56c95b9fcaeb97f87e18c7a674dbeb5173204",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('divisions by 0', 'SECWORD', ''), ('371003153', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/kernels\/depthwise_conv.cc'])",
            "num_files":1.0,
            "patch_content":"From cbda3c6b2dbbd3fbdc482ff8c0170a78ec2e97d0 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Wed, 28 Apr 2021 15:53:48 -0700\nSubject: [PATCH] Prevent divisions by 0\n\nPiperOrigin-RevId: 371003153\nChange-Id: Idef56c95b9fcaeb97f87e18c7a674dbeb5173204\n---\n tensorflow\/lite\/kernels\/depthwise_conv.cc | 5 +++--\n 1 file changed, 3 insertions(+), 2 deletions(-)\n\ndiff --git a\/tensorflow\/lite\/kernels\/depthwise_conv.cc b\/tensorflow\/lite\/kernels\/depthwise_conv.cc\nindex 42920e11fc4333..fdbcae3607f06c 100644\n--- a\/tensorflow\/lite\/kernels\/depthwise_conv.cc\n+++ b\/tensorflow\/lite\/kernels\/depthwise_conv.cc\n@@ -285,8 +285,8 @@ TfLiteStatus ComputeDepthMultiplier(TfLiteContext* context,\n                                     int16* depth_multiplier) {\n   int num_filter_channels = SizeOfDimension(filter, 3);\n   int num_input_channels = SizeOfDimension(input, 3);\n+  TF_LITE_ENSURE(context, num_input_channels != 0);\n   TF_LITE_ENSURE_EQ(context, num_filter_channels % num_input_channels, 0);\n-\n   *depth_multiplier = num_filter_channels \/ num_input_channels;\n   return kTfLiteOk;\n }\n@@ -455,8 +455,9 @@ TfLiteStatus EvalHybridPerChannel(TfLiteContext* context, TfLiteNode* node,\n   float output_activation_min, output_activation_max;\n   CalculateActivationRange(params->activation, &output_activation_min,\n                            &output_activation_max);\n-  const int input_size = NumElements(input) \/ SizeOfDimension(input, 0);\n   const int batch_size = SizeOfDimension(input, 0);\n+  TF_LITE_ENSURE(context, batch_size != 0);\n+  const int input_size = NumElements(input) \/ batch_size;\n   TfLiteTensor* input_quantized;\n   TF_LITE_ENSURE_OK(context,\n                     GetTemporarySafe(context, node, data->input_quantized_index,"
        },
        {
            "index":431,
            "vuln_id":"GHSA-5qw5-89mw-wcg2",
            "cwe_id":"{'CWE-787'}",
            "score":8.8,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/97282c6d0d34476b6ba033f961590b783fa184cd'}",
            "dataset":"osv",
            "summary":"Out of bounds write in Tensorflow ### Impact\nTensorFlow is vulnerable to a heap OOB write in [Grappler](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/a1320ec1eac186da1d03f033109191f715b2b130\/tensorflow\/core\/grappler\/costs\/graph_properties.cc#L1132-L1141):\n\n```cc\nStatus SetUnknownShape(const NodeDef* node, int output_port) {\n  shape_inference::ShapeHandle shape = \n      GetUnknownOutputShape(node, output_port);\n  InferenceContext* ctx = GetContext(node);\n  if (ctx == nullptr) {\n    return errors::InvalidArgument(\"Missing context\");\n  }\n  ctx->set_output(output_port, shape);\n  return Status::OK();\n}\n```\n\nThe [`set_output`](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/a1320ec1eac186da1d03f033109191f715b2b130\/tensorflow\/core\/framework\/shape_inference.h#L394) function writes to an array at the specified index:\n\n```cc\nvoid set_output(int idx, ShapeHandle shape) { outputs_.at(idx) = shape; }\n```\n\nHence, this gives a malicious user a write primitive.\n\n### Patches\nWe have patched the issue in GitHub commit [97282c6d0d34476b6ba033f961590b783fa184cd](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/97282c6d0d34476b6ba033f961590b783fa184cd).\n\nThe fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.",
            "published_date":"2022-02-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/97282c6d0d34476b6ba033f961590b783fa184cd",
            "commit_sha":"97282c6d0d34476b6ba033f961590b783fa184cd",
            "patch":"SINGLE",
            "chain_ord":"['97282c6d0d34476b6ba033f961590b783fa184cd']",
            "before_first_fix_commit":"{'557a09455bc98108bc29b3b78e818f9d7dca920f'}",
            "last_fix_commit":"97282c6d0d34476b6ba033f961590b783fa184cd",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/08\/2021, 13:48:40",
            "message":"Prevent a crash due to heap OOB write in grappler.\n\nPiperOrigin-RevId: 408318417\nChange-Id: If095feb8c001e3a8ac4a85b7387b81e8309df47d",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 1, 'total': 7}",
            "files":"{'tensorflow\/core\/grappler\/costs\/graph_properties.cc': {'additions': 6, 'deletions': 1, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/97282c6d0d34476b6ba033f961590b783fa184cd\/tensorflow%2Fcore%2Fgrappler%2Fcosts%2Fgraph_properties.cc', 'patch': '@@ -1134,7 +1134,12 @@ class SymbolicShapeRefiner {\\n         GetUnknownOutputShape(node, output_port);\\n     InferenceContext* ctx = GetContext(node);\\n     if (ctx == nullptr) {\\n-      return errors::InvalidArgument(\"Missing context\");\\n+      return errors::InvalidArgument(\"SetUnknownShape: Missing context\");\\n+    }\\n+    if (output_port < 0 || output_port >= ctx->num_outputs()) {\\n+      return errors::InvalidArgument(\\n+          \"SetUnknownShape: output_port must be in [0, \", ctx->num_outputs(),\\n+          \") but was \", output_port);\\n     }\\n     ctx->set_output(output_port, shape);\\n     return Status::OK();'}}",
            "message_norm":"prevent a crash due to heap oob write in grappler.\n\npiperorigin-revid: 408318417\nchange-id: if095feb8c001e3a8ac4a85b7387b81e8309df47d",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('heap oob', 'SECWORD', ''), ('408318417', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/grappler\/costs\/graph_properties.cc'])",
            "num_files":1.0,
            "patch_content":"From 97282c6d0d34476b6ba033f961590b783fa184cd Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Mon, 8 Nov 2021 05:48:40 -0800\nSubject: [PATCH] Prevent a crash due to heap OOB write in grappler.\n\nPiperOrigin-RevId: 408318417\nChange-Id: If095feb8c001e3a8ac4a85b7387b81e8309df47d\n---\n tensorflow\/core\/grappler\/costs\/graph_properties.cc | 7 ++++++-\n 1 file changed, 6 insertions(+), 1 deletion(-)\n\ndiff --git a\/tensorflow\/core\/grappler\/costs\/graph_properties.cc b\/tensorflow\/core\/grappler\/costs\/graph_properties.cc\nindex 51a2cd080c5445..3cc12173ba10c5 100644\n--- a\/tensorflow\/core\/grappler\/costs\/graph_properties.cc\n+++ b\/tensorflow\/core\/grappler\/costs\/graph_properties.cc\n@@ -1134,7 +1134,12 @@ class SymbolicShapeRefiner {\n         GetUnknownOutputShape(node, output_port);\n     InferenceContext* ctx = GetContext(node);\n     if (ctx == nullptr) {\n-      return errors::InvalidArgument(\"Missing context\");\n+      return errors::InvalidArgument(\"SetUnknownShape: Missing context\");\n+    }\n+    if (output_port < 0 || output_port >= ctx->num_outputs()) {\n+      return errors::InvalidArgument(\n+          \"SetUnknownShape: output_port must be in [0, \", ctx->num_outputs(),\n+          \") but was \", output_port);\n     }\n     ctx->set_output(output_port, shape);\n     return Status::OK();"
        },
        {
            "index":120,
            "vuln_id":"GHSA-2hjr-fg6c-v2h6",
            "cwe_id":"{'CWE-200'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/HubSpot\/jinjava\/pull\/435\/commits\/1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165', 'https:\/\/github.com\/HubSpot\/jinjava\/pull\/426\/commits\/5dfa5b87318744a4d020b66d5f7747acc36b213b'}",
            "dataset":"osv",
            "summary":"Unauthorized access to Class instance in Jinjava Jinjava before 2.5.4 allow access to arbitrary classes by calling Java methods on objects passed into a Jinjava context. This could allow for abuse of the application class loader, including Arbitrary File Disclosure.",
            "published_date":"2022-02-09",
            "chain_len":2,
            "project":"https:\/\/github.com\/HubSpot\/jinjava",
            "commit_href":"https:\/\/github.com\/HubSpot\/jinjava\/pull\/435\/commits\/1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165",
            "commit_sha":"1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165",
            "patch":"MULTI",
            "chain_ord":"['5dfa5b87318744a4d020b66d5f7747acc36b213b', '1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165']",
            "before_first_fix_commit":"{'bfc6ecde3a98db02a00c87a3b905a0af907188f0'}",
            "last_fix_commit":"1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165",
            "chain_ord_pos":2.0,
            "commit_datetime":"04\/28\/2020, 18:20:50",
            "message":"Add interpreter to blacklist",
            "author":"Matt Coley",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 1, 'total': 4}",
            "files":"{'src\/main\/java\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java': {'additions': 3, 'deletions': 1, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/HubSpot\/jinjava\/raw\/1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165\/src%2Fmain%2Fjava%2Fcom%2Fhubspot%2Fjinjava%2Fel%2Fext%2FJinjavaBeanELResolver.java', 'patch': '@@ -2,6 +2,7 @@\\n \\n import com.google.common.base.CaseFormat;\\n import com.google.common.collect.ImmutableSet;\\n+import com.hubspot.jinjava.interpret.JinjavaInterpreter;\\n import java.lang.reflect.Constructor;\\n import java.lang.reflect.Field;\\n import java.lang.reflect.Method;\\n@@ -136,7 +137,8 @@ protected boolean isRestrictedClass(Object o) {\\n       o instanceof Thread ||\\n       o instanceof Method ||\\n       o instanceof Field ||\\n-      o instanceof Constructor\\n+      o instanceof Constructor ||\\n+      o instanceof JinjavaInterpreter\\n     );\\n   }\\n }'}}",
            "message_norm":"add interpreter to blacklist",
            "language":"sv",
            "entities":"[('add', 'ACTION', ''), ('blacklist', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/main\/java\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java'])",
            "num_files":1.0,
            "patch_content":"From 1b9aaa4b420c58b4a301cf4b7d26207f1c8d1165 Mon Sep 17 00:00:00 2001\nFrom: Matt Coley <mcoley@hubspot.com>\nDate: Tue, 28 Apr 2020 14:20:50 -0400\nSubject: [PATCH] Add interpreter to blacklist\n\n---\n ...\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java     | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/main\/java\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java b\/src\/main\/java\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java\nindex 967afb0c4..30549acc9 100644\n--- a\/src\/main\/java\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java\n+++ b\/src\/main\/java\/com\/hubspot\/jinjava\/el\/ext\/JinjavaBeanELResolver.java\n@@ -2,6 +2,7 @@\n \n import com.google.common.base.CaseFormat;\n import com.google.common.collect.ImmutableSet;\n+import com.hubspot.jinjava.interpret.JinjavaInterpreter;\n import java.lang.reflect.Constructor;\n import java.lang.reflect.Field;\n import java.lang.reflect.Method;\n@@ -136,7 +137,8 @@ protected boolean isRestrictedClass(Object o) {\n       o instanceof Thread ||\n       o instanceof Method ||\n       o instanceof Field ||\n-      o instanceof Constructor\n+      o instanceof Constructor ||\n+      o instanceof JinjavaInterpreter\n     );\n   }\n }"
        },
        {
            "index":931,
            "vuln_id":"GHSA-gxg6-rc6c-v673",
            "cwe_id":"{'CWE-20'}",
            "score":8.1,
            "chain":"{'https:\/\/github.com\/beanshell\/beanshell\/commit\/7c68fde2d6fc65e362f20863d868c112a90a9b49', 'https:\/\/github.com\/beanshell\/beanshell\/commit\/1ccc66bb693d4e46a34a904db8eeff07808d2ced'}",
            "dataset":"osv",
            "summary":"Improper Input Validation in BeanShell BeanShell (bsh) before 2.0b6, when included on the classpath by an application that uses Java serialization or XStream, allows remote attackers to execute arbitrary code via crafted serialized data, related to XThis.Handler.",
            "published_date":"2022-05-13",
            "chain_len":2,
            "project":"https:\/\/github.com\/beanshell\/beanshell",
            "commit_href":"https:\/\/github.com\/beanshell\/beanshell\/commit\/7c68fde2d6fc65e362f20863d868c112a90a9b49",
            "commit_sha":"7c68fde2d6fc65e362f20863d868c112a90a9b49",
            "patch":"MULTI",
            "chain_ord":"['1ccc66bb693d4e46a34a904db8eeff07808d2ced', '7c68fde2d6fc65e362f20863d868c112a90a9b49']",
            "before_first_fix_commit":"{'1ccc66bb693d4e46a34a904db8eeff07808d2ced'}",
            "last_fix_commit":"7c68fde2d6fc65e362f20863d868c112a90a9b49",
            "chain_ord_pos":2.0,
            "commit_datetime":"02\/03\/2016, 01:03:20",
            "message":"Prevent deserialization of Handler",
            "author":"Stian Soiland-Reyes",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
            "files":"{'src\/bsh\/XThis.java': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/beanshell\/beanshell\/raw\/7c68fde2d6fc65e362f20863d868c112a90a9b49\/src%2Fbsh%2FXThis.java', 'patch': '@@ -118,6 +118,10 @@ interface from JDK1.2 VM...\\n \\t*\/\\n \\tclass Handler implements InvocationHandler\\n \\t{\\n+\\t\\tprivate Object readResolve() throws ObjectStreamException {\\n+\\t\\t\\tthrow new NotSerializableException();\\n+\\t\\t}\\n+\\n \\t\\tpublic Object invoke( Object proxy, Method method, Object[] args )\\n \\t\\t\\tthrows Throwable\\n \\t\\t{'}}",
            "message_norm":"prevent deserialization of handler",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('deserialization', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/bsh\/XThis.java'])",
            "num_files":1.0,
            "patch_content":"From 7c68fde2d6fc65e362f20863d868c112a90a9b49 Mon Sep 17 00:00:00 2001\nFrom: Stian Soiland-Reyes <soiland-reyes@cs.manchester.ac.uk>\nDate: Wed, 3 Feb 2016 01:03:20 +0000\nSubject: [PATCH] Prevent deserialization of Handler\n\n---\n src\/bsh\/XThis.java | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/src\/bsh\/XThis.java b\/src\/bsh\/XThis.java\nindex 6f68b431c..f169fdc21 100644\n--- a\/src\/bsh\/XThis.java\n+++ b\/src\/bsh\/XThis.java\n@@ -118,6 +118,10 @@ interface from JDK1.2 VM...\n \t*\/\n \tclass Handler implements InvocationHandler\n \t{\n+\t\tprivate Object readResolve() throws ObjectStreamException {\n+\t\t\tthrow new NotSerializableException();\n+\t\t}\n+\n \t\tpublic Object invoke( Object proxy, Method method, Object[] args )\n \t\t\tthrows Throwable\n \t\t{"
        },
        {
            "index":420,
            "vuln_id":"GHSA-w32p-76xr-88pc",
            "cwe_id":"{'CWE-787'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/90f67afac6362828c750f3bccbcc1c360caf29e4', 'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/3d6226cc2d1077537220361c82e34a362c6c76ee'}",
            "dataset":"osv",
            "summary":"Out-of-bounds write A remote code execution vulnerability exists in the way that the Chakra scripting engine handles objects in memory in Microsoft Edge, aka 'Chakra Scripting Engine Memory Corruption Vulnerability'. This CVE ID is unique from CVE-2019-0989, CVE-2019-0991, CVE-2019-0992, CVE-2019-0993, CVE-2019-1002, CVE-2019-1024, CVE-2019-1051, CVE-2019-1052.",
            "published_date":"2021-03-29",
            "chain_len":2,
            "project":"https:\/\/github.com\/chakra-core\/ChakraCore",
            "commit_href":"https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/90f67afac6362828c750f3bccbcc1c360caf29e4",
            "commit_sha":"90f67afac6362828c750f3bccbcc1c360caf29e4",
            "patch":"MULTI",
            "chain_ord":"['90f67afac6362828c750f3bccbcc1c360caf29e4', '3d6226cc2d1077537220361c82e34a362c6c76ee']",
            "before_first_fix_commit":"{'d797e3f00e34c12c8c0ae52f56344325439dccd7', 'eabf77ad17010f220639e5261798da9ac14e43e3'}",
            "last_fix_commit":"3d6226cc2d1077537220361c82e34a362c6c76ee",
            "chain_ord_pos":1.0,
            "commit_datetime":"05\/15\/2019, 22:37:38",
            "message":"CVE-2019-1003",
            "author":"Paul Leathers",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
            "files":"{'lib\/Runtime\/Library\/JavascriptProxy.cpp': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/chakra-core\/ChakraCore\/raw\/90f67afac6362828c750f3bccbcc1c360caf29e4\/lib%2FRuntime%2FLibrary%2FJavascriptProxy.cpp', 'patch': '@@ -392,6 +392,8 @@ namespace Js\\n         }\\n         propertyDescriptor->SetValue(getGetResult);\\n \\n+        threadContext->AddImplicitCallFlags(Js::ImplicitCall_External);\\n+\\n         return TRUE;\\n     }\\n \\n@@ -1907,6 +1909,9 @@ namespace Js\\n                 }\\n             }\\n         }\\n+\\n+        threadContext->AddImplicitCallFlags(Js::ImplicitCall_External);\\n+\\n         return TRUE;\\n \\n     }'}}",
            "message_norm":"cve-2019-1003",
            "language":"ro",
            "entities":"[('cve-2019-1003', 'VULNID', 'CVE')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/Runtime\/Library\/JavascriptProxy.cpp'])",
            "num_files":1.0,
            "patch_content":"From 90f67afac6362828c750f3bccbcc1c360caf29e4 Mon Sep 17 00:00:00 2001\nFrom: Paul Leathers <pleath@microsoft.com>\nDate: Wed, 15 May 2019 15:37:38 -0700\nSubject: [PATCH] CVE-2019-1003\n\n---\n lib\/Runtime\/Library\/JavascriptProxy.cpp | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/lib\/Runtime\/Library\/JavascriptProxy.cpp b\/lib\/Runtime\/Library\/JavascriptProxy.cpp\nindex 6e026109735..ed817269a82 100644\n--- a\/lib\/Runtime\/Library\/JavascriptProxy.cpp\n+++ b\/lib\/Runtime\/Library\/JavascriptProxy.cpp\n@@ -392,6 +392,8 @@ namespace Js\n         }\n         propertyDescriptor->SetValue(getGetResult);\n \n+        threadContext->AddImplicitCallFlags(Js::ImplicitCall_External);\n+\n         return TRUE;\n     }\n \n@@ -1907,6 +1909,9 @@ namespace Js\n                 }\n             }\n         }\n+\n+        threadContext->AddImplicitCallFlags(Js::ImplicitCall_External);\n+\n         return TRUE;\n \n     }"
        },
        {
            "index":15,
            "vuln_id":"GHSA-m648-33qf-v3gp",
            "cwe_id":"{'CWE-20'}",
            "score":4.4,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/14755416e364f17fb1870882fa778c7fec7f16e3'}",
            "dataset":"osv",
            "summary":"CHECK-fail in LSTM with zero-length input in TensorFlow ### Impact\nRunning an LSTM\/GRU model where the LSTM\/GRU layer receives an input with zero-length results in a `CHECK` failure when using the CUDA backend.\n\nThis can result in a query-of-death vulnerability, via denial of service, if users can control the input to the layer.\n\n### Patches\nWe have patched the issue in GitHub commit [14755416e364f17fb1870882fa778c7fec7f16e3](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/14755416e364f17fb1870882fa778c7fec7f16e3) and will release TensorFlow 2.4.0 containing the patch. TensorFlow nightly packages after this commit will also have the issue resolved.\n\nSince this issue also impacts TF versions before 2.4, we will patch all releases between 1.15 and 2.3 inclusive.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.",
            "published_date":"2020-12-10",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/14755416e364f17fb1870882fa778c7fec7f16e3",
            "commit_sha":"14755416e364f17fb1870882fa778c7fec7f16e3",
            "patch":"SINGLE",
            "chain_ord":"['14755416e364f17fb1870882fa778c7fec7f16e3']",
            "before_first_fix_commit":"{'042a6923d7f9ff05e7514bf6011e4ca30be70113'}",
            "last_fix_commit":"14755416e364f17fb1870882fa778c7fec7f16e3",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/08\/2020, 04:31:31",
            "message":"Prevent CHECK-fail in LSTM\/GRU with zero-length input.\n\nPiperOrigin-RevId: 346239181\nChange-Id: I5f233dbc076aab7bb4e31ba24f5abd4eaf99ea4f",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 2, 'total': 8}",
            "files":"{'tensorflow\/stream_executor\/cuda\/cuda_dnn.cc': {'additions': 6, 'deletions': 2, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/14755416e364f17fb1870882fa778c7fec7f16e3\/tensorflow%2Fstream_executor%2Fcuda%2Fcuda_dnn.cc', 'patch': '@@ -1468,7 +1468,9 @@ class CudnnRnnSequenceTensorDescriptor\\n   static port::StatusOr<CudnnRnnSequenceTensorDescriptor> Create(\\n       GpuExecutor* parent, int max_seq_length, int batch_size, int data_size,\\n       cudnnDataType_t data_type) {\\n-    CHECK_GT(max_seq_length, 0);\\n+    if (max_seq_length <= 0) {\\n+      return port::Status(port::error::INVALID_ARGUMENT, \"max_seq_length <= 0\");\\n+    }\\n     int dims[] = {batch_size, data_size, 1};\\n     int strides[] = {dims[1] * dims[2], dims[2], 1};\\n     TensorDescriptor tensor_desc = CreateTensorDescriptor();\\n@@ -1486,7 +1488,9 @@ class CudnnRnnSequenceTensorDescriptor\\n       GpuExecutor* parent, int max_seq_length, int batch_size, int data_size,\\n       const absl::Span<const int>& seq_lengths, bool time_major,\\n       cudnnDataType_t data_type) {\\n-    CHECK_GT(max_seq_length, 0);\\n+    if (max_seq_length <= 0) {\\n+      return port::Status(port::error::INVALID_ARGUMENT, \"max_seq_length <= 0\");\\n+    }\\n     int dims[] = {batch_size, data_size, 1};\\n     int strides[] = {dims[1] * dims[2], dims[2], 1};\\n     TensorDescriptor tensor_desc = CreateTensorDescriptor();'}}",
            "message_norm":"prevent check-fail in lstm\/gru with zero-length input.\n\npiperorigin-revid: 346239181\nchange-id: i5f233dbc076aab7bb4e31ba24f5abd4eaf99ea4f",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('346239181', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/stream_executor\/cuda\/cuda_dnn.cc'])",
            "num_files":1.0,
            "patch_content":"From 14755416e364f17fb1870882fa778c7fec7f16e3 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Mon, 7 Dec 2020 20:31:31 -0800\nSubject: [PATCH] Prevent CHECK-fail in LSTM\/GRU with zero-length input.\n\nPiperOrigin-RevId: 346239181\nChange-Id: I5f233dbc076aab7bb4e31ba24f5abd4eaf99ea4f\n---\n tensorflow\/stream_executor\/cuda\/cuda_dnn.cc | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\ndiff --git a\/tensorflow\/stream_executor\/cuda\/cuda_dnn.cc b\/tensorflow\/stream_executor\/cuda\/cuda_dnn.cc\nindex c03eb0a57e99cf..e4e9914adf0feb 100644\n--- a\/tensorflow\/stream_executor\/cuda\/cuda_dnn.cc\n+++ b\/tensorflow\/stream_executor\/cuda\/cuda_dnn.cc\n@@ -1468,7 +1468,9 @@ class CudnnRnnSequenceTensorDescriptor\n   static port::StatusOr<CudnnRnnSequenceTensorDescriptor> Create(\n       GpuExecutor* parent, int max_seq_length, int batch_size, int data_size,\n       cudnnDataType_t data_type) {\n-    CHECK_GT(max_seq_length, 0);\n+    if (max_seq_length <= 0) {\n+      return port::Status(port::error::INVALID_ARGUMENT, \"max_seq_length <= 0\");\n+    }\n     int dims[] = {batch_size, data_size, 1};\n     int strides[] = {dims[1] * dims[2], dims[2], 1};\n     TensorDescriptor tensor_desc = CreateTensorDescriptor();\n@@ -1486,7 +1488,9 @@ class CudnnRnnSequenceTensorDescriptor\n       GpuExecutor* parent, int max_seq_length, int batch_size, int data_size,\n       const absl::Span<const int>& seq_lengths, bool time_major,\n       cudnnDataType_t data_type) {\n-    CHECK_GT(max_seq_length, 0);\n+    if (max_seq_length <= 0) {\n+      return port::Status(port::error::INVALID_ARGUMENT, \"max_seq_length <= 0\");\n+    }\n     int dims[] = {batch_size, data_size, 1};\n     int strides[] = {dims[1] * dims[2], dims[2], 1};\n     TensorDescriptor tensor_desc = CreateTensorDescriptor();"
        },
        {
            "index":686,
            "vuln_id":"GHSA-35q2-47q7-3pc3",
            "cwe_id":"{'CWE-400'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/NodeRedis\/node-redis\/commit\/2d11b6dc9b9774464a91fb4b448bad8bf699629e'}",
            "dataset":"osv",
            "summary":"Node-Redis potential exponential regex in monitor mode ### Impact\nWhen a client is in monitoring mode, the regex begin used to detected monitor messages could cause exponential backtracking on some strings. This issue could lead to a denial of service.\n\n### Patches\nThe problem was fixed in commit [`2d11b6d`](https:\/\/github.com\/NodeRedis\/node-redis\/commit\/2d11b6dc9b9774464a91fb4b448bad8bf699629e) and was released in version `3.1.1`.\n\n### References\n#1569 (GHSL-2021-026)",
            "published_date":"2021-04-27",
            "chain_len":1,
            "project":"https:\/\/github.com\/NodeRedis\/node-redis",
            "commit_href":"https:\/\/github.com\/NodeRedis\/node-redis\/commit\/2d11b6dc9b9774464a91fb4b448bad8bf699629e",
            "commit_sha":"2d11b6dc9b9774464a91fb4b448bad8bf699629e",
            "patch":"SINGLE",
            "chain_ord":"['2d11b6dc9b9774464a91fb4b448bad8bf699629e']",
            "before_first_fix_commit":"{'7e77de84bc80b0742321939c59612dc27559bbff'}",
            "last_fix_commit":"2d11b6dc9b9774464a91fb4b448bad8bf699629e",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/08\/2021, 22:04:34",
            "message":"fix #1569 - improve monitor_regex (#1595)\n\nCo-authored-by: Guy Korland <gkorland@gmail.com>",
            "author":"Leibale Eidelman",
            "comments":"{'com_1': {'author': 'Plavit', 'datetime': '04\/27\/2021, 21:27:30', 'body': 'lemme check compatibility'}}",
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'lib\/utils.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/redis\/node-redis\/raw\/2d11b6dc9b9774464a91fb4b448bad8bf699629e\/lib%2Futils.js', 'patch': '@@ -127,7 +127,7 @@ module.exports = {\\n     reply_to_object: replyToObject,\\n     print: print,\\n     err_code: \/^([A-Z]+)\\\\s+(.+)$\/,\\n-    monitor_regex: \/^[0-9]{10,11}\\\\.[0-9]+ \\\\[[0-9]+ .+\\\\]( \".+?\")+$\/,\\n+    monitor_regex: \/^[0-9]{10,11}\\\\.[0-9]+ \\\\[[0-9]+ .+\\\\].*\"$\/,\\n     clone: convenienceClone,\\n     callback_or_emit: callbackOrEmit,\\n     reply_in_order: replyInOrder'}}",
            "message_norm":"fix #1569 - improve monitor_regex (#1595)\n\nco-authored-by: guy korland <gkorland@gmail.com>",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('#1569', 'ISSUE', ''), ('improve', 'ACTION', ''), ('#1595', 'ISSUE', ''), ('gkorland@gmail.com', 'EMAIL', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/utils.js'])",
            "num_files":1.0,
            "patch_content":"From 2d11b6dc9b9774464a91fb4b448bad8bf699629e Mon Sep 17 00:00:00 2001\nFrom: Leibale Eidelman <leibale1998@gmail.com>\nDate: Thu, 8 Apr 2021 18:04:34 -0400\nSubject: [PATCH] fix #1569 - improve monitor_regex (#1595)\n\nCo-authored-by: Guy Korland <gkorland@gmail.com>\n---\n lib\/utils.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lib\/utils.js b\/lib\/utils.js\nindex 52e58ecfa6c..d0336ae9c1d 100644\n--- a\/lib\/utils.js\n+++ b\/lib\/utils.js\n@@ -127,7 +127,7 @@ module.exports = {\n     reply_to_object: replyToObject,\n     print: print,\n     err_code: \/^([A-Z]+)\\s+(.+)$\/,\n-    monitor_regex: \/^[0-9]{10,11}\\.[0-9]+ \\[[0-9]+ .+\\]( \".+?\")+$\/,\n+    monitor_regex: \/^[0-9]{10,11}\\.[0-9]+ \\[[0-9]+ .+\\].*\"$\/,\n     clone: convenienceClone,\n     callback_or_emit: callbackOrEmit,\n     reply_in_order: replyInOrder"
        },
        {
            "index":678,
            "vuln_id":"GHSA-vx6v-xg64-pmr8",
            "cwe_id":"{'CWE-79'}",
            "score":8.8,
            "chain":"{'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/2c7065e0c4296e0c692fb4a7ee19c7357583af30'}",
            "dataset":"osv",
            "summary":"Cross-site Scripting in django-helpdesk django-helpdesk is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').",
            "published_date":"2021-11-15",
            "chain_len":1,
            "project":"https:\/\/github.com\/django-helpdesk\/django-helpdesk",
            "commit_href":"https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/2c7065e0c4296e0c692fb4a7ee19c7357583af30",
            "commit_sha":"2c7065e0c4296e0c692fb4a7ee19c7357583af30",
            "patch":"SINGLE",
            "chain_ord":"['2c7065e0c4296e0c692fb4a7ee19c7357583af30']",
            "before_first_fix_commit":"{'3f245871ac91356fd91a4e2cea5048bcac1d833e'}",
            "last_fix_commit":"2c7065e0c4296e0c692fb4a7ee19c7357583af30",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/11\/2021, 10:32:09",
            "message":"Add function `htmlEntities`\n\n`htmlentities()` is a function which converts special characters. This allows you to show to display the string without the browser reading it as HTML.",
            "author":"lethanhphuc",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 2, 'total': 8}",
            "files":"{'helpdesk\/templates\/helpdesk\/ticket_list.html': {'additions': 6, 'deletions': 2, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/raw\/2c7065e0c4296e0c692fb4a7ee19c7357583af30\/helpdesk%2Ftemplates%2Fhelpdesk%2Fticket_list.html', 'patch': '@@ -330,7 +330,11 @@ <h5 class=\"mb-0\">\\n         function get_url(row) {\\n             return \"{% url \\'helpdesk:view\\' 1234 %}\".replace(\/1234\/, row.id.toString());\\n         }\\n-\\n+        \\n+        function htmlEntities(str) {\\n+            return String(str).replace(\/&\/g, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\').replace(\/\"\/g, \\'&quot;\\');\\n+        }\\n+        \\n         $(document).ready(function () {\\n             \/\/ Ticket DataTable Initialization\\n             $(\\'#ticketTable\\').DataTable({\\n@@ -366,7 +370,7 @@ <h5 class=\"mb-0\">\\n                             if (type === \\'display\\') {\\n                                 data = \\'<div class=\"tickettitle\"><a href=\"\\' + get_url(row) + \\'\" >\\' +\\n                                     row.id + \\'. \\' +\\n-                                    row.title + \\'<\/a><\/div>\\';\\n+                                    htmlEntities(row.title) + \\'<\/a><\/div>\\';\\n                             }\\n                             return data\\n                         }'}}",
            "message_norm":"add function `htmlentities`\n\n`htmlentities()` is a function which converts special characters. this allows you to show to display the string without the browser reading it as html.",
            "language":"en",
            "entities":"[('add', 'ACTION', ''), ('htmlentities', 'SECWORD', ''), ('htmlentities', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['helpdesk\/templates\/helpdesk\/ticket_list.html'])",
            "num_files":1.0,
            "patch_content":"From 2c7065e0c4296e0c692fb4a7ee19c7357583af30 Mon Sep 17 00:00:00 2001\nFrom: lethanhphuc <31820707+noobpk@users.noreply.github.com>\nDate: Thu, 11 Nov 2021 17:32:09 +0700\nSubject: [PATCH] Add function `htmlEntities`\n\n`htmlentities()` is a function which converts special characters. This allows you to show to display the string without the browser reading it as HTML.\n---\n helpdesk\/templates\/helpdesk\/ticket_list.html | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\ndiff --git a\/helpdesk\/templates\/helpdesk\/ticket_list.html b\/helpdesk\/templates\/helpdesk\/ticket_list.html\nindex c9a57d23d..2894349b8 100644\n--- a\/helpdesk\/templates\/helpdesk\/ticket_list.html\n+++ b\/helpdesk\/templates\/helpdesk\/ticket_list.html\n@@ -330,7 +330,11 @@ <h5 class=\"mb-0\">\n         function get_url(row) {\n             return \"{% url 'helpdesk:view' 1234 %}\".replace(\/1234\/, row.id.toString());\n         }\n-\n+        \n+        function htmlEntities(str) {\n+            return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n+        }\n+        \n         $(document).ready(function () {\n             \/\/ Ticket DataTable Initialization\n             $('#ticketTable').DataTable({\n@@ -366,7 +370,7 @@ <h5 class=\"mb-0\">\n                             if (type === 'display') {\n                                 data = '<div class=\"tickettitle\"><a href=\"' + get_url(row) + '\" >' +\n                                     row.id + '. ' +\n-                                    row.title + '<\/a><\/div>';\n+                                    htmlEntities(row.title) + '<\/a><\/div>';\n                             }\n                             return data\n                         }"
        },
        {
            "index":702,
            "vuln_id":"GHSA-8rq8-f485-7v8x",
            "cwe_id":"{'CWE-502'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/abersheeran\/rpc.py\/commit\/491e7a841ed9a754796d6ab047a9fb16e23bf8bd'}",
            "dataset":"osv",
            "summary":"rpc.py 0.6.0 vulnerable to Deserialization of Untrusted Data rpc.py through 0.6.0 allows Remote Code Execution because an unpickle occurs when the \"serializer: pickle\" HTTP header is sent. In other words, although JSON (not Pickle) is the default data format, an unauthenticated client can cause the data to be processed with unpickle.\n\n[Per the maintainer](https:\/\/github.com\/abersheeran\/rpc.py\/issues\/22), rpc.py is not designed for an API that is open to the outside world, and external requests cannot reach rpc.py in real world use.\n\nA [fix](https:\/\/github.com\/abersheeran\/rpc.py\/commit\/491e7a841ed9a754796d6ab047a9fb16e23bf8bd) exists on the `master` branch. As a workaround, use the following code to turn off pickle in older versions:\n```\ndel SERIALIZER_NAMES[PickleSerializer.name]\ndel SERIALIZER_TYPES[PickleSerializer.content_type]",
            "published_date":"2022-07-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/abersheeran\/rpc.py",
            "commit_href":"https:\/\/github.com\/abersheeran\/rpc.py\/commit\/491e7a841ed9a754796d6ab047a9fb16e23bf8bd",
            "commit_sha":"491e7a841ed9a754796d6ab047a9fb16e23bf8bd",
            "patch":"SINGLE",
            "chain_ord":"['491e7a841ed9a754796d6ab047a9fb16e23bf8bd']",
            "before_first_fix_commit":"{'3d5c31916a597f8bdd3260c50d6ec398da1c421c'}",
            "last_fix_commit":"491e7a841ed9a754796d6ab047a9fb16e23bf8bd",
            "chain_ord_pos":1.0,
            "commit_datetime":"07\/06\/2022, 04:55:59",
            "message":"PickleSerializer is turned off by default",
            "author":"Aber",
            "comments":null,
            "stats":"{'additions': 7, 'deletions': 2, 'total': 9}",
            "files":"{'rpcpy\/serializers.py': {'additions': 7, 'deletions': 2, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/abersheeran\/rpc.py\/raw\/491e7a841ed9a754796d6ab047a9fb16e23bf8bd\/rpcpy%2Fserializers.py', 'patch': '@@ -108,16 +108,21 @@ def decode(self, data: bytes) -> typing.Any:\\n         return cbor.loads(data)\\n \\n \\n+# Since the release of pickle to the external network may lead to\\n+# arbitrary code execution vulnerabilities, this serialization\\n+# method is not enabled by default. It is recommended to turn it on\\n+# when there is physical isolation from the outside.\\n+\\n SERIALIZER_NAMES = {\\n     JSONSerializer.name: JSONSerializer(),\\n-    PickleSerializer.name: PickleSerializer(),\\n+    # PickleSerializer.name: PickleSerializer(),\\n     MsgpackSerializer.name: MsgpackSerializer(),\\n     CBORSerializer.name: CBORSerializer(),\\n }\\n \\n SERIALIZER_TYPES = {\\n     JSONSerializer.content_type: JSONSerializer(),\\n-    PickleSerializer.content_type: PickleSerializer(),\\n+    # PickleSerializer.content_type: PickleSerializer(),\\n     MsgpackSerializer.content_type: MsgpackSerializer(),\\n     CBORSerializer.content_type: CBORSerializer(),\\n }'}}",
            "message_norm":"pickleserializer is turned off by default",
            "language":"en",
            "entities":"[('pickleserializer', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['rpcpy\/serializers.py'])",
            "num_files":1.0,
            "patch_content":"From 491e7a841ed9a754796d6ab047a9fb16e23bf8bd Mon Sep 17 00:00:00 2001\nFrom: Aber <me@abersheeran.com>\nDate: Wed, 6 Jul 2022 12:55:59 +0800\nSubject: [PATCH] PickleSerializer is turned off by default\n\n---\n rpcpy\/serializers.py | 9 +++++++--\n 1 file changed, 7 insertions(+), 2 deletions(-)\n\ndiff --git a\/rpcpy\/serializers.py b\/rpcpy\/serializers.py\nindex 4ae3eac..742998b 100644\n--- a\/rpcpy\/serializers.py\n+++ b\/rpcpy\/serializers.py\n@@ -108,16 +108,21 @@ def decode(self, data: bytes) -> typing.Any:\n         return cbor.loads(data)\n \n \n+# Since the release of pickle to the external network may lead to\n+# arbitrary code execution vulnerabilities, this serialization\n+# method is not enabled by default. It is recommended to turn it on\n+# when there is physical isolation from the outside.\n+\n SERIALIZER_NAMES = {\n     JSONSerializer.name: JSONSerializer(),\n-    PickleSerializer.name: PickleSerializer(),\n+    # PickleSerializer.name: PickleSerializer(),\n     MsgpackSerializer.name: MsgpackSerializer(),\n     CBORSerializer.name: CBORSerializer(),\n }\n \n SERIALIZER_TYPES = {\n     JSONSerializer.content_type: JSONSerializer(),\n-    PickleSerializer.content_type: PickleSerializer(),\n+    # PickleSerializer.content_type: PickleSerializer(),\n     MsgpackSerializer.content_type: MsgpackSerializer(),\n     CBORSerializer.content_type: CBORSerializer(),\n }"
        },
        {
            "index":762,
            "vuln_id":"GHSA-jjr8-m8g8-p6wv",
            "cwe_id":"{'CWE-476'}",
            "score":4.4,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/f8378920345f4f4604202d4ab15ef64b2aceaa16'}",
            "dataset":"osv",
            "summary":"Null pointer dereference in TFLite's `Reshape` operator ### Impact\nThe fix for [CVE-2020-15209](https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2020-15209) missed the case when the target shape of `Reshape` operator is given by the elements of a 1-D tensor. As such, the [fix for the vulnerability](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/9c1dc920d8ffb4893d6c9d27d1f039607b326743\/tensorflow\/lite\/core\/subgraph.cc#L1062-L1074) allowed passing a null-buffer-backed tensor with a 1D shape:\n\n```cc\nif (tensor->data.raw == nullptr && tensor->bytes > 0) {\n  if (registration.builtin_code == kTfLiteBuiltinReshape && i == 1) {\n    \/\/ In general, having a tensor here with no buffer will be an error.\n    \/\/ However, for the reshape operator, the second input tensor is only\n    \/\/ used for the shape, not for the data. Thus, null buffer is ok.\n    continue;\n  } else {\n    \/\/ In all other cases, we need to return an error as otherwise we will\n    \/\/ trigger a null pointer dereference (likely).\n    ReportError(\"Input tensor %d lacks data\", tensor_index);\n    return kTfLiteError;\n  }\n}\n```\n\n### Patches\nWe have patched the issue in GitHub commit [f8378920345f4f4604202d4ab15ef64b2aceaa16](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/f8378920345f4f4604202d4ab15ef64b2aceaa16).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/f8378920345f4f4604202d4ab15ef64b2aceaa16",
            "commit_sha":"f8378920345f4f4604202d4ab15ef64b2aceaa16",
            "patch":"SINGLE",
            "chain_ord":"['f8378920345f4f4604202d4ab15ef64b2aceaa16']",
            "before_first_fix_commit":"{'9c1dc920d8ffb4893d6c9d27d1f039607b326743'}",
            "last_fix_commit":"f8378920345f4f4604202d4ab15ef64b2aceaa16",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/28\/2021, 00:47:59",
            "message":"Prevent a null pointer dereference in TFLite.\n\nPiperOrigin-RevId: 370800353\nChange-Id: Ic9c9712ce5c6e384c954dcd640a5bd9ff05c9a05",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 10, 'deletions': 3, 'total': 13}",
            "files":"{'tensorflow\/lite\/core\/subgraph.cc': {'additions': 10, 'deletions': 3, 'changes': 13, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/f8378920345f4f4604202d4ab15ef64b2aceaa16\/tensorflow%2Flite%2Fcore%2Fsubgraph.cc', 'patch': '@@ -1060,10 +1060,17 @@ TfLiteStatus Subgraph::Invoke() {\\n         TF_LITE_ENSURE_STATUS(EnsureTensorDataIsReadable(tensor_index));\\n       }\\n       if (tensor->data.raw == nullptr && tensor->bytes > 0) {\\n-        if (registration.builtin_code == kTfLiteBuiltinReshape && i == 1) {\\n+        if (registration.builtin_code == kTfLiteBuiltinReshape && i == 1 &&\\n+            tensor->dims->size != 1) {\\n           \/\/ In general, having a tensor here with no buffer will be an error.\\n-          \/\/ However, for the reshape operator, the second input tensor is only\\n-          \/\/ used for the shape, not for the data. Thus, null buffer is ok.\\n+          \/\/ However, for the reshape operator, the second input tensor is\\n+          \/\/ sometimes only used for the shape, not for the data. Thus, null\\n+          \/\/ buffer is ok in this situation.\\n+          \/\/ The situation where null buffer is not ok for reshape operator is\\n+          \/\/ only when there are 2 inputs given to the node and the one\\n+          \/\/ corresponding to the shape (i == 1) is a vector that contains all\\n+          \/\/ dimensions. See `GetOutputShape()` function in\\n+          \/\/ `tensorflow\/lite\/kernels\/reshape.cc`\\n           continue;\\n         } else {\\n           \/\/ In all other cases, we need to return an error as otherwise we will'}}",
            "message_norm":"prevent a null pointer dereference in tflite.\n\npiperorigin-revid: 370800353\nchange-id: ic9c9712ce5c6e384c954dcd640a5bd9ff05c9a05",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('null pointer dereference', 'SECWORD', ''), ('370800353', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/core\/subgraph.cc'])",
            "num_files":1.0,
            "patch_content":"From f8378920345f4f4604202d4ab15ef64b2aceaa16 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 27 Apr 2021 17:47:59 -0700\nSubject: [PATCH] Prevent a null pointer dereference in TFLite.\n\nPiperOrigin-RevId: 370800353\nChange-Id: Ic9c9712ce5c6e384c954dcd640a5bd9ff05c9a05\n---\n tensorflow\/lite\/core\/subgraph.cc | 13 ++++++++++---\n 1 file changed, 10 insertions(+), 3 deletions(-)\n\ndiff --git a\/tensorflow\/lite\/core\/subgraph.cc b\/tensorflow\/lite\/core\/subgraph.cc\nindex 7f9dd2ce3363d5..0273018b3bf03d 100644\n--- a\/tensorflow\/lite\/core\/subgraph.cc\n+++ b\/tensorflow\/lite\/core\/subgraph.cc\n@@ -1060,10 +1060,17 @@ TfLiteStatus Subgraph::Invoke() {\n         TF_LITE_ENSURE_STATUS(EnsureTensorDataIsReadable(tensor_index));\n       }\n       if (tensor->data.raw == nullptr && tensor->bytes > 0) {\n-        if (registration.builtin_code == kTfLiteBuiltinReshape && i == 1) {\n+        if (registration.builtin_code == kTfLiteBuiltinReshape && i == 1 &&\n+            tensor->dims->size != 1) {\n           \/\/ In general, having a tensor here with no buffer will be an error.\n-          \/\/ However, for the reshape operator, the second input tensor is only\n-          \/\/ used for the shape, not for the data. Thus, null buffer is ok.\n+          \/\/ However, for the reshape operator, the second input tensor is\n+          \/\/ sometimes only used for the shape, not for the data. Thus, null\n+          \/\/ buffer is ok in this situation.\n+          \/\/ The situation where null buffer is not ok for reshape operator is\n+          \/\/ only when there are 2 inputs given to the node and the one\n+          \/\/ corresponding to the shape (i == 1) is a vector that contains all\n+          \/\/ dimensions. See `GetOutputShape()` function in\n+          \/\/ `tensorflow\/lite\/kernels\/reshape.cc`\n           continue;\n         } else {\n           \/\/ In all other cases, we need to return an error as otherwise we will"
        },
        {
            "index":935,
            "vuln_id":"GHSA-jhj6-5mh6-4pvf",
            "cwe_id":"{'CWE-476'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/kitabisa\/teler\/commit\/ec6082049dba9e44a21f35fb7b123d42ce1a1a7e'}",
            "dataset":"osv",
            "summary":"Denial-of-Service within Docker container ### Impact\nIf you run teler inside a Docker container and encounter `errors.Exit` function, it will cause denial-of-service (`SIGSEGV`) because it doesn't get process ID and process group ID of teler properly to kills.\n\n### Patches\nUpgrade to the >= 0.0.1 version.\n\n### Workarounds\nN\/A\n\n### References\n- https:\/\/github.com\/kitabisa\/teler\/commit\/ec6082049dba9e44a21f35fb7b123d42ce1a1a7e\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Issues Section](https:\/\/github.com\/kitabisa\/teler\/issues)\n* Email us at [infosec@kitabisa.com](mailto:infosec@kitabisa.com)",
            "published_date":"2021-05-24",
            "chain_len":1,
            "project":"https:\/\/github.com\/kitabisa\/teler",
            "commit_href":"https:\/\/github.com\/kitabisa\/teler\/commit\/ec6082049dba9e44a21f35fb7b123d42ce1a1a7e",
            "commit_sha":"ec6082049dba9e44a21f35fb7b123d42ce1a1a7e",
            "patch":"SINGLE",
            "chain_ord":"['ec6082049dba9e44a21f35fb7b123d42ce1a1a7e']",
            "before_first_fix_commit":"{'7be1cb4511a8236d5203a924bc0aa4db008aafb8'}",
            "last_fix_commit":"ec6082049dba9e44a21f35fb7b123d42ce1a1a7e",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/02\/2020, 14:09:38",
            "message":":hammer: Fix segmentation fault of syscall\n\nIf teler is run via the docker image, the syscall function cannot allocate and return a nil pointer to address.",
            "author":"Dwi Siswanto",
            "comments":null,
            "stats":"{'additions': 8, 'deletions': 1, 'total': 9}",
            "files":"{'pkg\/errors\/abort.go': {'additions': 8, 'deletions': 1, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/kitabisa\/teler\/raw\/ec6082049dba9e44a21f35fb7b123d42ce1a1a7e\/pkg%2Ferrors%2Fabort.go', 'patch': '@@ -2,10 +2,17 @@\\n \\n package errors\\n \\n-import \"syscall\"\\n+import (\\n+\\t\"os\"\\n+\\t\"syscall\"\\n+)\\n \\n \/\/ Abort will terminate & sends SIGTERM to process\\n func Abort(i ...int) {\\n+\\tif _, err := os.Stat(\"\/.dockerenv\"); err == nil {\\n+\\t\\tos.Exit(i[0])\\n+\\t}\\n+\\n \\tpgid, err := syscall.Getpgid(syscall.Getpid())\\n \\tif err != nil {\\n \\t\\tExit(err.Error())'}}",
            "message_norm":":hammer: fix segmentation fault of syscall\n\nif teler is run via the docker image, the syscall function cannot allocate and return a nil pointer to address.",
            "language":"en",
            "entities":"[('segmentation fault', 'SECWORD', ''), ('address', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['pkg\/errors\/abort.go'])",
            "num_files":1.0,
            "patch_content":"From ec6082049dba9e44a21f35fb7b123d42ce1a1a7e Mon Sep 17 00:00:00 2001\nFrom: Dwi Siswanto <dwi.siswanto98@gmail.com>\nDate: Mon, 2 Nov 2020 21:09:38 +0700\nSubject: [PATCH] :hammer: Fix segmentation fault of syscall\n\nIf teler is run via the docker image, the syscall function cannot allocate and return a nil pointer to address.\n---\n pkg\/errors\/abort.go | 9 ++++++++-\n 1 file changed, 8 insertions(+), 1 deletion(-)\n\ndiff --git a\/pkg\/errors\/abort.go b\/pkg\/errors\/abort.go\nindex 736ce7b9..97220efd 100644\n--- a\/pkg\/errors\/abort.go\n+++ b\/pkg\/errors\/abort.go\n@@ -2,10 +2,17 @@\n \n package errors\n \n-import \"syscall\"\n+import (\n+\t\"os\"\n+\t\"syscall\"\n+)\n \n \/\/ Abort will terminate & sends SIGTERM to process\n func Abort(i ...int) {\n+\tif _, err := os.Stat(\"\/.dockerenv\"); err == nil {\n+\t\tos.Exit(i[0])\n+\t}\n+\n \tpgid, err := syscall.Getpgid(syscall.Getpid())\n \tif err != nil {\n \t\tExit(err.Error())"
        },
        {
            "index":141,
            "vuln_id":"GHSA-4rq4-32rv-6wp6",
            "cwe_id":"{'CWE-269'}",
            "score":7.1,
            "chain":"{'https:\/\/github.com\/shelljs\/shelljs\/commit\/d919d22dd6de385edaa9d90313075a77f74b338c'}",
            "dataset":"osv",
            "summary":"Improper Privilege Management in shelljs shelljs is vulnerable to Improper Privilege Management",
            "published_date":"2022-01-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/shelljs\/shelljs",
            "commit_href":"https:\/\/github.com\/shelljs\/shelljs\/commit\/d919d22dd6de385edaa9d90313075a77f74b338c",
            "commit_sha":"d919d22dd6de385edaa9d90313075a77f74b338c",
            "patch":"SINGLE",
            "chain_ord":"['d919d22dd6de385edaa9d90313075a77f74b338c']",
            "before_first_fix_commit":"{'fcf1651be9a3bb8e20ba1fd24b8a91f369829c53'}",
            "last_fix_commit":"d919d22dd6de385edaa9d90313075a77f74b338c",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/07\/2022, 05:14:23",
            "message":"fix(exec): lockdown file permissions (#1060)\n\nThis locks down file permissions used by the internal implementation of\r\n`shell.exec()`.\r\n\r\nIssue #1058\r\nTested manually using the documented scenarios",
            "author":"Nate Fischer",
            "comments":null,
            "stats":"{'additions': 19, 'deletions': 1, 'total': 20}",
            "files":"{'src\/exec.js': {'additions': 19, 'deletions': 1, 'changes': 20, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/shelljs\/shelljs\/raw\/d919d22dd6de385edaa9d90313075a77f74b338c\/src%2Fexec.js', 'patch': \"@@ -48,7 +48,24 @@ function execSync(cmd, opts, pipe) {\\n     stderrFile: stderrFile,\\n   };\\n \\n-  fs.writeFileSync(paramsFile, JSON.stringify(paramsToSerialize), 'utf8');\\n+  \/\/ Create the files and ensure these are locked down (for read and write) to\\n+  \/\/ the current user. The main concerns here are:\\n+  \/\/\\n+  \/\/ * If we execute a command which prints sensitive output, then\\n+  \/\/   stdoutFile\/stderrFile must not be readable by other users.\\n+  \/\/ * paramsFile must not be readable by other users, or else they can read it\\n+  \/\/   to figure out the path for stdoutFile\/stderrFile and create these first\\n+  \/\/   (locked down to their own access), which will crash exec() when it tries\\n+  \/\/   to write to the files.\\n+  function writeFileLockedDown(filePath, data) {\\n+    fs.writeFileSync(filePath, data, {\\n+      encoding: 'utf8',\\n+      mode: parseInt('600', 8),\\n+    });\\n+  }\\n+  writeFileLockedDown(stdoutFile, '');\\n+  writeFileLockedDown(stderrFile, '');\\n+  writeFileLockedDown(paramsFile, JSON.stringify(paramsToSerialize));\\n \\n   var execArgs = [\\n     path.join(__dirname, 'exec-child.js'),\\n@@ -91,6 +108,7 @@ function execSync(cmd, opts, pipe) {\\n   }\\n \\n   \/\/ No biggie if we can't erase the files now -- they're in a temp dir anyway\\n+  \/\/ and we locked down permissions (see the note above).\\n   try { common.unlinkSync(paramsFile); } catch (e) {}\\n   try { common.unlinkSync(stderrFile); } catch (e) {}\\n   try { common.unlinkSync(stdoutFile); } catch (e) {}\"}}",
            "message_norm":"fix(exec): lockdown file permissions (#1060)\n\nthis locks down file permissions used by the internal implementation of\r\n`shell.exec()`.\r\n\r\nissue #1058\r\ntested manually using the documented scenarios",
            "language":"en",
            "entities":"[('fix(exec', 'ACTION', ''), ('file permissions', 'SECWORD', ''), ('#1060', 'ISSUE', ''), ('file permissions', 'SECWORD', ''), ('#1058', 'ISSUE', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/exec.js'])",
            "num_files":1.0,
            "patch_content":"From d919d22dd6de385edaa9d90313075a77f74b338c Mon Sep 17 00:00:00 2001\nFrom: Nate Fischer <ntfschr@google.com>\nDate: Thu, 6 Jan 2022 21:14:23 -0800\nSubject: [PATCH] fix(exec): lockdown file permissions (#1060)\n\nThis locks down file permissions used by the internal implementation of\n`shell.exec()`.\n\nIssue #1058\nTested manually using the documented scenarios\n---\n src\/exec.js | 20 +++++++++++++++++++-\n 1 file changed, 19 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/exec.js b\/src\/exec.js\nindex de3322c81..78faf13d2 100644\n--- a\/src\/exec.js\n+++ b\/src\/exec.js\n@@ -48,7 +48,24 @@ function execSync(cmd, opts, pipe) {\n     stderrFile: stderrFile,\n   };\n \n-  fs.writeFileSync(paramsFile, JSON.stringify(paramsToSerialize), 'utf8');\n+  \/\/ Create the files and ensure these are locked down (for read and write) to\n+  \/\/ the current user. The main concerns here are:\n+  \/\/\n+  \/\/ * If we execute a command which prints sensitive output, then\n+  \/\/   stdoutFile\/stderrFile must not be readable by other users.\n+  \/\/ * paramsFile must not be readable by other users, or else they can read it\n+  \/\/   to figure out the path for stdoutFile\/stderrFile and create these first\n+  \/\/   (locked down to their own access), which will crash exec() when it tries\n+  \/\/   to write to the files.\n+  function writeFileLockedDown(filePath, data) {\n+    fs.writeFileSync(filePath, data, {\n+      encoding: 'utf8',\n+      mode: parseInt('600', 8),\n+    });\n+  }\n+  writeFileLockedDown(stdoutFile, '');\n+  writeFileLockedDown(stderrFile, '');\n+  writeFileLockedDown(paramsFile, JSON.stringify(paramsToSerialize));\n \n   var execArgs = [\n     path.join(__dirname, 'exec-child.js'),\n@@ -91,6 +108,7 @@ function execSync(cmd, opts, pipe) {\n   }\n \n   \/\/ No biggie if we can't erase the files now -- they're in a temp dir anyway\n+  \/\/ and we locked down permissions (see the note above).\n   try { common.unlinkSync(paramsFile); } catch (e) {}\n   try { common.unlinkSync(stderrFile); } catch (e) {}\n   try { common.unlinkSync(stdoutFile); } catch (e) {}"
        },
        {
            "index":557,
            "vuln_id":"GHSA-rcvx-rmvf-mxch",
            "cwe_id":"{'CWE-79'}",
            "score":6.1,
            "chain":"{'https:\/\/github.com\/eclipse\/hawkbit\/commit\/94b7c12cde1b38eda5414bd88d6d068008cfb9f9'}",
            "dataset":"osv",
            "summary":"Cross-site Scripting in Eclipse Hawkbit In all version of Eclipse Hawkbit prior to 0.3.0M7, the HTTP 404 (Not Found) JSON response body returned by the REST API may contain unsafe characters within the path attribute. Sending a POST request to a non existing resource will return the full path from the given URL unescaped to the client.",
            "published_date":"2022-02-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/eclipse\/hawkbit",
            "commit_href":"https:\/\/github.com\/eclipse\/hawkbit\/commit\/94b7c12cde1b38eda5414bd88d6d068008cfb9f9",
            "commit_sha":"94b7c12cde1b38eda5414bd88d6d068008cfb9f9",
            "patch":"SINGLE",
            "chain_ord":"['94b7c12cde1b38eda5414bd88d6d068008cfb9f9']",
            "before_first_fix_commit":"{'8816396d18880d2020743ce2e83a08446449d0db'}",
            "last_fix_commit":"94b7c12cde1b38eda5414bd88d6d068008cfb9f9",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/12\/2021, 10:56:44",
            "message":"Fixes #1067\n\nJSON body response for HTTP 404 error may contain unsafe URL path characters. Thus removing path from the response\n\nSigned-off-by: Dominic Schabel <dominic.schabel@bosch.io>",
            "author":"Dominic Schabel",
            "comments":null,
            "stats":"{'additions': 22, 'deletions': 4, 'total': 26}",
            "files":"{'hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java': {'additions': 22, 'deletions': 4, 'changes': 26, 'status': 'renamed', 'raw_url': 'https:\/\/github.com\/eclipse\/hawkbit\/raw\/94b7c12cde1b38eda5414bd88d6d068008cfb9f9\/hawkbit-runtime%2Fhawkbit-update-server%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fhawkbit%2Fapp%2FErrorController.java', 'patch': '@@ -8,6 +8,8 @@\\n  *\/\\n package org.eclipse.hawkbit.app;\\n \\n+import java.util.Map;\\n+\\n import javax.servlet.http.HttpServletRequest;\\n import javax.servlet.http.HttpServletResponse;\\n \\n@@ -23,22 +25,23 @@\\n \/**\\n  * Error page controller that ensures that ocet stream does not return text in\\n  * case of an error.\\n- *\\n  *\/\\n @Controller\\n \/\/ Exception squid:S3752 - errors need handling for all methods\\n @SuppressWarnings(\"squid:S3752\")\\n-public class StreamAwareErrorController extends BasicErrorController {\\n+public class ErrorController extends BasicErrorController {\\n+\\n+    private static final String PATH = \"path\";\\n \\n     \/**\\n-     * A new {@link StreamAwareErrorController}.\\n+     * A new {@link ErrorController}.\\n      * \\n      * @param errorAttributes\\n      *            the error attributes\\n      * @param serverProperties\\n      *            configuration properties\\n      *\/\\n-    public StreamAwareErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\\n+    public ErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\\n         super(errorAttributes, serverProperties.getError());\\n     }\\n \\n@@ -48,4 +51,19 @@ public ResponseEntity<Void> errorStream(final HttpServletRequest request, final\\n         return new ResponseEntity<>(status);\\n     }\\n \\n+    @Override\\n+    @RequestMapping\\n+    public ResponseEntity<Map<String, Object>> error(final HttpServletRequest request) {\\n+        final HttpStatus status = getStatus(request);\\n+        final Map<String, Object> body = getErrorAttributesWithoutPath(request);\\n+        return new ResponseEntity<>(body, status);\\n+    }\\n+\\n+    private Map<String, Object> getErrorAttributesWithoutPath(final HttpServletRequest request) {\\n+        final Map<String, Object> body = getErrorAttributes(request, isIncludeStackTrace(request, MediaType.ALL));\\n+        if (body != null && body.containsKey(PATH)) {\\n+            body.remove(PATH);\\n+        }\\n+        return body;\\n+    }\\n }'}}",
            "message_norm":"fixes #1067\n\njson body response for http 404 error may contain unsafe url path characters. thus removing path from the response\n\nsigned-off-by: dominic schabel <dominic.schabel@bosch.io>",
            "language":"en",
            "entities":"[('fixes', 'ACTION', ''), ('#1067', 'ISSUE', ''), ('error', 'FLAW', ''), ('unsafe', 'SECWORD', ''), ('removing', 'ACTION', ''), ('dominic.schabel@bosch.io', 'EMAIL', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java'])",
            "num_files":1.0,
            "patch_content":"From 94b7c12cde1b38eda5414bd88d6d068008cfb9f9 Mon Sep 17 00:00:00 2001\nFrom: Dominic Schabel <dominic.schabel@bosch.io>\nDate: Tue, 12 Jan 2021 11:56:44 +0100\nSubject: [PATCH] Fixes #1067\n\nJSON body response for HTTP 404 error may contain unsafe URL path characters. Thus removing path from the response\n\nSigned-off-by: Dominic Schabel <dominic.schabel@bosch.io>\n---\n ...orController.java => ErrorController.java} | 26 ++++++++++++++++---\n 1 file changed, 22 insertions(+), 4 deletions(-)\n rename hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/{StreamAwareErrorController.java => ErrorController.java} (64%)\n\ndiff --git a\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java b\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\nsimilarity index 64%\nrename from hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java\nrename to hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\nindex 39793afe74..da4c46be24 100644\n--- a\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java\n+++ b\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\n@@ -8,6 +8,8 @@\n  *\/\n package org.eclipse.hawkbit.app;\n \n+import java.util.Map;\n+\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n \n@@ -23,22 +25,23 @@\n \/**\n  * Error page controller that ensures that ocet stream does not return text in\n  * case of an error.\n- *\n  *\/\n @Controller\n \/\/ Exception squid:S3752 - errors need handling for all methods\n @SuppressWarnings(\"squid:S3752\")\n-public class StreamAwareErrorController extends BasicErrorController {\n+public class ErrorController extends BasicErrorController {\n+\n+    private static final String PATH = \"path\";\n \n     \/**\n-     * A new {@link StreamAwareErrorController}.\n+     * A new {@link ErrorController}.\n      * \n      * @param errorAttributes\n      *            the error attributes\n      * @param serverProperties\n      *            configuration properties\n      *\/\n-    public StreamAwareErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\n+    public ErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\n         super(errorAttributes, serverProperties.getError());\n     }\n \n@@ -48,4 +51,19 @@ public ResponseEntity<Void> errorStream(final HttpServletRequest request, final\n         return new ResponseEntity<>(status);\n     }\n \n+    @Override\n+    @RequestMapping\n+    public ResponseEntity<Map<String, Object>> error(final HttpServletRequest request) {\n+        final HttpStatus status = getStatus(request);\n+        final Map<String, Object> body = getErrorAttributesWithoutPath(request);\n+        return new ResponseEntity<>(body, status);\n+    }\n+\n+    private Map<String, Object> getErrorAttributesWithoutPath(final HttpServletRequest request) {\n+        final Map<String, Object> body = getErrorAttributes(request, isIncludeStackTrace(request, MediaType.ALL));\n+        if (body != null && body.containsKey(PATH)) {\n+            body.remove(PATH);\n+        }\n+        return body;\n+    }\n }"
        },
        {
            "index":313,
            "vuln_id":"GHSA-6pqm-xvfc-w7p4",
            "cwe_id":"{'CWE-352'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/654e871a3923e79076818a9a03533fe88222c871'}",
            "dataset":"osv",
            "summary":"showdoc is vulnerable to Cross-Site Request Forgery (CSRF) showdoc is vulnerable to Cross-Site Request Forgery (CSRF).",
            "published_date":"2021-12-03",
            "chain_len":1,
            "project":"https:\/\/github.com\/star7th\/showdoc",
            "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/654e871a3923e79076818a9a03533fe88222c871",
            "commit_sha":"654e871a3923e79076818a9a03533fe88222c871",
            "patch":"SINGLE",
            "chain_ord":"['654e871a3923e79076818a9a03533fe88222c871']",
            "before_first_fix_commit":"{'a9886f26c08225e0adca75c67dfca3f7c42b87d0'}",
            "last_fix_commit":"654e871a3923e79076818a9a03533fe88222c871",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/22\/2021, 12:22:29",
            "message":"Cookie security \/Cookie \u5b89\u5168",
            "author":"star7th",
            "comments":null,
            "stats":"{'additions': 12, 'deletions': 0, 'total': 12}",
            "files":"{'server\/index.php': {'additions': 12, 'deletions': 0, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/654e871a3923e79076818a9a03533fe88222c871\/server%2Findex.php', 'patch': \"@@ -8,6 +8,18 @@\\n     require '.\/vendor\/autoload.php';\\n }\\n \\n+\/\/ cookie\u5b89\u5168\uff0c\u7ed9PHPSESSID\u52a0\u4e0aStrict\\n+if (PHP_VERSION_ID >= 70300) {\\n+    session_set_cookie_params([\\n+        'samesite' => 'Strict'\\n+    ]);\\n+} else { \\n+    session_set_cookie_params(\\n+        NULL,\\n+        '\/; samesite=Strict',\\n+    );\\n+}\\n+\\n \/\/ \u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f \u5efa\u8bae\u5f00\u53d1\u9636\u6bb5\u5f00\u542f \u90e8\u7f72\u9636\u6bb5\u6ce8\u91ca\u6216\u8005\u8bbe\u4e3afalse\\n define('APP_DEBUG',True);\"}}",
            "message_norm":"cookie security \/cookie \u5b89\u5168",
            "language":"en",
            "entities":"[('cookie', 'SECWORD', ''), ('security', 'SECWORD', ''), ('\/cookie', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['server\/index.php'])",
            "num_files":1.0,
            "patch_content":"From 654e871a3923e79076818a9a03533fe88222c871 Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Mon, 22 Nov 2021 20:22:29 +0800\nSubject: [PATCH] =?UTF-8?q?Cookie=20security=20\/Cookie=20=E5=AE=89?=\n =?UTF-8?q?=E5=85=A8?=\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n---\n server\/index.php | 12 ++++++++++++\n 1 file changed, 12 insertions(+)\n\ndiff --git a\/server\/index.php b\/server\/index.php\nindex 6f19bcc82..176d03cdc 100644\n--- a\/server\/index.php\n+++ b\/server\/index.php\n@@ -8,6 +8,18 @@\n     require '.\/vendor\/autoload.php';\n }\n \n+\/\/ cookie\u5b89\u5168\uff0c\u7ed9PHPSESSID\u52a0\u4e0aStrict\n+if (PHP_VERSION_ID >= 70300) {\n+    session_set_cookie_params([\n+        'samesite' => 'Strict'\n+    ]);\n+} else { \n+    session_set_cookie_params(\n+        NULL,\n+        '\/; samesite=Strict',\n+    );\n+}\n+\n \/\/ \u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f \u5efa\u8bae\u5f00\u53d1\u9636\u6bb5\u5f00\u542f \u90e8\u7f72\u9636\u6bb5\u6ce8\u91ca\u6216\u8005\u8bbe\u4e3afalse\n define('APP_DEBUG',True);"
        },
        {
            "index":802,
            "vuln_id":"GHSA-389p-fchr-q2mg",
            "cwe_id":"{'CWE-22'}",
            "score":9.8,
            "chain":"{'https:\/\/github.com\/ImpressCMS\/impresscms\/commit\/a66d7bb499faafab803e24833606028fa0ba4261'}",
            "dataset":"osv",
            "summary":"Path Traversal in ImpressCMS ImpressCMS before 1.4.2 allows unauthenticated remote code execution via .....\/\/\/ directory traversal in origName or imageName, leading to unsafe interaction with the CKEditor processImage.php script. The payload may be placed in PHP_SESSION_UPLOAD_PROGRESS when the PHP installation supports upload_progress.",
            "published_date":"2022-02-15",
            "chain_len":1,
            "project":"https:\/\/github.com\/ImpressCMS\/impresscms",
            "commit_href":"https:\/\/github.com\/ImpressCMS\/impresscms\/commit\/a66d7bb499faafab803e24833606028fa0ba4261",
            "commit_sha":"a66d7bb499faafab803e24833606028fa0ba4261",
            "patch":"SINGLE",
            "chain_ord":"['a66d7bb499faafab803e24833606028fa0ba4261']",
            "before_first_fix_commit":"{'e174e84f000add55a731ffc435b8ed08b6a03d06'}",
            "last_fix_commit":"a66d7bb499faafab803e24833606028fa0ba4261",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/04\/2020, 23:48:24",
            "message":"Prevents using submitted filenames with ..\/ for controller (#812)\n\n* Prevents using submitted filenames with ..\/ for controller\r\n\r\n* Using preg replace for better parent paths replaces\r\n\r\nCo-authored-by: Raimondas Rimkevi\u010dius (aka MekDrop) <mekdrop@impresscms.org>",
            "author":"Raimondas Rimkevi\u010dius",
            "comments":null,
            "stats":"{'additions': 643, 'deletions': 642, 'total': 1285}",
            "files":"{'htdocs\/libraries\/icms\/ipf\/Controller.php': {'additions': 643, 'deletions': 642, 'changes': 1285, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ImpressCMS\/impresscms\/raw\/a66d7bb499faafab803e24833606028fa0ba4261\/htdocs%2Flibraries%2Ficms%2Fipf%2FController.php', 'patch': '@@ -1,642 +1,643 @@\\n-<?php\\r\\n-\\r\\n-\/**\\r\\n- * This class is responsible for providing operations to an object for managing the object\\'s manipulation\\r\\n- *\\r\\n- * @copyright\\tThe ImpressCMS Project http:\/\/www.impresscms.org\/\\r\\n- * @license\\t\\thttp:\/\/www.gnu.org\/licenses\/old-licenses\/gpl-2.0.html GNU General Public License (GPL)\\r\\n- * @category\\tICMS\\r\\n- * @package\\t\\tIpf\\r\\n- * @subpackage\\tController\\r\\n- * @since\\t\\t1.1\\r\\n- * @author\\t\\tOriginal idea by Jan Keller Pedersen <mithrandir@xoops.org> - IDG Danmark A\/S <www.idg.dk>\\r\\n- * @author\\t\\tmarcan <marcan@impresscms.org>\\r\\n- * @version\\t\\tSVN: $Id: Controller.php 11972 2012-08-26 17:49:13Z skenow $\\r\\n- * @todo\\t\\tUse language constants for messages\\r\\n- *\/\\r\\n-\\r\\n-defined(\\'ICMS_ROOT_PATH\\') or die(\"ImpressCMS root path not defined\");\\r\\n-\\r\\n-\/**\\r\\n- *\\r\\n- *\\r\\n- * @category\\tICMS\\r\\n- * @package\\t\\tIpf\\r\\n- * @subpackage\\tController\\r\\n- *\\r\\n- *\/\\r\\n-class icms_ipf_Controller {\\r\\n-\\r\\n-\\t\/** *\/\\r\\n-\\tpublic $handler;\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param $handler\\r\\n-\\t *\/\\r\\n-\\tpublic function __construct($handler) {\\r\\n-\\t\\t$this->handler=$handler;\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tobj\\t\\t$icmsObj\\r\\n-\\t *\/\\r\\n-\\tpublic function postDataToObject(&$icmsObj) {\\r\\n-\\t\\tforeach (array_keys($icmsObj->vars) as $key) {\\r\\n-\\t\\t\\t\/\/ do not post data if control is a label\\r\\n-\\t\\t\\t$control = $icmsObj->getControl($key);\\r\\n-\\t\\t\\tif (is_array($control) && isset($control[\\'name\\']) && $control[\\'name\\'] == \"label\") continue;\\r\\n-\\r\\n-\\t\\t\\tswitch ($icmsObj->vars[$key][\\'data_type\\']) {\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_IMAGE:\\r\\n-\\t\\t\\t\\t\\tif (isset($_POST[\\'url_\\' . $key]) && $_POST[\\'url_\\' . $key] !=\\'\\') {\\r\\n-\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'beforeFileUnlink\\', $icmsObj);\\r\\n-\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\\r\\n-\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t\\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, \\'e\\');\\r\\n-\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, $_POST[\\'url_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t\\tif (is_file($oldFile) ) unlink($oldFile);\\r\\n-\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'afterFileUnlink\\', $icmsObj);\\r\\n-\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\\r\\n-\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\tif (isset($_POST[\\'delete_\\' . $key]) && $_POST[\\'delete_\\' . $key] == \\'1\\') {\\r\\n-\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'beforeFileUnlink\\', $icmsObj);\\r\\n-\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\\r\\n-\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t\\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, \\'e\\');\\r\\n-\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, \\'\\');\\r\\n-\\t\\t\\t\\t\\t\\tif (is_file($oldFile) ) unlink($oldFile);\\r\\n-\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'afterFileUnlink\\', $icmsObj);\\r\\n-\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\\r\\n-\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_URLLINK:\\r\\n-\\t\\t\\t\\t\\t$linkObj = $icmsObj->getUrlLinkObj($key);\\r\\n-\\t\\t\\t\\t\\t$linkObj->setVar(\\'mid\\', $_POST[\\'mid_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t$linkObj->setVar(\\'caption\\', $_POST[\\'caption_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t$linkObj->setVar(\\'description\\', $_POST[\\'desc_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t$linkObj->setVar(\\'target\\', $_POST[\\'target_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t$linkObj->setVar(\\'url\\', $_POST[\\'url_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\tif ($linkObj->getVar(\\'url\\') != \\'\\') {\\r\\n-\\t\\t\\t\\t\\t\\t$icmsObj->storeUrlLinkObj($linkObj);\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t\/\/@todo: catch errors\\r\\n-\\t\\t\\t\\t\\t$icmsObj->setVar($key, $linkObj->getVar(\\'urllinkid\\'));\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_FILE:\\r\\n-\\t\\t\\t\\t\\tif (!isset($_FILES[\\'upload_\\' . $key][\\'name\\']) || $_FILES[\\'upload_\\' . $key][\\'name\\'] == \\'\\') {\\r\\n-\\t\\t\\t\\t\\t\\t$fileObj = $icmsObj->getFileObj($key);\\r\\n-\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'mid\\', $_POST[\\'mid_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'caption\\', $_POST[\\'caption_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'description\\', $_POST[\\'desc_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'url\\', $_POST[\\'url_\\' . $key]);\\r\\n-\\t\\t\\t\\t\\t\\tif (!($fileObj->getVar(\\'url\\') == \\'\\' && $fileObj->getVar(\\'url\\') == \\'\\' && $fileObj->getVar(\\'url\\') == \\'\\')) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$res = $icmsObj->storeFileObj($fileObj);\\r\\n-\\t\\t\\t\\t\\t\\t\\tif ($res) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, $fileObj->getVar(\\'fileid\\'));\\r\\n-\\t\\t\\t\\t\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t\/\/error setted, but no error message (to be improved)\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors($fileObj->getErrors());\\r\\n-\\t\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_STIME:\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_MTIME:\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_LTIME:\\r\\n-\\t\\t\\t\\t\\t\/\/ check if this field\\'s value is available in the POST array\\r\\n-\\t\\t\\t\\t\\tif (is_array($_POST[$key]) && isset($_POST[$key][\\'date\\'])) {\\r\\n-\\t\\t\\t\\t\\t\\t$value = strtotime($_POST[$key][\\'date\\']) + $_POST[$key][\\'time\\'];\\r\\n-\\t\\t\\t\\t\\t\/\/ in case the field is hidden, it\\'s not formated so we can simply take the value and store it\\r\\n-\\t\\t\\t\\t\\t} elseif (filter_var($_POST[$key], FILTER_VALIDATE_INT) == $_POST[$key]) {\\r\\n-\\t\\t\\t\\t\\t\\t$value = (int)$_POST[$key];\\r\\n-\\t\\t\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t\\t\\t$value = strtotime($_POST[$key]);\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t$icmsObj->setVar($key, $value);\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_URL:\\r\\n-\\t\\t\\t\\t\\tif (isset($_POST[$key])) {\\r\\n-\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, filter_var($_POST[$key], FILTER_SANITIZE_URL));\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\r\\n-\\t\\t\\t\\tcase XOBJ_DTYPE_ARRAY:\\r\\n-\\t\\t\\t\\t\\tif (is_array($_POST[$key])) {\\r\\n-\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, serialize($_POST[$key]));\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\r\\n-\\t\\t\\t\\tdefault:\\r\\n-\\t\\t\\t\\t\\t$icmsObj->setVar($key, $_POST[$key]);\\r\\n-\\t\\t\\t\\t\\tbreak;\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t}\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tobj\\t\\t$icmsObj\\tObject\\r\\n-\\t * @param\\tint\\t\\t$objectid\\r\\n-\\t * @param\\tstr\\t\\t$created_success_msg\\tMessage to display on successful creation\\r\\n-\\t * @param\\tstr\\t\\t$modified_success_msg\\tMessage to display on successful modification\\r\\n-\\t * @param\\tbool\\t$redirect_page\\t\\t\\tWhether to redirect afterwards, or not\\r\\n-\\t * @param\\tbool\\t$debug\\t\\t\\t\\t\\tWhether to display debug information, or not\\r\\n-\\t *\/\\r\\n-\\tpublic function &doStoreFromDefaultForm(&$icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false) {\\r\\n-\\t\\tglobal $impresscms;\\r\\n-\\t\\t$this->postDataToObject($icmsObj);\\r\\n-\\r\\n-\\t\\tif ($icmsObj->isNew()) {\\r\\n-\\t\\t\\t$redirect_msg = $created_success_msg;\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t$redirect_msg = $modified_success_msg;\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\t\/\/ Check if there were uploaded files\\r\\n-\\t\\t$uploaderResult = true;\\r\\n-\\t\\tif (isset($_POST[\\'icms_upload_image\\']) || isset($_POST[\\'icms_upload_file\\'])) {\\r\\n-\\t\\t\\t$uploaderObj = new icms_file_MediaUploadHandler($icmsObj->getImageDir(true), $this->handler->_allowedMimeTypes, $this->handler->_maxFileSize, $this->handler->_maxWidth, $this->handler->_maxHeight);\\r\\n-\\t\\t\\tforeach ( $_FILES as $name=>$file_array) {\\r\\n-\\t\\t\\t\\tif (isset ($file_array[\\'name\\']) && $file_array[\\'name\\'] != \"\" && in_array(str_replace(\\'upload_\\', \\'\\', $name), array_keys($icmsObj->vars))) {\\r\\n-\\t\\t\\t\\t\\tif ($uploaderObj->fetchMedia($name)) {\\r\\n-\\t\\t\\t\\t\\t\\t$uploaderObj->setTargetFileName(time() . \"_\" . $uploaderObj->getMediaName());\\r\\n-\\t\\t\\t\\t\\t\\tif ($uploaderObj->upload()) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && true;\\r\\n-\\t\\t\\t\\t\\t\\t\\t\/\/ Find the related field in the icms_ipf_Object\\r\\n-\\t\\t\\t\\t\\t\\t\\t$related_field = str_replace(\\'upload_\\', \\'\\', $name);\\r\\n-\\t\\t\\t\\t\\t\\t\\t$uploadedArray[] = $related_field;\\r\\n-\\t\\t\\t\\t\\t\\t\\t\/\/ if it\\'s a richfile\\r\\n-\\t\\t\\t\\t\\t\\t\\tif ($icmsObj->vars[$related_field][\\'data_type\\'] == XOBJ_DTYPE_FILE) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$object_fileurl = $icmsObj->getUploadDir();\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$fileObj = $icmsObj->getFileObj($related_field);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'url\\', $object_fileurl . $uploaderObj->getSavedFileName());\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'mid\\', $_POST[\\'mid_\\' . $related_field]);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'caption\\', $_POST[\\'caption_\\' . $related_field]);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'description\\', $_POST[\\'desc_\\' . $related_field]);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->storeFileObj($fileObj);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setVar($related_field, $fileObj->getVar(\\'fileid\\'));\\r\\n-\\t\\t\\t\\t\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'beforeFileUnlink\\', $icmsObj);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$old_file = $icmsObj->getUploadDir(true) . $icmsObj->getVar($related_field);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\tif (is_file($old_file) ) unlink($old_file);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setVar($related_field, $uploaderObj->getSavedFileName());\\r\\n-\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'afterFileUnlink\\', $icmsObj);\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors($uploaderObj->getErrors(false));\\r\\n-\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\r\\n-\\t\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t\\t\\t$icmsObj->setErrors($uploaderObj->getErrors(false));\\r\\n-\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\r\\n-\\t\\t\\t\\t\\t}\\r\\n-\\t\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\tif ($uploaderResult) {\\r\\n-\\t\\t\\tif ($debug) {\\r\\n-\\t\\t\\t\\t$storeResult = $this->handler->insertD($icmsObj);\\r\\n-\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t$storeResult = $this->handler->insert($icmsObj);\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t$storeResult = false;\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\tif ($storeResult) {\\r\\n-\\t\\t\\tif ($this->handler->getPermissions()) {\\r\\n-\\t\\t\\t\\t$icmspermissions_handler = new icms_ipf_permission_Handler($this->handler);\\r\\n-\\t\\t\\t\\t$icmspermissions_handler->storeAllPermissionsForId($icmsObj->id());\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\tif ($redirect_page === null) {\\r\\n-\\t\\t\\treturn $icmsObj;\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\tif (!$storeResult) {\\r\\n-\\t\\t\\t\\tredirect_header($impresscms->urls[\\'previouspage\\'], 3, _CO_ICMS_SAVE_ERROR . $icmsObj->getHtmlErrors());\\r\\n-\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t$redirect_page = $redirect_page ? $redirect_page : icms_get_page_before_form();\\r\\n-\\t\\t\\t\\tredirect_header($redirect_page, 2, $redirect_msg);\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t}\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * Store the object in the database autmatically from a form sending POST data\\r\\n-\\t *\\r\\n-\\t * @param string $created_success_msg message to display if new object was created\\r\\n-\\t * @param string $modified_success_msg message to display if object was successfully edited\\r\\n-\\t * @param string $created_redir_page redirect page after creating the object\\r\\n-\\t * @param string $modified_redir_page redirect page after editing the object\\r\\n-\\t * @param string $redirect_page redirect page, if not set, then we backup once\\r\\n-\\t * @param bool $exit if set to TRUE then the script ends\\r\\n-\\t * @return bool\\r\\n-\\t *\/\\r\\n-\\tpublic function &storeFromDefaultForm($created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false, $x_param = false) {\\r\\n-\\t\\t$objectid = ( isset($_POST[$this->handler->keyName]) )\\r\\n-\\t\\t\\t\\t? (int) $_POST[$this->handler->keyName]\\r\\n-\\t\\t\\t\\t: 0;\\r\\n-\\t\\tif ($debug) {\\r\\n-\\t\\t\\tif ($x_param) {\\r\\n-\\t\\t\\t\\t$icmsObj = $this->handler->getD($objectid, true,  $x_param);\\r\\n-\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t$icmsObj = $this->handler->getD($objectid);\\r\\n-\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\tif ($x_param) {\\r\\n-\\t\\t\\t\\t$icmsObj = $this->handler->get($objectid, true, false, false, $x_param);\\r\\n-\\t\\t\\t} else {\\r\\n-\\t\\t\\t\\t$icmsObj = $this->handler->get($objectid);\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\t\/**\\r\\n-\\t\\t * @todo multilanguage persistable handler is not fully implemented yet\\r\\n-\\t\\t *\/\\r\\n-\\r\\n-\\t\\t\/\/ if handler is the Multilanguage handler, we will need to treat this for multilanguage\\r\\n-\\t\\tif (is_subclass_of($this->handler, \\'icmspersistablemlobjecthandler\\')) {\\r\\n-\\r\\n-\\t\\t\\tif ($icmsObj->isNew()) {\\r\\n-\\t\\t\\t\\t\/\/ This is a new object. We need to store the meta data and then the language data\\r\\n-\\t\\t\\t\\t\/\/ First, we will get rid of the multilanguage data to only store the meta data\\r\\n-\\t\\t\\t\\t$icmsObj->stripMultilanguageFields();\\r\\n-\\t\\t\\t\\t$newObject =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\\r\\n-\\t\\t\\t\\t\/**\\r\\n-\\t\\t\\t\\t * @todo we need to trap potential errors here\\r\\n-\\t\\t\\t\\t *\/\\r\\n-\\r\\n-\\t\\t\\t\\t\/\/ ok, the meta daa is stored. Let\\'s recreate the object and then\\r\\n-\\t\\t\\t\\t\/\/ get rid of anything not multilanguage\\r\\n-\\t\\t\\t\\tunset($icmsObj);\\r\\n-\\t\\t\\t\\t$icmsObj = $this->handler->get($objectid);\\r\\n-\\t\\t\\t\\t$icmsObj->stripNonMultilanguageFields();\\r\\n-\\r\\n-\\t\\t\\t\\t$icmsObj->setVar($this->handler->keyName, $newObject->getVar($this->handler->keyName));\\r\\n-\\t\\t\\t\\t$this->handler->changeTableNameForML();\\r\\n-\\t\\t\\t\\t$ret =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\\r\\n-\\r\\n-\\t\\t\\t\\treturn $ret;\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\treturn $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\\r\\n-\\t\\t}\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * Stores an object and shows debug information\\r\\n-\\t *\/\\r\\n-\\tpublic function &storeicms_ipf_ObjectD() {\\r\\n-\\t\\treturn $this->storeicms_ipf_Object(true);\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tbool\\t$debug\\r\\n-\\t * @param\\tbool\\t$xparam\\r\\n-\\t * @see\\t\\tstoreFromDefaultForm\\r\\n-\\t *\/\\r\\n-\\tpublic function &storeicms_ipf_Object($debug=false, $xparam = false) {\\r\\n-\\t\\t$ret =& $this->storeFromDefaultForm(\\'\\', \\'\\', null, $debug, $xparam);\\r\\n-\\r\\n-\\t\\treturn $ret;\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * Handles deletion of an object which keyid is passed as a GET param\\r\\n-\\t *\\r\\n-\\t * @param string $redir_page redirect page after deleting the object\\r\\n-\\t * @return bool\\r\\n-\\t *\/\\r\\n-\\tpublic function handleObjectDeletion($confirm_msg = false, $op=\\'del\\', $userSide=false) {\\r\\n-\\t\\tglobal $impresscms;\\r\\n-\\r\\n-\\t\\t$objectid = (isset($_REQUEST[$this->handler->keyName])) ? (int) $_REQUEST[$this->handler->keyName] : 0;\\r\\n-\\t\\t$icmsObj = $this->handler->get($objectid);\\r\\n-\\r\\n-\\t\\tif ($icmsObj->isNew()) {\\r\\n-\\t\\t\\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\\r\\n-\\t\\t\\texit();\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\t$confirm = ( isset($_POST[\\'confirm\\']) ) ? $_POST[\\'confirm\\'] : 0;\\r\\n-\\t\\tif ($confirm) {\\r\\n-\\t\\t\\tif (!$this->handler->delete($icmsObj)) {\\r\\n-\\t\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\\r\\n-\\t\\t\\t\\texit;\\r\\n-\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_SUCCESS);\\r\\n-\\t\\t\\texit();\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t\/\/ no confirm: show deletion condition\\r\\n-\\r\\n-\\t\\t\\ticms_cp_header();\\r\\n-\\r\\n-\\t\\t\\tif (!$confirm_msg) {\\r\\n-\\t\\t\\t\\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\\r\\n-\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t\\t$hiddens = array(\\r\\n-\\t\\t\\t\\t\\t\\t\\'op\\' => $op,\\r\\n-\\t\\t\\t\\t\\t\\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\\r\\n-\\t\\t\\t\\t\\t\\t\\'confirm\\' => 1,\\r\\n-\\t\\t\\t\\t\\t\\t\\'redirect_page\\' => $impresscms->urls[\\'previouspage\\']\\r\\n-\\t\\t\\t);\\r\\n-\\t\\t\\tif ($this->handler->_moduleName == \\'system\\') {\\r\\n-\\t\\t\\t\\t$hiddens[\\'fct\\'] = isset($_GET[\\'fct\\']) ? $_GET[\\'fct\\'] : false;\\r\\n-\\t\\t\\t}\\r\\n-\\t\\t\\ticms_core_Message::confirm($hiddens, xoops_getenv(\\'SCRIPT_NAME\\'), sprintf($confirm_msg , $icmsObj->getVar($this->handler->identifierName)), _CO_ICMS_DELETE);\\r\\n-\\r\\n-\\t\\t\\ticms_cp_footer();\\r\\n-\\r\\n-\\t\\t}\\r\\n-\\t\\texit();\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tbool\\t$confirm_msg\\r\\n-\\t * @param\\tstring\\t$op\\r\\n-\\t *\/\\r\\n-\\tpublic function handleObjectDeletionFromUserSide($confirm_msg = false, $op=\\'del\\') {\\r\\n-\\t\\tglobal $icmsTpl, $impresscms;\\r\\n-\\r\\n-\\t\\t$objectid = ( isset($_REQUEST[$this->handler->keyName]) ) ? (int) ($_REQUEST[$this->handler->keyName]) : 0;\\r\\n-\\t\\t$icmsObj = $this->handler->get($objectid);\\r\\n-\\r\\n-\\t\\tif ($icmsObj->isNew()) {\\r\\n-\\t\\t\\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\\r\\n-\\t\\t\\texit();\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\t$confirm = ( isset($_POST[\\'confirm\\']) ) ? $_POST[\\'confirm\\'] : 0;\\r\\n-\\t\\tif ($confirm) {\\r\\n-\\t\\t\\tif (!$this->handler->delete($icmsObj)) {\\r\\n-\\t\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\\r\\n-\\t\\t\\t\\texit;\\r\\n-\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_SUCCESS);\\r\\n-\\t\\t\\texit();\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t\/\/ no confirm: show deletion condition\\r\\n-\\t\\t\\tif (!$confirm_msg) {\\r\\n-\\t\\t\\t\\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\\r\\n-\\t\\t\\t}\\r\\n-\\r\\n-\\t\\t\\tob_start();\\r\\n-\\t\\t\\ticms_core_Message::confirm(array(\\r\\n-\\t\\t\\t\\t\\'op\\' => $op,\\r\\n-\\t\\t\\t\\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\\r\\n-\\t\\t\\t\\t\\'confirm\\' => 1,\\r\\n-\\t\\t\\t\\t\\'redirect_page\\' => $impresscms->urls[\\'previouspage\\']),\\r\\n-\\t\\t\\t\\txoops_getenv(\\'SCRIPT_NAME\\'),\\r\\n-\\t\\t\\t\\tsprintf($confirm_msg ,\\r\\n-\\t\\t\\t\\t$icmsObj->getVar($this->handler->identifierName)),\\r\\n-\\t\\t\\t\\t_CO_ICMS_DELETE\\r\\n-\\t\\t\\t);\\r\\n-\\t\\t\\t$icmspersistable_delete_confirm = ob_get_clean();\\r\\n-\\t\\t\\t$icmsTpl->assign(\\'icmspersistable_delete_confirm\\', $icmspersistable_delete_confirm);\\r\\n-\\t\\t}\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * Retrieve the object admin side link for a {@link icms_ipf_view_Single} page\\r\\n-\\t *\\r\\n-\\t * @param\\tobject\\t$icmsObj\\treference to the object from which we want the user side link\\r\\n-\\t * @param\\tbool\\t$onlyUrl\\twhether or not to return a simple URL or a full <a> link\\r\\n-\\t * @param\\tbool\\t$withimage\\treturn a linked image instead of linked text\\r\\n-\\t * @return\\tstring\\tadmin side link to the object\\r\\n-\\t *\/\\r\\n-\\tpublic function getAdminViewItemLink($icmsObj, $onlyUrl=false, $withimage=false) {\\r\\n-\\t\\t$ret = $this->handler->_moduleUrl . \"admin\/\"\\r\\n-\\t\\t\\t. $this->handler->_page . \"?op=view&amp;\"\\r\\n-\\t\\t\\t. $this->handler->keyName . \"=\"\\r\\n-\\t\\t\\t. $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\tif ($onlyUrl) {\\r\\n-\\t\\t\\treturn $ret;\\r\\n-\\t\\t} elseif ($withimage) {\\r\\n-\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\r\\n-\\t\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL\\r\\n-\\t\\t\\t\\t\\t. \"\/actions\/viewmag.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\r\\n-\\t\\t\\t\\t\\t. _CO_ICMS_ADMIN_VIEW . \"\\'  title=\\'\"\\r\\n-\\t\\t\\t\\t\\t. _CO_ICMS_ADMIN_VIEW . \"\\'\/><\/a>\";\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * Retrieve the object user side link\\r\\n-\\t *\\r\\n-\\t * @param object $icmsObj reference to the object from which we want the user side link\\r\\n-\\t * @param bool $onlyUrl wether or not to return a simple URL or a full <a> link\\r\\n-\\t * @return string user side link to the object\\r\\n-\\t *\/\\r\\n-\\tpublic function getItemLink(&$icmsObj, $onlyUrl=false) {\\r\\n-\\t\\t\/**\\r\\n-\\t\\t * @todo URL Rewrite feature is not finished yet...\\r\\n-\\t\\t *\/\\r\\n-\\t\\t\/\/$seoMode = smart_getModuleModeSEO($this->handler->_moduleName);\\r\\n-\\t\\t\/\/$seoModuleName = smart_getModuleNameForSEO($this->handler->_moduleName);\\r\\n-\\t\\t$seoMode = false;\\r\\n-\\t\\t$seoModuleName = $this->handler->_moduleName;\\r\\n-\\r\\n-\\t\\t\/**\\r\\n-\\t\\t * $seoIncludeId feature is not finished yet, so let\\'s put it always to true\\r\\n-\\t\\t *\/\\r\\n-\\t\\t\/\/$seoIncludeId = smart_getModuleIncludeIdSEO($this->handler->_moduleName);\\r\\n-\\t\\t$seoIncludeId = true;\\r\\n-\\r\\n-\\t\\t\/*if ($seoMode == \\'rewrite\\') {\\r\\n-\\t\\t\\t$ret = ICMS_URL . \\'\/\\' . $seoModuleName . \\'.\\' . $this->handler->_itemname . ($seoIncludeId ? \\'.\\'\\t. $icmsObj->getVar($this->handler->keyName) : \\'\\'). \\'\/\\' . $icmsObj->getVar(\\'short_url\\') . \\'.html\\';\\r\\n-\\t\\t\\t} else if ($seoMode == \\'pathinfo\\') {\\r\\n-\\t\\t\\t$ret = SMARTOBJECT_URL . \\'seo.php\/\\' . $seoModuleName . \\'.\\' . $this->handler->_itemname . ($seoIncludeId ? \\'.\\'\\t. $icmsObj->getVar($this->handler->keyName) : \\'\\'). \\'\/\\' . $icmsObj->getVar(\\'short_url\\') . \\'.html\\';\\r\\n-\\t\\t\\t} else {\\r\\n-\\t\\t\\t*\/\\t$ret = $this->handler->_moduleUrl . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t\/\/}\\r\\n-\\r\\n-\\t\\tif (!$onlyUrl) {\\r\\n-\\t\\t\\t$ret = \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\r\\n-\\t\\t}\\r\\n-\\t\\treturn $ret;\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * This method returns a view link of the Object\\r\\n-\\t *\\r\\n-\\t * @param icms_ipf_Object $icmsObj\\r\\n-\\t * @param boolean $onlyUrl\\r\\n-\\t * @param boolean $withimage\\r\\n-\\t * @param boolean $userSide\\r\\n-\\t * @return string\\r\\n-\\t *\/\\r\\n-\\tpublic function getViewItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\\r\\n-\\t\\tif ($this->handler->_moduleName != \\'system\\') {\\r\\n-\\t\\t\\t$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\r\\n-\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t$admin_side = \\'\\';\\r\\n-\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . \\'admin.php?fct=\\'\\r\\n-\\t\\t\\t\\t. $this->handler->_itemname . \"&amp;op=view&amp;\"\\r\\n-\\t\\t\\t\\t. $this->handler->keyName . \"=\"\\r\\n-\\t\\t\\t\\t. $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t}\\r\\n-\\t\\tif ($onlyUrl) {\\r\\n-\\t\\t\\treturn $ret;\\r\\n-\\t\\t} elseif ($withimage) {\\r\\n-\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\r\\n-\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/viewmag.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\r\\n-\\t\\t\\t\\t. _PREVIEW . \"\\'  title=\\'\" . _PREVIEW . \"\\'\/><\/a>\";\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tobject\\t$icmsObj\\r\\n-\\t * @param\\tbool\\t$onlyUrl\\r\\n-\\t * @param\\tbool\\t$withimage\\r\\n-\\t *\/\\r\\n-\\tpublic function getEditLanguageLink($icmsObj, $onlyUrl=false, $withimage=true) {\\r\\n-\\t\\t$ret = $this->handler->_moduleUrl . \"admin\/\"\\r\\n-\\t\\t\\t. $this->handler->_page\\r\\n-\\t\\t\\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName)\\r\\n-\\t\\t\\t. \"&amp;language=\" . $icmsObj->getVar(\\'language\\');\\r\\n-\\t\\tif ($onlyUrl) {\\r\\n-\\t\\t\\treturn $ret;\\r\\n-\\t\\t} elseif ($withimage) {\\r\\n-\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\r\\n-\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/wizard.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\r\\n-\\t\\t\\t\\t. _CO_ICMS_LANGUAGE_MODIFY . \"\\'  title=\\'\" . _CO_ICMS_LANGUAGE_MODIFY . \"\\'\/><\/a>\";\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tobj\\t\\t$icmsObj\\r\\n-\\t * @param\\tbool\\t$onlyUrl\\r\\n-\\t * @param\\tbool\\t$withimage\\r\\n-\\t * @param\\tbool\\t$userSide\\r\\n-\\t *\/\\r\\n-\\tpublic function getEditItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\\r\\n-\\t\\tif ($this->handler->_moduleName != \\'system\\') {\\r\\n-\\t\\t\\t$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\r\\n-\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\\r\\n-\\t\\t\\t\\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t\/**\\r\\n-\\t\\t\\t * @todo: to be implemented...\\r\\n-\\t\\t\\t *\/\\r\\n-\\t\\t\\t\/\/$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\r\\n-\\t\\t\\t$admin_side = \\'\\';\\r\\n-\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side\\r\\n-\\t\\t\\t\\t. \\'admin.php?fct=\\' . $this->handler->_itemname\\r\\n-\\t\\t\\t\\t. \"&amp;op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t}\\r\\n-\\t\\tif ($onlyUrl) {\\r\\n-\\t\\t\\treturn $ret;\\r\\n-\\t\\t} elseif ($withimage) {\\r\\n-\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\r\\n-\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/edit.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\r\\n-\\t\\t\\t\\t. _CO_ICMS_MODIFY . \"\\'  title=\\'\" . _CO_ICMS_MODIFY . \"\\'\/><\/a>\";\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tobj\\t\\t$icmsObj\\r\\n-\\t * @param\\tbool\\t$onlyUrl\\r\\n-\\t * @param\\tbool\\t$withimage\\r\\n-\\t * @param\\tbool\\t$userSide\\r\\n-\\t *\/\\r\\n-\\tpublic function getDeleteItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\\r\\n-\\t\\tif ($this->handler->_moduleName != \\'system\\') {\\r\\n-\\t\\t\\t$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\r\\n-\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\\r\\n-\\t\\t\\t\\t. \"?op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t} else {\\r\\n-\\t\\t\\t\/**\\r\\n-\\t\\t\\t * @todo: to be implemented...\\r\\n-\\t\\t\\t *\/\\r\\n-\\t\\t\\t\/\/$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\r\\n-\\t\\t\\t$admin_side = \\'\\';\\r\\n-\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side\\r\\n-\\t\\t\\t\\t. \\'admin.php?fct=\\' . $this->handler->_itemname\\r\\n-\\t\\t\\t\\t. \"&amp;op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t}\\r\\n-\\t\\tif ($onlyUrl) {\\r\\n-\\t\\t\\treturn $ret;\\r\\n-\\t\\t} elseif ($withimage) {\\r\\n-\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\r\\n-\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/editdelete.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\r\\n-\\t\\t\\t\\t. _CO_ICMS_DELETE . \"\\'  title=\\'\" . _CO_ICMS_DELETE . \"\\'\/><\/a>\";\\r\\n-\\t\\t}\\r\\n-\\r\\n-\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t *\\r\\n-\\t * @param\\tobj\\t\\t$icmsObj\\r\\n-\\t * @todo\\tNeeds to be completed\\r\\n-\\t *\/\\r\\n-\\tpublic function getPrintAndMailLink($icmsObj) {\\r\\n-\\t\\tglobal $icmsConfig, $impresscms;\\r\\n-\\r\\n-\\t\\t$ret = \\'\\';\\r\\n-\\t\\t\/*\\t\\t$printlink = $this->handler->_moduleUrl . \"print.php?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\r\\n-\\t\\t $js = \"javascript:openWithSelfMain(\\'\" . $printlink . \"\\', \\'smartpopup\\', 700, 519);\";\\r\\n-\\t\\t $printlink = \\'<a href=\"\\' . $js . \\'\"><img  src=\"\\' . ICMS_IMAGES_SET_URL . \\'\/actions\/fileprint.png\" alt=\"\" style=\"vertical-align: middle;\"\/><\/a>\\';\\r\\n-\\r\\n-\\t\\t $icmsModule = icms_getModuleInfo($icmsObj->handler->_moduleName);\\r\\n-\\t\\t $link = $impresscms->urls[\\'full\\']();\\r\\n-\\t\\t $mid = $icmsModule->getVar(\\'mid\\');\\r\\n-\\t\\t $friendlink = \"<a href=\\\\\"javascript:openWithSelfMain(\\'\".SMARTOBJECT_URL.\"sendlink.php?link=\" . $link . \"&amp;mid=\" . $mid . \"\\', \\',\\',\\',\\',\\',\\',\\'sendmessage\\', 674, 500);\\\\\"><img src=\\\\\"\".SMARTOBJECT_IMAGES_ACTIONS_URL . \"mail_send.png\\\\\"  alt=\\\\\"\" . _CO_ICMS_EMAIL . \"\\\\\" title=\\\\\"\" . _CO_ICMS_EMAIL . \"\\\\\" style=\\\\\"vertical-align: middle;\\\\\"\/><\/a>\";\\r\\n-\\r\\n-\\t\\t $ret = \\'<span id=\"smartobject_print_button\">\\' . $printlink . \"&nbsp;<\/span>\" . \\'<span id=\"smartobject_mail_button\">\\' . $friendlink . \\'<\/span>\\';\\r\\n-\\t\\t *\/\\r\\n-\\t\\treturn $ret;\\r\\n-\\t}\\r\\n-\\r\\n-\\t\/**\\r\\n-\\t * Creates a string from the object\\'s module name and item name\\r\\n-\\t *\/\\r\\n-\\tpublic function getModuleItemString() {\\r\\n-\\t\\t$ret = $this->handler->_moduleName . \\'_\\' . $this->handler->_itemname;\\r\\n-\\t\\treturn $ret;\\r\\n-\\t}\\r\\n-}\\r\\n-\\r\\n+<?php\\n+\\n+\/**\\n+ * This class is responsible for providing operations to an object for managing the object\\'s manipulation\\n+ *\\n+ * @copyright\\tThe ImpressCMS Project http:\/\/www.impresscms.org\/\\n+ * @license\\t\\thttp:\/\/www.gnu.org\/licenses\/old-licenses\/gpl-2.0.html GNU General Public License (GPL)\\n+ * @category\\tICMS\\n+ * @package\\t\\tIpf\\n+ * @subpackage\\tController\\n+ * @since\\t\\t1.1\\n+ * @author\\t\\tOriginal idea by Jan Keller Pedersen <mithrandir@xoops.org> - IDG Danmark A\/S <www.idg.dk>\\n+ * @author\\t\\tmarcan <marcan@impresscms.org>\\n+ * @version\\t\\tSVN: $Id: Controller.php 11972 2012-08-26 17:49:13Z skenow $\\n+ * @todo\\t\\tUse language constants for messages\\n+ *\/\\n+\\n+defined(\\'ICMS_ROOT_PATH\\') or die(\"ImpressCMS root path not defined\");\\n+\\n+\/**\\n+ *\\n+ *\\n+ * @category\\tICMS\\n+ * @package\\t\\tIpf\\n+ * @subpackage\\tController\\n+ *\\n+ *\/\\n+class icms_ipf_Controller {\\n+\\n+\\t\/** *\/\\n+\\tpublic $handler;\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param $handler\\n+\\t *\/\\n+\\tpublic function __construct($handler) {\\n+\\t\\t$this->handler=$handler;\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tobj\\t\\t$icmsObj\\n+\\t *\/\\n+\\tpublic function postDataToObject(&$icmsObj) {\\n+\\t\\tforeach (array_keys($icmsObj->vars) as $key) {\\n+\\t\\t\\t\/\/ do not post data if control is a label\\n+\\t\\t\\t$control = $icmsObj->getControl($key);\\n+\\t\\t\\tif (is_array($control) && isset($control[\\'name\\']) && $control[\\'name\\'] == \"label\") continue;\\n+\\n+\\t\\t\\tswitch ($icmsObj->vars[$key][\\'data_type\\']) {\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_IMAGE:\\n+\\t\\t\\t\\t\\tif (isset($_POST[\\'url_\\' . $key]) && $_POST[\\'url_\\' . $key] !=\\'\\') {\\n+\\t\\t\\t\\t\\t\\t$_POST[\\'url_\\' . $key] = preg_replace(\\'|[\\\\.]+\\\\\/|\\', \\'.\/\\', $_POST[\\'url_\\' . $key]);\\n+\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'beforeFileUnlink\\', $icmsObj);\\n+\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\n+\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\\n+\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t\\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, \\'e\\');\\n+\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, $_POST[\\'url_\\' . $key]);\\n+\\t\\t\\t\\t\\t\\tif (is_file($oldFile) ) unlink($oldFile);\\n+\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'afterFileUnlink\\', $icmsObj);\\n+\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\n+\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\\n+\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\tif (isset($_POST[\\'delete_\\' . $key]) && $_POST[\\'delete_\\' . $key] == \\'1\\') {\\n+\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'beforeFileUnlink\\', $icmsObj);\\n+\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\n+\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\\n+\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t\\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, \\'e\\');\\n+\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, \\'\\');\\n+\\t\\t\\t\\t\\t\\tif (is_file($oldFile) ) unlink($oldFile);\\n+\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'afterFileUnlink\\', $icmsObj);\\n+\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\n+\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\\n+\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\tbreak;\\n+\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_URLLINK:\\n+\\t\\t\\t\\t\\t$linkObj = $icmsObj->getUrlLinkObj($key);\\n+\\t\\t\\t\\t\\t$linkObj->setVar(\\'mid\\', $_POST[\\'mid_\\' . $key]);\\n+\\t\\t\\t\\t\\t$linkObj->setVar(\\'caption\\', $_POST[\\'caption_\\' . $key]);\\n+\\t\\t\\t\\t\\t$linkObj->setVar(\\'description\\', $_POST[\\'desc_\\' . $key]);\\n+\\t\\t\\t\\t\\t$linkObj->setVar(\\'target\\', $_POST[\\'target_\\' . $key]);\\n+\\t\\t\\t\\t\\t$linkObj->setVar(\\'url\\', $_POST[\\'url_\\' . $key]);\\n+\\t\\t\\t\\t\\tif ($linkObj->getVar(\\'url\\') != \\'\\') {\\n+\\t\\t\\t\\t\\t\\t$icmsObj->storeUrlLinkObj($linkObj);\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t\/\/@todo: catch errors\\n+\\t\\t\\t\\t\\t$icmsObj->setVar($key, $linkObj->getVar(\\'urllinkid\\'));\\n+\\t\\t\\t\\t\\tbreak;\\n+\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_FILE:\\n+\\t\\t\\t\\t\\tif (!isset($_FILES[\\'upload_\\' . $key][\\'name\\']) || $_FILES[\\'upload_\\' . $key][\\'name\\'] == \\'\\') {\\n+\\t\\t\\t\\t\\t\\t$fileObj = $icmsObj->getFileObj($key);\\n+\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'mid\\', $_POST[\\'mid_\\' . $key]);\\n+\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'caption\\', $_POST[\\'caption_\\' . $key]);\\n+\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'description\\', $_POST[\\'desc_\\' . $key]);\\n+\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'url\\', preg_replace(\\'|[\\\\.]+\\\\\/|\\', \\'.\/\\', $_POST[\\'url_\\' . $key]));\\n+\\t\\t\\t\\t\\t\\tif (!($fileObj->getVar(\\'url\\') == \\'\\' && $fileObj->getVar(\\'url\\') == \\'\\' && $fileObj->getVar(\\'url\\') == \\'\\')) {\\n+\\t\\t\\t\\t\\t\\t\\t$res = $icmsObj->storeFileObj($fileObj);\\n+\\t\\t\\t\\t\\t\\t\\tif ($res) {\\n+\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, $fileObj->getVar(\\'fileid\\'));\\n+\\t\\t\\t\\t\\t\\t\\t} else {\\n+\\t\\t\\t\\t\\t\\t\\t\\t\/\/error setted, but no error message (to be improved)\\n+\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors($fileObj->getErrors());\\n+\\t\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\tbreak;\\n+\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_STIME:\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_MTIME:\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_LTIME:\\n+\\t\\t\\t\\t\\t\/\/ check if this field\\'s value is available in the POST array\\n+\\t\\t\\t\\t\\tif (is_array($_POST[$key]) && isset($_POST[$key][\\'date\\'])) {\\n+\\t\\t\\t\\t\\t\\t$value = strtotime($_POST[$key][\\'date\\']) + $_POST[$key][\\'time\\'];\\n+\\t\\t\\t\\t\\t\/\/ in case the field is hidden, it\\'s not formated so we can simply take the value and store it\\n+\\t\\t\\t\\t\\t} elseif (filter_var($_POST[$key], FILTER_VALIDATE_INT) == $_POST[$key]) {\\n+\\t\\t\\t\\t\\t\\t$value = (int)$_POST[$key];\\n+\\t\\t\\t\\t\\t} else {\\n+\\t\\t\\t\\t\\t\\t$value = strtotime($_POST[$key]);\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t$icmsObj->setVar($key, $value);\\n+\\t\\t\\t\\t\\tbreak;\\n+\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_URL:\\n+\\t\\t\\t\\t\\tif (isset($_POST[$key])) {\\n+\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, filter_var($_POST[$key], FILTER_SANITIZE_URL));\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\tbreak;\\n+\\n+\\t\\t\\t\\tcase XOBJ_DTYPE_ARRAY:\\n+\\t\\t\\t\\t\\tif (is_array($_POST[$key])) {\\n+\\t\\t\\t\\t\\t\\t$icmsObj->setVar($key, serialize($_POST[$key]));\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\tbreak;\\n+\\n+\\t\\t\\t\\tdefault:\\n+\\t\\t\\t\\t\\t$icmsObj->setVar($key, $_POST[$key]);\\n+\\t\\t\\t\\t\\tbreak;\\n+\\t\\t\\t}\\n+\\t\\t}\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tobj\\t\\t$icmsObj\\tObject\\n+\\t * @param\\tint\\t\\t$objectid\\n+\\t * @param\\tstr\\t\\t$created_success_msg\\tMessage to display on successful creation\\n+\\t * @param\\tstr\\t\\t$modified_success_msg\\tMessage to display on successful modification\\n+\\t * @param\\tbool\\t$redirect_page\\t\\t\\tWhether to redirect afterwards, or not\\n+\\t * @param\\tbool\\t$debug\\t\\t\\t\\t\\tWhether to display debug information, or not\\n+\\t *\/\\n+\\tpublic function &doStoreFromDefaultForm(&$icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false) {\\n+\\t\\tglobal $impresscms;\\n+\\t\\t$this->postDataToObject($icmsObj);\\n+\\n+\\t\\tif ($icmsObj->isNew()) {\\n+\\t\\t\\t$redirect_msg = $created_success_msg;\\n+\\t\\t} else {\\n+\\t\\t\\t$redirect_msg = $modified_success_msg;\\n+\\t\\t}\\n+\\n+\\t\\t\/\/ Check if there were uploaded files\\n+\\t\\t$uploaderResult = true;\\n+\\t\\tif (isset($_POST[\\'icms_upload_image\\']) || isset($_POST[\\'icms_upload_file\\'])) {\\n+\\t\\t\\t$uploaderObj = new icms_file_MediaUploadHandler($icmsObj->getImageDir(true), $this->handler->_allowedMimeTypes, $this->handler->_maxFileSize, $this->handler->_maxWidth, $this->handler->_maxHeight);\\n+\\t\\t\\tforeach ( $_FILES as $name=>$file_array) {\\n+\\t\\t\\t\\tif (isset ($file_array[\\'name\\']) && $file_array[\\'name\\'] != \"\" && in_array(str_replace(\\'upload_\\', \\'\\', $name), array_keys($icmsObj->vars))) {\\n+\\t\\t\\t\\t\\tif ($uploaderObj->fetchMedia($name)) {\\n+\\t\\t\\t\\t\\t\\t$uploaderObj->setTargetFileName(time() . \"_\" . $uploaderObj->getMediaName());\\n+\\t\\t\\t\\t\\t\\tif ($uploaderObj->upload()) {\\n+\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && true;\\n+\\t\\t\\t\\t\\t\\t\\t\/\/ Find the related field in the icms_ipf_Object\\n+\\t\\t\\t\\t\\t\\t\\t$related_field = str_replace(\\'upload_\\', \\'\\', $name);\\n+\\t\\t\\t\\t\\t\\t\\t$uploadedArray[] = $related_field;\\n+\\t\\t\\t\\t\\t\\t\\t\/\/ if it\\'s a richfile\\n+\\t\\t\\t\\t\\t\\t\\tif ($icmsObj->vars[$related_field][\\'data_type\\'] == XOBJ_DTYPE_FILE) {\\n+\\t\\t\\t\\t\\t\\t\\t\\t$object_fileurl = $icmsObj->getUploadDir();\\n+\\t\\t\\t\\t\\t\\t\\t\\t$fileObj = $icmsObj->getFileObj($related_field);\\n+\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'url\\', $object_fileurl . $uploaderObj->getSavedFileName());\\n+\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'mid\\', $_POST[\\'mid_\\' . $related_field]);\\n+\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'caption\\', $_POST[\\'caption_\\' . $related_field]);\\n+\\t\\t\\t\\t\\t\\t\\t\\t$fileObj->setVar(\\'description\\', $_POST[\\'desc_\\' . $related_field]);\\n+\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->storeFileObj($fileObj);\\n+\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setVar($related_field, $fileObj->getVar(\\'fileid\\'));\\n+\\t\\t\\t\\t\\t\\t\\t} else {\\n+\\t\\t\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'beforeFileUnlink\\', $icmsObj);\\n+\\t\\t\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\n+\\t\\t\\t\\t\\t\\t\\t\\t}\\n+\\n+\\t\\t\\t\\t\\t\\t\\t\\t$old_file = $icmsObj->getUploadDir(true) . $icmsObj->getVar($related_field);\\n+\\t\\t\\t\\t\\t\\t\\t\\tif (is_file($old_file) ) unlink($old_file);\\n+\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setVar($related_field, $uploaderObj->getSavedFileName());\\n+\\n+\\t\\t\\t\\t\\t\\t\\t\\t$eventResult = $this->handler->executeEvent(\\'afterFileUnlink\\', $icmsObj);\\n+\\t\\t\\t\\t\\t\\t\\t\\tif (!$eventResult) {\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\n+\\t\\t\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t\\t} else {\\n+\\t\\t\\t\\t\\t\\t\\t$icmsObj->setErrors($uploaderObj->getErrors(false));\\n+\\t\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\n+\\t\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t\\t} else {\\n+\\t\\t\\t\\t\\t\\t$icmsObj->setErrors($uploaderObj->getErrors(false));\\n+\\t\\t\\t\\t\\t\\t$uploaderResult = $uploaderResult && false;\\n+\\t\\t\\t\\t\\t}\\n+\\t\\t\\t\\t}\\n+\\n+\\t\\t\\t}\\n+\\t\\t}\\n+\\n+\\t\\tif ($uploaderResult) {\\n+\\t\\t\\tif ($debug) {\\n+\\t\\t\\t\\t$storeResult = $this->handler->insertD($icmsObj);\\n+\\t\\t\\t} else {\\n+\\t\\t\\t\\t$storeResult = $this->handler->insert($icmsObj);\\n+\\t\\t\\t}\\n+\\t\\t} else {\\n+\\t\\t\\t$storeResult = false;\\n+\\t\\t}\\n+\\n+\\t\\tif ($storeResult) {\\n+\\t\\t\\tif ($this->handler->getPermissions()) {\\n+\\t\\t\\t\\t$icmspermissions_handler = new icms_ipf_permission_Handler($this->handler);\\n+\\t\\t\\t\\t$icmspermissions_handler->storeAllPermissionsForId($icmsObj->id());\\n+\\t\\t\\t}\\n+\\t\\t}\\n+\\n+\\t\\tif ($redirect_page === null) {\\n+\\t\\t\\treturn $icmsObj;\\n+\\t\\t} else {\\n+\\t\\t\\tif (!$storeResult) {\\n+\\t\\t\\t\\tredirect_header($impresscms->urls[\\'previouspage\\'], 3, _CO_ICMS_SAVE_ERROR . $icmsObj->getHtmlErrors());\\n+\\t\\t\\t} else {\\n+\\t\\t\\t\\t$redirect_page = $redirect_page ? $redirect_page : icms_get_page_before_form();\\n+\\t\\t\\t\\tredirect_header($redirect_page, 2, $redirect_msg);\\n+\\t\\t\\t}\\n+\\t\\t}\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * Store the object in the database autmatically from a form sending POST data\\n+\\t *\\n+\\t * @param string $created_success_msg message to display if new object was created\\n+\\t * @param string $modified_success_msg message to display if object was successfully edited\\n+\\t * @param string $created_redir_page redirect page after creating the object\\n+\\t * @param string $modified_redir_page redirect page after editing the object\\n+\\t * @param string $redirect_page redirect page, if not set, then we backup once\\n+\\t * @param bool $exit if set to TRUE then the script ends\\n+\\t * @return bool\\n+\\t *\/\\n+\\tpublic function &storeFromDefaultForm($created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false, $x_param = false) {\\n+\\t\\t$objectid = ( isset($_POST[$this->handler->keyName]) )\\n+\\t\\t\\t\\t? (int) $_POST[$this->handler->keyName]\\n+\\t\\t\\t\\t: 0;\\n+\\t\\tif ($debug) {\\n+\\t\\t\\tif ($x_param) {\\n+\\t\\t\\t\\t$icmsObj = $this->handler->getD($objectid, true,  $x_param);\\n+\\t\\t\\t} else {\\n+\\t\\t\\t\\t$icmsObj = $this->handler->getD($objectid);\\n+\\t\\t\\t}\\n+\\n+\\t\\t} else {\\n+\\t\\t\\tif ($x_param) {\\n+\\t\\t\\t\\t$icmsObj = $this->handler->get($objectid, true, false, false, $x_param);\\n+\\t\\t\\t} else {\\n+\\t\\t\\t\\t$icmsObj = $this->handler->get($objectid);\\n+\\t\\t\\t}\\n+\\t\\t}\\n+\\n+\\t\\t\/**\\n+\\t\\t * @todo multilanguage persistable handler is not fully implemented yet\\n+\\t\\t *\/\\n+\\n+\\t\\t\/\/ if handler is the Multilanguage handler, we will need to treat this for multilanguage\\n+\\t\\tif (is_subclass_of($this->handler, \\'icmspersistablemlobjecthandler\\')) {\\n+\\n+\\t\\t\\tif ($icmsObj->isNew()) {\\n+\\t\\t\\t\\t\/\/ This is a new object. We need to store the meta data and then the language data\\n+\\t\\t\\t\\t\/\/ First, we will get rid of the multilanguage data to only store the meta data\\n+\\t\\t\\t\\t$icmsObj->stripMultilanguageFields();\\n+\\t\\t\\t\\t$newObject =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\\n+\\t\\t\\t\\t\/**\\n+\\t\\t\\t\\t * @todo we need to trap potential errors here\\n+\\t\\t\\t\\t *\/\\n+\\n+\\t\\t\\t\\t\/\/ ok, the meta daa is stored. Let\\'s recreate the object and then\\n+\\t\\t\\t\\t\/\/ get rid of anything not multilanguage\\n+\\t\\t\\t\\tunset($icmsObj);\\n+\\t\\t\\t\\t$icmsObj = $this->handler->get($objectid);\\n+\\t\\t\\t\\t$icmsObj->stripNonMultilanguageFields();\\n+\\n+\\t\\t\\t\\t$icmsObj->setVar($this->handler->keyName, $newObject->getVar($this->handler->keyName));\\n+\\t\\t\\t\\t$this->handler->changeTableNameForML();\\n+\\t\\t\\t\\t$ret =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\\n+\\n+\\t\\t\\t\\treturn $ret;\\n+\\t\\t\\t}\\n+\\t\\t} else {\\n+\\t\\t\\treturn $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\\n+\\t\\t}\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * Stores an object and shows debug information\\n+\\t *\/\\n+\\tpublic function &storeicms_ipf_ObjectD() {\\n+\\t\\treturn $this->storeicms_ipf_Object(true);\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tbool\\t$debug\\n+\\t * @param\\tbool\\t$xparam\\n+\\t * @see\\t\\tstoreFromDefaultForm\\n+\\t *\/\\n+\\tpublic function &storeicms_ipf_Object($debug=false, $xparam = false) {\\n+\\t\\t$ret =& $this->storeFromDefaultForm(\\'\\', \\'\\', null, $debug, $xparam);\\n+\\n+\\t\\treturn $ret;\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * Handles deletion of an object which keyid is passed as a GET param\\n+\\t *\\n+\\t * @param string $redir_page redirect page after deleting the object\\n+\\t * @return bool\\n+\\t *\/\\n+\\tpublic function handleObjectDeletion($confirm_msg = false, $op=\\'del\\', $userSide=false) {\\n+\\t\\tglobal $impresscms;\\n+\\n+\\t\\t$objectid = (isset($_REQUEST[$this->handler->keyName])) ? (int) $_REQUEST[$this->handler->keyName] : 0;\\n+\\t\\t$icmsObj = $this->handler->get($objectid);\\n+\\n+\\t\\tif ($icmsObj->isNew()) {\\n+\\t\\t\\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\\n+\\t\\t\\texit();\\n+\\t\\t}\\n+\\n+\\t\\t$confirm = ( isset($_POST[\\'confirm\\']) ) ? $_POST[\\'confirm\\'] : 0;\\n+\\t\\tif ($confirm) {\\n+\\t\\t\\tif (!$this->handler->delete($icmsObj)) {\\n+\\t\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\\n+\\t\\t\\t\\texit;\\n+\\t\\t\\t}\\n+\\n+\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_SUCCESS);\\n+\\t\\t\\texit();\\n+\\t\\t} else {\\n+\\t\\t\\t\/\/ no confirm: show deletion condition\\n+\\n+\\t\\t\\ticms_cp_header();\\n+\\n+\\t\\t\\tif (!$confirm_msg) {\\n+\\t\\t\\t\\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\\n+\\t\\t\\t}\\n+\\n+\\t\\t\\t$hiddens = array(\\n+\\t\\t\\t\\t\\t\\t\\'op\\' => $op,\\n+\\t\\t\\t\\t\\t\\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\\n+\\t\\t\\t\\t\\t\\t\\'confirm\\' => 1,\\n+\\t\\t\\t\\t\\t\\t\\'redirect_page\\' => $impresscms->urls[\\'previouspage\\']\\n+\\t\\t\\t);\\n+\\t\\t\\tif ($this->handler->_moduleName == \\'system\\') {\\n+\\t\\t\\t\\t$hiddens[\\'fct\\'] = isset($_GET[\\'fct\\']) ? $_GET[\\'fct\\'] : false;\\n+\\t\\t\\t}\\n+\\t\\t\\ticms_core_Message::confirm($hiddens, xoops_getenv(\\'SCRIPT_NAME\\'), sprintf($confirm_msg , $icmsObj->getVar($this->handler->identifierName)), _CO_ICMS_DELETE);\\n+\\n+\\t\\t\\ticms_cp_footer();\\n+\\n+\\t\\t}\\n+\\t\\texit();\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tbool\\t$confirm_msg\\n+\\t * @param\\tstring\\t$op\\n+\\t *\/\\n+\\tpublic function handleObjectDeletionFromUserSide($confirm_msg = false, $op=\\'del\\') {\\n+\\t\\tglobal $icmsTpl, $impresscms;\\n+\\n+\\t\\t$objectid = ( isset($_REQUEST[$this->handler->keyName]) ) ? (int) ($_REQUEST[$this->handler->keyName]) : 0;\\n+\\t\\t$icmsObj = $this->handler->get($objectid);\\n+\\n+\\t\\tif ($icmsObj->isNew()) {\\n+\\t\\t\\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\\n+\\t\\t\\texit();\\n+\\t\\t}\\n+\\n+\\t\\t$confirm = ( isset($_POST[\\'confirm\\']) ) ? $_POST[\\'confirm\\'] : 0;\\n+\\t\\tif ($confirm) {\\n+\\t\\t\\tif (!$this->handler->delete($icmsObj)) {\\n+\\t\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\\n+\\t\\t\\t\\texit;\\n+\\t\\t\\t}\\n+\\n+\\t\\t\\tredirect_header($_POST[\\'redirect_page\\'], 3, _CO_ICMS_DELETE_SUCCESS);\\n+\\t\\t\\texit();\\n+\\t\\t} else {\\n+\\t\\t\\t\/\/ no confirm: show deletion condition\\n+\\t\\t\\tif (!$confirm_msg) {\\n+\\t\\t\\t\\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\\n+\\t\\t\\t}\\n+\\n+\\t\\t\\tob_start();\\n+\\t\\t\\ticms_core_Message::confirm(array(\\n+\\t\\t\\t\\t\\'op\\' => $op,\\n+\\t\\t\\t\\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\\n+\\t\\t\\t\\t\\'confirm\\' => 1,\\n+\\t\\t\\t\\t\\'redirect_page\\' => $impresscms->urls[\\'previouspage\\']),\\n+\\t\\t\\t\\txoops_getenv(\\'SCRIPT_NAME\\'),\\n+\\t\\t\\t\\tsprintf($confirm_msg ,\\n+\\t\\t\\t\\t$icmsObj->getVar($this->handler->identifierName)),\\n+\\t\\t\\t\\t_CO_ICMS_DELETE\\n+\\t\\t\\t);\\n+\\t\\t\\t$icmspersistable_delete_confirm = ob_get_clean();\\n+\\t\\t\\t$icmsTpl->assign(\\'icmspersistable_delete_confirm\\', $icmspersistable_delete_confirm);\\n+\\t\\t}\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * Retrieve the object admin side link for a {@link icms_ipf_view_Single} page\\n+\\t *\\n+\\t * @param\\tobject\\t$icmsObj\\treference to the object from which we want the user side link\\n+\\t * @param\\tbool\\t$onlyUrl\\twhether or not to return a simple URL or a full <a> link\\n+\\t * @param\\tbool\\t$withimage\\treturn a linked image instead of linked text\\n+\\t * @return\\tstring\\tadmin side link to the object\\n+\\t *\/\\n+\\tpublic function getAdminViewItemLink($icmsObj, $onlyUrl=false, $withimage=false) {\\n+\\t\\t$ret = $this->handler->_moduleUrl . \"admin\/\"\\n+\\t\\t\\t. $this->handler->_page . \"?op=view&amp;\"\\n+\\t\\t\\t. $this->handler->keyName . \"=\"\\n+\\t\\t\\t. $icmsObj->getVar($this->handler->keyName);\\n+\\t\\tif ($onlyUrl) {\\n+\\t\\t\\treturn $ret;\\n+\\t\\t} elseif ($withimage) {\\n+\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\n+\\t\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL\\n+\\t\\t\\t\\t\\t. \"\/actions\/viewmag.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\n+\\t\\t\\t\\t\\t. _CO_ICMS_ADMIN_VIEW . \"\\'  title=\\'\"\\n+\\t\\t\\t\\t\\t. _CO_ICMS_ADMIN_VIEW . \"\\'\/><\/a>\";\\n+\\t\\t}\\n+\\n+\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * Retrieve the object user side link\\n+\\t *\\n+\\t * @param object $icmsObj reference to the object from which we want the user side link\\n+\\t * @param bool $onlyUrl wether or not to return a simple URL or a full <a> link\\n+\\t * @return string user side link to the object\\n+\\t *\/\\n+\\tpublic function getItemLink(&$icmsObj, $onlyUrl=false) {\\n+\\t\\t\/**\\n+\\t\\t * @todo URL Rewrite feature is not finished yet...\\n+\\t\\t *\/\\n+\\t\\t\/\/$seoMode = smart_getModuleModeSEO($this->handler->_moduleName);\\n+\\t\\t\/\/$seoModuleName = smart_getModuleNameForSEO($this->handler->_moduleName);\\n+\\t\\t$seoMode = false;\\n+\\t\\t$seoModuleName = $this->handler->_moduleName;\\n+\\n+\\t\\t\/**\\n+\\t\\t * $seoIncludeId feature is not finished yet, so let\\'s put it always to true\\n+\\t\\t *\/\\n+\\t\\t\/\/$seoIncludeId = smart_getModuleIncludeIdSEO($this->handler->_moduleName);\\n+\\t\\t$seoIncludeId = true;\\n+\\n+\\t\\t\/*if ($seoMode == \\'rewrite\\') {\\n+\\t\\t\\t$ret = ICMS_URL . \\'\/\\' . $seoModuleName . \\'.\\' . $this->handler->_itemname . ($seoIncludeId ? \\'.\\'\\t. $icmsObj->getVar($this->handler->keyName) : \\'\\'). \\'\/\\' . $icmsObj->getVar(\\'short_url\\') . \\'.html\\';\\n+\\t\\t\\t} else if ($seoMode == \\'pathinfo\\') {\\n+\\t\\t\\t$ret = SMARTOBJECT_URL . \\'seo.php\/\\' . $seoModuleName . \\'.\\' . $this->handler->_itemname . ($seoIncludeId ? \\'.\\'\\t. $icmsObj->getVar($this->handler->keyName) : \\'\\'). \\'\/\\' . $icmsObj->getVar(\\'short_url\\') . \\'.html\\';\\n+\\t\\t\\t} else {\\n+\\t\\t\\t*\/\\t$ret = $this->handler->_moduleUrl . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t\/\/}\\n+\\n+\\t\\tif (!$onlyUrl) {\\n+\\t\\t\\t$ret = \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\n+\\t\\t}\\n+\\t\\treturn $ret;\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * This method returns a view link of the Object\\n+\\t *\\n+\\t * @param icms_ipf_Object $icmsObj\\n+\\t * @param boolean $onlyUrl\\n+\\t * @param boolean $withimage\\n+\\t * @param boolean $userSide\\n+\\t * @return string\\n+\\t *\/\\n+\\tpublic function getViewItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\\n+\\t\\tif ($this->handler->_moduleName != \\'system\\') {\\n+\\t\\t\\t$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\n+\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t} else {\\n+\\t\\t\\t$admin_side = \\'\\';\\n+\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . \\'admin.php?fct=\\'\\n+\\t\\t\\t\\t. $this->handler->_itemname . \"&amp;op=view&amp;\"\\n+\\t\\t\\t\\t. $this->handler->keyName . \"=\"\\n+\\t\\t\\t\\t. $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t}\\n+\\t\\tif ($onlyUrl) {\\n+\\t\\t\\treturn $ret;\\n+\\t\\t} elseif ($withimage) {\\n+\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\n+\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/viewmag.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\n+\\t\\t\\t\\t. _PREVIEW . \"\\'  title=\\'\" . _PREVIEW . \"\\'\/><\/a>\";\\n+\\t\\t}\\n+\\n+\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tobject\\t$icmsObj\\n+\\t * @param\\tbool\\t$onlyUrl\\n+\\t * @param\\tbool\\t$withimage\\n+\\t *\/\\n+\\tpublic function getEditLanguageLink($icmsObj, $onlyUrl=false, $withimage=true) {\\n+\\t\\t$ret = $this->handler->_moduleUrl . \"admin\/\"\\n+\\t\\t\\t. $this->handler->_page\\n+\\t\\t\\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName)\\n+\\t\\t\\t. \"&amp;language=\" . $icmsObj->getVar(\\'language\\');\\n+\\t\\tif ($onlyUrl) {\\n+\\t\\t\\treturn $ret;\\n+\\t\\t} elseif ($withimage) {\\n+\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\n+\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/wizard.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\n+\\t\\t\\t\\t. _CO_ICMS_LANGUAGE_MODIFY . \"\\'  title=\\'\" . _CO_ICMS_LANGUAGE_MODIFY . \"\\'\/><\/a>\";\\n+\\t\\t}\\n+\\n+\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tobj\\t\\t$icmsObj\\n+\\t * @param\\tbool\\t$onlyUrl\\n+\\t * @param\\tbool\\t$withimage\\n+\\t * @param\\tbool\\t$userSide\\n+\\t *\/\\n+\\tpublic function getEditItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\\n+\\t\\tif ($this->handler->_moduleName != \\'system\\') {\\n+\\t\\t\\t$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\n+\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\\n+\\t\\t\\t\\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t} else {\\n+\\t\\t\\t\/**\\n+\\t\\t\\t * @todo: to be implemented...\\n+\\t\\t\\t *\/\\n+\\t\\t\\t\/\/$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\n+\\t\\t\\t$admin_side = \\'\\';\\n+\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side\\n+\\t\\t\\t\\t. \\'admin.php?fct=\\' . $this->handler->_itemname\\n+\\t\\t\\t\\t. \"&amp;op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t}\\n+\\t\\tif ($onlyUrl) {\\n+\\t\\t\\treturn $ret;\\n+\\t\\t} elseif ($withimage) {\\n+\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\n+\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/edit.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\n+\\t\\t\\t\\t. _CO_ICMS_MODIFY . \"\\'  title=\\'\" . _CO_ICMS_MODIFY . \"\\'\/><\/a>\";\\n+\\t\\t}\\n+\\n+\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tobj\\t\\t$icmsObj\\n+\\t * @param\\tbool\\t$onlyUrl\\n+\\t * @param\\tbool\\t$withimage\\n+\\t * @param\\tbool\\t$userSide\\n+\\t *\/\\n+\\tpublic function getDeleteItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\\n+\\t\\tif ($this->handler->_moduleName != \\'system\\') {\\n+\\t\\t\\t$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\n+\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\\n+\\t\\t\\t\\t. \"?op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t} else {\\n+\\t\\t\\t\/**\\n+\\t\\t\\t * @todo: to be implemented...\\n+\\t\\t\\t *\/\\n+\\t\\t\\t\/\/$admin_side = $userSide ? \\'\\' : \\'admin\/\\';\\n+\\t\\t\\t$admin_side = \\'\\';\\n+\\t\\t\\t$ret = $this->handler->_moduleUrl . $admin_side\\n+\\t\\t\\t\\t. \\'admin.php?fct=\\' . $this->handler->_itemname\\n+\\t\\t\\t\\t. \"&amp;op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t}\\n+\\t\\tif ($onlyUrl) {\\n+\\t\\t\\treturn $ret;\\n+\\t\\t} elseif ($withimage) {\\n+\\t\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\\n+\\t\\t\\t\\t<img src=\\'\" . ICMS_IMAGES_SET_URL . \"\/actions\/editdelete.png\\' style=\\'vertical-align: middle;\\' alt=\\'\"\\n+\\t\\t\\t\\t. _CO_ICMS_DELETE . \"\\'  title=\\'\" . _CO_ICMS_DELETE . \"\\'\/><\/a>\";\\n+\\t\\t}\\n+\\n+\\t\\treturn \"<a href=\\'\" . $ret . \"\\'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\\n+\\t}\\n+\\n+\\t\/**\\n+\\t *\\n+\\t * @param\\tobj\\t\\t$icmsObj\\n+\\t * @todo\\tNeeds to be completed\\n+\\t *\/\\n+\\tpublic function getPrintAndMailLink($icmsObj) {\\n+\\t\\tglobal $icmsConfig, $impresscms;\\n+\\n+\\t\\t$ret = \\'\\';\\n+\\t\\t\/*\\t\\t$printlink = $this->handler->_moduleUrl . \"print.php?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\\n+\\t\\t $js = \"javascript:openWithSelfMain(\\'\" . $printlink . \"\\', \\'smartpopup\\', 700, 519);\";\\n+\\t\\t $printlink = \\'<a href=\"\\' . $js . \\'\"><img  src=\"\\' . ICMS_IMAGES_SET_URL . \\'\/actions\/fileprint.png\" alt=\"\" style=\"vertical-align: middle;\"\/><\/a>\\';\\n+\\n+\\t\\t $icmsModule = icms_getModuleInfo($icmsObj->handler->_moduleName);\\n+\\t\\t $link = $impresscms->urls[\\'full\\']();\\n+\\t\\t $mid = $icmsModule->getVar(\\'mid\\');\\n+\\t\\t $friendlink = \"<a href=\\\\\"javascript:openWithSelfMain(\\'\".SMARTOBJECT_URL.\"sendlink.php?link=\" . $link . \"&amp;mid=\" . $mid . \"\\', \\',\\',\\',\\',\\',\\',\\'sendmessage\\', 674, 500);\\\\\"><img src=\\\\\"\".SMARTOBJECT_IMAGES_ACTIONS_URL . \"mail_send.png\\\\\"  alt=\\\\\"\" . _CO_ICMS_EMAIL . \"\\\\\" title=\\\\\"\" . _CO_ICMS_EMAIL . \"\\\\\" style=\\\\\"vertical-align: middle;\\\\\"\/><\/a>\";\\n+\\n+\\t\\t $ret = \\'<span id=\"smartobject_print_button\">\\' . $printlink . \"&nbsp;<\/span>\" . \\'<span id=\"smartobject_mail_button\">\\' . $friendlink . \\'<\/span>\\';\\n+\\t\\t *\/\\n+\\t\\treturn $ret;\\n+\\t}\\n+\\n+\\t\/**\\n+\\t * Creates a string from the object\\'s module name and item name\\n+\\t *\/\\n+\\tpublic function getModuleItemString() {\\n+\\t\\t$ret = $this->handler->_moduleName . \\'_\\' . $this->handler->_itemname;\\n+\\t\\treturn $ret;\\n+\\t}\\n+}\\n+'}}",
            "message_norm":"prevents using submitted filenames with ..\/ for controller (#812)\n\n* prevents using submitted filenames with ..\/ for controller\r\n\r\n* using preg replace for better parent paths replaces\r\n\r\nco-authored-by: raimondas rimkevi\u010dius (aka mekdrop) <mekdrop@impresscms.org>",
            "language":"en",
            "entities":"[('prevents', 'ACTION', ''), ('#812', 'ISSUE', ''), ('prevents', 'ACTION', ''), ('mekdrop@impresscms.org', 'EMAIL', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['htdocs\/libraries\/icms\/ipf\/Controller.php'])",
            "num_files":1.0,
            "patch_content":"From a66d7bb499faafab803e24833606028fa0ba4261 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Raimondas=20Rimkevi=C4=8Dius?= <github@mekdrop.name>\nDate: Sat, 5 Dec 2020 01:48:24 +0200\nSubject: [PATCH] Prevents using submitted filenames with ..\/ for controller\n (#812)\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n* Prevents using submitted filenames with ..\/ for controller\n\n* Using preg replace for better parent paths replaces\n\nCo-authored-by: Raimondas Rimkevi\u010dius (aka MekDrop) <mekdrop@impresscms.org>\n---\n htdocs\/libraries\/icms\/ipf\/Controller.php | 1285 +++++++++++-----------\n 1 file changed, 643 insertions(+), 642 deletions(-)\n\ndiff --git a\/htdocs\/libraries\/icms\/ipf\/Controller.php b\/htdocs\/libraries\/icms\/ipf\/Controller.php\nindex 66e37b3eb14b..ce1eb928c9b0 100644\n--- a\/htdocs\/libraries\/icms\/ipf\/Controller.php\n+++ b\/htdocs\/libraries\/icms\/ipf\/Controller.php\n@@ -1,642 +1,643 @@\n-<?php\r\n-\r\n-\/**\r\n- * This class is responsible for providing operations to an object for managing the object's manipulation\r\n- *\r\n- * @copyright\tThe ImpressCMS Project http:\/\/www.impresscms.org\/\r\n- * @license\t\thttp:\/\/www.gnu.org\/licenses\/old-licenses\/gpl-2.0.html GNU General Public License (GPL)\r\n- * @category\tICMS\r\n- * @package\t\tIpf\r\n- * @subpackage\tController\r\n- * @since\t\t1.1\r\n- * @author\t\tOriginal idea by Jan Keller Pedersen <mithrandir@xoops.org> - IDG Danmark A\/S <www.idg.dk>\r\n- * @author\t\tmarcan <marcan@impresscms.org>\r\n- * @version\t\tSVN: $Id: Controller.php 11972 2012-08-26 17:49:13Z skenow $\r\n- * @todo\t\tUse language constants for messages\r\n- *\/\r\n-\r\n-defined('ICMS_ROOT_PATH') or die(\"ImpressCMS root path not defined\");\r\n-\r\n-\/**\r\n- *\r\n- *\r\n- * @category\tICMS\r\n- * @package\t\tIpf\r\n- * @subpackage\tController\r\n- *\r\n- *\/\r\n-class icms_ipf_Controller {\r\n-\r\n-\t\/** *\/\r\n-\tpublic $handler;\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param $handler\r\n-\t *\/\r\n-\tpublic function __construct($handler) {\r\n-\t\t$this->handler=$handler;\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tobj\t\t$icmsObj\r\n-\t *\/\r\n-\tpublic function postDataToObject(&$icmsObj) {\r\n-\t\tforeach (array_keys($icmsObj->vars) as $key) {\r\n-\t\t\t\/\/ do not post data if control is a label\r\n-\t\t\t$control = $icmsObj->getControl($key);\r\n-\t\t\tif (is_array($control) && isset($control['name']) && $control['name'] == \"label\") continue;\r\n-\r\n-\t\t\tswitch ($icmsObj->vars[$key]['data_type']) {\r\n-\t\t\t\tcase XOBJ_DTYPE_IMAGE:\r\n-\t\t\t\t\tif (isset($_POST['url_' . $key]) && $_POST['url_' . $key] !='') {\r\n-\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('beforeFileUnlink', $icmsObj);\r\n-\t\t\t\t\t\tif (!$eventResult) {\r\n-\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\r\n-\t\t\t\t\t\t}\r\n-\t\t\t\t\t\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, 'e');\r\n-\t\t\t\t\t\t$icmsObj->setVar($key, $_POST['url_' . $key]);\r\n-\t\t\t\t\t\tif (is_file($oldFile) ) unlink($oldFile);\r\n-\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('afterFileUnlink', $icmsObj);\r\n-\t\t\t\t\t\tif (!$eventResult) {\r\n-\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\r\n-\t\t\t\t\t\t}\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\tif (isset($_POST['delete_' . $key]) && $_POST['delete_' . $key] == '1') {\r\n-\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('beforeFileUnlink', $icmsObj);\r\n-\t\t\t\t\t\tif (!$eventResult) {\r\n-\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\r\n-\t\t\t\t\t\t}\r\n-\t\t\t\t\t\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, 'e');\r\n-\t\t\t\t\t\t$icmsObj->setVar($key, '');\r\n-\t\t\t\t\t\tif (is_file($oldFile) ) unlink($oldFile);\r\n-\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('afterFileUnlink', $icmsObj);\r\n-\t\t\t\t\t\tif (!$eventResult) {\r\n-\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\r\n-\t\t\t\t\t\t}\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\tbreak;\r\n-\r\n-\t\t\t\tcase XOBJ_DTYPE_URLLINK:\r\n-\t\t\t\t\t$linkObj = $icmsObj->getUrlLinkObj($key);\r\n-\t\t\t\t\t$linkObj->setVar('mid', $_POST['mid_' . $key]);\r\n-\t\t\t\t\t$linkObj->setVar('caption', $_POST['caption_' . $key]);\r\n-\t\t\t\t\t$linkObj->setVar('description', $_POST['desc_' . $key]);\r\n-\t\t\t\t\t$linkObj->setVar('target', $_POST['target_' . $key]);\r\n-\t\t\t\t\t$linkObj->setVar('url', $_POST['url_' . $key]);\r\n-\t\t\t\t\tif ($linkObj->getVar('url') != '') {\r\n-\t\t\t\t\t\t$icmsObj->storeUrlLinkObj($linkObj);\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\t\/\/@todo: catch errors\r\n-\t\t\t\t\t$icmsObj->setVar($key, $linkObj->getVar('urllinkid'));\r\n-\t\t\t\t\tbreak;\r\n-\r\n-\t\t\t\tcase XOBJ_DTYPE_FILE:\r\n-\t\t\t\t\tif (!isset($_FILES['upload_' . $key]['name']) || $_FILES['upload_' . $key]['name'] == '') {\r\n-\t\t\t\t\t\t$fileObj = $icmsObj->getFileObj($key);\r\n-\t\t\t\t\t\t$fileObj->setVar('mid', $_POST['mid_' . $key]);\r\n-\t\t\t\t\t\t$fileObj->setVar('caption', $_POST['caption_' . $key]);\r\n-\t\t\t\t\t\t$fileObj->setVar('description', $_POST['desc_' . $key]);\r\n-\t\t\t\t\t\t$fileObj->setVar('url', $_POST['url_' . $key]);\r\n-\t\t\t\t\t\tif (!($fileObj->getVar('url') == '' && $fileObj->getVar('url') == '' && $fileObj->getVar('url') == '')) {\r\n-\t\t\t\t\t\t\t$res = $icmsObj->storeFileObj($fileObj);\r\n-\t\t\t\t\t\t\tif ($res) {\r\n-\t\t\t\t\t\t\t\t$icmsObj->setVar($key, $fileObj->getVar('fileid'));\r\n-\t\t\t\t\t\t\t} else {\r\n-\t\t\t\t\t\t\t\t\/\/error setted, but no error message (to be improved)\r\n-\t\t\t\t\t\t\t\t$icmsObj->setErrors($fileObj->getErrors());\r\n-\t\t\t\t\t\t\t}\r\n-\t\t\t\t\t\t}\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\tbreak;\r\n-\r\n-\t\t\t\tcase XOBJ_DTYPE_STIME:\r\n-\t\t\t\tcase XOBJ_DTYPE_MTIME:\r\n-\t\t\t\tcase XOBJ_DTYPE_LTIME:\r\n-\t\t\t\t\t\/\/ check if this field's value is available in the POST array\r\n-\t\t\t\t\tif (is_array($_POST[$key]) && isset($_POST[$key]['date'])) {\r\n-\t\t\t\t\t\t$value = strtotime($_POST[$key]['date']) + $_POST[$key]['time'];\r\n-\t\t\t\t\t\/\/ in case the field is hidden, it's not formated so we can simply take the value and store it\r\n-\t\t\t\t\t} elseif (filter_var($_POST[$key], FILTER_VALIDATE_INT) == $_POST[$key]) {\r\n-\t\t\t\t\t\t$value = (int)$_POST[$key];\r\n-\t\t\t\t\t} else {\r\n-\t\t\t\t\t\t$value = strtotime($_POST[$key]);\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\t$icmsObj->setVar($key, $value);\r\n-\t\t\t\t\tbreak;\r\n-\r\n-\t\t\t\tcase XOBJ_DTYPE_URL:\r\n-\t\t\t\t\tif (isset($_POST[$key])) {\r\n-\t\t\t\t\t\t$icmsObj->setVar($key, filter_var($_POST[$key], FILTER_SANITIZE_URL));\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\tbreak;\r\n-\r\n-\t\t\t\tcase XOBJ_DTYPE_ARRAY:\r\n-\t\t\t\t\tif (is_array($_POST[$key])) {\r\n-\t\t\t\t\t\t$icmsObj->setVar($key, serialize($_POST[$key]));\r\n-\t\t\t\t\t}\r\n-\t\t\t\t\tbreak;\r\n-\r\n-\t\t\t\tdefault:\r\n-\t\t\t\t\t$icmsObj->setVar($key, $_POST[$key]);\r\n-\t\t\t\t\tbreak;\r\n-\t\t\t}\r\n-\t\t}\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tobj\t\t$icmsObj\tObject\r\n-\t * @param\tint\t\t$objectid\r\n-\t * @param\tstr\t\t$created_success_msg\tMessage to display on successful creation\r\n-\t * @param\tstr\t\t$modified_success_msg\tMessage to display on successful modification\r\n-\t * @param\tbool\t$redirect_page\t\t\tWhether to redirect afterwards, or not\r\n-\t * @param\tbool\t$debug\t\t\t\t\tWhether to display debug information, or not\r\n-\t *\/\r\n-\tpublic function &doStoreFromDefaultForm(&$icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false) {\r\n-\t\tglobal $impresscms;\r\n-\t\t$this->postDataToObject($icmsObj);\r\n-\r\n-\t\tif ($icmsObj->isNew()) {\r\n-\t\t\t$redirect_msg = $created_success_msg;\r\n-\t\t} else {\r\n-\t\t\t$redirect_msg = $modified_success_msg;\r\n-\t\t}\r\n-\r\n-\t\t\/\/ Check if there were uploaded files\r\n-\t\t$uploaderResult = true;\r\n-\t\tif (isset($_POST['icms_upload_image']) || isset($_POST['icms_upload_file'])) {\r\n-\t\t\t$uploaderObj = new icms_file_MediaUploadHandler($icmsObj->getImageDir(true), $this->handler->_allowedMimeTypes, $this->handler->_maxFileSize, $this->handler->_maxWidth, $this->handler->_maxHeight);\r\n-\t\t\tforeach ( $_FILES as $name=>$file_array) {\r\n-\t\t\t\tif (isset ($file_array['name']) && $file_array['name'] != \"\" && in_array(str_replace('upload_', '', $name), array_keys($icmsObj->vars))) {\r\n-\t\t\t\t\tif ($uploaderObj->fetchMedia($name)) {\r\n-\t\t\t\t\t\t$uploaderObj->setTargetFileName(time() . \"_\" . $uploaderObj->getMediaName());\r\n-\t\t\t\t\t\tif ($uploaderObj->upload()) {\r\n-\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && true;\r\n-\t\t\t\t\t\t\t\/\/ Find the related field in the icms_ipf_Object\r\n-\t\t\t\t\t\t\t$related_field = str_replace('upload_', '', $name);\r\n-\t\t\t\t\t\t\t$uploadedArray[] = $related_field;\r\n-\t\t\t\t\t\t\t\/\/ if it's a richfile\r\n-\t\t\t\t\t\t\tif ($icmsObj->vars[$related_field]['data_type'] == XOBJ_DTYPE_FILE) {\r\n-\t\t\t\t\t\t\t\t$object_fileurl = $icmsObj->getUploadDir();\r\n-\t\t\t\t\t\t\t\t$fileObj = $icmsObj->getFileObj($related_field);\r\n-\t\t\t\t\t\t\t\t$fileObj->setVar('url', $object_fileurl . $uploaderObj->getSavedFileName());\r\n-\t\t\t\t\t\t\t\t$fileObj->setVar('mid', $_POST['mid_' . $related_field]);\r\n-\t\t\t\t\t\t\t\t$fileObj->setVar('caption', $_POST['caption_' . $related_field]);\r\n-\t\t\t\t\t\t\t\t$fileObj->setVar('description', $_POST['desc_' . $related_field]);\r\n-\t\t\t\t\t\t\t\t$icmsObj->storeFileObj($fileObj);\r\n-\t\t\t\t\t\t\t\t$icmsObj->setVar($related_field, $fileObj->getVar('fileid'));\r\n-\t\t\t\t\t\t\t} else {\r\n-\t\t\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('beforeFileUnlink', $icmsObj);\r\n-\t\t\t\t\t\t\t\tif (!$eventResult) {\r\n-\t\t\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\r\n-\t\t\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\r\n-\t\t\t\t\t\t\t\t}\r\n-\r\n-\t\t\t\t\t\t\t\t$old_file = $icmsObj->getUploadDir(true) . $icmsObj->getVar($related_field);\r\n-\t\t\t\t\t\t\t\tif (is_file($old_file) ) unlink($old_file);\r\n-\t\t\t\t\t\t\t\t$icmsObj->setVar($related_field, $uploaderObj->getSavedFileName());\r\n-\r\n-\t\t\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('afterFileUnlink', $icmsObj);\r\n-\t\t\t\t\t\t\t\tif (!$eventResult) {\r\n-\t\t\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\r\n-\t\t\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\r\n-\t\t\t\t\t\t\t\t}\r\n-\t\t\t\t\t\t\t}\r\n-\t\t\t\t\t\t} else {\r\n-\t\t\t\t\t\t\t$icmsObj->setErrors($uploaderObj->getErrors(false));\r\n-\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\r\n-\t\t\t\t\t\t}\r\n-\t\t\t\t\t} else {\r\n-\t\t\t\t\t\t$icmsObj->setErrors($uploaderObj->getErrors(false));\r\n-\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\r\n-\t\t\t\t\t}\r\n-\t\t\t\t}\r\n-\r\n-\t\t\t}\r\n-\t\t}\r\n-\r\n-\t\tif ($uploaderResult) {\r\n-\t\t\tif ($debug) {\r\n-\t\t\t\t$storeResult = $this->handler->insertD($icmsObj);\r\n-\t\t\t} else {\r\n-\t\t\t\t$storeResult = $this->handler->insert($icmsObj);\r\n-\t\t\t}\r\n-\t\t} else {\r\n-\t\t\t$storeResult = false;\r\n-\t\t}\r\n-\r\n-\t\tif ($storeResult) {\r\n-\t\t\tif ($this->handler->getPermissions()) {\r\n-\t\t\t\t$icmspermissions_handler = new icms_ipf_permission_Handler($this->handler);\r\n-\t\t\t\t$icmspermissions_handler->storeAllPermissionsForId($icmsObj->id());\r\n-\t\t\t}\r\n-\t\t}\r\n-\r\n-\t\tif ($redirect_page === null) {\r\n-\t\t\treturn $icmsObj;\r\n-\t\t} else {\r\n-\t\t\tif (!$storeResult) {\r\n-\t\t\t\tredirect_header($impresscms->urls['previouspage'], 3, _CO_ICMS_SAVE_ERROR . $icmsObj->getHtmlErrors());\r\n-\t\t\t} else {\r\n-\t\t\t\t$redirect_page = $redirect_page ? $redirect_page : icms_get_page_before_form();\r\n-\t\t\t\tredirect_header($redirect_page, 2, $redirect_msg);\r\n-\t\t\t}\r\n-\t\t}\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * Store the object in the database autmatically from a form sending POST data\r\n-\t *\r\n-\t * @param string $created_success_msg message to display if new object was created\r\n-\t * @param string $modified_success_msg message to display if object was successfully edited\r\n-\t * @param string $created_redir_page redirect page after creating the object\r\n-\t * @param string $modified_redir_page redirect page after editing the object\r\n-\t * @param string $redirect_page redirect page, if not set, then we backup once\r\n-\t * @param bool $exit if set to TRUE then the script ends\r\n-\t * @return bool\r\n-\t *\/\r\n-\tpublic function &storeFromDefaultForm($created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false, $x_param = false) {\r\n-\t\t$objectid = ( isset($_POST[$this->handler->keyName]) )\r\n-\t\t\t\t? (int) $_POST[$this->handler->keyName]\r\n-\t\t\t\t: 0;\r\n-\t\tif ($debug) {\r\n-\t\t\tif ($x_param) {\r\n-\t\t\t\t$icmsObj = $this->handler->getD($objectid, true,  $x_param);\r\n-\t\t\t} else {\r\n-\t\t\t\t$icmsObj = $this->handler->getD($objectid);\r\n-\t\t\t}\r\n-\r\n-\t\t} else {\r\n-\t\t\tif ($x_param) {\r\n-\t\t\t\t$icmsObj = $this->handler->get($objectid, true, false, false, $x_param);\r\n-\t\t\t} else {\r\n-\t\t\t\t$icmsObj = $this->handler->get($objectid);\r\n-\t\t\t}\r\n-\t\t}\r\n-\r\n-\t\t\/**\r\n-\t\t * @todo multilanguage persistable handler is not fully implemented yet\r\n-\t\t *\/\r\n-\r\n-\t\t\/\/ if handler is the Multilanguage handler, we will need to treat this for multilanguage\r\n-\t\tif (is_subclass_of($this->handler, 'icmspersistablemlobjecthandler')) {\r\n-\r\n-\t\t\tif ($icmsObj->isNew()) {\r\n-\t\t\t\t\/\/ This is a new object. We need to store the meta data and then the language data\r\n-\t\t\t\t\/\/ First, we will get rid of the multilanguage data to only store the meta data\r\n-\t\t\t\t$icmsObj->stripMultilanguageFields();\r\n-\t\t\t\t$newObject =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\r\n-\t\t\t\t\/**\r\n-\t\t\t\t * @todo we need to trap potential errors here\r\n-\t\t\t\t *\/\r\n-\r\n-\t\t\t\t\/\/ ok, the meta daa is stored. Let's recreate the object and then\r\n-\t\t\t\t\/\/ get rid of anything not multilanguage\r\n-\t\t\t\tunset($icmsObj);\r\n-\t\t\t\t$icmsObj = $this->handler->get($objectid);\r\n-\t\t\t\t$icmsObj->stripNonMultilanguageFields();\r\n-\r\n-\t\t\t\t$icmsObj->setVar($this->handler->keyName, $newObject->getVar($this->handler->keyName));\r\n-\t\t\t\t$this->handler->changeTableNameForML();\r\n-\t\t\t\t$ret =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\r\n-\r\n-\t\t\t\treturn $ret;\r\n-\t\t\t}\r\n-\t\t} else {\r\n-\t\t\treturn $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\r\n-\t\t}\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * Stores an object and shows debug information\r\n-\t *\/\r\n-\tpublic function &storeicms_ipf_ObjectD() {\r\n-\t\treturn $this->storeicms_ipf_Object(true);\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tbool\t$debug\r\n-\t * @param\tbool\t$xparam\r\n-\t * @see\t\tstoreFromDefaultForm\r\n-\t *\/\r\n-\tpublic function &storeicms_ipf_Object($debug=false, $xparam = false) {\r\n-\t\t$ret =& $this->storeFromDefaultForm('', '', null, $debug, $xparam);\r\n-\r\n-\t\treturn $ret;\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * Handles deletion of an object which keyid is passed as a GET param\r\n-\t *\r\n-\t * @param string $redir_page redirect page after deleting the object\r\n-\t * @return bool\r\n-\t *\/\r\n-\tpublic function handleObjectDeletion($confirm_msg = false, $op='del', $userSide=false) {\r\n-\t\tglobal $impresscms;\r\n-\r\n-\t\t$objectid = (isset($_REQUEST[$this->handler->keyName])) ? (int) $_REQUEST[$this->handler->keyName] : 0;\r\n-\t\t$icmsObj = $this->handler->get($objectid);\r\n-\r\n-\t\tif ($icmsObj->isNew()) {\r\n-\t\t\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\r\n-\t\t\texit();\r\n-\t\t}\r\n-\r\n-\t\t$confirm = ( isset($_POST['confirm']) ) ? $_POST['confirm'] : 0;\r\n-\t\tif ($confirm) {\r\n-\t\t\tif (!$this->handler->delete($icmsObj)) {\r\n-\t\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\r\n-\t\t\t\texit;\r\n-\t\t\t}\r\n-\r\n-\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_SUCCESS);\r\n-\t\t\texit();\r\n-\t\t} else {\r\n-\t\t\t\/\/ no confirm: show deletion condition\r\n-\r\n-\t\t\ticms_cp_header();\r\n-\r\n-\t\t\tif (!$confirm_msg) {\r\n-\t\t\t\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\r\n-\t\t\t}\r\n-\r\n-\t\t\t$hiddens = array(\r\n-\t\t\t\t\t\t'op' => $op,\r\n-\t\t\t\t\t\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\r\n-\t\t\t\t\t\t'confirm' => 1,\r\n-\t\t\t\t\t\t'redirect_page' => $impresscms->urls['previouspage']\r\n-\t\t\t);\r\n-\t\t\tif ($this->handler->_moduleName == 'system') {\r\n-\t\t\t\t$hiddens['fct'] = isset($_GET['fct']) ? $_GET['fct'] : false;\r\n-\t\t\t}\r\n-\t\t\ticms_core_Message::confirm($hiddens, xoops_getenv('SCRIPT_NAME'), sprintf($confirm_msg , $icmsObj->getVar($this->handler->identifierName)), _CO_ICMS_DELETE);\r\n-\r\n-\t\t\ticms_cp_footer();\r\n-\r\n-\t\t}\r\n-\t\texit();\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tbool\t$confirm_msg\r\n-\t * @param\tstring\t$op\r\n-\t *\/\r\n-\tpublic function handleObjectDeletionFromUserSide($confirm_msg = false, $op='del') {\r\n-\t\tglobal $icmsTpl, $impresscms;\r\n-\r\n-\t\t$objectid = ( isset($_REQUEST[$this->handler->keyName]) ) ? (int) ($_REQUEST[$this->handler->keyName]) : 0;\r\n-\t\t$icmsObj = $this->handler->get($objectid);\r\n-\r\n-\t\tif ($icmsObj->isNew()) {\r\n-\t\t\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\r\n-\t\t\texit();\r\n-\t\t}\r\n-\r\n-\t\t$confirm = ( isset($_POST['confirm']) ) ? $_POST['confirm'] : 0;\r\n-\t\tif ($confirm) {\r\n-\t\t\tif (!$this->handler->delete($icmsObj)) {\r\n-\t\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\r\n-\t\t\t\texit;\r\n-\t\t\t}\r\n-\r\n-\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_SUCCESS);\r\n-\t\t\texit();\r\n-\t\t} else {\r\n-\t\t\t\/\/ no confirm: show deletion condition\r\n-\t\t\tif (!$confirm_msg) {\r\n-\t\t\t\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\r\n-\t\t\t}\r\n-\r\n-\t\t\tob_start();\r\n-\t\t\ticms_core_Message::confirm(array(\r\n-\t\t\t\t'op' => $op,\r\n-\t\t\t\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\r\n-\t\t\t\t'confirm' => 1,\r\n-\t\t\t\t'redirect_page' => $impresscms->urls['previouspage']),\r\n-\t\t\t\txoops_getenv('SCRIPT_NAME'),\r\n-\t\t\t\tsprintf($confirm_msg ,\r\n-\t\t\t\t$icmsObj->getVar($this->handler->identifierName)),\r\n-\t\t\t\t_CO_ICMS_DELETE\r\n-\t\t\t);\r\n-\t\t\t$icmspersistable_delete_confirm = ob_get_clean();\r\n-\t\t\t$icmsTpl->assign('icmspersistable_delete_confirm', $icmspersistable_delete_confirm);\r\n-\t\t}\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * Retrieve the object admin side link for a {@link icms_ipf_view_Single} page\r\n-\t *\r\n-\t * @param\tobject\t$icmsObj\treference to the object from which we want the user side link\r\n-\t * @param\tbool\t$onlyUrl\twhether or not to return a simple URL or a full <a> link\r\n-\t * @param\tbool\t$withimage\treturn a linked image instead of linked text\r\n-\t * @return\tstring\tadmin side link to the object\r\n-\t *\/\r\n-\tpublic function getAdminViewItemLink($icmsObj, $onlyUrl=false, $withimage=false) {\r\n-\t\t$ret = $this->handler->_moduleUrl . \"admin\/\"\r\n-\t\t\t. $this->handler->_page . \"?op=view&amp;\"\r\n-\t\t\t. $this->handler->keyName . \"=\"\r\n-\t\t\t. $icmsObj->getVar($this->handler->keyName);\r\n-\t\tif ($onlyUrl) {\r\n-\t\t\treturn $ret;\r\n-\t\t} elseif ($withimage) {\r\n-\t\t\treturn \"<a href='\" . $ret . \"'>\r\n-\t\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL\r\n-\t\t\t\t\t. \"\/actions\/viewmag.png' style='vertical-align: middle;' alt='\"\r\n-\t\t\t\t\t. _CO_ICMS_ADMIN_VIEW . \"'  title='\"\r\n-\t\t\t\t\t. _CO_ICMS_ADMIN_VIEW . \"'\/><\/a>\";\r\n-\t\t}\r\n-\r\n-\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * Retrieve the object user side link\r\n-\t *\r\n-\t * @param object $icmsObj reference to the object from which we want the user side link\r\n-\t * @param bool $onlyUrl wether or not to return a simple URL or a full <a> link\r\n-\t * @return string user side link to the object\r\n-\t *\/\r\n-\tpublic function getItemLink(&$icmsObj, $onlyUrl=false) {\r\n-\t\t\/**\r\n-\t\t * @todo URL Rewrite feature is not finished yet...\r\n-\t\t *\/\r\n-\t\t\/\/$seoMode = smart_getModuleModeSEO($this->handler->_moduleName);\r\n-\t\t\/\/$seoModuleName = smart_getModuleNameForSEO($this->handler->_moduleName);\r\n-\t\t$seoMode = false;\r\n-\t\t$seoModuleName = $this->handler->_moduleName;\r\n-\r\n-\t\t\/**\r\n-\t\t * $seoIncludeId feature is not finished yet, so let's put it always to true\r\n-\t\t *\/\r\n-\t\t\/\/$seoIncludeId = smart_getModuleIncludeIdSEO($this->handler->_moduleName);\r\n-\t\t$seoIncludeId = true;\r\n-\r\n-\t\t\/*if ($seoMode == 'rewrite') {\r\n-\t\t\t$ret = ICMS_URL . '\/' . $seoModuleName . '.' . $this->handler->_itemname . ($seoIncludeId ? '.'\t. $icmsObj->getVar($this->handler->keyName) : ''). '\/' . $icmsObj->getVar('short_url') . '.html';\r\n-\t\t\t} else if ($seoMode == 'pathinfo') {\r\n-\t\t\t$ret = SMARTOBJECT_URL . 'seo.php\/' . $seoModuleName . '.' . $this->handler->_itemname . ($seoIncludeId ? '.'\t. $icmsObj->getVar($this->handler->keyName) : ''). '\/' . $icmsObj->getVar('short_url') . '.html';\r\n-\t\t\t} else {\r\n-\t\t\t*\/\t$ret = $this->handler->_moduleUrl . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t\/\/}\r\n-\r\n-\t\tif (!$onlyUrl) {\r\n-\t\t\t$ret = \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\r\n-\t\t}\r\n-\t\treturn $ret;\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * This method returns a view link of the Object\r\n-\t *\r\n-\t * @param icms_ipf_Object $icmsObj\r\n-\t * @param boolean $onlyUrl\r\n-\t * @param boolean $withimage\r\n-\t * @param boolean $userSide\r\n-\t * @return string\r\n-\t *\/\r\n-\tpublic function getViewItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\r\n-\t\tif ($this->handler->_moduleName != 'system') {\r\n-\t\t\t$admin_side = $userSide ? '' : 'admin\/';\r\n-\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t} else {\r\n-\t\t\t$admin_side = '';\r\n-\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . 'admin.php?fct='\r\n-\t\t\t\t. $this->handler->_itemname . \"&amp;op=view&amp;\"\r\n-\t\t\t\t. $this->handler->keyName . \"=\"\r\n-\t\t\t\t. $icmsObj->getVar($this->handler->keyName);\r\n-\t\t}\r\n-\t\tif ($onlyUrl) {\r\n-\t\t\treturn $ret;\r\n-\t\t} elseif ($withimage) {\r\n-\t\t\treturn \"<a href='\" . $ret . \"'>\r\n-\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/viewmag.png' style='vertical-align: middle;' alt='\"\r\n-\t\t\t\t. _PREVIEW . \"'  title='\" . _PREVIEW . \"'\/><\/a>\";\r\n-\t\t}\r\n-\r\n-\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tobject\t$icmsObj\r\n-\t * @param\tbool\t$onlyUrl\r\n-\t * @param\tbool\t$withimage\r\n-\t *\/\r\n-\tpublic function getEditLanguageLink($icmsObj, $onlyUrl=false, $withimage=true) {\r\n-\t\t$ret = $this->handler->_moduleUrl . \"admin\/\"\r\n-\t\t\t. $this->handler->_page\r\n-\t\t\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName)\r\n-\t\t\t. \"&amp;language=\" . $icmsObj->getVar('language');\r\n-\t\tif ($onlyUrl) {\r\n-\t\t\treturn $ret;\r\n-\t\t} elseif ($withimage) {\r\n-\t\t\treturn \"<a href='\" . $ret . \"'>\r\n-\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/wizard.png' style='vertical-align: middle;' alt='\"\r\n-\t\t\t\t. _CO_ICMS_LANGUAGE_MODIFY . \"'  title='\" . _CO_ICMS_LANGUAGE_MODIFY . \"'\/><\/a>\";\r\n-\t\t}\r\n-\r\n-\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tobj\t\t$icmsObj\r\n-\t * @param\tbool\t$onlyUrl\r\n-\t * @param\tbool\t$withimage\r\n-\t * @param\tbool\t$userSide\r\n-\t *\/\r\n-\tpublic function getEditItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\r\n-\t\tif ($this->handler->_moduleName != 'system') {\r\n-\t\t\t$admin_side = $userSide ? '' : 'admin\/';\r\n-\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\r\n-\t\t\t\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t} else {\r\n-\t\t\t\/**\r\n-\t\t\t * @todo: to be implemented...\r\n-\t\t\t *\/\r\n-\t\t\t\/\/$admin_side = $userSide ? '' : 'admin\/';\r\n-\t\t\t$admin_side = '';\r\n-\t\t\t$ret = $this->handler->_moduleUrl . $admin_side\r\n-\t\t\t\t. 'admin.php?fct=' . $this->handler->_itemname\r\n-\t\t\t\t. \"&amp;op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t}\r\n-\t\tif ($onlyUrl) {\r\n-\t\t\treturn $ret;\r\n-\t\t} elseif ($withimage) {\r\n-\t\t\treturn \"<a href='\" . $ret . \"'>\r\n-\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/edit.png' style='vertical-align: middle;' alt='\"\r\n-\t\t\t\t. _CO_ICMS_MODIFY . \"'  title='\" . _CO_ICMS_MODIFY . \"'\/><\/a>\";\r\n-\t\t}\r\n-\r\n-\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tobj\t\t$icmsObj\r\n-\t * @param\tbool\t$onlyUrl\r\n-\t * @param\tbool\t$withimage\r\n-\t * @param\tbool\t$userSide\r\n-\t *\/\r\n-\tpublic function getDeleteItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\r\n-\t\tif ($this->handler->_moduleName != 'system') {\r\n-\t\t\t$admin_side = $userSide ? '' : 'admin\/';\r\n-\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\r\n-\t\t\t\t. \"?op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t} else {\r\n-\t\t\t\/**\r\n-\t\t\t * @todo: to be implemented...\r\n-\t\t\t *\/\r\n-\t\t\t\/\/$admin_side = $userSide ? '' : 'admin\/';\r\n-\t\t\t$admin_side = '';\r\n-\t\t\t$ret = $this->handler->_moduleUrl . $admin_side\r\n-\t\t\t\t. 'admin.php?fct=' . $this->handler->_itemname\r\n-\t\t\t\t. \"&amp;op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t}\r\n-\t\tif ($onlyUrl) {\r\n-\t\t\treturn $ret;\r\n-\t\t} elseif ($withimage) {\r\n-\t\t\treturn \"<a href='\" . $ret . \"'>\r\n-\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/editdelete.png' style='vertical-align: middle;' alt='\"\r\n-\t\t\t\t. _CO_ICMS_DELETE . \"'  title='\" . _CO_ICMS_DELETE . \"'\/><\/a>\";\r\n-\t\t}\r\n-\r\n-\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t *\r\n-\t * @param\tobj\t\t$icmsObj\r\n-\t * @todo\tNeeds to be completed\r\n-\t *\/\r\n-\tpublic function getPrintAndMailLink($icmsObj) {\r\n-\t\tglobal $icmsConfig, $impresscms;\r\n-\r\n-\t\t$ret = '';\r\n-\t\t\/*\t\t$printlink = $this->handler->_moduleUrl . \"print.php?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\r\n-\t\t $js = \"javascript:openWithSelfMain('\" . $printlink . \"', 'smartpopup', 700, 519);\";\r\n-\t\t $printlink = '<a href=\"' . $js . '\"><img  src=\"' . ICMS_IMAGES_SET_URL . '\/actions\/fileprint.png\" alt=\"\" style=\"vertical-align: middle;\"\/><\/a>';\r\n-\r\n-\t\t $icmsModule = icms_getModuleInfo($icmsObj->handler->_moduleName);\r\n-\t\t $link = $impresscms->urls['full']();\r\n-\t\t $mid = $icmsModule->getVar('mid');\r\n-\t\t $friendlink = \"<a href=\\\"javascript:openWithSelfMain('\".SMARTOBJECT_URL.\"sendlink.php?link=\" . $link . \"&amp;mid=\" . $mid . \"', ',',',',',','sendmessage', 674, 500);\\\"><img src=\\\"\".SMARTOBJECT_IMAGES_ACTIONS_URL . \"mail_send.png\\\"  alt=\\\"\" . _CO_ICMS_EMAIL . \"\\\" title=\\\"\" . _CO_ICMS_EMAIL . \"\\\" style=\\\"vertical-align: middle;\\\"\/><\/a>\";\r\n-\r\n-\t\t $ret = '<span id=\"smartobject_print_button\">' . $printlink . \"&nbsp;<\/span>\" . '<span id=\"smartobject_mail_button\">' . $friendlink . '<\/span>';\r\n-\t\t *\/\r\n-\t\treturn $ret;\r\n-\t}\r\n-\r\n-\t\/**\r\n-\t * Creates a string from the object's module name and item name\r\n-\t *\/\r\n-\tpublic function getModuleItemString() {\r\n-\t\t$ret = $this->handler->_moduleName . '_' . $this->handler->_itemname;\r\n-\t\treturn $ret;\r\n-\t}\r\n-}\r\n-\r\n+<?php\n+\n+\/**\n+ * This class is responsible for providing operations to an object for managing the object's manipulation\n+ *\n+ * @copyright\tThe ImpressCMS Project http:\/\/www.impresscms.org\/\n+ * @license\t\thttp:\/\/www.gnu.org\/licenses\/old-licenses\/gpl-2.0.html GNU General Public License (GPL)\n+ * @category\tICMS\n+ * @package\t\tIpf\n+ * @subpackage\tController\n+ * @since\t\t1.1\n+ * @author\t\tOriginal idea by Jan Keller Pedersen <mithrandir@xoops.org> - IDG Danmark A\/S <www.idg.dk>\n+ * @author\t\tmarcan <marcan@impresscms.org>\n+ * @version\t\tSVN: $Id: Controller.php 11972 2012-08-26 17:49:13Z skenow $\n+ * @todo\t\tUse language constants for messages\n+ *\/\n+\n+defined('ICMS_ROOT_PATH') or die(\"ImpressCMS root path not defined\");\n+\n+\/**\n+ *\n+ *\n+ * @category\tICMS\n+ * @package\t\tIpf\n+ * @subpackage\tController\n+ *\n+ *\/\n+class icms_ipf_Controller {\n+\n+\t\/** *\/\n+\tpublic $handler;\n+\n+\t\/**\n+\t *\n+\t * @param $handler\n+\t *\/\n+\tpublic function __construct($handler) {\n+\t\t$this->handler=$handler;\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tobj\t\t$icmsObj\n+\t *\/\n+\tpublic function postDataToObject(&$icmsObj) {\n+\t\tforeach (array_keys($icmsObj->vars) as $key) {\n+\t\t\t\/\/ do not post data if control is a label\n+\t\t\t$control = $icmsObj->getControl($key);\n+\t\t\tif (is_array($control) && isset($control['name']) && $control['name'] == \"label\") continue;\n+\n+\t\t\tswitch ($icmsObj->vars[$key]['data_type']) {\n+\t\t\t\tcase XOBJ_DTYPE_IMAGE:\n+\t\t\t\t\tif (isset($_POST['url_' . $key]) && $_POST['url_' . $key] !='') {\n+\t\t\t\t\t\t$_POST['url_' . $key] = preg_replace('|[\\.]+\\\/|', '.\/', $_POST['url_' . $key]);\n+\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('beforeFileUnlink', $icmsObj);\n+\t\t\t\t\t\tif (!$eventResult) {\n+\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, 'e');\n+\t\t\t\t\t\t$icmsObj->setVar($key, $_POST['url_' . $key]);\n+\t\t\t\t\t\tif (is_file($oldFile) ) unlink($oldFile);\n+\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('afterFileUnlink', $icmsObj);\n+\t\t\t\t\t\tif (!$eventResult) {\n+\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\t\t\t\t\tif (isset($_POST['delete_' . $key]) && $_POST['delete_' . $key] == '1') {\n+\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('beforeFileUnlink', $icmsObj);\n+\t\t\t\t\t\tif (!$eventResult) {\n+\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\n+\t\t\t\t\t\t}\n+\t\t\t\t\t\t$oldFile = $icmsObj->getUploadDir(true) . $icmsObj->getVar($key, 'e');\n+\t\t\t\t\t\t$icmsObj->setVar($key, '');\n+\t\t\t\t\t\tif (is_file($oldFile) ) unlink($oldFile);\n+\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('afterFileUnlink', $icmsObj);\n+\t\t\t\t\t\tif (!$eventResult) {\n+\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tcase XOBJ_DTYPE_URLLINK:\n+\t\t\t\t\t$linkObj = $icmsObj->getUrlLinkObj($key);\n+\t\t\t\t\t$linkObj->setVar('mid', $_POST['mid_' . $key]);\n+\t\t\t\t\t$linkObj->setVar('caption', $_POST['caption_' . $key]);\n+\t\t\t\t\t$linkObj->setVar('description', $_POST['desc_' . $key]);\n+\t\t\t\t\t$linkObj->setVar('target', $_POST['target_' . $key]);\n+\t\t\t\t\t$linkObj->setVar('url', $_POST['url_' . $key]);\n+\t\t\t\t\tif ($linkObj->getVar('url') != '') {\n+\t\t\t\t\t\t$icmsObj->storeUrlLinkObj($linkObj);\n+\t\t\t\t\t}\n+\t\t\t\t\t\/\/@todo: catch errors\n+\t\t\t\t\t$icmsObj->setVar($key, $linkObj->getVar('urllinkid'));\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tcase XOBJ_DTYPE_FILE:\n+\t\t\t\t\tif (!isset($_FILES['upload_' . $key]['name']) || $_FILES['upload_' . $key]['name'] == '') {\n+\t\t\t\t\t\t$fileObj = $icmsObj->getFileObj($key);\n+\t\t\t\t\t\t$fileObj->setVar('mid', $_POST['mid_' . $key]);\n+\t\t\t\t\t\t$fileObj->setVar('caption', $_POST['caption_' . $key]);\n+\t\t\t\t\t\t$fileObj->setVar('description', $_POST['desc_' . $key]);\n+\t\t\t\t\t\t$fileObj->setVar('url', preg_replace('|[\\.]+\\\/|', '.\/', $_POST['url_' . $key]));\n+\t\t\t\t\t\tif (!($fileObj->getVar('url') == '' && $fileObj->getVar('url') == '' && $fileObj->getVar('url') == '')) {\n+\t\t\t\t\t\t\t$res = $icmsObj->storeFileObj($fileObj);\n+\t\t\t\t\t\t\tif ($res) {\n+\t\t\t\t\t\t\t\t$icmsObj->setVar($key, $fileObj->getVar('fileid'));\n+\t\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\t\t\/\/error setted, but no error message (to be improved)\n+\t\t\t\t\t\t\t\t$icmsObj->setErrors($fileObj->getErrors());\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t}\n+\t\t\t\t\t}\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tcase XOBJ_DTYPE_STIME:\n+\t\t\t\tcase XOBJ_DTYPE_MTIME:\n+\t\t\t\tcase XOBJ_DTYPE_LTIME:\n+\t\t\t\t\t\/\/ check if this field's value is available in the POST array\n+\t\t\t\t\tif (is_array($_POST[$key]) && isset($_POST[$key]['date'])) {\n+\t\t\t\t\t\t$value = strtotime($_POST[$key]['date']) + $_POST[$key]['time'];\n+\t\t\t\t\t\/\/ in case the field is hidden, it's not formated so we can simply take the value and store it\n+\t\t\t\t\t} elseif (filter_var($_POST[$key], FILTER_VALIDATE_INT) == $_POST[$key]) {\n+\t\t\t\t\t\t$value = (int)$_POST[$key];\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\t$value = strtotime($_POST[$key]);\n+\t\t\t\t\t}\n+\t\t\t\t\t$icmsObj->setVar($key, $value);\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tcase XOBJ_DTYPE_URL:\n+\t\t\t\t\tif (isset($_POST[$key])) {\n+\t\t\t\t\t\t$icmsObj->setVar($key, filter_var($_POST[$key], FILTER_SANITIZE_URL));\n+\t\t\t\t\t}\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tcase XOBJ_DTYPE_ARRAY:\n+\t\t\t\t\tif (is_array($_POST[$key])) {\n+\t\t\t\t\t\t$icmsObj->setVar($key, serialize($_POST[$key]));\n+\t\t\t\t\t}\n+\t\t\t\t\tbreak;\n+\n+\t\t\t\tdefault:\n+\t\t\t\t\t$icmsObj->setVar($key, $_POST[$key]);\n+\t\t\t\t\tbreak;\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tobj\t\t$icmsObj\tObject\n+\t * @param\tint\t\t$objectid\n+\t * @param\tstr\t\t$created_success_msg\tMessage to display on successful creation\n+\t * @param\tstr\t\t$modified_success_msg\tMessage to display on successful modification\n+\t * @param\tbool\t$redirect_page\t\t\tWhether to redirect afterwards, or not\n+\t * @param\tbool\t$debug\t\t\t\t\tWhether to display debug information, or not\n+\t *\/\n+\tpublic function &doStoreFromDefaultForm(&$icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false) {\n+\t\tglobal $impresscms;\n+\t\t$this->postDataToObject($icmsObj);\n+\n+\t\tif ($icmsObj->isNew()) {\n+\t\t\t$redirect_msg = $created_success_msg;\n+\t\t} else {\n+\t\t\t$redirect_msg = $modified_success_msg;\n+\t\t}\n+\n+\t\t\/\/ Check if there were uploaded files\n+\t\t$uploaderResult = true;\n+\t\tif (isset($_POST['icms_upload_image']) || isset($_POST['icms_upload_file'])) {\n+\t\t\t$uploaderObj = new icms_file_MediaUploadHandler($icmsObj->getImageDir(true), $this->handler->_allowedMimeTypes, $this->handler->_maxFileSize, $this->handler->_maxWidth, $this->handler->_maxHeight);\n+\t\t\tforeach ( $_FILES as $name=>$file_array) {\n+\t\t\t\tif (isset ($file_array['name']) && $file_array['name'] != \"\" && in_array(str_replace('upload_', '', $name), array_keys($icmsObj->vars))) {\n+\t\t\t\t\tif ($uploaderObj->fetchMedia($name)) {\n+\t\t\t\t\t\t$uploaderObj->setTargetFileName(time() . \"_\" . $uploaderObj->getMediaName());\n+\t\t\t\t\t\tif ($uploaderObj->upload()) {\n+\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && true;\n+\t\t\t\t\t\t\t\/\/ Find the related field in the icms_ipf_Object\n+\t\t\t\t\t\t\t$related_field = str_replace('upload_', '', $name);\n+\t\t\t\t\t\t\t$uploadedArray[] = $related_field;\n+\t\t\t\t\t\t\t\/\/ if it's a richfile\n+\t\t\t\t\t\t\tif ($icmsObj->vars[$related_field]['data_type'] == XOBJ_DTYPE_FILE) {\n+\t\t\t\t\t\t\t\t$object_fileurl = $icmsObj->getUploadDir();\n+\t\t\t\t\t\t\t\t$fileObj = $icmsObj->getFileObj($related_field);\n+\t\t\t\t\t\t\t\t$fileObj->setVar('url', $object_fileurl . $uploaderObj->getSavedFileName());\n+\t\t\t\t\t\t\t\t$fileObj->setVar('mid', $_POST['mid_' . $related_field]);\n+\t\t\t\t\t\t\t\t$fileObj->setVar('caption', $_POST['caption_' . $related_field]);\n+\t\t\t\t\t\t\t\t$fileObj->setVar('description', $_POST['desc_' . $related_field]);\n+\t\t\t\t\t\t\t\t$icmsObj->storeFileObj($fileObj);\n+\t\t\t\t\t\t\t\t$icmsObj->setVar($related_field, $fileObj->getVar('fileid'));\n+\t\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('beforeFileUnlink', $icmsObj);\n+\t\t\t\t\t\t\t\tif (!$eventResult) {\n+\t\t\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the beforeFileUnlink event\");\n+\t\t\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\n+\t\t\t\t\t\t\t\t}\n+\n+\t\t\t\t\t\t\t\t$old_file = $icmsObj->getUploadDir(true) . $icmsObj->getVar($related_field);\n+\t\t\t\t\t\t\t\tif (is_file($old_file) ) unlink($old_file);\n+\t\t\t\t\t\t\t\t$icmsObj->setVar($related_field, $uploaderObj->getSavedFileName());\n+\n+\t\t\t\t\t\t\t\t$eventResult = $this->handler->executeEvent('afterFileUnlink', $icmsObj);\n+\t\t\t\t\t\t\t\tif (!$eventResult) {\n+\t\t\t\t\t\t\t\t\t$icmsObj->setErrors(\"An error occured during the afterFileUnlink event\");\n+\t\t\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\n+\t\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t\t}\n+\t\t\t\t\t\t} else {\n+\t\t\t\t\t\t\t$icmsObj->setErrors($uploaderObj->getErrors(false));\n+\t\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\n+\t\t\t\t\t\t}\n+\t\t\t\t\t} else {\n+\t\t\t\t\t\t$icmsObj->setErrors($uploaderObj->getErrors(false));\n+\t\t\t\t\t\t$uploaderResult = $uploaderResult && false;\n+\t\t\t\t\t}\n+\t\t\t\t}\n+\n+\t\t\t}\n+\t\t}\n+\n+\t\tif ($uploaderResult) {\n+\t\t\tif ($debug) {\n+\t\t\t\t$storeResult = $this->handler->insertD($icmsObj);\n+\t\t\t} else {\n+\t\t\t\t$storeResult = $this->handler->insert($icmsObj);\n+\t\t\t}\n+\t\t} else {\n+\t\t\t$storeResult = false;\n+\t\t}\n+\n+\t\tif ($storeResult) {\n+\t\t\tif ($this->handler->getPermissions()) {\n+\t\t\t\t$icmspermissions_handler = new icms_ipf_permission_Handler($this->handler);\n+\t\t\t\t$icmspermissions_handler->storeAllPermissionsForId($icmsObj->id());\n+\t\t\t}\n+\t\t}\n+\n+\t\tif ($redirect_page === null) {\n+\t\t\treturn $icmsObj;\n+\t\t} else {\n+\t\t\tif (!$storeResult) {\n+\t\t\t\tredirect_header($impresscms->urls['previouspage'], 3, _CO_ICMS_SAVE_ERROR . $icmsObj->getHtmlErrors());\n+\t\t\t} else {\n+\t\t\t\t$redirect_page = $redirect_page ? $redirect_page : icms_get_page_before_form();\n+\t\t\t\tredirect_header($redirect_page, 2, $redirect_msg);\n+\t\t\t}\n+\t\t}\n+\t}\n+\n+\t\/**\n+\t * Store the object in the database autmatically from a form sending POST data\n+\t *\n+\t * @param string $created_success_msg message to display if new object was created\n+\t * @param string $modified_success_msg message to display if object was successfully edited\n+\t * @param string $created_redir_page redirect page after creating the object\n+\t * @param string $modified_redir_page redirect page after editing the object\n+\t * @param string $redirect_page redirect page, if not set, then we backup once\n+\t * @param bool $exit if set to TRUE then the script ends\n+\t * @return bool\n+\t *\/\n+\tpublic function &storeFromDefaultForm($created_success_msg, $modified_success_msg, $redirect_page=false, $debug=false, $x_param = false) {\n+\t\t$objectid = ( isset($_POST[$this->handler->keyName]) )\n+\t\t\t\t? (int) $_POST[$this->handler->keyName]\n+\t\t\t\t: 0;\n+\t\tif ($debug) {\n+\t\t\tif ($x_param) {\n+\t\t\t\t$icmsObj = $this->handler->getD($objectid, true,  $x_param);\n+\t\t\t} else {\n+\t\t\t\t$icmsObj = $this->handler->getD($objectid);\n+\t\t\t}\n+\n+\t\t} else {\n+\t\t\tif ($x_param) {\n+\t\t\t\t$icmsObj = $this->handler->get($objectid, true, false, false, $x_param);\n+\t\t\t} else {\n+\t\t\t\t$icmsObj = $this->handler->get($objectid);\n+\t\t\t}\n+\t\t}\n+\n+\t\t\/**\n+\t\t * @todo multilanguage persistable handler is not fully implemented yet\n+\t\t *\/\n+\n+\t\t\/\/ if handler is the Multilanguage handler, we will need to treat this for multilanguage\n+\t\tif (is_subclass_of($this->handler, 'icmspersistablemlobjecthandler')) {\n+\n+\t\t\tif ($icmsObj->isNew()) {\n+\t\t\t\t\/\/ This is a new object. We need to store the meta data and then the language data\n+\t\t\t\t\/\/ First, we will get rid of the multilanguage data to only store the meta data\n+\t\t\t\t$icmsObj->stripMultilanguageFields();\n+\t\t\t\t$newObject =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\n+\t\t\t\t\/**\n+\t\t\t\t * @todo we need to trap potential errors here\n+\t\t\t\t *\/\n+\n+\t\t\t\t\/\/ ok, the meta daa is stored. Let's recreate the object and then\n+\t\t\t\t\/\/ get rid of anything not multilanguage\n+\t\t\t\tunset($icmsObj);\n+\t\t\t\t$icmsObj = $this->handler->get($objectid);\n+\t\t\t\t$icmsObj->stripNonMultilanguageFields();\n+\n+\t\t\t\t$icmsObj->setVar($this->handler->keyName, $newObject->getVar($this->handler->keyName));\n+\t\t\t\t$this->handler->changeTableNameForML();\n+\t\t\t\t$ret =& $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\n+\n+\t\t\t\treturn $ret;\n+\t\t\t}\n+\t\t} else {\n+\t\t\treturn $this->doStoreFromDefaultForm($icmsObj, $objectid, $created_success_msg, $modified_success_msg, $redirect_page, $debug);\n+\t\t}\n+\t}\n+\n+\t\/**\n+\t * Stores an object and shows debug information\n+\t *\/\n+\tpublic function &storeicms_ipf_ObjectD() {\n+\t\treturn $this->storeicms_ipf_Object(true);\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tbool\t$debug\n+\t * @param\tbool\t$xparam\n+\t * @see\t\tstoreFromDefaultForm\n+\t *\/\n+\tpublic function &storeicms_ipf_Object($debug=false, $xparam = false) {\n+\t\t$ret =& $this->storeFromDefaultForm('', '', null, $debug, $xparam);\n+\n+\t\treturn $ret;\n+\t}\n+\n+\t\/**\n+\t * Handles deletion of an object which keyid is passed as a GET param\n+\t *\n+\t * @param string $redir_page redirect page after deleting the object\n+\t * @return bool\n+\t *\/\n+\tpublic function handleObjectDeletion($confirm_msg = false, $op='del', $userSide=false) {\n+\t\tglobal $impresscms;\n+\n+\t\t$objectid = (isset($_REQUEST[$this->handler->keyName])) ? (int) $_REQUEST[$this->handler->keyName] : 0;\n+\t\t$icmsObj = $this->handler->get($objectid);\n+\n+\t\tif ($icmsObj->isNew()) {\n+\t\t\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\n+\t\t\texit();\n+\t\t}\n+\n+\t\t$confirm = ( isset($_POST['confirm']) ) ? $_POST['confirm'] : 0;\n+\t\tif ($confirm) {\n+\t\t\tif (!$this->handler->delete($icmsObj)) {\n+\t\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\n+\t\t\t\texit;\n+\t\t\t}\n+\n+\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_SUCCESS);\n+\t\t\texit();\n+\t\t} else {\n+\t\t\t\/\/ no confirm: show deletion condition\n+\n+\t\t\ticms_cp_header();\n+\n+\t\t\tif (!$confirm_msg) {\n+\t\t\t\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\n+\t\t\t}\n+\n+\t\t\t$hiddens = array(\n+\t\t\t\t\t\t'op' => $op,\n+\t\t\t\t\t\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\n+\t\t\t\t\t\t'confirm' => 1,\n+\t\t\t\t\t\t'redirect_page' => $impresscms->urls['previouspage']\n+\t\t\t);\n+\t\t\tif ($this->handler->_moduleName == 'system') {\n+\t\t\t\t$hiddens['fct'] = isset($_GET['fct']) ? $_GET['fct'] : false;\n+\t\t\t}\n+\t\t\ticms_core_Message::confirm($hiddens, xoops_getenv('SCRIPT_NAME'), sprintf($confirm_msg , $icmsObj->getVar($this->handler->identifierName)), _CO_ICMS_DELETE);\n+\n+\t\t\ticms_cp_footer();\n+\n+\t\t}\n+\t\texit();\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tbool\t$confirm_msg\n+\t * @param\tstring\t$op\n+\t *\/\n+\tpublic function handleObjectDeletionFromUserSide($confirm_msg = false, $op='del') {\n+\t\tglobal $icmsTpl, $impresscms;\n+\n+\t\t$objectid = ( isset($_REQUEST[$this->handler->keyName]) ) ? (int) ($_REQUEST[$this->handler->keyName]) : 0;\n+\t\t$icmsObj = $this->handler->get($objectid);\n+\n+\t\tif ($icmsObj->isNew()) {\n+\t\t\tredirect_header(\"javascript:history.go(-1)\", 3, _CO_ICMS_NOT_SELECTED);\n+\t\t\texit();\n+\t\t}\n+\n+\t\t$confirm = ( isset($_POST['confirm']) ) ? $_POST['confirm'] : 0;\n+\t\tif ($confirm) {\n+\t\t\tif (!$this->handler->delete($icmsObj)) {\n+\t\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_ERROR . $icmsObj->getHtmlErrors());\n+\t\t\t\texit;\n+\t\t\t}\n+\n+\t\t\tredirect_header($_POST['redirect_page'], 3, _CO_ICMS_DELETE_SUCCESS);\n+\t\t\texit();\n+\t\t} else {\n+\t\t\t\/\/ no confirm: show deletion condition\n+\t\t\tif (!$confirm_msg) {\n+\t\t\t\t$confirm_msg = _CO_ICMS_DELETE_CONFIRM;\n+\t\t\t}\n+\n+\t\t\tob_start();\n+\t\t\ticms_core_Message::confirm(array(\n+\t\t\t\t'op' => $op,\n+\t\t\t\t$this->handler->keyName => $icmsObj->getVar($this->handler->keyName),\n+\t\t\t\t'confirm' => 1,\n+\t\t\t\t'redirect_page' => $impresscms->urls['previouspage']),\n+\t\t\t\txoops_getenv('SCRIPT_NAME'),\n+\t\t\t\tsprintf($confirm_msg ,\n+\t\t\t\t$icmsObj->getVar($this->handler->identifierName)),\n+\t\t\t\t_CO_ICMS_DELETE\n+\t\t\t);\n+\t\t\t$icmspersistable_delete_confirm = ob_get_clean();\n+\t\t\t$icmsTpl->assign('icmspersistable_delete_confirm', $icmspersistable_delete_confirm);\n+\t\t}\n+\t}\n+\n+\t\/**\n+\t * Retrieve the object admin side link for a {@link icms_ipf_view_Single} page\n+\t *\n+\t * @param\tobject\t$icmsObj\treference to the object from which we want the user side link\n+\t * @param\tbool\t$onlyUrl\twhether or not to return a simple URL or a full <a> link\n+\t * @param\tbool\t$withimage\treturn a linked image instead of linked text\n+\t * @return\tstring\tadmin side link to the object\n+\t *\/\n+\tpublic function getAdminViewItemLink($icmsObj, $onlyUrl=false, $withimage=false) {\n+\t\t$ret = $this->handler->_moduleUrl . \"admin\/\"\n+\t\t\t. $this->handler->_page . \"?op=view&amp;\"\n+\t\t\t. $this->handler->keyName . \"=\"\n+\t\t\t. $icmsObj->getVar($this->handler->keyName);\n+\t\tif ($onlyUrl) {\n+\t\t\treturn $ret;\n+\t\t} elseif ($withimage) {\n+\t\t\treturn \"<a href='\" . $ret . \"'>\n+\t\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL\n+\t\t\t\t\t. \"\/actions\/viewmag.png' style='vertical-align: middle;' alt='\"\n+\t\t\t\t\t. _CO_ICMS_ADMIN_VIEW . \"'  title='\"\n+\t\t\t\t\t. _CO_ICMS_ADMIN_VIEW . \"'\/><\/a>\";\n+\t\t}\n+\n+\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\n+\t}\n+\n+\t\/**\n+\t * Retrieve the object user side link\n+\t *\n+\t * @param object $icmsObj reference to the object from which we want the user side link\n+\t * @param bool $onlyUrl wether or not to return a simple URL or a full <a> link\n+\t * @return string user side link to the object\n+\t *\/\n+\tpublic function getItemLink(&$icmsObj, $onlyUrl=false) {\n+\t\t\/**\n+\t\t * @todo URL Rewrite feature is not finished yet...\n+\t\t *\/\n+\t\t\/\/$seoMode = smart_getModuleModeSEO($this->handler->_moduleName);\n+\t\t\/\/$seoModuleName = smart_getModuleNameForSEO($this->handler->_moduleName);\n+\t\t$seoMode = false;\n+\t\t$seoModuleName = $this->handler->_moduleName;\n+\n+\t\t\/**\n+\t\t * $seoIncludeId feature is not finished yet, so let's put it always to true\n+\t\t *\/\n+\t\t\/\/$seoIncludeId = smart_getModuleIncludeIdSEO($this->handler->_moduleName);\n+\t\t$seoIncludeId = true;\n+\n+\t\t\/*if ($seoMode == 'rewrite') {\n+\t\t\t$ret = ICMS_URL . '\/' . $seoModuleName . '.' . $this->handler->_itemname . ($seoIncludeId ? '.'\t. $icmsObj->getVar($this->handler->keyName) : ''). '\/' . $icmsObj->getVar('short_url') . '.html';\n+\t\t\t} else if ($seoMode == 'pathinfo') {\n+\t\t\t$ret = SMARTOBJECT_URL . 'seo.php\/' . $seoModuleName . '.' . $this->handler->_itemname . ($seoIncludeId ? '.'\t. $icmsObj->getVar($this->handler->keyName) : ''). '\/' . $icmsObj->getVar('short_url') . '.html';\n+\t\t\t} else {\n+\t\t\t*\/\t$ret = $this->handler->_moduleUrl . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t\/\/}\n+\n+\t\tif (!$onlyUrl) {\n+\t\t\t$ret = \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\n+\t\t}\n+\t\treturn $ret;\n+\t}\n+\n+\t\/**\n+\t * This method returns a view link of the Object\n+\t *\n+\t * @param icms_ipf_Object $icmsObj\n+\t * @param boolean $onlyUrl\n+\t * @param boolean $withimage\n+\t * @param boolean $userSide\n+\t * @return string\n+\t *\/\n+\tpublic function getViewItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\n+\t\tif ($this->handler->_moduleName != 'system') {\n+\t\t\t$admin_side = $userSide ? '' : 'admin\/';\n+\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page . \"?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t} else {\n+\t\t\t$admin_side = '';\n+\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . 'admin.php?fct='\n+\t\t\t\t. $this->handler->_itemname . \"&amp;op=view&amp;\"\n+\t\t\t\t. $this->handler->keyName . \"=\"\n+\t\t\t\t. $icmsObj->getVar($this->handler->keyName);\n+\t\t}\n+\t\tif ($onlyUrl) {\n+\t\t\treturn $ret;\n+\t\t} elseif ($withimage) {\n+\t\t\treturn \"<a href='\" . $ret . \"'>\n+\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/viewmag.png' style='vertical-align: middle;' alt='\"\n+\t\t\t\t. _PREVIEW . \"'  title='\" . _PREVIEW . \"'\/><\/a>\";\n+\t\t}\n+\n+\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tobject\t$icmsObj\n+\t * @param\tbool\t$onlyUrl\n+\t * @param\tbool\t$withimage\n+\t *\/\n+\tpublic function getEditLanguageLink($icmsObj, $onlyUrl=false, $withimage=true) {\n+\t\t$ret = $this->handler->_moduleUrl . \"admin\/\"\n+\t\t\t. $this->handler->_page\n+\t\t\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName)\n+\t\t\t. \"&amp;language=\" . $icmsObj->getVar('language');\n+\t\tif ($onlyUrl) {\n+\t\t\treturn $ret;\n+\t\t} elseif ($withimage) {\n+\t\t\treturn \"<a href='\" . $ret . \"'>\n+\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/wizard.png' style='vertical-align: middle;' alt='\"\n+\t\t\t\t. _CO_ICMS_LANGUAGE_MODIFY . \"'  title='\" . _CO_ICMS_LANGUAGE_MODIFY . \"'\/><\/a>\";\n+\t\t}\n+\n+\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tobj\t\t$icmsObj\n+\t * @param\tbool\t$onlyUrl\n+\t * @param\tbool\t$withimage\n+\t * @param\tbool\t$userSide\n+\t *\/\n+\tpublic function getEditItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\n+\t\tif ($this->handler->_moduleName != 'system') {\n+\t\t\t$admin_side = $userSide ? '' : 'admin\/';\n+\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\n+\t\t\t\t. \"?op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t} else {\n+\t\t\t\/**\n+\t\t\t * @todo: to be implemented...\n+\t\t\t *\/\n+\t\t\t\/\/$admin_side = $userSide ? '' : 'admin\/';\n+\t\t\t$admin_side = '';\n+\t\t\t$ret = $this->handler->_moduleUrl . $admin_side\n+\t\t\t\t. 'admin.php?fct=' . $this->handler->_itemname\n+\t\t\t\t. \"&amp;op=mod&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t}\n+\t\tif ($onlyUrl) {\n+\t\t\treturn $ret;\n+\t\t} elseif ($withimage) {\n+\t\t\treturn \"<a href='\" . $ret . \"'>\n+\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/edit.png' style='vertical-align: middle;' alt='\"\n+\t\t\t\t. _CO_ICMS_MODIFY . \"'  title='\" . _CO_ICMS_MODIFY . \"'\/><\/a>\";\n+\t\t}\n+\n+\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tobj\t\t$icmsObj\n+\t * @param\tbool\t$onlyUrl\n+\t * @param\tbool\t$withimage\n+\t * @param\tbool\t$userSide\n+\t *\/\n+\tpublic function getDeleteItemLink($icmsObj, $onlyUrl=false, $withimage=true, $userSide=false) {\n+\t\tif ($this->handler->_moduleName != 'system') {\n+\t\t\t$admin_side = $userSide ? '' : 'admin\/';\n+\t\t\t$ret = $this->handler->_moduleUrl . $admin_side . $this->handler->_page\n+\t\t\t\t. \"?op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t} else {\n+\t\t\t\/**\n+\t\t\t * @todo: to be implemented...\n+\t\t\t *\/\n+\t\t\t\/\/$admin_side = $userSide ? '' : 'admin\/';\n+\t\t\t$admin_side = '';\n+\t\t\t$ret = $this->handler->_moduleUrl . $admin_side\n+\t\t\t\t. 'admin.php?fct=' . $this->handler->_itemname\n+\t\t\t\t. \"&amp;op=del&amp;\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t}\n+\t\tif ($onlyUrl) {\n+\t\t\treturn $ret;\n+\t\t} elseif ($withimage) {\n+\t\t\treturn \"<a href='\" . $ret . \"'>\n+\t\t\t\t<img src='\" . ICMS_IMAGES_SET_URL . \"\/actions\/editdelete.png' style='vertical-align: middle;' alt='\"\n+\t\t\t\t. _CO_ICMS_DELETE . \"'  title='\" . _CO_ICMS_DELETE . \"'\/><\/a>\";\n+\t\t}\n+\n+\t\treturn \"<a href='\" . $ret . \"'>\" . $icmsObj->getVar($this->handler->identifierName) . \"<\/a>\";\n+\t}\n+\n+\t\/**\n+\t *\n+\t * @param\tobj\t\t$icmsObj\n+\t * @todo\tNeeds to be completed\n+\t *\/\n+\tpublic function getPrintAndMailLink($icmsObj) {\n+\t\tglobal $icmsConfig, $impresscms;\n+\n+\t\t$ret = '';\n+\t\t\/*\t\t$printlink = $this->handler->_moduleUrl . \"print.php?\" . $this->handler->keyName . \"=\" . $icmsObj->getVar($this->handler->keyName);\n+\t\t $js = \"javascript:openWithSelfMain('\" . $printlink . \"', 'smartpopup', 700, 519);\";\n+\t\t $printlink = '<a href=\"' . $js . '\"><img  src=\"' . ICMS_IMAGES_SET_URL . '\/actions\/fileprint.png\" alt=\"\" style=\"vertical-align: middle;\"\/><\/a>';\n+\n+\t\t $icmsModule = icms_getModuleInfo($icmsObj->handler->_moduleName);\n+\t\t $link = $impresscms->urls['full']();\n+\t\t $mid = $icmsModule->getVar('mid');\n+\t\t $friendlink = \"<a href=\\\"javascript:openWithSelfMain('\".SMARTOBJECT_URL.\"sendlink.php?link=\" . $link . \"&amp;mid=\" . $mid . \"', ',',',',',','sendmessage', 674, 500);\\\"><img src=\\\"\".SMARTOBJECT_IMAGES_ACTIONS_URL . \"mail_send.png\\\"  alt=\\\"\" . _CO_ICMS_EMAIL . \"\\\" title=\\\"\" . _CO_ICMS_EMAIL . \"\\\" style=\\\"vertical-align: middle;\\\"\/><\/a>\";\n+\n+\t\t $ret = '<span id=\"smartobject_print_button\">' . $printlink . \"&nbsp;<\/span>\" . '<span id=\"smartobject_mail_button\">' . $friendlink . '<\/span>';\n+\t\t *\/\n+\t\treturn $ret;\n+\t}\n+\n+\t\/**\n+\t * Creates a string from the object's module name and item name\n+\t *\/\n+\tpublic function getModuleItemString() {\n+\t\t$ret = $this->handler->_moduleName . '_' . $this->handler->_itemname;\n+\t\treturn $ret;\n+\t}\n+}\n+"
        },
        {
            "index":738,
            "vuln_id":"GHSA-wjh9-344g-vc49",
            "cwe_id":"{'CWE-79'}",
            "score":5.4,
            "chain":"{'https:\/\/github.com\/francoisjacquet\/rosariosis\/commit\/6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8'}",
            "dataset":"osv",
            "summary":"Cross-site Scripting in RosarioSIS Cross-site Scripting (XSS) - Stored in GitHub repository francoisjacquet\/rosariosis prior to 9.0.",
            "published_date":"2022-06-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/francoisjacquet\/rosariosis",
            "commit_href":"https:\/\/github.com\/francoisjacquet\/rosariosis\/commit\/6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8",
            "commit_sha":"6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8",
            "patch":"SINGLE",
            "chain_ord":"['6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8']",
            "before_first_fix_commit":"{'25eb3196e26df31917dfef87aa9f66f78c1646ea'}",
            "last_fix_commit":"6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8",
            "chain_ord_pos":1.0,
            "commit_datetime":"06\/04\/2022, 11:44:21",
            "message":"Fix stored XSS security issue: remove inline JS from URL in PreparePHP_SELF.fnc.php",
            "author":"Fran\u00e7ois Jacquet",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'functions\/PreparePHP_SELF.fnc.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/francoisjacquet\/rosariosis\/raw\/6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8\/functions%2FPreparePHP_SELF.fnc.php', 'patch': \"@@ -200,7 +200,7 @@ function( $match ) {\\n \\n \\tforeach ( $remove as $remove_string )\\n \\t{\\n-\\t\\twhile ( strpos( $string, $remove_string ) !== false )\\n+\\t\\twhile ( stripos( $string, $remove_string ) !== false )\\n \\t\\t{\\n \\t\\t\\t$string = str_ireplace( $remove, '', $string );\\n \\t\\t}\"}}",
            "message_norm":"fix stored xss security issue: remove inline js from url in preparephp_self.fnc.php",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('security', 'SECWORD', ''), ('issue', 'FLAW', ''), ('remove', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['functions\/PreparePHP_SELF.fnc.php'])",
            "num_files":1.0,
            "patch_content":"From 6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Fran=C3=A7ois=20Jacquet?=\n <francoisjacquet@users.noreply.github.com>\nDate: Sat, 4 Jun 2022 13:44:21 +0200\nSubject: [PATCH] Fix stored XSS security issue: remove inline JS from URL in\n PreparePHP_SELF.fnc.php\n\n---\n functions\/PreparePHP_SELF.fnc.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/functions\/PreparePHP_SELF.fnc.php b\/functions\/PreparePHP_SELF.fnc.php\nindex 80da4699a..f7dfe677b 100644\n--- a\/functions\/PreparePHP_SELF.fnc.php\n+++ b\/functions\/PreparePHP_SELF.fnc.php\n@@ -200,7 +200,7 @@ function( $match ) {\n \n \tforeach ( $remove as $remove_string )\n \t{\n-\t\twhile ( strpos( $string, $remove_string ) !== false )\n+\t\twhile ( stripos( $string, $remove_string ) !== false )\n \t\t{\n \t\t\t$string = str_ireplace( $remove, '', $string );\n \t\t}"
        },
        {
            "index":103,
            "vuln_id":"GHSA-gx5w-rrhp-f436",
            "cwe_id":"{'CWE-79'}",
            "score":8.2,
            "chain":"{'https:\/\/github.com\/rust-lang\/mdBook\/commit\/32abeef088e98327ca0dfccdad92e84afa9d2e9b'}",
            "dataset":"osv",
            "summary":"XSS in mdBook > This is a cross-post of [the official security advisory][ml]. The official post contains a signed version with our PGP key, as well.\n\n[ml]: https:\/\/groups.google.com\/g\/rustlang-security-announcements\/c\/3-sO6of29O0\n\nThe Rust Security Response Working Group was recently notified of a security issue affecting the search feature of mdBook, which could allow an attacker to execute arbitrary JavaScript code on the page.\n\nThe CVE for this vulnerability is [CVE-2020-26297](https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2020-26297).\n\n## Overview\n\nThe search feature of mdBook (introduced in version 0.1.4) was affected by a cross site scripting vulnerability that allowed an attacker to execute arbitrary JavaScript code on an user's browser by tricking the user into typing a malicious search query, or tricking the user into clicking a link to the search page with the malicious search query prefilled.\n\nmdBook 0.4.5 fixes the vulnerability by properly escaping the search query.\n\n## Mitigations\n\nOwners of websites built with mdBook have to upgrade to mdBook 0.4.5 or greater and rebuild their website contents with it. It's possible to install mdBook 0.4.5 on the local system with:\n\n```\ncargo install mdbook --version 0.4.5 --force\n```\n\n## Acknowledgements\n\nThanks to Kamil Vavra for responsibly disclosing the vulnerability to us according to [our security policy](https:\/\/www.rust-lang.org\/policies\/security).\n\n## Timeline of events\n\nAll times are listed in UTC.\n\n- 2020-12-30 20:14 - The issue is reported to the Rust Security Response WG\n- 2020-12-30 20:32 - The issue is acknowledged and the investigation began\n- 2020-12-30 21:21 - Found the cause of the vulnerability and prepared the patch\n- 2021-01-04 15:00 - Patched version released and vulnerability disclosed",
            "published_date":"2021-08-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/rust-lang\/mdBook",
            "commit_href":"https:\/\/github.com\/rust-lang\/mdBook\/commit\/32abeef088e98327ca0dfccdad92e84afa9d2e9b",
            "commit_sha":"32abeef088e98327ca0dfccdad92e84afa9d2e9b",
            "patch":"SINGLE",
            "chain_ord":"['32abeef088e98327ca0dfccdad92e84afa9d2e9b']",
            "before_first_fix_commit":"{'5de9b6841ed03c8149eeec3c8a5fcd40b5d4dbe0'}",
            "last_fix_commit":"32abeef088e98327ca0dfccdad92e84afa9d2e9b",
            "chain_ord_pos":1.0,
            "commit_datetime":"12\/30\/2020, 21:13:15",
            "message":"fix xss in the search page\n\nThanks to Kamil Vavra for responsibly disclosing the vulnerability\naccording to Rust's Security Policy.",
            "author":"Pietro Albini",
            "comments":null,
            "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
            "files":"{'src\/theme\/searcher\/searcher.js': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/rust-lang\/mdBook\/raw\/32abeef088e98327ca0dfccdad92e84afa9d2e9b\/src%2Ftheme%2Fsearcher%2Fsearcher.js', 'patch': '@@ -145,6 +145,11 @@ window.search = window.search || {};\\n             url.push(\"\");\\n         }\\n \\n+        \/\/ encodeURIComponent escapes all chars that could allow an XSS except\\n+        \/\/ for \\'. Due to that we also manually replace \\' with its url-encoded\\n+        \/\/ representation (%27).\\n+        var searchterms = encodeURIComponent(searchterms.join(\" \")).replace(\/\\\\\\'\/g, \"%27\");\\n+\\n         return \\'<a href=\"\\' + path_to_root + url[0] + \\'?\\' + URL_MARK_PARAM + \\'=\\' + searchterms + \\'#\\' + url[1]\\n             + \\'\" aria-details=\"teaser_\\' + teaser_count + \\'\">\\' + result.doc.breadcrumbs + \\'<\/a>\\'\\n             + \\'<span class=\"teaser\" id=\"teaser_\\' + teaser_count + \\'\" aria-label=\"Search Result Teaser\">\\''}}",
            "message_norm":"fix xss in the search page\n\nthanks to kamil vavra for responsibly disclosing the vulnerability\naccording to rust's security policy.",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', ''), ('security', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/theme\/searcher\/searcher.js'])",
            "num_files":1.0,
            "patch_content":"From 32abeef088e98327ca0dfccdad92e84afa9d2e9b Mon Sep 17 00:00:00 2001\nFrom: Pietro Albini <pietro@pietroalbini.org>\nDate: Wed, 30 Dec 2020 22:13:15 +0100\nSubject: [PATCH] fix xss in the search page\n\nThanks to Kamil Vavra for responsibly disclosing the vulnerability\naccording to Rust's Security Policy.\n---\n src\/theme\/searcher\/searcher.js | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/src\/theme\/searcher\/searcher.js b\/src\/theme\/searcher\/searcher.js\nindex e1cc806b8e..acf3d50cbc 100644\n--- a\/src\/theme\/searcher\/searcher.js\n+++ b\/src\/theme\/searcher\/searcher.js\n@@ -145,6 +145,11 @@ window.search = window.search || {};\n             url.push(\"\");\n         }\n \n+        \/\/ encodeURIComponent escapes all chars that could allow an XSS except\n+        \/\/ for '. Due to that we also manually replace ' with its url-encoded\n+        \/\/ representation (%27).\n+        var searchterms = encodeURIComponent(searchterms.join(\" \")).replace(\/\\'\/g, \"%27\");\n+\n         return '<a href=\"' + path_to_root + url[0] + '?' + URL_MARK_PARAM + '=' + searchterms + '#' + url[1]\n             + '\" aria-details=\"teaser_' + teaser_count + '\">' + result.doc.breadcrumbs + '<\/a>'\n             + '<span class=\"teaser\" id=\"teaser_' + teaser_count + '\" aria-label=\"Search Result Teaser\">'"
        },
        {
            "index":608,
            "vuln_id":"GHSA-6m26-25q2-cq46",
            "cwe_id":"{'CWE-79'}",
            "score":4.8,
            "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/c897d0dc159849763a813184d9b75b966c6360bf'}",
            "dataset":"osv",
            "summary":"Cross-site Scripting in microweber Microweber Cross-site Scripting (XSS) - Stored XSS vulnerability on admin page up to version 1.3.",
            "published_date":"2022-02-27",
            "chain_len":1,
            "project":"https:\/\/github.com\/microweber\/microweber",
            "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/c897d0dc159849763a813184d9b75b966c6360bf",
            "commit_sha":"c897d0dc159849763a813184d9b75b966c6360bf",
            "patch":"SINGLE",
            "chain_ord":"['c897d0dc159849763a813184d9b75b966c6360bf']",
            "before_first_fix_commit":"{'7d3e768be798979e82778c47fbabfbd944ec8ea7'}",
            "last_fix_commit":"c897d0dc159849763a813184d9b75b966c6360bf",
            "chain_ord_pos":1.0,
            "commit_datetime":"02\/25\/2022, 09:57:42",
            "message":"add xss clean to create media dir method",
            "author":"Bozhidar Slaveykov",
            "comments":null,
            "stats":"{'additions': 6, 'deletions': 1, 'total': 7}",
            "files":"{'src\/MicroweberPackages\/Media\/MediaManager.php': {'additions': 6, 'deletions': 1, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/c897d0dc159849763a813184d9b75b966c6360bf\/src%2FMicroweberPackages%2FMedia%2FMediaManager.php', 'patch': \"@@ -4,6 +4,7 @@\\n \\n use Conner\\\\Tagging\\\\Model\\\\Tagged;\\n use \\\\Intervention\\\\Image\\\\ImageManagerStatic as Image;\\n+use MicroweberPackages\\\\Helper\\\\HTMLClean;\\n use MicroweberPackages\\\\Media\\\\Models\\\\Media;\\n use MicroweberPackages\\\\Media\\\\Models\\\\MediaThumbnail;\\n use MicroweberPackages\\\\Utils\\\\Media\\\\Thumbnailer;\\n@@ -1184,6 +1185,10 @@ public function thumbnail_img($params)\\n \\n     public function create_media_dir($params)\\n     {\\n+\\n+        $clean = new HTMLClean();\\n+        $_REQUEST = $clean->cleanArray($_REQUEST);\\n+\\n         must_have_access();\\n         $resp = array();\\n         \/\/ $target_path = media_base_path() . 'uploaded' . DS;\\n@@ -1198,7 +1203,7 @@ public function create_media_dir($params)\\n \\n             $target_path = $fn_path;\\n         }\\n-        if (!isset($_REQUEST['name'])) {\\n+        if (!isset($_REQUEST['name']) || empty($_REQUEST['name'])) {\\n             $resp = array('error' => 'You must send new_folder parameter');\\n         } else {\\n             $fn_new_folder_path = $_REQUEST['name'];\"}}",
            "message_norm":"add xss clean to create media dir method",
            "language":"en",
            "entities":"[('add', 'ACTION', ''), ('xss', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/MicroweberPackages\/Media\/MediaManager.php'])",
            "num_files":1.0,
            "patch_content":"From c897d0dc159849763a813184d9b75b966c6360bf Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Fri, 25 Feb 2022 11:57:42 +0200\nSubject: [PATCH] add xss clean to create media dir method\n\n---\n src\/MicroweberPackages\/Media\/MediaManager.php | 7 ++++++-\n 1 file changed, 6 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/MicroweberPackages\/Media\/MediaManager.php b\/src\/MicroweberPackages\/Media\/MediaManager.php\nindex 1ed03ac0085..eca46fa89bb 100644\n--- a\/src\/MicroweberPackages\/Media\/MediaManager.php\n+++ b\/src\/MicroweberPackages\/Media\/MediaManager.php\n@@ -4,6 +4,7 @@\n \n use Conner\\Tagging\\Model\\Tagged;\n use \\Intervention\\Image\\ImageManagerStatic as Image;\n+use MicroweberPackages\\Helper\\HTMLClean;\n use MicroweberPackages\\Media\\Models\\Media;\n use MicroweberPackages\\Media\\Models\\MediaThumbnail;\n use MicroweberPackages\\Utils\\Media\\Thumbnailer;\n@@ -1184,6 +1185,10 @@ public function thumbnail_img($params)\n \n     public function create_media_dir($params)\n     {\n+\n+        $clean = new HTMLClean();\n+        $_REQUEST = $clean->cleanArray($_REQUEST);\n+\n         must_have_access();\n         $resp = array();\n         \/\/ $target_path = media_base_path() . 'uploaded' . DS;\n@@ -1198,7 +1203,7 @@ public function create_media_dir($params)\n \n             $target_path = $fn_path;\n         }\n-        if (!isset($_REQUEST['name'])) {\n+        if (!isset($_REQUEST['name']) || empty($_REQUEST['name'])) {\n             $resp = array('error' => 'You must send new_folder parameter');\n         } else {\n             $fn_new_folder_path = $_REQUEST['name'];"
        },
        {
            "index":941,
            "vuln_id":"GHSA-hm37-9xh2-q499",
            "cwe_id":"{'CWE-209'}",
            "score":7.7,
            "chain":"{'https:\/\/github.com\/scottcwang\/openssh_key_parser\/commit\/d5b53b4b7e76c5b666fc657019dbf864fb04076c', 'https:\/\/github.com\/scottcwang\/openssh_key_parser\/commit\/26e0a471e9fdb23e635bc3014cf4cbd2323a08d3', 'https:\/\/github.com\/scottcwang\/openssh_key_parser\/commit\/274447f91b4037b7050ae634879b657554523b39'}",
            "dataset":"osv",
            "summary":"Possible leak of key's raw field if declared length is incorrect ### Impact\nIf a field of a key is shorter than it is declared to be, the parser raises an error with a message containing the raw field value. An attacker able to modify the declared length of a key's sensitive field can thus expose the raw value of that field.\n\n### Patches\nUpgrade to version 0.0.6, which no longer includes the raw field value in the error message.\n\n### Workarounds\nN\/A\n\n### References\nN\/A\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [openssh_key_parser](https:\/\/github.com\/scottcwang\/openssh_key_parser)",
            "published_date":"2022-07-06",
            "chain_len":3,
            "project":"https:\/\/github.com\/scottcwang\/openssh_key_parser",
            "commit_href":"https:\/\/github.com\/scottcwang\/openssh_key_parser\/commit\/26e0a471e9fdb23e635bc3014cf4cbd2323a08d3",
            "commit_sha":"26e0a471e9fdb23e635bc3014cf4cbd2323a08d3",
            "patch":"MULTI",
            "chain_ord":"['26e0a471e9fdb23e635bc3014cf4cbd2323a08d3', 'd5b53b4b7e76c5b666fc657019dbf864fb04076c', '274447f91b4037b7050ae634879b657554523b39']",
            "before_first_fix_commit":"{'ae4d131d1cd8fe06325bfd6b749305aca60873bf', '69fe5b7addc21d3f39626ae93c6961811aea9d4c'}",
            "last_fix_commit":"274447f91b4037b7050ae634879b657554523b39",
            "chain_ord_pos":1.0,
            "commit_datetime":"06\/22\/2022, 14:49:37",
            "message":"Changed an exception message to prevent possible disclosures of keying material.",
            "author":"Michael Doyle",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
            "files":"{'openssh_key\/pascal_style_byte_stream.py': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/scottcwang\/openssh_key_parser\/raw\/26e0a471e9fdb23e635bc3014cf4cbd2323a08d3\/openssh_key%2Fpascal_style_byte_stream.py', 'patch': '@@ -236,7 +236,8 @@ def read_fixed_bytes(self, num_bytes: int) -> bytes:\\n         \"\"\"\\n         read_bytes = self.read(num_bytes)\\n         if len(read_bytes) < num_bytes:\\n-            raise EOFError(read_bytes)\\n+            raise EOFError(\"Fewer than \\'num_bytes\\' bytes remaining in the \"\\n+                    \"underlying bytestream\")\\n         return read_bytes\\n \\n     def read_pascal_bytes(self, string_length_size: int) -> bytes:'}}",
            "message_norm":"changed an exception message to prevent possible disclosures of keying material.",
            "language":"en",
            "entities":"[('changed', 'ACTION', ''), ('prevent', 'ACTION', ''), ('keying', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['openssh_key\/pascal_style_byte_stream.py'])",
            "num_files":1.0,
            "patch_content":"From 26e0a471e9fdb23e635bc3014cf4cbd2323a08d3 Mon Sep 17 00:00:00 2001\nFrom: Michael Doyle <mike@arnica.io>\nDate: Wed, 22 Jun 2022 10:49:37 -0400\nSubject: [PATCH] Changed an exception message to prevent possible disclosures\n of keying material.\n\n---\n openssh_key\/pascal_style_byte_stream.py | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/openssh_key\/pascal_style_byte_stream.py b\/openssh_key\/pascal_style_byte_stream.py\nindex e6d4003..f8fefa6 100644\n--- a\/openssh_key\/pascal_style_byte_stream.py\n+++ b\/openssh_key\/pascal_style_byte_stream.py\n@@ -236,7 +236,8 @@ def read_fixed_bytes(self, num_bytes: int) -> bytes:\n         \"\"\"\n         read_bytes = self.read(num_bytes)\n         if len(read_bytes) < num_bytes:\n-            raise EOFError(read_bytes)\n+            raise EOFError(\"Fewer than 'num_bytes' bytes remaining in the \"\n+                    \"underlying bytestream\")\n         return read_bytes\n \n     def read_pascal_bytes(self, string_length_size: int) -> bytes:"
        },
        {
            "index":629,
            "vuln_id":"GHSA-g452-6rfc-vrvx",
            "cwe_id":"{'CWE-915'}",
            "score":5.3,
            "chain":"{'https:\/\/github.com\/samholmes\/node-open-graph\/commit\/a0cef507a90adaac7dbbe9c404f09a50bdefb348'}",
            "dataset":"osv",
            "summary":"Prototype Pollution in open-graph This affects the package open-graph before 0.2.6. The function parse could be tricked into adding or modifying properties of Object.prototype using a __proto__ or constructor payload.",
            "published_date":"2021-09-01",
            "chain_len":1,
            "project":"https:\/\/github.com\/samholmes\/node-open-graph",
            "commit_href":"https:\/\/github.com\/samholmes\/node-open-graph\/commit\/a0cef507a90adaac7dbbe9c404f09a50bdefb348",
            "commit_sha":"a0cef507a90adaac7dbbe9c404f09a50bdefb348",
            "patch":"SINGLE",
            "chain_ord":"['a0cef507a90adaac7dbbe9c404f09a50bdefb348']",
            "before_first_fix_commit":"{'ef532ed1c51be12155bc1f9baecad09a7c587e04'}",
            "last_fix_commit":"a0cef507a90adaac7dbbe9c404f09a50bdefb348",
            "chain_ord_pos":1.0,
            "commit_datetime":"08\/03\/2021, 16:31:10",
            "message":"Patch: Filter out blacklisted keys in og property name",
            "author":"Samuel Holmes",
            "comments":null,
            "stats":"{'additions': 7, 'deletions': 0, 'total': 7}",
            "files":"{'index.js': {'additions': 7, 'deletions': 0, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/samholmes\/node-open-graph\/raw\/a0cef507a90adaac7dbbe9c404f09a50bdefb348\/index.js', 'patch': '@@ -10,6 +10,11 @@ var shorthandProperties = {\\n \\t\"audio\": \"audio:url\"\\n }\\n \\n+var keyBlacklist = [\\n+\\t\\'__proto__\\',\\n+\\t\\'constructor\\',\\n+\\t\\'prototype\\'\\n+]\\n \\n exports = module.exports = function(url, cb, options){\\n   var userAgent = (options || {}).userAgent || \\'NodeOpenGraphCrawler (https:\/\/github.com\/samholmes\/node-open-graph)\\'\\n@@ -122,6 +127,8 @@ exports.parse = function($, options){\\n \\t\\twhile (keys.length > 1) {\\n \\t\\t\\tkey = keys.shift();\\n \\n+\\t\\t\\tif (keyBlacklist.includes(key)) continue\\n+\\n \\t\\t\\tif (Array.isArray(ptr[key])) {\\n \\t\\t\\t\\t\/\/ the last index of ptr[key] should become\\n \\t\\t\\t\\t\/\/ the object we are examining.'}}",
            "message_norm":"patch: filter out blacklisted keys in og property name",
            "language":"en",
            "entities":"[('blacklisted', 'SECWORD', ''), ('keys', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['index.js'])",
            "num_files":1.0,
            "patch_content":"From a0cef507a90adaac7dbbe9c404f09a50bdefb348 Mon Sep 17 00:00:00 2001\nFrom: Samuel Holmes <sam@edge.app>\nDate: Tue, 3 Aug 2021 09:31:10 -0700\nSubject: [PATCH] Patch: Filter out blacklisted keys in og property name\n\n---\n index.js | 7 +++++++\n 1 file changed, 7 insertions(+)\n\ndiff --git a\/index.js b\/index.js\nindex 50a6020..be75277 100644\n--- a\/index.js\n+++ b\/index.js\n@@ -10,6 +10,11 @@ var shorthandProperties = {\n \t\"audio\": \"audio:url\"\n }\n \n+var keyBlacklist = [\n+\t'__proto__',\n+\t'constructor',\n+\t'prototype'\n+]\n \n exports = module.exports = function(url, cb, options){\n   var userAgent = (options || {}).userAgent || 'NodeOpenGraphCrawler (https:\/\/github.com\/samholmes\/node-open-graph)'\n@@ -122,6 +127,8 @@ exports.parse = function($, options){\n \t\twhile (keys.length > 1) {\n \t\t\tkey = keys.shift();\n \n+\t\t\tif (keyBlacklist.includes(key)) continue\n+\n \t\t\tif (Array.isArray(ptr[key])) {\n \t\t\t\t\/\/ the last index of ptr[key] should become\n \t\t\t\t\/\/ the object we are examining."
        },
        {
            "index":767,
            "vuln_id":"GHSA-2jx3-5j9v-prpp",
            "cwe_id":"{'CWE-89'}",
            "score":8.1,
            "chain":"{'https:\/\/github.com\/PrestaShop\/blockwishlist\/commit\/b3ec4b85af5fd73f74d55390b226d221298ca084'}",
            "dataset":"osv",
            "summary":"BlockWishList SQL Injection vulnerability ### Impact\nAn authenticated customer can perform SQL injection\n\n### Patches\nIssue is fixed in 2.1.1",
            "published_date":"2022-06-25",
            "chain_len":1,
            "project":"https:\/\/github.com\/PrestaShop\/blockwishlist",
            "commit_href":"https:\/\/github.com\/PrestaShop\/blockwishlist\/commit\/b3ec4b85af5fd73f74d55390b226d221298ca084",
            "commit_sha":"b3ec4b85af5fd73f74d55390b226d221298ca084",
            "patch":"SINGLE",
            "chain_ord":"['b3ec4b85af5fd73f74d55390b226d221298ca084']",
            "before_first_fix_commit":"{'13e64b2709544354fd116927b80bc3fa249bc5b4', 'be79516175d564f60a657627482b0a60c3da353e'}",
            "last_fix_commit":"b3ec4b85af5fd73f74d55390b226d221298ca084",
            "chain_ord_pos":1.0,
            "commit_datetime":"06\/24\/2022, 08:04:52",
            "message":"Merge pull request from GHSA-2jx3-5j9v-prpp\n\nValidate order by and order way",
            "author":"atomiix",
            "comments":"{'com_1': {'author': 'doekia', 'datetime': '07\/22\/2022, 17:26:35', 'body': \"So apparently there is unfiltered value returned by toLegacyOrderWay() (I'm doubt full of it see below)\\r\\nIf this is the case CHANGE the function, not simply one module otherwise it is an open door for other modules.\\r\\n\\r\\nWhy I'm doubtfull ? Because toLegacyOrderWay() calls getDirection() which return $this->direction. $this->direction is set by setDirection() (during construct) and tests are done against values asc, desc, random otherwise exception. How can this lead to sql injection\"}, 'com_2': {'author': 'infiniweb', 'datetime': '07\/22\/2022, 21:40:39', 'body': '@doekia this issue is not with `toLegacyOrderWay`. The SQL injection can be reproduced because of the usage of `toLegacyOrderBy` (not `toLegacyOrderWay`) combined with a wrong usage of `getLegacyPrefix`. I can confirm the exploit. The usage of `Validate::isOrderBy($sortOrder)` is fixing the issue.'}, 'com_3': {'author': 'doekia', 'datetime': '07\/25\/2022, 18:07:12', 'body': 'Therefore I repeat, the function that need to be patched SHOULD BE toLegacyOrderBy() that should implement the Validate::isOrderBy() before returning values.\\r\\nSuch way will protect ANY modules that use the framework function toLegacyOrderBy()'}, 'com_4': {'author': 'Pilypas', 'datetime': '07\/27\/2022, 11:25:43', 'body': 'Can you tell me if the vulnerability in the module is also in Prestashop 1.6.1.24 version of blockwishlist 1.3.2 ?'}, 'com_5': {'author': 'infiniweb', 'datetime': '07\/27\/2022, 11:27:28', 'body': \"@Pilypas . No it's not. Please refer to https:\/\/github.com\/PrestaShop\/blockwishlist\/security\/advisories\/GHSA-2jx3-5j9v-prpp\"}}",
            "stats":"{'additions': 5, 'deletions': 1, 'total': 6}",
            "files":"{'src\/Search\/WishListProductSearchProvider.php': {'additions': 5, 'deletions': 1, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/PrestaShop\/blockwishlist\/raw\/b3ec4b85af5fd73f74d55390b226d221298ca084\/src%2FSearch%2FWishListProductSearchProvider.php', 'patch': \"@@ -35,6 +35,7 @@\\n use Product;\\n use Shop;\\n use Symfony\\\\Component\\\\Translation\\\\TranslatorInterface;\\n+use Validate;\\n use WishList;\\n \\n \/**\\n@@ -167,7 +168,10 @@ private function getProductsOrCount(\\n \\n         if ('products' === $type) {\\n             $sortOrder = $query->getSortOrder()->toLegacyOrderBy(true);\\n-            $querySearch->orderBy($sortOrder . ' ' . $query->getSortOrder()->toLegacyOrderWay());\\n+            $sortWay = $query->getSortOrder()->toLegacyOrderWay();\\n+            if (Validate::isOrderBy($sortOrder) && Validate::isOrderWay($sortWay)) {\\n+                $querySearch->orderBy($sortOrder . ' ' . $sortWay);\\n+            }\\n             $querySearch->limit((int) $query->getResultsPerPage(), ((int) $query->getPage() - 1) * (int) $query->getResultsPerPage());\\n             $products = $this->db->executeS($querySearch);\"}}",
            "message_norm":"merge pull request from ghsa-2jx3-5j9v-prpp\n\nvalidate order by and order way",
            "language":"no",
            "entities":"[('ghsa-2jx3-5j9v-prpp', 'VULNID', 'GHSA')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/Search\/WishListProductSearchProvider.php'])",
            "num_files":1.0,
            "patch_content":"From be79516175d564f60a657627482b0a60c3da353e Mon Sep 17 00:00:00 2001\nFrom: Thomas BACCELLI <thomas.baccelli@prestashop.com>\nDate: Tue, 21 Jun 2022 18:34:22 +0200\nSubject: [PATCH] Validate order by and order way\n\n---\n src\/Search\/WishListProductSearchProvider.php | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/Search\/WishListProductSearchProvider.php b\/src\/Search\/WishListProductSearchProvider.php\nindex efab3b30..5e2d1e7b 100644\n--- a\/src\/Search\/WishListProductSearchProvider.php\n+++ b\/src\/Search\/WishListProductSearchProvider.php\n@@ -35,6 +35,7 @@\n use Product;\n use Shop;\n use Symfony\\Component\\Translation\\TranslatorInterface;\n+use Validate;\n use WishList;\n \n \/**\n@@ -167,7 +168,10 @@ private function getProductsOrCount(\n \n         if ('products' === $type) {\n             $sortOrder = $query->getSortOrder()->toLegacyOrderBy(true);\n-            $querySearch->orderBy($sortOrder . ' ' . $query->getSortOrder()->toLegacyOrderWay());\n+            $sortWay = $query->getSortOrder()->toLegacyOrderWay();\n+            if (Validate::isOrderBy($sortOrder) && Validate::isOrderWay($sortWay)) {\n+                $querySearch->orderBy($sortOrder . ' ' . $sortWay);\n+            }\n             $querySearch->limit((int) $query->getResultsPerPage(), ((int) $query->getPage() - 1) * (int) $query->getResultsPerPage());\n             $products = $this->db->executeS($querySearch);"
        },
        {
            "index":942,
            "vuln_id":"GHSA-f522-ffg8-j8r6",
            "cwe_id":"{'CWE-20'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/mafintosh\/is-my-json-valid\/commit\/eca4beb21e61877d76fdf6bea771f72f39544d9b', 'https:\/\/github.com\/mafintosh\/is-my-json-valid\/commit\/b3051b277f7caa08cd2edc6f74f50aeda65d2976'}",
            "dataset":"osv",
            "summary":"Regular Expression Denial of Service in is-my-json-valid Version of `is-my-json-valid` before 1.4.1 or 2.17.2 are vulnerable to regular expression denial of service (ReDoS) via the email validation function.\n\n\n## Recommendation\n\nUpdate to version 1.4.1, 2.17.2 or later.",
            "published_date":"2017-10-24",
            "chain_len":2,
            "project":"https:\/\/github.com\/mafintosh\/is-my-json-valid",
            "commit_href":"https:\/\/github.com\/mafintosh\/is-my-json-valid\/commit\/eca4beb21e61877d76fdf6bea771f72f39544d9b",
            "commit_sha":"eca4beb21e61877d76fdf6bea771f72f39544d9b",
            "patch":"MULTI",
            "chain_ord":"['eca4beb21e61877d76fdf6bea771f72f39544d9b', 'b3051b277f7caa08cd2edc6f74f50aeda65d2976']",
            "before_first_fix_commit":"{'5c6a43dedebf975508465b375af98e9afde2f49c', '767c6c0ee5e55c506ccd49141e7f31cb1910c47f'}",
            "last_fix_commit":"b3051b277f7caa08cd2edc6f74f50aeda65d2976",
            "chain_ord_pos":1.0,
            "commit_datetime":"01\/17\/2016, 21:55:32",
            "message":"fix utc-millisec regex to avoid a ddos attack",
            "author":"Mathias Buus",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'formats.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/mafintosh\/is-my-json-valid\/raw\/eca4beb21e61877d76fdf6bea771f72f39544d9b\/formats.js', 'patch': \"@@ -11,4 +11,4 @@ exports['alpha'] = \/^[a-zA-Z]+$\/\\n exports['alphanumeric'] = \/^[a-zA-Z0-9]+$\/\\n exports['style'] = \/\\\\s*(.+?):\\\\s*([^;]+);?\/g\\n exports['phone'] = \/^\\\\+(?:[0-9] ?){6,14}[0-9]$\/\\n-exports['utc-millisec'] = \/^[0-9]+(\\\\.?[0-9]+)?$\/\\n+exports['utc-millisec'] = \/^[0-9]{1,15}\\\\.?[0-9]{0,15}$\/\"}}",
            "message_norm":"fix utc-millisec regex to avoid a ddos attack",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('ddos', 'SECWORD', ''), ('attack', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['formats.js'])",
            "num_files":1.0,
            "patch_content":"From eca4beb21e61877d76fdf6bea771f72f39544d9b Mon Sep 17 00:00:00 2001\nFrom: Mathias Buus <mathiasbuus@gmail.com>\nDate: Sun, 17 Jan 2016 22:55:32 +0100\nSubject: [PATCH] fix utc-millisec regex to avoid a ddos attack\n\n---\n formats.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/formats.js b\/formats.js\nindex 3038dae..9cb8380 100644\n--- a\/formats.js\n+++ b\/formats.js\n@@ -11,4 +11,4 @@ exports['alpha'] = \/^[a-zA-Z]+$\/\n exports['alphanumeric'] = \/^[a-zA-Z0-9]+$\/\n exports['style'] = \/\\s*(.+?):\\s*([^;]+);?\/g\n exports['phone'] = \/^\\+(?:[0-9] ?){6,14}[0-9]$\/\n-exports['utc-millisec'] = \/^[0-9]+(\\.?[0-9]+)?$\/\n+exports['utc-millisec'] = \/^[0-9]{1,15}\\.?[0-9]{0,15}$\/"
        },
        {
            "index":250,
            "vuln_id":"GHSA-rgvq-pcvf-hx75",
            "cwe_id":"{'CWE-131'}",
            "score":5.3,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/f94ef358bb3e91d517446454edff6535bcfe8e4a', 'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c4d7afb6a5986b04505aca4466ae1951686c80f6', 'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/b761c9b652af2107cfbc33efd19be0ce41daa33e'}",
            "dataset":"osv",
            "summary":"Heap OOB and null pointer dereference in `RaggedTensorToTensor` ### Impact\nDue to lack of validation in `tf.raw_ops.RaggedTensorToTensor`, an attacker can exploit an undefined behavior if input arguments are empty:\n\n```python\nimport tensorflow as tf\n\nshape = tf.constant([-1, -1], shape=[2], dtype=tf.int64)\nvalues = tf.constant([], shape=[0], dtype=tf.int64)\ndefault_value = tf.constant(404, dtype=tf.int64)\nrow = tf.constant([269, 404, 0, 0, 0, 0, 0], shape=[7], dtype=tf.int64)\nrows = [row]\ntypes = ['ROW_SPLITS']\n\ntf.raw_ops.RaggedTensorToTensor(\n  shape=shape, values=values, default_value=default_value, \n  row_partition_tensors=rows, row_partition_types=types)\n```\n\nThe [implementation](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/656e7673b14acd7835dc778867f84916c6d1cac2\/tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc#L356-L360) only checks that one of the tensors is not empty, but does not check for the other ones.\n\nThere are multiple `DCHECK` validations to prevent heap OOB, but these are no-op in release builds, hence they don't prevent anything.\n\n### Patches\nWe have patched the issue in GitHub commit [b761c9b652af2107cfbc33efd19be0ce41daa33e](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/b761c9b652af2107cfbc33efd19be0ce41daa33e) followed by GitHub commit [f94ef358bb3e91d517446454edff6535bcfe8e4a](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/f94ef358bb3e91d517446454edff6535bcfe8e4a) and GitHub commit [c4d7afb6a5986b04505aca4466ae1951686c80f6](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c4d7afb6a5986b04505aca4466ae1951686c80f6).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick these commits on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by Yakun Zhang and Ying Wang of Baidu X-Team.",
            "published_date":"2021-05-21",
            "chain_len":3,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c4d7afb6a5986b04505aca4466ae1951686c80f6",
            "commit_sha":"c4d7afb6a5986b04505aca4466ae1951686c80f6",
            "patch":"MULTI",
            "chain_ord":"['f94ef358bb3e91d517446454edff6535bcfe8e4a', 'b761c9b652af2107cfbc33efd19be0ce41daa33e', 'c4d7afb6a5986b04505aca4466ae1951686c80f6']",
            "before_first_fix_commit":"{'50034ad2d55b10eb9d4593374546710b12f134e1'}",
            "last_fix_commit":"c4d7afb6a5986b04505aca4466ae1951686c80f6",
            "chain_ord_pos":3.0,
            "commit_datetime":"05\/11\/2021, 22:22:49",
            "message":"Fix heap OOB \/ undefined behavior in `RaggedTensorToTensor`\n\nPiperOrigin-RevId: 373244623\nChange-Id: I2d6cbbc8c67b238a8815bf58097f7586d87c54f2",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 35, 'deletions': 20, 'total': 55}",
            "files":"{'tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc': {'additions': 35, 'deletions': 20, 'changes': 55, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/c4d7afb6a5986b04505aca4466ae1951686c80f6\/tensorflow%2Fcore%2Fkernels%2Fragged_tensor_to_tensor_op.cc', 'patch': '@@ -207,8 +207,8 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\\n     DCHECK_EQ(result->size(), first_dimension);\\n   }\\n \\n-  void CalculateOutputIndexRowSplit(\\n-      OpKernelContext* context, const RowPartitionTensor& row_split,\\n+  Status CalculateOutputIndexRowSplit(\\n+      const RowPartitionTensor& row_split,\\n       const vector<INDEX_TYPE>& parent_output_index,\\n       INDEX_TYPE output_index_multiplier, INDEX_TYPE output_size,\\n       vector<INDEX_TYPE>* result) {\\n@@ -232,10 +232,11 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\\n         result->push_back(-1);\\n       }\\n     }\\n-    if (row_split_size > 0) {\\n-      OP_REQUIRES(context, result->size() == row_split(row_split_size - 1),\\n-                  errors::InvalidArgument(\"Invalid row split size.\"));\\n+    if (row_split_size > 0 && result->size() != row_split(row_split_size - 1)) {\\n+      return errors::InvalidArgument(\"Invalid row split size.\");\\n     }\\n+\\n+    return Status::OK();\\n   }\\n \\n   \/\/ Calculate the output index of the first element of a list.\\n@@ -259,20 +260,26 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\\n   \/\/ result[6] = -1 because parent_output_index[value_rowids[6]] == -1\\n   \/\/ result[7] = -1 because parent_output_index[value_rowids[6]] == -1\\n   \/\/ result[8] = parent_output_index[value_rowids[7]]\\n-  void CalculateOutputIndexValueRowID(\\n-      OpKernelContext* context, const RowPartitionTensor& value_rowids,\\n+  Status CalculateOutputIndexValueRowID(\\n+      const RowPartitionTensor& value_rowids,\\n       const vector<INDEX_TYPE>& parent_output_index,\\n       INDEX_TYPE output_index_multiplier, INDEX_TYPE output_size,\\n       vector<INDEX_TYPE>* result) {\\n     const INDEX_TYPE index_size = value_rowids.size();\\n     result->reserve(index_size);\\n     if (index_size == 0) {\\n-      return;\\n+      return Status::OK();\\n     }\\n \\n     INDEX_TYPE current_output_column = 0;\\n     INDEX_TYPE current_value_rowid = value_rowids(0);\\n-    DCHECK_LT(current_value_rowid, parent_output_index.size());\\n+\\n+    if (current_value_rowid >= parent_output_index.size()) {\\n+      return errors::InvalidArgument(\\n+          \"Got current_value_rowid=\", current_value_rowid,\\n+          \" which is not less than \", parent_output_index.size());\\n+    }\\n+\\n     INDEX_TYPE current_output_index = parent_output_index[current_value_rowid];\\n     result->push_back(current_output_index);\\n     for (INDEX_TYPE i = 1; i < index_size; ++i) {\\n@@ -289,13 +296,23 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\\n       } else {\\n         current_output_column = 0;\\n         current_value_rowid = next_value_rowid;\\n-        DCHECK_LT(next_value_rowid, parent_output_index.size());\\n+\\n+        if (next_value_rowid >= parent_output_index.size()) {\\n+          return errors::InvalidArgument(\\n+              \"Got next_value_rowid=\", next_value_rowid,\\n+              \" which is not less than \", parent_output_index.size());\\n+        }\\n+\\n         current_output_index = parent_output_index[next_value_rowid];\\n       }\\n       result->push_back(current_output_index);\\n     }\\n-    OP_REQUIRES(context, result->size() == value_rowids.size(),\\n-                errors::InvalidArgument(\"Invalid row ids.\"));\\n+\\n+    if (result->size() != value_rowids.size()) {\\n+      return errors::InvalidArgument(\"Invalid row ids.\");\\n+    }\\n+\\n+    return Status::OK();\\n   }\\n \\n   Status CalculateOutputIndex(OpKernelContext* context, int dimension,\\n@@ -308,21 +325,19 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\\n     auto partition_type = GetRowPartitionTypeByDimension(dimension);\\n     switch (partition_type) {\\n       case RowPartitionType::VALUE_ROWIDS:\\n-        CalculateOutputIndexValueRowID(\\n-            context, row_partition_tensor, parent_output_index,\\n-            output_index_multiplier, output_size, result);\\n-        return tensorflow::Status::OK();\\n+        return CalculateOutputIndexValueRowID(\\n+            row_partition_tensor, parent_output_index, output_index_multiplier,\\n+            output_size, result);\\n       case RowPartitionType::ROW_SPLITS:\\n         if (row_partition_tensor.size() - 1 > parent_output_index.size()) {\\n           return errors::InvalidArgument(\\n               \"Row partition size is greater than output size: \",\\n               row_partition_tensor.size() - 1, \" > \",\\n               parent_output_index.size());\\n         }\\n-        CalculateOutputIndexRowSplit(\\n-            context, row_partition_tensor, parent_output_index,\\n-            output_index_multiplier, output_size, result);\\n-        return tensorflow::Status::OK();\\n+        return CalculateOutputIndexRowSplit(\\n+            row_partition_tensor, parent_output_index, output_index_multiplier,\\n+            output_size, result);\\n       default:\\n         return errors::InvalidArgument(\\n             \"Unsupported partition type:\",'}}",
            "message_norm":"fix heap oob \/ undefined behavior in `raggedtensortotensor`\n\npiperorigin-revid: 373244623\nchange-id: i2d6cbbc8c67b238a8815bf58097f7586d87c54f2",
            "language":"en",
            "entities":"[('fix', 'ACTION', ''), ('heap oob', 'SECWORD', ''), ('373244623', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc'])",
            "num_files":1.0,
            "patch_content":"From c4d7afb6a5986b04505aca4466ae1951686c80f6 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 11 May 2021 15:22:49 -0700\nSubject: [PATCH] Fix heap OOB \/ undefined behavior in `RaggedTensorToTensor`\n\nPiperOrigin-RevId: 373244623\nChange-Id: I2d6cbbc8c67b238a8815bf58097f7586d87c54f2\n---\n ...\/kernels\/ragged_tensor_to_tensor_op.cc     | 55 ++++++++++++-------\n 1 file changed, 35 insertions(+), 20 deletions(-)\n\ndiff --git a\/tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc b\/tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc\nindex 376d55945d2ce8..b79a07e67ba913 100644\n--- a\/tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc\n+++ b\/tensorflow\/core\/kernels\/ragged_tensor_to_tensor_op.cc\n@@ -207,8 +207,8 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\n     DCHECK_EQ(result->size(), first_dimension);\n   }\n \n-  void CalculateOutputIndexRowSplit(\n-      OpKernelContext* context, const RowPartitionTensor& row_split,\n+  Status CalculateOutputIndexRowSplit(\n+      const RowPartitionTensor& row_split,\n       const vector<INDEX_TYPE>& parent_output_index,\n       INDEX_TYPE output_index_multiplier, INDEX_TYPE output_size,\n       vector<INDEX_TYPE>* result) {\n@@ -232,10 +232,11 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\n         result->push_back(-1);\n       }\n     }\n-    if (row_split_size > 0) {\n-      OP_REQUIRES(context, result->size() == row_split(row_split_size - 1),\n-                  errors::InvalidArgument(\"Invalid row split size.\"));\n+    if (row_split_size > 0 && result->size() != row_split(row_split_size - 1)) {\n+      return errors::InvalidArgument(\"Invalid row split size.\");\n     }\n+\n+    return Status::OK();\n   }\n \n   \/\/ Calculate the output index of the first element of a list.\n@@ -259,20 +260,26 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\n   \/\/ result[6] = -1 because parent_output_index[value_rowids[6]] == -1\n   \/\/ result[7] = -1 because parent_output_index[value_rowids[6]] == -1\n   \/\/ result[8] = parent_output_index[value_rowids[7]]\n-  void CalculateOutputIndexValueRowID(\n-      OpKernelContext* context, const RowPartitionTensor& value_rowids,\n+  Status CalculateOutputIndexValueRowID(\n+      const RowPartitionTensor& value_rowids,\n       const vector<INDEX_TYPE>& parent_output_index,\n       INDEX_TYPE output_index_multiplier, INDEX_TYPE output_size,\n       vector<INDEX_TYPE>* result) {\n     const INDEX_TYPE index_size = value_rowids.size();\n     result->reserve(index_size);\n     if (index_size == 0) {\n-      return;\n+      return Status::OK();\n     }\n \n     INDEX_TYPE current_output_column = 0;\n     INDEX_TYPE current_value_rowid = value_rowids(0);\n-    DCHECK_LT(current_value_rowid, parent_output_index.size());\n+\n+    if (current_value_rowid >= parent_output_index.size()) {\n+      return errors::InvalidArgument(\n+          \"Got current_value_rowid=\", current_value_rowid,\n+          \" which is not less than \", parent_output_index.size());\n+    }\n+\n     INDEX_TYPE current_output_index = parent_output_index[current_value_rowid];\n     result->push_back(current_output_index);\n     for (INDEX_TYPE i = 1; i < index_size; ++i) {\n@@ -289,13 +296,23 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\n       } else {\n         current_output_column = 0;\n         current_value_rowid = next_value_rowid;\n-        DCHECK_LT(next_value_rowid, parent_output_index.size());\n+\n+        if (next_value_rowid >= parent_output_index.size()) {\n+          return errors::InvalidArgument(\n+              \"Got next_value_rowid=\", next_value_rowid,\n+              \" which is not less than \", parent_output_index.size());\n+        }\n+\n         current_output_index = parent_output_index[next_value_rowid];\n       }\n       result->push_back(current_output_index);\n     }\n-    OP_REQUIRES(context, result->size() == value_rowids.size(),\n-                errors::InvalidArgument(\"Invalid row ids.\"));\n+\n+    if (result->size() != value_rowids.size()) {\n+      return errors::InvalidArgument(\"Invalid row ids.\");\n+    }\n+\n+    return Status::OK();\n   }\n \n   Status CalculateOutputIndex(OpKernelContext* context, int dimension,\n@@ -308,10 +325,9 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\n     auto partition_type = GetRowPartitionTypeByDimension(dimension);\n     switch (partition_type) {\n       case RowPartitionType::VALUE_ROWIDS:\n-        CalculateOutputIndexValueRowID(\n-            context, row_partition_tensor, parent_output_index,\n-            output_index_multiplier, output_size, result);\n-        return tensorflow::Status::OK();\n+        return CalculateOutputIndexValueRowID(\n+            row_partition_tensor, parent_output_index, output_index_multiplier,\n+            output_size, result);\n       case RowPartitionType::ROW_SPLITS:\n         if (row_partition_tensor.size() - 1 > parent_output_index.size()) {\n           return errors::InvalidArgument(\n@@ -319,10 +335,9 @@ class RaggedTensorToTensorBaseOp : public OpKernel {\n               row_partition_tensor.size() - 1, \" > \",\n               parent_output_index.size());\n         }\n-        CalculateOutputIndexRowSplit(\n-            context, row_partition_tensor, parent_output_index,\n-            output_index_multiplier, output_size, result);\n-        return tensorflow::Status::OK();\n+        return CalculateOutputIndexRowSplit(\n+            row_partition_tensor, parent_output_index, output_index_multiplier,\n+            output_size, result);\n       default:\n         return errors::InvalidArgument(\n             \"Unsupported partition type:\","
        },
        {
            "index":167,
            "vuln_id":"GHSA-j7rm-8ww4-xx2g",
            "cwe_id":"{'CWE-369'}",
            "score":2.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/0d45ea1ca641b21b73bcf9c00e0179cda284e7e7'}",
            "dataset":"osv",
            "summary":"Division by zero in TFLite's implementation of `SpaceToDepth` ### Impact\nThe `Prepare` step of the `SpaceToDepth` TFLite operator [does not check for 0 before division](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/5f7975d09eac0f10ed8a17dbb6f5964977725adc\/tensorflow\/lite\/kernels\/space_to_depth.cc#L63-L67).\n\n```cc \nconst int block_size = params->block_size;\nconst int input_height = input->dims->data[1];\nconst int input_width = input->dims->data[2];\nint output_height = input_height \/ block_size;\nint output_width = input_width \/ block_size;\n```   \n\nAn attacker can craft a model such that `params->block_size` would be zero.\n\n### Patches\nWe have patched the issue in GitHub commit [0d45ea1ca641b21b73bcf9c00e0179cda284e7e7](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/0d45ea1ca641b21b73bcf9c00e0179cda284e7e7).\n\nThe fix will be included in TensorFlow 2.5.0. We will also cherrypick this commit on TensorFlow 2.4.2, TensorFlow 2.3.3, TensorFlow 2.2.3 and TensorFlow 2.1.4, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.\n\n### Attribution\nThis vulnerability has been reported by members of the Aivul Team from Qihoo 360.",
            "published_date":"2021-05-21",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/0d45ea1ca641b21b73bcf9c00e0179cda284e7e7",
            "commit_sha":"0d45ea1ca641b21b73bcf9c00e0179cda284e7e7",
            "patch":"SINGLE",
            "chain_ord":"['0d45ea1ca641b21b73bcf9c00e0179cda284e7e7']",
            "before_first_fix_commit":"{'5f7975d09eac0f10ed8a17dbb6f5964977725adc'}",
            "last_fix_commit":"0d45ea1ca641b21b73bcf9c00e0179cda284e7e7",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/28\/2021, 00:45:57",
            "message":"Prevent one more div by 0 in TFLite\n\nPiperOrigin-RevId: 370800114\nChange-Id: I6b956aeb8c458cc6f514408d2e89ffacfe249e57",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
            "files":"{'tensorflow\/lite\/kernels\/space_to_depth.cc': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/0d45ea1ca641b21b73bcf9c00e0179cda284e7e7\/tensorflow%2Flite%2Fkernels%2Fspace_to_depth.cc', 'patch': '@@ -61,6 +61,7 @@ TfLiteStatus Prepare(TfLiteContext* context, TfLiteNode* node) {\\n   TF_LITE_ENSURE_TYPES_EQ(context, input->type, output->type);\\n \\n   const int block_size = params->block_size;\\n+  TF_LITE_ENSURE(context, block_size > 0);\\n   const int input_height = input->dims->data[1];\\n   const int input_width = input->dims->data[2];\\n   int output_height = input_height \/ block_size;'}}",
            "message_norm":"prevent one more div by 0 in tflite\n\npiperorigin-revid: 370800114\nchange-id: i6b956aeb8c458cc6f514408d2e89ffacfe249e57",
            "language":"en",
            "entities":"[('prevent', 'ACTION', ''), ('div by 0', 'SECWORD', ''), ('370800114', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/lite\/kernels\/space_to_depth.cc'])",
            "num_files":1.0,
            "patch_content":"From 0d45ea1ca641b21b73bcf9c00e0179cda284e7e7 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Tue, 27 Apr 2021 17:45:57 -0700\nSubject: [PATCH] Prevent one more div by 0 in TFLite\n\nPiperOrigin-RevId: 370800114\nChange-Id: I6b956aeb8c458cc6f514408d2e89ffacfe249e57\n---\n tensorflow\/lite\/kernels\/space_to_depth.cc | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/tensorflow\/lite\/kernels\/space_to_depth.cc b\/tensorflow\/lite\/kernels\/space_to_depth.cc\nindex 4db7440b57e60b..35a0fe1c26e207 100644\n--- a\/tensorflow\/lite\/kernels\/space_to_depth.cc\n+++ b\/tensorflow\/lite\/kernels\/space_to_depth.cc\n@@ -61,6 +61,7 @@ TfLiteStatus Prepare(TfLiteContext* context, TfLiteNode* node) {\n   TF_LITE_ENSURE_TYPES_EQ(context, input->type, output->type);\n \n   const int block_size = params->block_size;\n+  TF_LITE_ENSURE(context, block_size > 0);\n   const int input_height = input->dims->data[1];\n   const int input_width = input->dims->data[2];\n   int output_height = input_height \/ block_size;"
        },
        {
            "index":538,
            "vuln_id":"GHSA-hxp5-8pgq-mgv9",
            "cwe_id":"{'CWE-295'}",
            "score":5.9,
            "chain":"{'https:\/\/github.com\/apache\/calcite\/commit\/43eeafcbac29d02c72bd520c003cdfc571de2d15'}",
            "dataset":"osv",
            "summary":"Missing Authentication for Critical Function in Apache Calcite \"HttpUtils#getURLConnection method disables explicitly hostname verification for HTTPS connections making clients vulnerable to man-in-the-middle attacks. Calcite uses this method internally to connect with Druid and Splunk so information leakage may happen when using the respective Calcite adapters. The method itself is in a utility class so people may use it to create vulnerable HTTPS connections for other applications. From Apache Calcite 1.26 onwards, the hostname verification will be performed using the default JVM truststore.\"",
            "published_date":"2021-04-22",
            "chain_len":1,
            "project":"https:\/\/github.com\/apache\/calcite",
            "commit_href":"https:\/\/github.com\/apache\/calcite\/commit\/43eeafcbac29d02c72bd520c003cdfc571de2d15",
            "commit_sha":"43eeafcbac29d02c72bd520c003cdfc571de2d15",
            "patch":"SINGLE",
            "chain_ord":"['43eeafcbac29d02c72bd520c003cdfc571de2d15']",
            "before_first_fix_commit":"{'ab19f98172848fe303a18173946c2def0b0d0312'}",
            "last_fix_commit":"43eeafcbac29d02c72bd520c003cdfc571de2d15",
            "chain_ord_pos":1.0,
            "commit_datetime":"09\/22\/2020, 21:42:06",
            "message":"[CALCITE-4298] Avoid disabling hostname verification on HTTPS connections",
            "author":"Stamatis Zampetakis",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 16, 'total': 17}",
            "files":"{'core\/src\/main\/java\/org\/apache\/calcite\/runtime\/HttpUtils.java': {'additions': 1, 'deletions': 16, 'changes': 17, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/calcite\/raw\/43eeafcbac29d02c72bd520c003cdfc571de2d15\/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fcalcite%2Fruntime%2FHttpUtils.java', 'patch': \"@@ -23,11 +23,9 @@\\n import java.io.Writer;\\n import java.net.HttpURLConnection;\\n import java.net.URL;\\n-import java.net.URLConnection;\\n import java.net.URLEncoder;\\n import java.nio.charset.StandardCharsets;\\n import java.util.Map;\\n-import javax.net.ssl.HttpsURLConnection;\\n \\n \/**\\n  * Utilities for connecting to REST services such as Splunk via HTTP.\\n@@ -37,20 +35,7 @@ private HttpUtils() {}\\n \\n   public static HttpURLConnection getURLConnection(String url)\\n       throws IOException {\\n-    URLConnection conn = new URL(url).openConnection();\\n-    final HttpURLConnection httpConn = (HttpURLConnection) conn;\\n-\\n-    \/\/ take care of https stuff - most of the time it's only needed to\\n-    \/\/ secure client\/server comm\\n-    \/\/ not to establish the identity of the server\\n-    if (httpConn instanceof HttpsURLConnection) {\\n-      HttpsURLConnection httpsConn = (HttpsURLConnection) httpConn;\\n-      httpsConn.setSSLSocketFactory(\\n-          TrustAllSslSocketFactory.createSSLSocketFactory());\\n-      httpsConn.setHostnameVerifier((arg0, arg1) -> true);\\n-    }\\n-\\n-    return httpConn;\\n+    return (HttpURLConnection) new URL(url).openConnection();\\n   }\\n \\n   public static void appendURLEncodedArgs(\"}}",
            "message_norm":"[calcite-4298] avoid disabling hostname verification on https connections",
            "language":"en",
            "entities":"[('hostname', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['core\/src\/main\/java\/org\/apache\/calcite\/runtime\/HttpUtils.java'])",
            "num_files":1.0,
            "patch_content":"From 43eeafcbac29d02c72bd520c003cdfc571de2d15 Mon Sep 17 00:00:00 2001\nFrom: Stamatis Zampetakis <zabetak@gmail.com>\nDate: Tue, 22 Sep 2020 23:42:06 +0200\nSubject: [PATCH] [CALCITE-4298] Avoid disabling hostname verification on HTTPS\n connections\n\n---\n ...\/org\/apache\/calcite\/runtime\/HttpUtils.java   | 17 +----------------\n 1 file changed, 1 insertion(+), 16 deletions(-)\n\ndiff --git a\/core\/src\/main\/java\/org\/apache\/calcite\/runtime\/HttpUtils.java b\/core\/src\/main\/java\/org\/apache\/calcite\/runtime\/HttpUtils.java\nindex a3b140beeed..d23b93805df 100644\n--- a\/core\/src\/main\/java\/org\/apache\/calcite\/runtime\/HttpUtils.java\n+++ b\/core\/src\/main\/java\/org\/apache\/calcite\/runtime\/HttpUtils.java\n@@ -23,11 +23,9 @@\n import java.io.Writer;\n import java.net.HttpURLConnection;\n import java.net.URL;\n-import java.net.URLConnection;\n import java.net.URLEncoder;\n import java.nio.charset.StandardCharsets;\n import java.util.Map;\n-import javax.net.ssl.HttpsURLConnection;\n \n \/**\n  * Utilities for connecting to REST services such as Splunk via HTTP.\n@@ -37,20 +35,7 @@ private HttpUtils() {}\n \n   public static HttpURLConnection getURLConnection(String url)\n       throws IOException {\n-    URLConnection conn = new URL(url).openConnection();\n-    final HttpURLConnection httpConn = (HttpURLConnection) conn;\n-\n-    \/\/ take care of https stuff - most of the time it's only needed to\n-    \/\/ secure client\/server comm\n-    \/\/ not to establish the identity of the server\n-    if (httpConn instanceof HttpsURLConnection) {\n-      HttpsURLConnection httpsConn = (HttpsURLConnection) httpConn;\n-      httpsConn.setSSLSocketFactory(\n-          TrustAllSslSocketFactory.createSSLSocketFactory());\n-      httpsConn.setHostnameVerifier((arg0, arg1) -> true);\n-    }\n-\n-    return httpConn;\n+    return (HttpURLConnection) new URL(url).openConnection();\n   }\n \n   public static void appendURLEncodedArgs("
        },
        {
            "index":904,
            "vuln_id":"GHSA-4v5p-v5h9-6xjx",
            "cwe_id":"{'CWE-617'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c2b31ff2d3151acb230edc3f5b1832d2c713a9e0'}",
            "dataset":"osv",
            "summary":"`CHECK`-failures in Tensorflow ### Impact\nAn attacker can trigger denial of service via assertion failure by altering a `SavedModel` on disk such that `AttrDef`s of some operation are duplicated.\n\n### Patches\nWe have patched the issue in GitHub commit [c2b31ff2d3151acb230edc3f5b1832d2c713a9e0](https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c2b31ff2d3151acb230edc3f5b1832d2c713a9e0).\n\nThe fix will be included in TensorFlow 2.8.0. We will also cherrypick this commit on TensorFlow 2.7.1, TensorFlow 2.6.3, and TensorFlow 2.5.3, as these are also affected and still in supported range.\n\n### For more information\nPlease consult [our security guide](https:\/\/github.com\/tensorflow\/tensorflow\/blob\/master\/SECURITY.md) for more information regarding the security model and how to contact us with issues and questions.",
            "published_date":"2022-02-09",
            "chain_len":1,
            "project":"https:\/\/github.com\/tensorflow\/tensorflow",
            "commit_href":"https:\/\/github.com\/tensorflow\/tensorflow\/commit\/c2b31ff2d3151acb230edc3f5b1832d2c713a9e0",
            "commit_sha":"c2b31ff2d3151acb230edc3f5b1832d2c713a9e0",
            "patch":"SINGLE",
            "chain_ord":"['c2b31ff2d3151acb230edc3f5b1832d2c713a9e0']",
            "before_first_fix_commit":"{'41424fd983e23b11ed13bbd5a2b2be0e25ab4244'}",
            "last_fix_commit":"c2b31ff2d3151acb230edc3f5b1832d2c713a9e0",
            "chain_ord_pos":1.0,
            "commit_datetime":"11\/08\/2021, 18:14:10",
            "message":"Remove a `DCHECK`-fail, log an error instead.\n\n`DCHECK` in debug mode results in crashes. TensorFlow has had multiple vulnerabilities due to this.\n\nOutside of debug mode, `DCHECK` is a no-op.\n\nA better alternative is to report an error to the log buffer and continue. This should happen both in debug mode and in prod mode.\n\nPiperOrigin-RevId: 408375925\nChange-Id: Id5b3e19c73f3fbe0cc4bba26ca44ff9607bb6356",
            "author":"Mihai Maruseac",
            "comments":null,
            "stats":"{'additions': 4, 'deletions': 3, 'total': 7}",
            "files":"{'tensorflow\/core\/framework\/op_def_util.cc': {'additions': 4, 'deletions': 3, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tensorflow\/tensorflow\/raw\/c2b31ff2d3151acb230edc3f5b1832d2c713a9e0\/tensorflow%2Fcore%2Fframework%2Fop_def_util.cc', 'patch': '@@ -821,9 +821,10 @@ bool RepeatedAttrDefEqual(\\n     const protobuf::RepeatedPtrField<OpDef::AttrDef>& a2) {\\n   std::unordered_map<string, const OpDef::AttrDef*> a1_set;\\n   for (const OpDef::AttrDef& def : a1) {\\n-    DCHECK(a1_set.find(def.name()) == a1_set.end())\\n-        << \"AttrDef names must be unique, but \\'\" << def.name()\\n-        << \"\\' appears more than once\";\\n+    if (a1_set.find(def.name()) != a1_set.end()) {\\n+      LOG(ERROR) << \"AttrDef names must be unique, but \\'\" << def.name()\\n+                 << \"\\' appears more than once\";\\n+    }\\n     a1_set[def.name()] = &def;\\n   }\\n   for (const OpDef::AttrDef& def : a2) {'}}",
            "message_norm":"remove a `dcheck`-fail, log an error instead.\n\n`dcheck` in debug mode results in crashes. tensorflow has had multiple vulnerabilities due to this.\n\noutside of debug mode, `dcheck` is a no-op.\n\na better alternative is to report an error to the log buffer and continue. this should happen both in debug mode and in prod mode.\n\npiperorigin-revid: 408375925\nchange-id: id5b3e19c73f3fbe0cc4bba26ca44ff9607bb6356",
            "language":"en",
            "entities":"[('remove', 'ACTION', ''), ('error', 'FLAW', ''), ('vulnerabilities', 'SECWORD', ''), ('error', 'FLAW', ''), ('408375925', 'SHA', 'generic_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['tensorflow\/core\/framework\/op_def_util.cc'])",
            "num_files":1.0,
            "patch_content":"From c2b31ff2d3151acb230edc3f5b1832d2c713a9e0 Mon Sep 17 00:00:00 2001\nFrom: Mihai Maruseac <mihaimaruseac@google.com>\nDate: Mon, 8 Nov 2021 10:14:10 -0800\nSubject: [PATCH] Remove a `DCHECK`-fail, log an error instead.\n\n`DCHECK` in debug mode results in crashes. TensorFlow has had multiple vulnerabilities due to this.\n\nOutside of debug mode, `DCHECK` is a no-op.\n\nA better alternative is to report an error to the log buffer and continue. This should happen both in debug mode and in prod mode.\n\nPiperOrigin-RevId: 408375925\nChange-Id: Id5b3e19c73f3fbe0cc4bba26ca44ff9607bb6356\n---\n tensorflow\/core\/framework\/op_def_util.cc | 7 ++++---\n 1 file changed, 4 insertions(+), 3 deletions(-)\n\ndiff --git a\/tensorflow\/core\/framework\/op_def_util.cc b\/tensorflow\/core\/framework\/op_def_util.cc\nindex dcbe5f38ce88ea..6127913d9ba1f0 100644\n--- a\/tensorflow\/core\/framework\/op_def_util.cc\n+++ b\/tensorflow\/core\/framework\/op_def_util.cc\n@@ -821,9 +821,10 @@ bool RepeatedAttrDefEqual(\n     const protobuf::RepeatedPtrField<OpDef::AttrDef>& a2) {\n   std::unordered_map<string, const OpDef::AttrDef*> a1_set;\n   for (const OpDef::AttrDef& def : a1) {\n-    DCHECK(a1_set.find(def.name()) == a1_set.end())\n-        << \"AttrDef names must be unique, but '\" << def.name()\n-        << \"' appears more than once\";\n+    if (a1_set.find(def.name()) != a1_set.end()) {\n+      LOG(ERROR) << \"AttrDef names must be unique, but '\" << def.name()\n+                 << \"' appears more than once\";\n+    }\n     a1_set[def.name()] = &def;\n   }\n   for (const OpDef::AttrDef& def : a2) {"
        },
        {
            "index":447,
            "vuln_id":"GHSA-3xgx-r9j4-qw9w",
            "cwe_id":"{'CWE-1321'}",
            "score":7.3,
            "chain":"{'https:\/\/github.com\/dexie\/Dexie.js\/commit\/1d655a69b9f28c3af6fae10cf5c61df387dc689b'}",
            "dataset":"osv",
            "summary":"Prototype Pollution in Dexie Dexie is a minimalistic wrapper for IndexedDB. The package dexie before 3.2.2, from 4.0.0-alpha.1 and before 4.0.0-alpha.3 are vulnerable to Prototype Pollution in the Dexie.setByKeyPath(obj, keyPath, value) function which does not properly check the keys being set (like __proto__ or constructor). This can allow an attacker to add\/modify properties of the Object.prototype leading to prototype pollution vulnerability. **Note:** This vulnerability can occur in multiple ways, for example when modifying a collection with untrusted user input.",
            "published_date":"2022-05-03",
            "chain_len":1,
            "project":"https:\/\/github.com\/dexie\/Dexie.js",
            "commit_href":"https:\/\/github.com\/dexie\/Dexie.js\/commit\/1d655a69b9f28c3af6fae10cf5c61df387dc689b",
            "commit_sha":"1d655a69b9f28c3af6fae10cf5c61df387dc689b",
            "patch":"SINGLE",
            "chain_ord":"['1d655a69b9f28c3af6fae10cf5c61df387dc689b']",
            "before_first_fix_commit":"{'b350b8cbc8a926b46c20f3a569555c4660a99ca4'}",
            "last_fix_commit":"1d655a69b9f28c3af6fae10cf5c61df387dc689b",
            "chain_ord_pos":1.0,
            "commit_datetime":"04\/27\/2022, 10:26:44",
            "message":"Prohibit prototype pollution",
            "author":"dfahlander",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
            "files":"{'src\/functions\/utils.ts': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/dexie\/Dexie.js\/raw\/1d655a69b9f28c3af6fae10cf5c61df387dc689b\/src%2Ffunctions%2Futils.ts', 'patch': '@@ -151,7 +151,7 @@ export function setByKeyPath(obj, keyPath, value) {\\n                 } else obj[currentKeyPath] = value;\\n             else {\\n                 var innerObj = obj[currentKeyPath];\\n-                if (!innerObj) innerObj = (obj[currentKeyPath] = {});\\n+                if (!innerObj || !hasOwn(obj, currentKeyPath)) innerObj = (obj[currentKeyPath] = {});\\n                 setByKeyPath(innerObj, remainingKeyPath, value);\\n             }\\n         } else {'}}",
            "message_norm":"prohibit prototype pollution",
            "language":"en",
            "entities":"[('prototype pollution', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/functions\/utils.ts'])",
            "num_files":1.0,
            "patch_content":"From 1d655a69b9f28c3af6fae10cf5c61df387dc689b Mon Sep 17 00:00:00 2001\nFrom: dfahlander <david.fahlander@gmail.com>\nDate: Wed, 27 Apr 2022 12:26:44 +0200\nSubject: [PATCH] Prohibit prototype pollution\n\n---\n src\/functions\/utils.ts | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/functions\/utils.ts b\/src\/functions\/utils.ts\nindex da97860c1..8485c9330 100644\n--- a\/src\/functions\/utils.ts\n+++ b\/src\/functions\/utils.ts\n@@ -151,7 +151,7 @@ export function setByKeyPath(obj, keyPath, value) {\n                 } else obj[currentKeyPath] = value;\n             else {\n                 var innerObj = obj[currentKeyPath];\n-                if (!innerObj) innerObj = (obj[currentKeyPath] = {});\n+                if (!innerObj || !hasOwn(obj, currentKeyPath)) innerObj = (obj[currentKeyPath] = {});\n                 setByKeyPath(innerObj, remainingKeyPath, value);\n             }\n         } else {"
        },
        {
            "index":587,
            "vuln_id":"GHSA-rv87-vcv4-fjvr",
            "cwe_id":"{'CWE-918'}",
            "score":6.5,
            "chain":"{'https:\/\/github.com\/jenkinsci\/urltrigger-plugin\/commit\/aec43e370550b26636aa9cab0f23a5cbcffdc44f', 'https:\/\/github.com\/jenkinsci\/urltrigger-plugin\/commit\/46220e69c220bacf8eb23911c8feba9dd68d1a26'}",
            "dataset":"osv",
            "summary":"URLTrigger Plugin server-side request forgery vulnerability A server-side request forgery vulnerability exists in Jenkins URLTrigger Plugin 0.41 and earlier in URLTrigger.java that allows attackers with Overall\/Read access to cause Jenkins to send a GET request to a specified URL. As of version 0.43, this form validation method no longer connects to a user provided URL.",
            "published_date":"2022-05-14",
            "chain_len":2,
            "project":"https:\/\/github.com\/jenkinsci\/urltrigger-plugin",
            "commit_href":"https:\/\/github.com\/jenkinsci\/urltrigger-plugin\/commit\/aec43e370550b26636aa9cab0f23a5cbcffdc44f",
            "commit_sha":"aec43e370550b26636aa9cab0f23a5cbcffdc44f",
            "patch":"MULTI",
            "chain_ord":"['46220e69c220bacf8eb23911c8feba9dd68d1a26', 'aec43e370550b26636aa9cab0f23a5cbcffdc44f']",
            "before_first_fix_commit":"{'46220e69c220bacf8eb23911c8feba9dd68d1a26'}",
            "last_fix_commit":"aec43e370550b26636aa9cab0f23a5cbcffdc44f",
            "chain_ord_pos":2.0,
            "commit_datetime":"05\/29\/2018, 21:33:01",
            "message":"Given that the URL is polled, may be valid at poll-time but not at\nconfiguration-time and may contain environment variables that could\nchange the URL at poll-time, validating it during configuration is\npointless.",
            "author":"Tony Noble",
            "comments":null,
            "stats":"{'additions': 2, 'deletions': 15, 'total': 17}",
            "files":"{'src\/main\/java\/org\/jenkinsci\/plugins\/urltrigger\/URLTrigger.java': {'additions': 2, 'deletions': 15, 'changes': 17, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jenkinsci\/urltrigger-plugin\/raw\/aec43e370550b26636aa9cab0f23a5cbcffdc44f\/src%2Fmain%2Fjava%2Forg%2Fjenkinsci%2Fplugins%2Furltrigger%2FURLTrigger.java', 'patch': '@@ -743,21 +743,8 @@ public FormValidation doCheckURL(@QueryParameter String value) {\\n             if ( value.contains( \"$\" ) ) {\\n             \\treturn FormValidation.warning( \"URL is parameterised and cannot be fully validated\" ) ;\\n             }\\n-\\n-            try {\\n-                URI uri = new URI(value);\\n-                if (uri.getScheme().equals(\"ftp\")) {\\n-                    FTPClient ftpClient = getFTPClientObject(value, null, null);\\n-                    ftpClient.getModificationTime(uri.getPath());\\n-                } else {\\n-                    ClientConfig cc = new DefaultClientConfig();\\n-                    Client client = Client.create(cc);\\n-                    client.resource(value).get(ClientResponse.class);\\n-                }\\n-                return FormValidation.ok();\\n-            } catch (Exception e) {\\n-                return FormValidation.error(e.getMessage());\\n-            }\\n+            \\n+            return FormValidation.ok();\\n         }\\n \\n         public FormValidation doCheckTimeout(@QueryParameter String value) {'}}",
            "message_norm":"given that the url is polled, may be valid at poll-time but not at\nconfiguration-time and may contain environment variables that could\nchange the url at poll-time, validating it during configuration is\npointless.",
            "language":"en",
            "entities":"[('change', 'ACTION', ''), ('validating', 'ACTION', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['src\/main\/java\/org\/jenkinsci\/plugins\/urltrigger\/URLTrigger.java'])",
            "num_files":1.0,
            "patch_content":"From aec43e370550b26636aa9cab0f23a5cbcffdc44f Mon Sep 17 00:00:00 2001\nFrom: Tony Noble <tony.noble@gmail.com>\nDate: Tue, 29 May 2018 22:33:01 +0100\nSubject: [PATCH] Given that the URL is polled, may be valid at poll-time but\n not at configuration-time and may contain environment variables that could\n change the URL at poll-time, validating it during configuration is pointless.\n\n---\n ...\/plugins\/urltrigger\/URLTrigger.java          | 17 ++---------------\n 1 file changed, 2 insertions(+), 15 deletions(-)\n\ndiff --git a\/src\/main\/java\/org\/jenkinsci\/plugins\/urltrigger\/URLTrigger.java b\/src\/main\/java\/org\/jenkinsci\/plugins\/urltrigger\/URLTrigger.java\nindex 6e18590..90e9b5b 100755\n--- a\/src\/main\/java\/org\/jenkinsci\/plugins\/urltrigger\/URLTrigger.java\n+++ b\/src\/main\/java\/org\/jenkinsci\/plugins\/urltrigger\/URLTrigger.java\n@@ -743,21 +743,8 @@ public FormValidation doCheckURL(@QueryParameter String value) {\n             if ( value.contains( \"$\" ) ) {\n             \treturn FormValidation.warning( \"URL is parameterised and cannot be fully validated\" ) ;\n             }\n-\n-            try {\n-                URI uri = new URI(value);\n-                if (uri.getScheme().equals(\"ftp\")) {\n-                    FTPClient ftpClient = getFTPClientObject(value, null, null);\n-                    ftpClient.getModificationTime(uri.getPath());\n-                } else {\n-                    ClientConfig cc = new DefaultClientConfig();\n-                    Client client = Client.create(cc);\n-                    client.resource(value).get(ClientResponse.class);\n-                }\n-                return FormValidation.ok();\n-            } catch (Exception e) {\n-                return FormValidation.error(e.getMessage());\n-            }\n+            \n+            return FormValidation.ok();\n         }\n \n         public FormValidation doCheckTimeout(@QueryParameter String value) {"
        },
        {
            "index":84,
            "vuln_id":"GHSA-6j89-jhpr-849f",
            "cwe_id":"{'CWE-787'}",
            "score":7.5,
            "chain":"{'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/3fe5e24694729966a157dc613f5586a6c75f1e9b', 'https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/cc871514deeaeaedb5b757c2ca8cd4ab9abccb5d'}",
            "dataset":"osv",
            "summary":"Out-of-bounds write A remote code execution vulnerability exists in the way that the Chakra scripting engine handles objects in memory in Microsoft Edge, aka 'Chakra Scripting Engine Memory Corruption Vulnerability'. This CVE ID is unique from CVE-2019-1308, CVE-2019-1335, CVE-2019-1366.",
            "published_date":"2021-03-29",
            "chain_len":2,
            "project":"https:\/\/github.com\/chakra-core\/ChakraCore",
            "commit_href":"https:\/\/github.com\/chakra-core\/ChakraCore\/commit\/3fe5e24694729966a157dc613f5586a6c75f1e9b",
            "commit_sha":"3fe5e24694729966a157dc613f5586a6c75f1e9b",
            "patch":"MULTI",
            "chain_ord":"['3fe5e24694729966a157dc613f5586a6c75f1e9b', 'cc871514deeaeaedb5b757c2ca8cd4ab9abccb5d']",
            "before_first_fix_commit":"{'7e9a2ee60baa95ceb4f48f522f823c812ca90c80', '5989c6e038d80f92dcd8e10d725cdf45396201bb'}",
            "last_fix_commit":"cc871514deeaeaedb5b757c2ca8cd4ab9abccb5d",
            "chain_ord_pos":1.0,
            "commit_datetime":"09\/03\/2019, 19:26:32",
            "message":"CVE-2019-1307",
            "author":"Paul Leathers",
            "comments":null,
            "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
            "files":"{'lib\/Backend\/GlobOpt.h': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/chakra-core\/ChakraCore\/raw\/3fe5e24694729966a157dc613f5586a6c75f1e9b\/lib%2FBackend%2FGlobOpt.h', 'patch': '@@ -370,6 +370,7 @@ class JsArrayKills\\n             (valueType.IsArrayOrObjectWithArray() &&\\n              (\\n               (killsArraysWithNoMissingValues && valueType.HasNoMissingValues()) ||\\n+              (killsObjectArraysWithNoMissingValues && !valueType.IsArray() && valueType.HasNoMissingValues()) ||\\n               (killsNativeArrays && !valueType.HasVarElements())\\n              )\\n             );'}}",
            "message_norm":"cve-2019-1307",
            "language":"ro",
            "entities":"[('cve-2019-1307', 'VULNID', 'CVE')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/Backend\/GlobOpt.h'])",
            "num_files":1.0,
            "patch_content":"From 3fe5e24694729966a157dc613f5586a6c75f1e9b Mon Sep 17 00:00:00 2001\nFrom: Paul Leathers <pleath@microsoft.com>\nDate: Tue, 3 Sep 2019 12:26:32 -0700\nSubject: [PATCH] CVE-2019-1307\n\n---\n lib\/Backend\/GlobOpt.h | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/lib\/Backend\/GlobOpt.h b\/lib\/Backend\/GlobOpt.h\nindex e141d2c84db..725ac0ea975 100644\n--- a\/lib\/Backend\/GlobOpt.h\n+++ b\/lib\/Backend\/GlobOpt.h\n@@ -370,6 +370,7 @@ class JsArrayKills\n             (valueType.IsArrayOrObjectWithArray() &&\n              (\n               (killsArraysWithNoMissingValues && valueType.HasNoMissingValues()) ||\n+              (killsObjectArraysWithNoMissingValues && !valueType.IsArray() && valueType.HasNoMissingValues()) ||\n               (killsNativeArrays && !valueType.HasVarElements())\n              )\n             );"
        },
        {
            "index":834,
            "vuln_id":"GHSA-6jp6-9rf9-gc66",
            "cwe_id":"{'CWE-79'}",
            "score":5.4,
            "chain":"{'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/9e19a8414337692cc90da2a91c9af5420f2952f1', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/f6753a1a1c63fade6ad418fbda827c6750ab0bda', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/22d577b1f1e88665a88b4569380148030e0f8389'}",
            "dataset":"osv",
            "summary":"Cross-site Scripting in Weblate ### Impact\nDue to improper neutralization, it was possible to perform cross-site scripting via crafted user and language names.\n\n### Patches\n\nThe issues were fixed in the 4.11 release. The following commits are addressing it:\n\n* f6753a1a1c63fade6ad418fbda827c6750ab0bda\n* 9e19a8414337692cc90da2a91c9af5420f2952f1\n* 22d577b1f1e88665a88b4569380148030e0f8389\n\n### Workarounds\n\nYou can look for crafted user and language names to see if you were affected.\n\n### References\n* https:\/\/hackerone.com\/reports\/1486674\n* https:\/\/hackerone.com\/reports\/1486718\n* https:\/\/hackerone.com\/reports\/1485226\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open a topic in [discussions](https:\/\/github.com\/WeblateOrg\/weblate\/discussions)\n* Email us at [care@weblate.org](mailto:care@weblate.org)",
            "published_date":"2022-02-25",
            "chain_len":3,
            "project":"https:\/\/github.com\/WeblateOrg\/weblate",
            "commit_href":"https:\/\/github.com\/WeblateOrg\/weblate\/commit\/9e19a8414337692cc90da2a91c9af5420f2952f1",
            "commit_sha":"9e19a8414337692cc90da2a91c9af5420f2952f1",
            "patch":"MULTI",
            "chain_ord":"['22d577b1f1e88665a88b4569380148030e0f8389', '9e19a8414337692cc90da2a91c9af5420f2952f1', 'f6753a1a1c63fade6ad418fbda827c6750ab0bda']",
            "before_first_fix_commit":"{'572628cef60e9d839b79b2087960b606a5cca4d8'}",
            "last_fix_commit":"f6753a1a1c63fade6ad418fbda827c6750ab0bda",
            "chain_ord_pos":2.0,
            "commit_datetime":"02\/22\/2022, 20:00:41",
            "message":"js: Add missing escaping to username completion\n\nFixes https:\/\/hackerone.com\/reports\/1486674",
            "author":"Michal \u010ciha\u0159",
            "comments":null,
            "stats":"{'additions': 3, 'deletions': 1, 'total': 4}",
            "files":"{'weblate\/static\/loader-bootstrap.js': {'additions': 3, 'deletions': 1, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/WeblateOrg\/weblate\/raw\/9e19a8414337692cc90da2a91c9af5420f2952f1\/weblate%2Fstatic%2Floader-bootstrap.js', 'patch': '@@ -1131,7 +1131,9 @@ $(function () {\\n       return \"\";\\n     },\\n     menuItemTemplate: function (item) {\\n-      return `<a>${item.string}<\/a>`;\\n+      let link = document.createElement(\"a\");\\n+      link.innerText = item.string;\\n+      return link.outerHTML;\\n     },\\n     values: (text, callback) => {\\n       $.ajax({'}}",
            "message_norm":"js: add missing escaping to username completion\n\nfixes https:\/\/hackerone.com\/reports\/1486674",
            "language":"en",
            "entities":"[('add', 'ACTION', ''), ('escaping', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('https:\/\/hackerone.com\/reports\/1486674', 'URL', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['weblate\/static\/loader-bootstrap.js'])",
            "num_files":1.0,
            "patch_content":"From 9e19a8414337692cc90da2a91c9af5420f2952f1 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>\nDate: Tue, 22 Feb 2022 21:00:41 +0100\nSubject: [PATCH] js: Add missing escaping to username completion\n\nFixes https:\/\/hackerone.com\/reports\/1486674\n---\n weblate\/static\/loader-bootstrap.js | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a\/weblate\/static\/loader-bootstrap.js b\/weblate\/static\/loader-bootstrap.js\nindex c0a44c787ead..c7fbdf09a5f8 100644\n--- a\/weblate\/static\/loader-bootstrap.js\n+++ b\/weblate\/static\/loader-bootstrap.js\n@@ -1131,7 +1131,9 @@ $(function () {\n       return \"\";\n     },\n     menuItemTemplate: function (item) {\n-      return `<a>${item.string}<\/a>`;\n+      let link = document.createElement(\"a\");\n+      link.innerText = item.string;\n+      return link.outerHTML;\n     },\n     values: (text, callback) => {\n       $.ajax({"
        },
        {
            "index":132,
            "vuln_id":"GHSA-wc9w-wvq2-ffm9",
            "cwe_id":"{'CWE-918'}",
            "score":5.4,
            "chain":"{'https:\/\/github.com\/grafana\/grafana\/commit\/ba953be95f0302c2ea80d23f1e5f2c1847365192'}",
            "dataset":"osv",
            "summary":"Server Side Request Forgery in Grafana The avatar feature in Grafana 3.0.1 through 7.0.1 has an SSRF Incorrect Access Control issue that allows remote code execution. This vulnerability allows any unauthenticated user\/client to make Grafana send HTTP requests to any URL and return its result to the user\/client. This can be used to gain information about the network that Grafana is running on.",
            "published_date":"2022-02-15",
            "chain_len":1,
            "project":"https:\/\/github.com\/grafana\/grafana",
            "commit_href":"https:\/\/github.com\/grafana\/grafana\/commit\/ba953be95f0302c2ea80d23f1e5f2c1847365192",
            "commit_sha":"ba953be95f0302c2ea80d23f1e5f2c1847365192",
            "patch":"SINGLE",
            "chain_ord":"['ba953be95f0302c2ea80d23f1e5f2c1847365192']",
            "before_first_fix_commit":"{'e5414f44aa2728cce0dbbc7698fddb514fa8193a'}",
            "last_fix_commit":"ba953be95f0302c2ea80d23f1e5f2c1847365192",
            "chain_ord_pos":1.0,
            "commit_datetime":"06\/03\/2020, 13:56:13",
            "message":"Only allow 32 hexadecimal digits for the avatar hash (#25322)\n\n(cherry picked from commit 7a9c0e31eca4958f5fba053cfea9e64a2ea58509)",
            "author":"Marcus Efraimsson",
            "comments":null,
            "stats":"{'additions': 11, 'deletions': 5, 'total': 16}",
            "files":"{'pkg\/api\/avatar\/avatar.go': {'additions': 11, 'deletions': 5, 'changes': 16, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/grafana\/grafana\/raw\/ba953be95f0302c2ea80d23f1e5f2c1847365192\/pkg%2Fapi%2Favatar%2Favatar.go', 'patch': '@@ -15,14 +15,14 @@ import (\\n \\t\"net\/http\"\\n \\t\"net\/url\"\\n \\t\"path\/filepath\"\\n+\\t\"regexp\"\\n \\t\"strconv\"\\n-\\t\"strings\"\\n \\t\"sync\"\\n \\t\"time\"\\n \\n \\t\"github.com\/grafana\/grafana\/pkg\/infra\/log\"\\n+\\t\"github.com\/grafana\/grafana\/pkg\/models\"\\n \\t\"github.com\/grafana\/grafana\/pkg\/setting\"\\n-\\t\"gopkg.in\/macaron.v1\"\\n \\n \\tgocache \"github.com\/patrickmn\/go-cache\"\\n )\\n@@ -73,9 +73,15 @@ type CacheServer struct {\\n \\tcache    *gocache.Cache\\n }\\n \\n-func (this *CacheServer) Handler(ctx *macaron.Context) {\\n-\\turlPath := ctx.Req.URL.Path\\n-\\thash := urlPath[strings.LastIndex(urlPath, \"\/\")+1:]\\n+var validMD5 = regexp.MustCompile(\"^[a-fA-F0-9]{32}$\")\\n+\\n+func (this *CacheServer) Handler(ctx *models.ReqContext) {\\n+\\thash := ctx.Params(\"hash\")\\n+\\n+\\tif len(hash) != 32 || !validMD5.MatchString(hash) {\\n+\\t\\tctx.JsonApiErr(404, \"Avatar not found\", nil)\\n+\\t\\treturn\\n+\\t}\\n \\n \\tvar avatar *Avatar\\n \\tobj, exists := this.cache.Get(hash)'}}",
            "message_norm":"only allow 32 hexadecimal digits for the avatar hash (#25322)\n\n(cherry picked from commit 7a9c0e31eca4958f5fba053cfea9e64a2ea58509)",
            "language":"en",
            "entities":"[('hash', 'SECWORD', ''), ('#25322', 'ISSUE', ''), ('commit 7a9c0e31eca4958f5fba053cfea9e64a2ea58509', 'SHA', 'prefix_colon_sha')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['pkg\/api\/avatar\/avatar.go'])",
            "num_files":1.0,
            "patch_content":"From ba953be95f0302c2ea80d23f1e5f2c1847365192 Mon Sep 17 00:00:00 2001\nFrom: Marcus Efraimsson <marcus.efraimsson@gmail.com>\nDate: Wed, 3 Jun 2020 15:56:13 +0200\nSubject: [PATCH] Only allow 32 hexadecimal digits for the avatar hash (#25322)\n\n(cherry picked from commit 7a9c0e31eca4958f5fba053cfea9e64a2ea58509)\n---\n pkg\/api\/avatar\/avatar.go | 16 +++++++++++-----\n 1 file changed, 11 insertions(+), 5 deletions(-)\n\ndiff --git a\/pkg\/api\/avatar\/avatar.go b\/pkg\/api\/avatar\/avatar.go\nindex d2d33df144bb..6768f9807ccf 100644\n--- a\/pkg\/api\/avatar\/avatar.go\n+++ b\/pkg\/api\/avatar\/avatar.go\n@@ -15,14 +15,14 @@ import (\n \t\"net\/http\"\n \t\"net\/url\"\n \t\"path\/filepath\"\n+\t\"regexp\"\n \t\"strconv\"\n-\t\"strings\"\n \t\"sync\"\n \t\"time\"\n \n \t\"github.com\/grafana\/grafana\/pkg\/infra\/log\"\n+\t\"github.com\/grafana\/grafana\/pkg\/models\"\n \t\"github.com\/grafana\/grafana\/pkg\/setting\"\n-\t\"gopkg.in\/macaron.v1\"\n \n \tgocache \"github.com\/patrickmn\/go-cache\"\n )\n@@ -73,9 +73,15 @@ type CacheServer struct {\n \tcache    *gocache.Cache\n }\n \n-func (this *CacheServer) Handler(ctx *macaron.Context) {\n-\turlPath := ctx.Req.URL.Path\n-\thash := urlPath[strings.LastIndex(urlPath, \"\/\")+1:]\n+var validMD5 = regexp.MustCompile(\"^[a-fA-F0-9]{32}$\")\n+\n+func (this *CacheServer) Handler(ctx *models.ReqContext) {\n+\thash := ctx.Params(\"hash\")\n+\n+\tif len(hash) != 32 || !validMD5.MatchString(hash) {\n+\t\tctx.JsonApiErr(404, \"Avatar not found\", nil)\n+\t\treturn\n+\t}\n \n \tvar avatar *Avatar\n \tobj, exists := this.cache.Get(hash)"
        },
        {
            "index":344,
            "vuln_id":"GHSA-v222-6mr4-qj29",
            "cwe_id":"{'CWE-78'}",
            "score":10.0,
            "chain":"{'https:\/\/github.com\/jirutka\/asciidoctor-include-ext\/commit\/cbaccf3de533cbca224bf61d0b74e4b84d41d8ee', 'https:\/\/github.com\/jirutka\/asciidoctor-include-ext\/commit\/c7ea001a597c7033575342c51483dab7b87ae155'}",
            "dataset":"osv",
            "summary":"Command Injection vulnerability in asciidoctor-include-ext ### Impact\n\nApplications using [Asciidoctor (Ruby)](https:\/\/github.com\/asciidoctor\/asciidoctor) with [asciidoctor-include-ext](https:\/\/github.com\/jirutka\/asciidoctor-include-ext) (prior to version 0.4.0), which render user-supplied input in AsciiDoc markup, may allow an attacker to execute arbitrary system commands on the host operating system. ~~This attack is possible even when `allow-uri-read` is disabled!~~ (EDIT: it\u2019s not)\n\n\n### Patches\n\nThe vulnerability has been fixed in commit c7ea001 (and further improved in cbaccf3), which is included in version [0.4.0](https:\/\/rubygems.org\/gems\/asciidoctor-include-ext\/versions\/0.4.0).\n\n### Workarounds\n\n```rb\nrequire 'asciidoctor\/include_ext'\n\nclass Asciidoctor::IncludeExt::IncludeProcessor\n  # Overrides superclass private method to mitigate Command Injection\n  # vulnerability in asciidoctor-include-ext <0.4.0.\n  def target_uri?(target)\n    target.downcase.start_with?('http:\/\/', 'https:\/\/') \\\n      && URI.parse(target).is_a?(URI::HTTP)\n  rescue URI::InvalidURIError\n    false\n  end\nend\n```\n\n### References\n\n* https:\/\/sakurity.com\/blog\/2015\/02\/28\/openuri.html\n\n### Credits\n\nThis vulnerability was discovered by Joern Schneeweisz from the GitLab Security Research Team.\n\n\n### For more information\n\nSee commit message c7ea001.\n\nIf you have any questions or comments about this advisory open an issue in [jirutka\/asciidoctor-include-ext](https:\/\/github.com\/jirutka\/asciidoctor-include-ext\/issues\/).",
            "published_date":"2022-03-31",
            "chain_len":2,
            "project":"https:\/\/github.com\/jirutka\/asciidoctor-include-ext",
            "commit_href":"https:\/\/github.com\/jirutka\/asciidoctor-include-ext\/commit\/cbaccf3de533cbca224bf61d0b74e4b84d41d8ee",
            "commit_sha":"cbaccf3de533cbca224bf61d0b74e4b84d41d8ee",
            "patch":"MULTI",
            "chain_ord":"['c7ea001a597c7033575342c51483dab7b87ae155', 'cbaccf3de533cbca224bf61d0b74e4b84d41d8ee']",
            "before_first_fix_commit":"{'c7ea001a597c7033575342c51483dab7b87ae155'}",
            "last_fix_commit":"cbaccf3de533cbca224bf61d0b74e4b84d41d8ee",
            "chain_ord_pos":2.0,
            "commit_datetime":"03\/29\/2022, 22:50:30",
            "message":"Make #read_lines code more robust, avoid using IO.open directly",
            "author":"Jakub Jirutka",
            "comments":null,
            "stats":"{'additions': 10, 'deletions': 4, 'total': 14}",
            "files":"{'lib\/asciidoctor\/include_ext\/include_processor.rb': {'additions': 10, 'deletions': 4, 'changes': 14, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jirutka\/asciidoctor-include-ext\/raw\/cbaccf3de533cbca224bf61d0b74e4b84d41d8ee\/lib%2Fasciidoctor%2Finclude_ext%2Finclude_processor.rb', 'patch': \"@@ -113,10 +113,16 @@ def resolve_target_path(target, reader)\\n     #   the line number. If `nil` is given, all lines are passed.\\n     # @return [Array<String>] an array of read lines.\\n     def read_lines(path, selector)\\n-      if selector\\n-        IO.foreach(path).select.with_index(1, &selector)\\n-      else\\n-        URI.open(path, &:read)\\n+      # IO.open is deliberately not used directly to avoid potential security risks.\\n+      # TODO: Get rid of 'open-uri' (URI.open).\\n+      io = target_http?(path) ? URI : File\\n+\\n+      io.open(path) do |f|\\n+        if selector\\n+          f.each.select.with_index(1, &selector)\\n+        else\\n+          f.read\\n+        end\\n       end\\n     end\"}}",
            "message_norm":"make #read_lines code more robust, avoid using io.open directly",
            "language":"en",
            "entities":null,
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['lib\/asciidoctor\/include_ext\/include_processor.rb'])",
            "num_files":1.0,
            "patch_content":"From cbaccf3de533cbca224bf61d0b74e4b84d41d8ee Mon Sep 17 00:00:00 2001\nFrom: Jakub Jirutka <jakub@jirutka.cz>\nDate: Wed, 30 Mar 2022 00:50:30 +0200\nSubject: [PATCH] Make #read_lines code more robust, avoid using IO.open\n directly\n\n---\n lib\/asciidoctor\/include_ext\/include_processor.rb | 14 ++++++++++----\n 1 file changed, 10 insertions(+), 4 deletions(-)\n\ndiff --git a\/lib\/asciidoctor\/include_ext\/include_processor.rb b\/lib\/asciidoctor\/include_ext\/include_processor.rb\nindex 5bd52d0..c2723d0 100644\n--- a\/lib\/asciidoctor\/include_ext\/include_processor.rb\n+++ b\/lib\/asciidoctor\/include_ext\/include_processor.rb\n@@ -113,10 +113,16 @@ def resolve_target_path(target, reader)\n     #   the line number. If `nil` is given, all lines are passed.\n     # @return [Array<String>] an array of read lines.\n     def read_lines(path, selector)\n-      if selector\n-        IO.foreach(path).select.with_index(1, &selector)\n-      else\n-        URI.open(path, &:read)\n+      # IO.open is deliberately not used directly to avoid potential security risks.\n+      # TODO: Get rid of 'open-uri' (URI.open).\n+      io = target_http?(path) ? URI : File\n+\n+      io.open(path) do |f|\n+        if selector\n+          f.each.select.with_index(1, &selector)\n+        else\n+          f.read\n+        end\n       end\n     end"
        },
        {
            "index":925,
            "vuln_id":"GHSA-m4hj-wg2r-qpcr",
            "cwe_id":"{'CWE-352'}",
            "score":4.3,
            "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/67093c879a6563aa6ee08003177777d1975e2351'}",
            "dataset":"osv",
            "summary":"showdoc is vulnerable to Cross-Site Request Forgery (CSRF) showdoc is vulnerable to Cross-Site Request Forgery (CSRF).",
            "published_date":"2021-11-15",
            "chain_len":1,
            "project":"https:\/\/github.com\/star7th\/showdoc",
            "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/67093c879a6563aa6ee08003177777d1975e2351",
            "commit_sha":"67093c879a6563aa6ee08003177777d1975e2351",
            "patch":"SINGLE",
            "chain_ord":"['67093c879a6563aa6ee08003177777d1975e2351']",
            "before_first_fix_commit":"{'7e6b547ac23be296f0a6066382eb1fd389af0439'}",
            "last_fix_commit":"67093c879a6563aa6ee08003177777d1975e2351",
            "chain_ord_pos":1.0,
            "commit_datetime":"10\/19\/2021, 14:19:10",
            "message":"Strict cookie",
            "author":"star7th",
            "comments":null,
            "stats":"{'additions': 16, 'deletions': 5, 'total': 21}",
            "files":"{'server\/Application\/Api\/Controller\/UserController.class.php': {'additions': 16, 'deletions': 5, 'changes': 21, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/67093c879a6563aa6ee08003177777d1975e2351\/server%2FApplication%2FApi%2FController%2FUserController.class.php', 'patch': '@@ -42,8 +42,12 @@ public function register(){\\n                     unset($ret[\\'password\\']);\\n                     session(\"login_user\" , $ret );\\n                     $token = D(\"UserToken\")->createToken($ret[\\'uid\\']);\\n-                    cookie(\\'cookie_token\\',$token,array(\\'expire\\'=>60*60*24*90,\\'httponly\\'=>\\'httponly\\'));\/\/\u6b64\u5904\u7531\u670d\u52a1\u7aef\u63a7\u5236token\u662f\u5426\u8fc7\u671f\uff0c\u6240\u4ee5cookies\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u591a\u4e45\u90fd\u65e0\u6240\u8c13\\n-                  $this->sendResult(array(\\n+                    if(version_compare(PHP_VERSION,\\'7.3.0\\',\\'>\\')){\\n+                        setcookie(\\'cookie_token\\',$token,array(\\'expires\\'=>time()+60*60*24*180,\\'httponly\\'=>\\'httponly\\',\\'samesite\\' => \\'Strict\\',\\'path\\'=>\\'\/\\'));\\n+                      }else{\\n+                        cookie(\\'cookie_token\\',$token,array(\\'expire\\'=>60*60*24*180,\\'httponly\\'=>\\'httponly\\'));\\n+                    }\\n+                    $this->sendResult(array(\\n                     \"uid\" => $ret[\\'uid\\'] ,\\n                     \"username\" => $ret[\\'username\\'] ,\\n                     \"name\" => $ret[\\'name\\'] ,\\n@@ -134,7 +138,11 @@ public function login(){\\n           session(\"login_user\" , $ret );\\n           D(\"User\")->setLastTime($ret[\\'uid\\']);\\n           $token = D(\"UserToken\")->createToken($ret[\\'uid\\'],60*60*24*180);\\n-          cookie(\\'cookie_token\\',$token,array(\\'expire\\'=>60*60*24*180,\\'httponly\\'=>\\'httponly\\'));\/\/\u6b64\u5904\u7531\u670d\u52a1\u7aef\u63a7\u5236token\u662f\u5426\u8fc7\u671f\uff0c\u6240\u4ee5cookies\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u591a\u4e45\u90fd\u65e0\u6240\u8c13\\n+          if(version_compare(PHP_VERSION,\\'7.3.0\\',\\'>\\')){\\n+            setcookie(\\'cookie_token\\',$token,array(\\'expires\\'=>time()+60*60*24*180,\\'httponly\\'=>\\'httponly\\',\\'samesite\\' => \\'Strict\\',\\'path\\'=>\\'\/\\'));\\n+          }else{\\n+            cookie(\\'cookie_token\\',$token,array(\\'expire\\'=>60*60*24*180,\\'httponly\\'=>\\'httponly\\'));\\n+          }\\n           $this->sendResult(array(\\n             \"uid\" => $ret[\\'uid\\'] ,\\n             \"username\" => $ret[\\'username\\'] ,\\n@@ -247,8 +255,11 @@ public function registerByVerify(){\\n                     unset($ret[\\'password\\']);\\n                     session(\"login_user\" , $ret );\\n                     $token = D(\"UserToken\")->createToken($ret[\\'uid\\']);\\n-                    cookie(\\'cookie_token\\',$token,array(\\'expire\\'=>60*60*24*90,\\'httponly\\'=>\\'httponly\\'));\/\/\u6b64\u5904\u7531\u670d\u52a1\u7aef\u63a7\u5236token\u662f\u5426\u8fc7\u671f\uff0c\u6240\u4ee5cookies\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u591a\u4e45\u90fd\u65e0\u6240\u8c13\\n-                    \\n+                    if(version_compare(PHP_VERSION,\\'7.3.0\\',\\'>\\')){\\n+                        setcookie(\\'cookie_token\\',$token,array(\\'expires\\'=>time()+60*60*24*180,\\'httponly\\'=>\\'httponly\\',\\'samesite\\' => \\'Strict\\',\\'path\\'=>\\'\/\\'));\\n+                      }else{\\n+                        cookie(\\'cookie_token\\',$token,array(\\'expire\\'=>60*60*24*180,\\'httponly\\'=>\\'httponly\\'));\\n+                    }                    \\n                     $this->sendResult(array(\\n                         \"uid\" => $ret[\\'uid\\'] ,\\n                         \"username\" => $ret[\\'username\\'] ,'}}",
            "message_norm":"strict cookie",
            "language":"en",
            "entities":"[('cookie', 'SECWORD', '')]",
            "classification_level_1":null,
            "classification_level_2":null,
            "list_files":"dict_keys(['server\/Application\/Api\/Controller\/UserController.class.php'])",
            "num_files":1.0,
            "patch_content":"From 67093c879a6563aa6ee08003177777d1975e2351 Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Tue, 19 Oct 2021 22:19:10 +0800\nSubject: [PATCH] Strict cookie\n\n---\n ...\/Api\/Controller\/UserController.class.php   | 21 ++++++++++++++-----\n 1 file changed, 16 insertions(+), 5 deletions(-)\n\ndiff --git a\/server\/Application\/Api\/Controller\/UserController.class.php b\/server\/Application\/Api\/Controller\/UserController.class.php\nindex f72f6539c..92ef92b11 100644\n--- a\/server\/Application\/Api\/Controller\/UserController.class.php\n+++ b\/server\/Application\/Api\/Controller\/UserController.class.php\n@@ -42,8 +42,12 @@ public function register(){\n                     unset($ret['password']);\n                     session(\"login_user\" , $ret );\n                     $token = D(\"UserToken\")->createToken($ret['uid']);\n-                    cookie('cookie_token',$token,array('expire'=>60*60*24*90,'httponly'=>'httponly'));\/\/\u6b64\u5904\u7531\u670d\u52a1\u7aef\u63a7\u5236token\u662f\u5426\u8fc7\u671f\uff0c\u6240\u4ee5cookies\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u591a\u4e45\u90fd\u65e0\u6240\u8c13\n-                  $this->sendResult(array(\n+                    if(version_compare(PHP_VERSION,'7.3.0','>')){\n+                        setcookie('cookie_token',$token,array('expires'=>time()+60*60*24*180,'httponly'=>'httponly','samesite' => 'Strict','path'=>'\/'));\n+                      }else{\n+                        cookie('cookie_token',$token,array('expire'=>60*60*24*180,'httponly'=>'httponly'));\n+                    }\n+                    $this->sendResult(array(\n                     \"uid\" => $ret['uid'] ,\n                     \"username\" => $ret['username'] ,\n                     \"name\" => $ret['name'] ,\n@@ -134,7 +138,11 @@ public function login(){\n           session(\"login_user\" , $ret );\n           D(\"User\")->setLastTime($ret['uid']);\n           $token = D(\"UserToken\")->createToken($ret['uid'],60*60*24*180);\n-          cookie('cookie_token',$token,array('expire'=>60*60*24*180,'httponly'=>'httponly'));\/\/\u6b64\u5904\u7531\u670d\u52a1\u7aef\u63a7\u5236token\u662f\u5426\u8fc7\u671f\uff0c\u6240\u4ee5cookies\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u591a\u4e45\u90fd\u65e0\u6240\u8c13\n+          if(version_compare(PHP_VERSION,'7.3.0','>')){\n+            setcookie('cookie_token',$token,array('expires'=>time()+60*60*24*180,'httponly'=>'httponly','samesite' => 'Strict','path'=>'\/'));\n+          }else{\n+            cookie('cookie_token',$token,array('expire'=>60*60*24*180,'httponly'=>'httponly'));\n+          }\n           $this->sendResult(array(\n             \"uid\" => $ret['uid'] ,\n             \"username\" => $ret['username'] ,\n@@ -247,8 +255,11 @@ public function registerByVerify(){\n                     unset($ret['password']);\n                     session(\"login_user\" , $ret );\n                     $token = D(\"UserToken\")->createToken($ret['uid']);\n-                    cookie('cookie_token',$token,array('expire'=>60*60*24*90,'httponly'=>'httponly'));\/\/\u6b64\u5904\u7531\u670d\u52a1\u7aef\u63a7\u5236token\u662f\u5426\u8fc7\u671f\uff0c\u6240\u4ee5cookies\u8fc7\u671f\u65f6\u95f4\u8bbe\u7f6e\u591a\u4e45\u90fd\u65e0\u6240\u8c13\n-                    \n+                    if(version_compare(PHP_VERSION,'7.3.0','>')){\n+                        setcookie('cookie_token',$token,array('expires'=>time()+60*60*24*180,'httponly'=>'httponly','samesite' => 'Strict','path'=>'\/'));\n+                      }else{\n+                        cookie('cookie_token',$token,array('expire'=>60*60*24*180,'httponly'=>'httponly'));\n+                    }                    \n                     $this->sendResult(array(\n                         \"uid\" => $ret['uid'] ,\n                         \"username\" => $ret['username'] ,"
        }
    ]
}