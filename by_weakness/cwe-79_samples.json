{
  "schema":{
    "fields":[
      {
        "name":"index",
        "type":"integer"
      },
      {
        "name":"vuln_id",
        "type":"string"
      },
      {
        "name":"cwe_id",
        "type":"string"
      },
      {
        "name":"score",
        "type":"number"
      },
      {
        "name":"chain",
        "type":"string"
      },
      {
        "name":"dataset",
        "type":"string"
      },
      {
        "name":"summary",
        "type":"string"
      },
      {
        "name":"published_date",
        "type":"string"
      },
      {
        "name":"chain_len",
        "type":"integer"
      },
      {
        "name":"project",
        "type":"string"
      },
      {
        "name":"commit_href",
        "type":"string"
      },
      {
        "name":"commit_sha",
        "type":"string"
      },
      {
        "name":"patch",
        "type":"string"
      },
      {
        "name":"chain_ord",
        "type":"string"
      },
      {
        "name":"before_first_fix_commit",
        "type":"string"
      },
      {
        "name":"last_fix_commit",
        "type":"string"
      },
      {
        "name":"chain_ord_pos",
        "type":"number"
      },
      {
        "name":"commit_datetime",
        "type":"string"
      },
      {
        "name":"message",
        "type":"string"
      },
      {
        "name":"author",
        "type":"string"
      },
      {
        "name":"comments",
        "type":"string"
      },
      {
        "name":"stats",
        "type":"string"
      },
      {
        "name":"files",
        "type":"string"
      },
      {
        "name":"message_norm",
        "type":"string"
      },
      {
        "name":"language",
        "type":"string"
      },
      {
        "name":"entities",
        "type":"string"
      },
      {
        "name":"classification_level_1",
        "type":"string"
      },
      {
        "name":"classification_level_2",
        "type":"string"
      },
      {
        "name":"list_files",
        "type":"string"
      },
      {
        "name":"num_files",
        "type":"number"
      },
      {
        "name":"patch_content",
        "type":"string"
      },
      {
        "name":"code_diff",
        "type":"string"
      }
    ],
    "primaryKey":[
      "index"
    ],
    "pandas_version":"1.4.0"
  },
  "data":[
    {
      "index":0,
      "vuln_id":"GHSA-wcm2-9c89-wmfm",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/jquery\/jquery-ui\/commit\/7e9060c109b928769a664dbcc2c17bd21231b6f3'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in jquery-ui Cross-site scripting (XSS) vulnerability in jquery.ui.dialog.js in the Dialog widget in jQuery UI before 1.10.0 allows remote attackers to inject arbitrary web script or HTML via the title option.",
      "published_date":"2017-10-24",
      "chain_len":1,
      "project":"https:\/\/github.com\/jquery\/jquery-ui",
      "commit_href":"https:\/\/github.com\/jquery\/jquery-ui\/commit\/7e9060c109b928769a664dbcc2c17bd21231b6f3",
      "commit_sha":"7e9060c109b928769a664dbcc2c17bd21231b6f3",
      "patch":"SINGLE",
      "chain_ord":"['7e9060c109b928769a664dbcc2c17bd21231b6f3']",
      "before_first_fix_commit":"{'60486ac632a0a1bbbb0c7449fe17bccfae11af80'}",
      "last_fix_commit":"7e9060c109b928769a664dbcc2c17bd21231b6f3",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/26\/2012, 09:14:36",
      "message":"Dialog: Extract setting the title into a _title method, use .text() to prevent XSS. Fixes #6016 - Dialog: Title XSS Vulnerability.",
      "author":"J\u00f6rn Zaefferer",
      "comments":null,
      "stats":"{'additions': 9, 'deletions': 4, 'total': 13}",
      "files":"{'ui\/jquery.ui.dialog.js': {'additions': 9, 'deletions': 4, 'changes': 13, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jquery\/jquery-ui\/raw\/7e9060c109b928769a664dbcc2c17bd21231b6f3\/ui%2Fjquery.ui.dialog.js', 'patch': '@@ -352,14 +352,21 @@ $.widget(\"ui.dialog\", {\\n \\t\\tuiDialogTitle = $( \"<span>\" )\\n \\t\\t\\t.uniqueId()\\n \\t\\t\\t.addClass( \"ui-dialog-title\" )\\n-\\t\\t\\t.html( this.options.title || \"&#160;\" )\\n \\t\\t\\t.prependTo( this.uiDialogTitlebar );\\n+\\t\\tthis._title( uiDialogTitle );\\n \\n \\t\\tthis.uiDialog.attr({\\n \\t\\t\\t\"aria-labelledby\": uiDialogTitle.attr( \"id\" )\\n \\t\\t});\\n \\t},\\n \\n+\\t_title: function( title ) {\\n+\\t\\tif ( !this.options.title ) {\\n+\\t\\t\\ttitle.html( \"&#160;\" );\\n+\\t\\t}\\n+\\t\\ttitle.text( this.options.title );\\n+\\t},\\n+\\n \\t_createButtonPane: function() {\\n \\t\\tvar uiDialogButtonPane = ( this.uiDialogButtonPane = $( \"<div>\" ) )\\n \\t\\t\\t.addClass( \"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\" );\\n@@ -600,9 +607,7 @@ $.widget(\"ui.dialog\", {\\n \\t\\t}\\n \\n \\t\\tif ( key === \"title\" ) {\\n-\\t\\t\\t\/\/ convert whatever was passed in to a string, for html() to not throw up\\n-\\t\\t\\t$( \".ui-dialog-title\", this.uiDialogTitlebar )\\n-\\t\\t\\t\\t.html( \"\" + ( value || \"&#160;\" ) );\\n+\\t\\t\\tthis._title( this.uiDialogTitlebar.find( \".ui-dialog-title\" ) );\\n \\t\\t}\\n \\t},'}}",
      "message_norm":"dialog: extract setting the title into a _title method, use .text() to prevent xss. fixes #6016 - dialog: title xss vulnerability.",
      "language":"en",
      "entities":"[('prevent', 'ACTION', ''), ('xss', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('#6016', 'ISSUE', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['ui\/jquery.ui.dialog.js'])",
      "num_files":1.0,
      "patch_content":"From 7e9060c109b928769a664dbcc2c17bd21231b6f3 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?J=C3=B6rn=20Zaefferer?= <joern.zaefferer@gmail.com>\nDate: Mon, 26 Nov 2012 10:14:36 +0100\nSubject: [PATCH] Dialog: Extract setting the title into a _title method, use\n .text() to prevent XSS. Fixes #6016 - Dialog: Title XSS Vulnerability.\n\n---\n ui\/jquery.ui.dialog.js | 13 +++++++++----\n 1 file changed, 9 insertions(+), 4 deletions(-)\n\ndiff --git a\/ui\/jquery.ui.dialog.js b\/ui\/jquery.ui.dialog.js\nindex 5eb3e2aca82..808d31d5b2b 100644\n--- a\/ui\/jquery.ui.dialog.js\n+++ b\/ui\/jquery.ui.dialog.js\n@@ -352,14 +352,21 @@ $.widget(\"ui.dialog\", {\n \t\tuiDialogTitle = $( \"<span>\" )\n \t\t\t.uniqueId()\n \t\t\t.addClass( \"ui-dialog-title\" )\n-\t\t\t.html( this.options.title || \"&#160;\" )\n \t\t\t.prependTo( this.uiDialogTitlebar );\n+\t\tthis._title( uiDialogTitle );\n \n \t\tthis.uiDialog.attr({\n \t\t\t\"aria-labelledby\": uiDialogTitle.attr( \"id\" )\n \t\t});\n \t},\n \n+\t_title: function( title ) {\n+\t\tif ( !this.options.title ) {\n+\t\t\ttitle.html( \"&#160;\" );\n+\t\t}\n+\t\ttitle.text( this.options.title );\n+\t},\n+\n \t_createButtonPane: function() {\n \t\tvar uiDialogButtonPane = ( this.uiDialogButtonPane = $( \"<div>\" ) )\n \t\t\t.addClass( \"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\" );\n@@ -600,9 +607,7 @@ $.widget(\"ui.dialog\", {\n \t\t}\n \n \t\tif ( key === \"title\" ) {\n-\t\t\t\/\/ convert whatever was passed in to a string, for html() to not throw up\n-\t\t\t$( \".ui-dialog-title\", this.uiDialogTitlebar )\n-\t\t\t\t.html( \"\" + ( value || \"&#160;\" ) );\n+\t\t\tthis._title( this.uiDialogTitlebar.find( \".ui-dialog-title\" ) );\n \t\t}\n \t},",
      "code_diff":"@@ -352,14 +352,21 @@ $.widget(\"ui.dialog\", {\n \t\tuiDialogTitle = $( \"<span>\" )\n \t\t\t.uniqueId()\n \t\t\t.addClass( \"ui-dialog-title\" )\n-\t\t\t.html( this.options.title || \"&#160;\" )\n \t\t\t.prependTo( this.uiDialogTitlebar );\n+\t\tthis._title( uiDialogTitle );\n \n \t\tthis.uiDialog.attr({\n \t\t\t\"aria-labelledby\": uiDialogTitle.attr( \"id\" )\n \t\t});\n \t},\n \n+\t_title: function( title ) {\n+\t\tif ( !this.options.title ) {\n+\t\t\ttitle.html( \"&#160;\" );\n+\t\t}\n+\t\ttitle.text( this.options.title );\n+\t},\n+\n \t_createButtonPane: function() {\n \t\tvar uiDialogButtonPane = ( this.uiDialogButtonPane = $( \"<div>\" ) )\n \t\t\t.addClass( \"ui-dialog-buttonpane ui-widget-content ui-helper-clearfix\" );\n@@ -600,9 +607,7 @@ $.widget(\"ui.dialog\", {\n \t\t}\n \n \t\tif ( key === \"title\" ) {\n-\t\t\t\/\/ convert whatever was passed in to a string, for html() to not throw up\n-\t\t\t$( \".ui-dialog-title\", this.uiDialogTitlebar )\n-\t\t\t\t.html( \"\" + ( value || \"&#160;\" ) );\n+\t\t\tthis._title( this.uiDialogTitlebar.find( \".ui-dialog-title\" ) );\n \t\t}\n \t},"
    },
    {
      "index":1,
      "vuln_id":"GHSA-q26w-wjj2-22vv",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/laurent22\/joplin\/commit\/fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13'}",
      "dataset":"osv",
      "summary":"Cross-site scripting in Joplin Joplin allows XSS via a LINK element in a note.",
      "published_date":"2021-05-10",
      "chain_len":1,
      "project":"https:\/\/github.com\/laurent22\/joplin",
      "commit_href":"https:\/\/github.com\/laurent22\/joplin\/commit\/fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13",
      "commit_sha":"fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13",
      "patch":"SINGLE",
      "chain_ord":"['fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13']",
      "before_first_fix_commit":"{'4a184721e4e4aa00a39d508cdc1a3ae660d3610e'}",
      "last_fix_commit":"fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/29\/2020, 16:19:56",
      "message":"All: Security: Remove \"link\" and \"meta\" tags from notes to prevent XSS",
      "author":"Laurent Cozic",
      "comments":null,
      "stats":"{'additions': 10, 'deletions': 5, 'total': 15}",
      "files":"{'ReactNativeClient\/lib\/joplin-renderer\/htmlUtils.js': {'additions': 10, 'deletions': 5, 'changes': 15, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/laurent22\/joplin\/raw\/fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13\/ReactNativeClient%2Flib%2Fjoplin-renderer%2FhtmlUtils.js', 'patch': '@@ -87,11 +87,16 @@ class HtmlUtils {\\n \\t\\t\\treturn tagStack[tagStack.length - 1];\\n \\t\\t};\\n \\n-\\t\\t\/\/ The BASE tag allows changing the base URL from which files are loaded, and\\n-\\t\\t\/\/ that can break several plugins, such as Katex (which needs to load CSS\\n-\\t\\t\/\/ files using a relative URL). For that reason it is disabled.\\n-\\t\\t\/\/ More info: https:\/\/github.com\/laurent22\/joplin\/issues\/3021\\n-\\t\\tconst disallowedTags = [\\'script\\', \\'iframe\\', \\'frameset\\', \\'frame\\', \\'object\\', \\'base\\', \\'embed\\'];\\n+\\t\\t\/\/ The BASE tag allows changing the base URL from which files are\\n+\\t\\t\/\/ loaded, and that can break several plugins, such as Katex (which\\n+\\t\\t\/\/ needs to load CSS files using a relative URL). For that reason\\n+\\t\\t\/\/ it is disabled. More info:\\n+\\t\\t\/\/ https:\/\/github.com\/laurent22\/joplin\/issues\/3021\\n+\\t\\t\/\/\\n+\\t\\t\/\/ \"link\" can be used to escape the parser and inject JavaScript.\\n+\\t\\t\/\/ Adding \"meta\" too for the same reason as it shouldn\\'t be used in\\n+\\t\\t\/\/ notes anyway.\\n+\\t\\tconst disallowedTags = [\\'script\\', \\'iframe\\', \\'frameset\\', \\'frame\\', \\'object\\', \\'base\\', \\'embed\\', \\'link\\', \\'meta\\'];\\n \\n \\t\\tconst parser = new htmlparser2.Parser({'}}",
      "message_norm":"all: security: remove \"link\" and \"meta\" tags from notes to prevent xss",
      "language":"en",
      "entities":"[('security', 'SECWORD', ''), ('remove', 'ACTION', ''), ('prevent', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['ReactNativeClient\/lib\/joplin-renderer\/htmlUtils.js'])",
      "num_files":1.0,
      "patch_content":"From fd90a490c0e5cacd17bfe0ffc422be1d2a9b1c13 Mon Sep 17 00:00:00 2001\nFrom: Laurent Cozic <laurent@cozic.net>\nDate: Thu, 29 Oct 2020 16:19:56 +0000\nSubject: [PATCH] All: Security: Remove \"link\" and \"meta\" tags from notes to\n prevent XSS\n\n---\n ...\/lib\/joplin-renderer\/htmlUtils.js              | 15 ++++++++++-----\n 1 file changed, 10 insertions(+), 5 deletions(-)\n\ndiff --git a\/ReactNativeClient\/lib\/joplin-renderer\/htmlUtils.js b\/ReactNativeClient\/lib\/joplin-renderer\/htmlUtils.js\nindex f9af4d97886..a9581f70aae 100644\n--- a\/ReactNativeClient\/lib\/joplin-renderer\/htmlUtils.js\n+++ b\/ReactNativeClient\/lib\/joplin-renderer\/htmlUtils.js\n@@ -87,11 +87,16 @@ class HtmlUtils {\n \t\t\treturn tagStack[tagStack.length - 1];\n \t\t};\n \n-\t\t\/\/ The BASE tag allows changing the base URL from which files are loaded, and\n-\t\t\/\/ that can break several plugins, such as Katex (which needs to load CSS\n-\t\t\/\/ files using a relative URL). For that reason it is disabled.\n-\t\t\/\/ More info: https:\/\/github.com\/laurent22\/joplin\/issues\/3021\n-\t\tconst disallowedTags = ['script', 'iframe', 'frameset', 'frame', 'object', 'base', 'embed'];\n+\t\t\/\/ The BASE tag allows changing the base URL from which files are\n+\t\t\/\/ loaded, and that can break several plugins, such as Katex (which\n+\t\t\/\/ needs to load CSS files using a relative URL). For that reason\n+\t\t\/\/ it is disabled. More info:\n+\t\t\/\/ https:\/\/github.com\/laurent22\/joplin\/issues\/3021\n+\t\t\/\/\n+\t\t\/\/ \"link\" can be used to escape the parser and inject JavaScript.\n+\t\t\/\/ Adding \"meta\" too for the same reason as it shouldn't be used in\n+\t\t\/\/ notes anyway.\n+\t\tconst disallowedTags = ['script', 'iframe', 'frameset', 'frame', 'object', 'base', 'embed', 'link', 'meta'];\n \n \t\tconst parser = new htmlparser2.Parser({",
      "code_diff":"@@ -87,11 +87,16 @@ class HtmlUtils {\n \t\t\treturn tagStack[tagStack.length - 1];\n \t\t};\n \n-\t\t\/\/ The BASE tag allows changing the base URL from which files are loaded, and\n-\t\t\/\/ that can break several plugins, such as Katex (which needs to load CSS\n-\t\t\/\/ files using a relative URL). For that reason it is disabled.\n-\t\t\/\/ More info: https:\/\/github.com\/laurent22\/joplin\/issues\/3021\n-\t\tconst disallowedTags = ['script', 'iframe', 'frameset', 'frame', 'object', 'base', 'embed'];\n+\t\t\/\/ The BASE tag allows changing the base URL from which files are\n+\t\t\/\/ loaded, and that can break several plugins, such as Katex (which\n+\t\t\/\/ needs to load CSS files using a relative URL). For that reason\n+\t\t\/\/ it is disabled. More info:\n+\t\t\/\/ https:\/\/github.com\/laurent22\/joplin\/issues\/3021\n+\t\t\/\/\n+\t\t\/\/ \"link\" can be used to escape the parser and inject JavaScript.\n+\t\t\/\/ Adding \"meta\" too for the same reason as it shouldn't be used in\n+\t\t\/\/ notes anyway.\n+\t\tconst disallowedTags = ['script', 'iframe', 'frameset', 'frame', 'object', 'base', 'embed', 'link', 'meta'];\n \n \t\tconst parser = new htmlparser2.Parser({"
    },
    {
      "index":2,
      "vuln_id":"GHSA-4p8f-mmfj-r45g",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/fatfreecrm\/fat_free_crm\/commit\/6d60bc8ed010c4eda05d6645c64849f415f68d65'}",
      "dataset":"osv",
      "summary":"Cross-site scripting in fat_free_crm Fat Free CRM before 0.18.1 has XSS in the tags_helper in app\/helpers\/tags_helper.rb.",
      "published_date":"2019-08-21",
      "chain_len":1,
      "project":"https:\/\/github.com\/fatfreecrm\/fat_free_crm",
      "commit_href":"https:\/\/github.com\/fatfreecrm\/fat_free_crm\/commit\/6d60bc8ed010c4eda05d6645c64849f415f68d65",
      "commit_sha":"6d60bc8ed010c4eda05d6645c64849f415f68d65",
      "patch":"SINGLE",
      "chain_ord":"['6d60bc8ed010c4eda05d6645c64849f415f68d65']",
      "before_first_fix_commit":"{'557fe238a65ca94ce21e3940724ab96e55e1b27d'}",
      "last_fix_commit":"6d60bc8ed010c4eda05d6645c64849f415f68d65",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/26\/2018, 23:55:55",
      "message":"Context-sensitive XSS bugfix.",
      "author":"Antonin Steinhauser",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/helpers\/tags_helper.rb': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/fatfreecrm\/fat_free_crm\/raw\/6d60bc8ed010c4eda05d6645c64849f415f68d65\/app%2Fhelpers%2Ftags_helper.rb', 'patch': '@@ -17,7 +17,7 @@ def tags_for_index(model)\\n       elsif !query.include?(hashtag)\\n         query += \" #{hashtag}\"\\n       end\\n-      out << link_to_function(tag, \"crm.search_tagged(\\'#{query}\\', \\'#{model.class.to_s.tableize}\\')\", title: tag)\\n+      out << link_to_function(tag, \"crm.search_tagged(\\'#{escape_javascript(query)}\\', \\'#{model.class.to_s.tableize}\\')\", title: tag)\\n     end\\n   end'}}",
      "message_norm":"context-sensitive xss bugfix.",
      "language":"fr",
      "entities":"[('sensitive', 'SECWORD', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/helpers\/tags_helper.rb'])",
      "num_files":1.0,
      "patch_content":"From 6d60bc8ed010c4eda05d6645c64849f415f68d65 Mon Sep 17 00:00:00 2001\nFrom: Antonin Steinhauser <steinhauser@d3s.mff.cuni.cz>\nDate: Fri, 26 Oct 2018 16:55:55 -0700\nSubject: [PATCH] Context-sensitive XSS bugfix.\n\n---\n app\/helpers\/tags_helper.rb | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/helpers\/tags_helper.rb b\/app\/helpers\/tags_helper.rb\nindex 266060c6ea..397977682f 100755\n--- a\/app\/helpers\/tags_helper.rb\n+++ b\/app\/helpers\/tags_helper.rb\n@@ -17,7 +17,7 @@ def tags_for_index(model)\n       elsif !query.include?(hashtag)\n         query += \" #{hashtag}\"\n       end\n-      out << link_to_function(tag, \"crm.search_tagged('#{query}', '#{model.class.to_s.tableize}')\", title: tag)\n+      out << link_to_function(tag, \"crm.search_tagged('#{escape_javascript(query)}', '#{model.class.to_s.tableize}')\", title: tag)\n     end\n   end",
      "code_diff":"@@ -17,7 +17,7 @@ def tags_for_index(model)\n       elsif !query.include?(hashtag)\n         query += \" #{hashtag}\"\n       end\n-      out << link_to_function(tag, \"crm.search_tagged('#{query}', '#{model.class.to_s.tableize}')\", title: tag)\n+      out << link_to_function(tag, \"crm.search_tagged('#{escape_javascript(query)}', '#{model.class.to_s.tableize}')\", title: tag)\n     end\n   end"
    },
    {
      "index":3,
      "vuln_id":"GHSA-cx2r-mf6x-55rx",
      "cwe_id":"{'CWE-79'}",
      "score":4.1,
      "chain":"{'https:\/\/github.com\/PrestaShop\/ps_linklist\/commit\/83e6e0bdda2287f4d6e64127cb90c41d26b5ad82'}",
      "dataset":"osv",
      "summary":"Stored XSS with custom URLs in PrestaShop module ps_linklist ### Impact\nStored XSS when using custom URLs.\n\n### Patches\nThe problem is fixed in 3.1.0\n\n### References\n[Cross-site Scripting (XSS) - Stored (CWE-79)](https:\/\/cwe.mitre.org\/data\/definitions\/79.html)",
      "published_date":"2021-10-12",
      "chain_len":1,
      "project":"https:\/\/github.com\/PrestaShop\/ps_linklist",
      "commit_href":"https:\/\/github.com\/PrestaShop\/ps_linklist\/commit\/83e6e0bdda2287f4d6e64127cb90c41d26b5ad82",
      "commit_sha":"83e6e0bdda2287f4d6e64127cb90c41d26b5ad82",
      "patch":"SINGLE",
      "chain_ord":"['83e6e0bdda2287f4d6e64127cb90c41d26b5ad82']",
      "before_first_fix_commit":"{'b90005c2cfed949ab564228b277a728e0a62a876', '632e61961553a5cdd4c12ad7218e914455dbaa6b'}",
      "last_fix_commit":"83e6e0bdda2287f4d6e64127cb90c41d26b5ad82",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/15\/2020, 14:16:34",
      "message":"Merge pull request from GHSA-cx2r-mf6x-55rx\n\nThe custom url field must be a valid url",
      "author":"GoT",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
      "files":"{'src\/Form\/Type\/CustomUrlType.php': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/PrestaShop\/ps_linklist\/raw\/83e6e0bdda2287f4d6e64127cb90c41d26b5ad82\/src%2FForm%2FType%2FCustomUrlType.php', 'patch': \"@@ -29,6 +29,7 @@\\n use PrestaShopBundle\\\\Form\\\\Admin\\\\Type\\\\TranslatorAwareType;\\n use Symfony\\\\Component\\\\Form\\\\Extension\\\\Core\\\\Type\\\\TextType;\\n use Symfony\\\\Component\\\\Form\\\\FormBuilderInterface;\\n+use Symfony\\\\Component\\\\Validator\\\\Constraints as Assert;\\n \\n class CustomUrlType extends TranslatorAwareType\\n {\\n@@ -45,6 +46,7 @@ public function buildForm(FormBuilderInterface $builder, array $options)\\n             ->add('url', TextType::class, [\\n                 'label' => $this->trans('URL', 'Modules.Linklist.Admin'),\\n                 'required' => true,\\n+                'constraints' => [new Assert\\\\Url()],\\n             ])\\n         ;\\n     }\"}}",
      "message_norm":"merge pull request from ghsa-cx2r-mf6x-55rx\n\nthe custom url field must be a valid url",
      "language":"en",
      "entities":"[('ghsa-cx2r-mf6x-55rx', 'VULNID', 'GHSA')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/Form\/Type\/CustomUrlType.php'])",
      "num_files":1.0,
      "patch_content":"From 632e61961553a5cdd4c12ad7218e914455dbaa6b Mon Sep 17 00:00:00 2001\nFrom: Pierre RAMBAUD <pierre.rambaud86@gmail.com>\nDate: Wed, 18 Mar 2020 12:13:09 +0100\nSubject: [PATCH] Check that the url is a real url accepting only http & https\n\n---\n src\/Form\/Type\/CustomUrlType.php | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/src\/Form\/Type\/CustomUrlType.php b\/src\/Form\/Type\/CustomUrlType.php\nindex da78efe4..943f38fb 100644\n--- a\/src\/Form\/Type\/CustomUrlType.php\n+++ b\/src\/Form\/Type\/CustomUrlType.php\n@@ -29,6 +29,7 @@\n use PrestaShopBundle\\Form\\Admin\\Type\\TranslatorAwareType;\n use Symfony\\Component\\Form\\Extension\\Core\\Type\\TextType;\n use Symfony\\Component\\Form\\FormBuilderInterface;\n+use Symfony\\Component\\Validator\\Constraints as Assert;\n \n class CustomUrlType extends TranslatorAwareType\n {\n@@ -45,6 +46,7 @@ public function buildForm(FormBuilderInterface $builder, array $options)\n             ->add('url', TextType::class, [\n                 'label' => $this->trans('URL', 'Modules.Linklist.Admin'),\n                 'required' => true,\n+                'constraints' => [new Assert\\Url()],\n             ])\n         ;\n     }",
      "code_diff":"@@ -29,6 +29,7 @@\n use PrestaShopBundle\\Form\\Admin\\Type\\TranslatorAwareType;\n use Symfony\\Component\\Form\\Extension\\Core\\Type\\TextType;\n use Symfony\\Component\\Form\\FormBuilderInterface;\n+use Symfony\\Component\\Validator\\Constraints as Assert;\n \n class CustomUrlType extends TranslatorAwareType\n {\n@@ -45,6 +46,7 @@ public function buildForm(FormBuilderInterface $builder, array $options)\n             ->add('url', TextType::class, [\n                 'label' => $this->trans('URL', 'Modules.Linklist.Admin'),\n                 'required' => true,\n+                'constraints' => [new Assert\\Url()],\n             ])\n         ;\n     }"
    },
    {
      "index":4,
      "vuln_id":"GHSA-5qjq-69w6-fg57",
      "cwe_id":"{'CWE-79'}",
      "score":10.0,
      "chain":"{'https:\/\/github.com\/flarum\/core\/commit\/440bed81b8019dff00642c8f493b4909d505a28a'}",
      "dataset":"osv",
      "summary":"XSS vulnerability with translator Flarum's translation system allowed for string inputs to be converted into HTML DOM nodes when rendered. This change was made after v0.1.0-beta.16 (our last beta before v1.0.0) and was not noticed or documented.\n\nThis allowed for any user to type malicious HTML markup within certain user input fields and have this execute on client browsers. The example which led to the discovery of this vulnerability was in the forum search box. Entering faux-malicious HTML markup, such as <script>alert('test')<\/script> resulted in an alert box appearing on the forum. This attack could also be modified to perform AJAX requests on behalf of a user, possibly deleting discussions, modifying their settings or profile, or even modifying settings on the Admin panel if the attack was targetted towards a privileged user.\n\n### Impact\n\nAll Flarum communities that run flarum v1.0.0 or v1.0.1 are impacted.\n\n### Patches\n\nThe vulnerability has been fixed and published as flarum\/core v1.0.2. All communities running Flarum v1.0 have to upgrade as soon as possible to v1.0.2 using:\n\n```\ncomposer update --prefer-dist --no-dev -a -W\n```\n\nYou can then confirm you run the latest version using:\n\n```\ncomposer show flarum\/core\n```\n\n### Workarounds\n\n__None.__\n\n### For more information\n\nFor any questions or comments on this vulnerability please visit https:\/\/discuss.flarum.org\/d\/27558.\n\nFor support questions create a discussion at https:\/\/discuss.flarum.org\/t\/support.\n\nA reminder that if you ever become aware of a security issue in Flarum, please report it to us privately by emailing security@flarum.org, and we will address it promptly.",
      "published_date":"2021-06-07",
      "chain_len":1,
      "project":"https:\/\/github.com\/flarum\/core",
      "commit_href":"https:\/\/github.com\/flarum\/core\/commit\/440bed81b8019dff00642c8f493b4909d505a28a",
      "commit_sha":"440bed81b8019dff00642c8f493b4909d505a28a",
      "patch":"SINGLE",
      "chain_ord":"['440bed81b8019dff00642c8f493b4909d505a28a']",
      "before_first_fix_commit":"{'eeb8fe1443b98f5f622ca52b4a02732f62d1aa77'}",
      "last_fix_commit":"440bed81b8019dff00642c8f493b4909d505a28a",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/06\/2021, 01:41:48",
      "message":"Fix XSS vulnerability",
      "author":"David Wheatley",
      "comments":"{'com_1': {'author': 'davwheat', 'datetime': '06\/07\/2021, 20:53:34', 'body': 'The details about this vulnerability have now been made public.\\r\\n\\r\\nFor more information, please see: https:\/\/discuss.flarum.org\/d\/27558-critical-security-update-to-flarum-core-v102'}}",
      "stats":"{'additions': 12, 'deletions': 1, 'total': 13}",
      "files":"{'js\/src\/common\/Translator.tsx': {'additions': 12, 'deletions': 1, 'changes': 13, 'status': 'renamed', 'raw_url': 'https:\/\/github.com\/flarum\/framework\/raw\/440bed81b8019dff00642c8f493b4909d505a28a\/js%2Fsrc%2Fcommon%2FTranslator.tsx', 'patch': \"@@ -48,12 +48,23 @@ export default class Translator {\\n     \/\/ future there should be a hook here to inspect the user and change the\\n     \/\/ translation key. This will allow a gender property to determine which\\n     \/\/ translation key is used.\\n+\\n     if ('user' in parameters) {\\n       const user = extract(parameters, 'user');\\n \\n       if (!parameters.username) parameters.username = username(user);\\n     }\\n-    return parameters;\\n+\\n+    const escapedParameters: TranslatorParameters = {};\\n+\\n+    for (const param in parameters) {\\n+      const paramValue = parameters[param];\\n+\\n+      if (typeof paramValue === 'string') escapedParameters[param] = <>{parameters[param]}<\/>;\\n+      else escapedParameters[param] = parameters[param];\\n+    }\\n+\\n+    return escapedParameters;\\n   }\\n \\n   trans(id: string, parameters: TranslatorParameters = {}) {\"}}",
      "message_norm":"fix xss vulnerability",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['js\/src\/common\/Translator.tsx'])",
      "num_files":1.0,
      "patch_content":"From 440bed81b8019dff00642c8f493b4909d505a28a Mon Sep 17 00:00:00 2001\nFrom: David Wheatley <hi@davwheat.dev>\nDate: Sun, 6 Jun 2021 02:41:48 +0100\nSubject: [PATCH] Fix XSS vulnerability\n\n---\n js\/src\/common\/{Translator.ts => Translator.tsx} | 13 ++++++++++++-\n 1 file changed, 12 insertions(+), 1 deletion(-)\n rename js\/src\/common\/{Translator.ts => Translator.tsx} (86%)\n\ndiff --git a\/js\/src\/common\/Translator.ts b\/js\/src\/common\/Translator.tsx\nsimilarity index 86%\nrename from js\/src\/common\/Translator.ts\nrename to js\/src\/common\/Translator.tsx\nindex 51b9c95a6e..2d2036ff3f 100644\n--- a\/js\/src\/common\/Translator.ts\n+++ b\/js\/src\/common\/Translator.tsx\n@@ -48,12 +48,23 @@ export default class Translator {\n     \/\/ future there should be a hook here to inspect the user and change the\n     \/\/ translation key. This will allow a gender property to determine which\n     \/\/ translation key is used.\n+\n     if ('user' in parameters) {\n       const user = extract(parameters, 'user');\n \n       if (!parameters.username) parameters.username = username(user);\n     }\n-    return parameters;\n+\n+    const escapedParameters: TranslatorParameters = {};\n+\n+    for (const param in parameters) {\n+      const paramValue = parameters[param];\n+\n+      if (typeof paramValue === 'string') escapedParameters[param] = <>{parameters[param]}<\/>;\n+      else escapedParameters[param] = parameters[param];\n+    }\n+\n+    return escapedParameters;\n   }\n \n   trans(id: string, parameters: TranslatorParameters = {}) {",
      "code_diff":"similarity index 86%\nrename from js\/src\/common\/Translator.ts\nrename to js\/src\/common\/Translator.tsx\n@@ -48,12 +48,23 @@ export default class Translator {\n     \/\/ future there should be a hook here to inspect the user and change the\n     \/\/ translation key. This will allow a gender property to determine which\n     \/\/ translation key is used.\n+\n     if ('user' in parameters) {\n       const user = extract(parameters, 'user');\n \n       if (!parameters.username) parameters.username = username(user);\n     }\n-    return parameters;\n+\n+    const escapedParameters: TranslatorParameters = {};\n+\n+    for (const param in parameters) {\n+      const paramValue = parameters[param];\n+\n+      if (typeof paramValue === 'string') escapedParameters[param] = <>{parameters[param]}<\/>;\n+      else escapedParameters[param] = parameters[param];\n+    }\n+\n+    return escapedParameters;\n   }\n \n   trans(id: string, parameters: TranslatorParameters = {}) {"
    },
    {
      "index":5,
      "vuln_id":"GHSA-3374-7h99-xr85",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/forkcms\/forkcms\/commit\/6ec6171206a7507a39695edc8bbd1b97ef1041c6'}",
      "dataset":"osv",
      "summary":"Cross-site scripting in forkcms Fork CMS Content Management System v5.8.0 was discovered to contain a cross-site scripting (XSS) vulnerability in the `Displayname` field when using the `Add`, `Edit` or `Register' functions. This vulnerability allows attackers to execute arbitrary web scripts or HTML.",
      "published_date":"2021-10-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/forkcms\/forkcms",
      "commit_href":"https:\/\/github.com\/forkcms\/forkcms\/commit\/6ec6171206a7507a39695edc8bbd1b97ef1041c6",
      "commit_sha":"6ec6171206a7507a39695edc8bbd1b97ef1041c6",
      "patch":"SINGLE",
      "chain_ord":"['6ec6171206a7507a39695edc8bbd1b97ef1041c6']",
      "before_first_fix_commit":"{'f439d630c2f46a85b251488cd7073068a66fae5c'}",
      "last_fix_commit":"6ec6171206a7507a39695edc8bbd1b97ef1041c6",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/17\/2020, 10:44:12",
      "message":"Fix xss in profiles display name",
      "author":"Jelmer Prins",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'src\/Backend\/Modules\/Profiles\/Actions\/Index.php': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/forkcms\/forkcms\/raw\/6ec6171206a7507a39695edc8bbd1b97ef1041c6\/src%2FBackend%2FModules%2FProfiles%2FActions%2FIndex.php', 'patch': \"@@ -128,6 +128,7 @@ private function loadDataGrid(): void\\n             'registered_on',\\n             true\\n         );\\n+        $this->dgProfiles->setColumnFunction('htmlspecialchars', ['[display_name]'], 'display_name');\\n \\n         \/\/ add the mass action controls\\n         $this->dgProfiles->setMassActionCheckboxes('check', '[id]');\"}}",
      "message_norm":"fix xss in profiles display name",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/Backend\/Modules\/Profiles\/Actions\/Index.php'])",
      "num_files":1.0,
      "patch_content":"From 6ec6171206a7507a39695edc8bbd1b97ef1041c6 Mon Sep 17 00:00:00 2001\nFrom: Jelmer Prins <jelmer@sumocoders.be>\nDate: Fri, 17 Apr 2020 12:44:12 +0200\nSubject: [PATCH] Fix xss in profiles display name\n\n---\n src\/Backend\/Modules\/Profiles\/Actions\/Index.php | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/src\/Backend\/Modules\/Profiles\/Actions\/Index.php b\/src\/Backend\/Modules\/Profiles\/Actions\/Index.php\nindex b6047acfb0..87f87f2344 100644\n--- a\/src\/Backend\/Modules\/Profiles\/Actions\/Index.php\n+++ b\/src\/Backend\/Modules\/Profiles\/Actions\/Index.php\n@@ -128,6 +128,7 @@ private function loadDataGrid(): void\n             'registered_on',\n             true\n         );\n+        $this->dgProfiles->setColumnFunction('htmlspecialchars', ['[display_name]'], 'display_name');\n \n         \/\/ add the mass action controls\n         $this->dgProfiles->setMassActionCheckboxes('check', '[id]');",
      "code_diff":"@@ -128,6 +128,7 @@ private function loadDataGrid(): void\n             'registered_on',\n             true\n         );\n+        $this->dgProfiles->setColumnFunction('htmlspecialchars', ['[display_name]'], 'display_name');\n \n         \/\/ add the mass action controls\n         $this->dgProfiles->setMassActionCheckboxes('check', '[id]');"
    },
    {
      "index":6,
      "vuln_id":"GHSA-qqxp-xp9v-vvx6",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/jquery\/jquery-ui\/commit\/f2854408cce7e4b7fc6bf8676761904af9c96bde', 'https:\/\/github.com\/jquery\/jquery-ui\/commit\/5fee6fd5000072ff32f2d65b6451f39af9e0e39e'}",
      "dataset":"osv",
      "summary":"Moderate severity vulnerability that affects jquery-ui Cross-site scripting (XSS) vulnerability in the default content option in jquery.ui.tooltip.js in the Tooltip widget in jQuery UI before 1.10.0 allows remote attackers to inject arbitrary web script or HTML via the title attribute, which is not properly handled in the autocomplete combo box demo.",
      "published_date":"2017-10-24",
      "chain_len":2,
      "project":"https:\/\/github.com\/jquery\/jquery-ui",
      "commit_href":"https:\/\/github.com\/jquery\/jquery-ui\/commit\/5fee6fd5000072ff32f2d65b6451f39af9e0e39e",
      "commit_sha":"5fee6fd5000072ff32f2d65b6451f39af9e0e39e",
      "patch":"MULTI",
      "chain_ord":"['5fee6fd5000072ff32f2d65b6451f39af9e0e39e', 'f2854408cce7e4b7fc6bf8676761904af9c96bde']",
      "before_first_fix_commit":"{'5fee6fd5000072ff32f2d65b6451f39af9e0e39e'}",
      "last_fix_commit":"f2854408cce7e4b7fc6bf8676761904af9c96bde",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/27\/2012, 15:52:19",
      "message":"Autocomplete demo: Combobox: Encode search term inside tooltips. Fixes #8859 - Autocomplete: XSS in combobox demo.",
      "author":"Scott Gonz\u00e1lez",
      "comments":"{'com_1': {'author': 'jzaefferer', 'datetime': '11\/27\/2012, 16:05:23', 'body': \"Doesn't this just hide the underlying tooltip vulnerability? If so, tooltip would have to use `.text()` instead of `.html()`, and make it sane to override that.\"}, 'com_2': {'author': 'scottgonzalez', 'datetime': '11\/27\/2012, 16:13:04', 'body': \"hmm...yeah, tooltip should handle this in the default `content` option. Good catch, I'll fix that.\"}, 'com_3': {'author': 'scottgonzalez', 'datetime': '11\/27\/2012, 16:22:17', 'body': 'Fixed in f2854408cce7e4b7fc6bf8676761904af9c96bde.'}}",
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'demos\/autocomplete\/combobox.html': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jquery\/jquery-ui\/raw\/5fee6fd5000072ff32f2d65b6451f39af9e0e39e\/demos%2Fautocomplete%2Fcombobox.html', 'patch': '@@ -61,7 +61,7 @@\\n \\t\\t\\t\\t\\t\\t\/\/ remove invalid value, as it didn\\'t match anything\\n \\t\\t\\t\\t\\t\\t$( element )\\n \\t\\t\\t\\t\\t\\t\\t.val( \"\" )\\n-\\t\\t\\t\\t\\t\\t\\t.attr( \"title\", value + \" didn\\'t match any item\" )\\n+\\t\\t\\t\\t\\t\\t\\t.attr( \"title\", $( \"<a>\" ).text( value ).html() + \" didn\\'t match any item\" )\\n \\t\\t\\t\\t\\t\\t\\t.tooltip( \"open\" );\\n \\t\\t\\t\\t\\t\\tselect.val( \"\" );\\n \\t\\t\\t\\t\\t\\tsetTimeout(function() {'}}",
      "message_norm":"autocomplete demo: combobox: encode search term inside tooltips. fixes #8859 - autocomplete: xss in combobox demo.",
      "language":"pt",
      "entities":"[('encode', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('#8859', 'ISSUE', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['demos\/autocomplete\/combobox.html'])",
      "num_files":1.0,
      "patch_content":"From 5fee6fd5000072ff32f2d65b6451f39af9e0e39e Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Scott=20Gonz=C3=A1lez?= <scott.gonzalez@gmail.com>\nDate: Tue, 27 Nov 2012 10:52:19 -0500\nSubject: [PATCH] Autocomplete demo: Combobox: Encode search term inside\n tooltips. Fixes #8859 - Autocomplete: XSS in combobox demo.\n\n---\n demos\/autocomplete\/combobox.html | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/demos\/autocomplete\/combobox.html b\/demos\/autocomplete\/combobox.html\nindex 6229d47b216..8c6f59fc198 100644\n--- a\/demos\/autocomplete\/combobox.html\n+++ b\/demos\/autocomplete\/combobox.html\n@@ -61,7 +61,7 @@\n \t\t\t\t\t\t\/\/ remove invalid value, as it didn't match anything\n \t\t\t\t\t\t$( element )\n \t\t\t\t\t\t\t.val( \"\" )\n-\t\t\t\t\t\t\t.attr( \"title\", value + \" didn't match any item\" )\n+\t\t\t\t\t\t\t.attr( \"title\", $( \"<a>\" ).text( value ).html() + \" didn't match any item\" )\n \t\t\t\t\t\t\t.tooltip( \"open\" );\n \t\t\t\t\t\tselect.val( \"\" );\n \t\t\t\t\t\tsetTimeout(function() {",
      "code_diff":"@@ -61,7 +61,7 @@\n \t\t\t\t\t\t\/\/ remove invalid value, as it didn't match anything\n \t\t\t\t\t\t$( element )\n \t\t\t\t\t\t\t.val( \"\" )\n-\t\t\t\t\t\t\t.attr( \"title\", value + \" didn't match any item\" )\n+\t\t\t\t\t\t\t.attr( \"title\", $( \"<a>\" ).text( value ).html() + \" didn't match any item\" )\n \t\t\t\t\t\t\t.tooltip( \"open\" );\n \t\t\t\t\t\tselect.val( \"\" );\n \t\t\t\t\t\tsetTimeout(function() {"
    },
    {
      "index":7,
      "vuln_id":"GHSA-q7q9-w24q-cpgh",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/apache\/ambari\/pull\/3040\/commits\/a9cfdb9dcce63a3494c07c81ebb2cf8da218a210'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting (XSS) in Apache Ambari Views A cross-site scripting issue was found in Apache Ambari Views. This was addressed in Apache Ambari 2.7.4.",
      "published_date":"2022-01-06",
      "chain_len":1,
      "project":"https:\/\/github.com\/apache\/ambari",
      "commit_href":"https:\/\/github.com\/apache\/ambari\/pull\/3040\/commits\/a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
      "commit_sha":"a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
      "patch":"SINGLE",
      "chain_ord":"['a9cfdb9dcce63a3494c07c81ebb2cf8da218a210']",
      "before_first_fix_commit":"{'9e9ddf752f36aa9340d6dfdc23ecccfcd646fc53'}",
      "last_fix_commit":"a9cfdb9dcce63a3494c07c81ebb2cf8da218a210",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/01\/2019, 11:43:05",
      "message":"AMBARI-25329. Ambari breadcrumbs xss vulnerability",
      "author":"Alex Antonenko",
      "comments":null,
      "stats":"{'additions': 12, 'deletions': 2, 'total': 14}",
      "files":"{'ambari-web\/app\/views\/common\/breadcrumbs_view.js': {'additions': 12, 'deletions': 2, 'changes': 14, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/ambari\/raw\/a9cfdb9dcce63a3494c07c81ebb2cf8da218a210\/ambari-web%2Fapp%2Fviews%2Fcommon%2Fbreadcrumbs_view.js', 'patch': \"@@ -149,8 +149,16 @@ App.BreadcrumbItem = Em.Object.extend({\\n   createLabel() {\\n     let label = this.get('label');\\n     let labelBindingPath = this.get('labelBindingPath');\\n+    let formattedLabel;\\n+\\n+    if (labelBindingPath) {\\n+      formattedLabel = Ember.Handlebars.Utils.escapeExpression(App.get(_getLabelPathWithoutApp(labelBindingPath)));\\n+    } else{\\n+      formattedLabel = label;\\n+    }\\n+\\n+\\n \\n-    let formattedLabel = labelBindingPath ? App.get(_getLabelPathWithoutApp(labelBindingPath)) : label;\\n     this.set('formattedLabel', this.labelPostFormat(formattedLabel));\\n   },\\n \\n@@ -216,7 +224,9 @@ App.BreadcrumbsView = Em.View.extend({\\n       }\\n       currentState = currentState.get('parentState');\\n     }\\n-    items = items.reverse().map(item => App.BreadcrumbItem.extend(item).create());\\n+    items.reverse();\\n+    items.slice(1).forEach(item => item.label = Ember.Handlebars.Utils.escapeExpression(item.label));\\n+    items = items.map(item => App.BreadcrumbItem.extend(item).create());\\n     if (items.length) {\\n       items.get('lastObject').setProperties({\\n         disabled: true,\"}}",
      "message_norm":"ambari-25329. ambari breadcrumbs xss vulnerability",
      "language":"ca",
      "entities":"[('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['ambari-web\/app\/views\/common\/breadcrumbs_view.js'])",
      "num_files":1.0,
      "patch_content":"From a9cfdb9dcce63a3494c07c81ebb2cf8da218a210 Mon Sep 17 00:00:00 2001\nFrom: Alex Antonenko <aantonenko@hortonworks.com>\nDate: Mon, 1 Jul 2019 14:43:05 +0300\nSubject: [PATCH] AMBARI-25329. Ambari breadcrumbs xss vulnerability\n\n---\n ambari-web\/app\/views\/common\/breadcrumbs_view.js | 14 ++++++++++++--\n 1 file changed, 12 insertions(+), 2 deletions(-)\n\ndiff --git a\/ambari-web\/app\/views\/common\/breadcrumbs_view.js b\/ambari-web\/app\/views\/common\/breadcrumbs_view.js\nindex ec6e6a64efb..31190c5faf2 100644\n--- a\/ambari-web\/app\/views\/common\/breadcrumbs_view.js\n+++ b\/ambari-web\/app\/views\/common\/breadcrumbs_view.js\n@@ -149,8 +149,16 @@ App.BreadcrumbItem = Em.Object.extend({\n   createLabel() {\n     let label = this.get('label');\n     let labelBindingPath = this.get('labelBindingPath');\n+    let formattedLabel;\n+\n+    if (labelBindingPath) {\n+      formattedLabel = Ember.Handlebars.Utils.escapeExpression(App.get(_getLabelPathWithoutApp(labelBindingPath)));\n+    } else{\n+      formattedLabel = label;\n+    }\n+\n+\n \n-    let formattedLabel = labelBindingPath ? App.get(_getLabelPathWithoutApp(labelBindingPath)) : label;\n     this.set('formattedLabel', this.labelPostFormat(formattedLabel));\n   },\n \n@@ -216,7 +224,9 @@ App.BreadcrumbsView = Em.View.extend({\n       }\n       currentState = currentState.get('parentState');\n     }\n-    items = items.reverse().map(item => App.BreadcrumbItem.extend(item).create());\n+    items.reverse();\n+    items.slice(1).forEach(item => item.label = Ember.Handlebars.Utils.escapeExpression(item.label));\n+    items = items.map(item => App.BreadcrumbItem.extend(item).create());\n     if (items.length) {\n       items.get('lastObject').setProperties({\n         disabled: true,",
      "code_diff":"@@ -149,8 +149,16 @@ App.BreadcrumbItem = Em.Object.extend({\n   createLabel() {\n     let label = this.get('label');\n     let labelBindingPath = this.get('labelBindingPath');\n+    let formattedLabel;\n+\n+    if (labelBindingPath) {\n+      formattedLabel = Ember.Handlebars.Utils.escapeExpression(App.get(_getLabelPathWithoutApp(labelBindingPath)));\n+    } else{\n+      formattedLabel = label;\n+    }\n+\n+\n \n-    let formattedLabel = labelBindingPath ? App.get(_getLabelPathWithoutApp(labelBindingPath)) : label;\n     this.set('formattedLabel', this.labelPostFormat(formattedLabel));\n   },\n \n@@ -216,7 +224,9 @@ App.BreadcrumbsView = Em.View.extend({\n       }\n       currentState = currentState.get('parentState');\n     }\n-    items = items.reverse().map(item => App.BreadcrumbItem.extend(item).create());\n+    items.reverse();\n+    items.slice(1).forEach(item => item.label = Ember.Handlebars.Utils.escapeExpression(item.label));\n+    items = items.map(item => App.BreadcrumbItem.extend(item).create());\n     if (items.length) {\n       items.get('lastObject').setProperties({\n         disabled: true,"
    },
    {
      "index":8,
      "vuln_id":"GHSA-vcfc-9wcp-j623",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/ServiceStack\/ServiceStack\/commit\/a0e0d7de20f5d1712f1793f925496def4383c610'}",
      "dataset":"osv",
      "summary":"Cross site scripting attack in ServiceStack Framework ServiceStack ServiceStack Framework 4.5.14 is affected by: Cross Site Scripting (XSS). The impact is: JavaScrpit is reflected in the server response, hence executed by the browser. The component is: the query used in the GET request is prone. The attack vector is: Since there is no server-side validation and If Browser encoding is bypassed, the victim is affected when opening a crafted URL. The fixed version is: 5.2.0.",
      "published_date":"2022-05-24",
      "chain_len":1,
      "project":"https:\/\/github.com\/ServiceStack\/ServiceStack",
      "commit_href":"https:\/\/github.com\/ServiceStack\/ServiceStack\/commit\/a0e0d7de20f5d1712f1793f925496def4383c610",
      "commit_sha":"a0e0d7de20f5d1712f1793f925496def4383c610",
      "patch":"SINGLE",
      "chain_ord":"['a0e0d7de20f5d1712f1793f925496def4383c610']",
      "before_first_fix_commit":"{'2c6fbe4554014ead15b7b188bb748b655b30807c'}",
      "last_fix_commit":"a0e0d7de20f5d1712f1793f925496def4383c610",
      "chain_ord_pos":1.0,
      "commit_datetime":"08\/17\/2018, 15:05:59",
      "message":"HtmlEncode Raw URL in HtmlFormat snapshot",
      "author":"Demis Bellot",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 2, 'total': 5}",
      "files":"{'src\/ServiceStack\/Formats\/HtmlFormat.cs': {'additions': 3, 'deletions': 2, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ServiceStack\/ServiceStack\/raw\/a0e0d7de20f5d1712f1793f925496def4383c610\/src%2FServiceStack%2FFormats%2FHtmlFormat.cs', 'patch': '@@ -90,12 +90,13 @@ public async Task SerializeToStreamAsync(IRequest req, object response, Stream o\\n             {\\n                 \/\/ Serialize then escape any potential script tags to avoid XSS when displaying as HTML\\n                 var json = JsonDataContractSerializer.Instance.SerializeToString(dto) ?? \"null\";\\n-                json = json.Replace(\"<\", \"&lt;\").Replace(\">\", \"&gt;\");\\n+                json = json.HtmlEncode();\\n \\n                 var url = req.ResolveAbsoluteUrl()\\n                     .Replace(\"format=html\", \"\")\\n                     .Replace(\"format=shtm\", \"\")\\n-                    .TrimEnd(\\'?\\', \\'&\\');\\n+                    .TrimEnd(\\'?\\', \\'&\\')\\n+                    .HtmlEncode();\\n \\n                 url += url.Contains(\"?\") ? \"&\" : \"?\";'}}",
      "message_norm":"htmlencode raw url in htmlformat snapshot",
      "language":"en",
      "entities":"[('htmlencode', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/ServiceStack\/Formats\/HtmlFormat.cs'])",
      "num_files":1.0,
      "patch_content":"From a0e0d7de20f5d1712f1793f925496def4383c610 Mon Sep 17 00:00:00 2001\nFrom: Demis Bellot <demis.bellot@gmail.com>\nDate: Fri, 17 Aug 2018 11:05:59 -0400\nSubject: [PATCH] HtmlEncode Raw URL in HtmlFormat snapshot\n\n---\n src\/ServiceStack\/Formats\/HtmlFormat.cs | 5 +++--\n 1 file changed, 3 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/ServiceStack\/Formats\/HtmlFormat.cs b\/src\/ServiceStack\/Formats\/HtmlFormat.cs\nindex e62df99e576..482955e38fc 100644\n--- a\/src\/ServiceStack\/Formats\/HtmlFormat.cs\n+++ b\/src\/ServiceStack\/Formats\/HtmlFormat.cs\n@@ -90,12 +90,13 @@ public async Task SerializeToStreamAsync(IRequest req, object response, Stream o\n             {\n                 \/\/ Serialize then escape any potential script tags to avoid XSS when displaying as HTML\n                 var json = JsonDataContractSerializer.Instance.SerializeToString(dto) ?? \"null\";\n-                json = json.Replace(\"<\", \"&lt;\").Replace(\">\", \"&gt;\");\n+                json = json.HtmlEncode();\n \n                 var url = req.ResolveAbsoluteUrl()\n                     .Replace(\"format=html\", \"\")\n                     .Replace(\"format=shtm\", \"\")\n-                    .TrimEnd('?', '&');\n+                    .TrimEnd('?', '&')\n+                    .HtmlEncode();\n \n                 url += url.Contains(\"?\") ? \"&\" : \"?\";",
      "code_diff":"@@ -90,12 +90,13 @@ public async Task SerializeToStreamAsync(IRequest req, object response, Stream o\n             {\n                 \/\/ Serialize then escape any potential script tags to avoid XSS when displaying as HTML\n                 var json = JsonDataContractSerializer.Instance.SerializeToString(dto) ?? \"null\";\n-                json = json.Replace(\"<\", \"&lt;\").Replace(\">\", \"&gt;\");\n+                json = json.HtmlEncode();\n \n                 var url = req.ResolveAbsoluteUrl()\n                     .Replace(\"format=html\", \"\")\n                     .Replace(\"format=shtm\", \"\")\n-                    .TrimEnd('?', '&');\n+                    .TrimEnd('?', '&')\n+                    .HtmlEncode();\n \n                 url += url.Contains(\"?\") ? \"&\" : \"?\";"
    },
    {
      "index":9,
      "vuln_id":"GHSA-whv6-rj84-2vh2",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/juliushaertl\/nextcloud-vue-collections\/commit\/8ec1fca214f003538cec4137792ede928f25f583'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in nextcloud-vue-collections Versions of `nextcloud-vue-collections` prior to 0.4.2 are vulnerable to Cross-Site Scripting (XSS).  The `v-tooltip` component has an insecure `defaultHTML` configuration that allows arbitrary JavaScript to be injected in the tooltip of a collection item. This allows attackers to execute arbitrary code in a victim's browser.\n\n\n## Recommendation\n\nUpgrade to version 0.4.2 or later.",
      "published_date":"2020-09-04",
      "chain_len":1,
      "project":"https:\/\/github.com\/juliushaertl\/nextcloud-vue-collections",
      "commit_href":"https:\/\/github.com\/juliushaertl\/nextcloud-vue-collections\/commit\/8ec1fca214f003538cec4137792ede928f25f583",
      "commit_sha":"8ec1fca214f003538cec4137792ede928f25f583",
      "patch":"SINGLE",
      "chain_ord":"['8ec1fca214f003538cec4137792ede928f25f583']",
      "before_first_fix_commit":"{'1d55cc3b462bc344de6cfbe45d590d0c2f99fc1a'}",
      "last_fix_commit":"8ec1fca214f003538cec4137792ede928f25f583",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/29\/2019, 13:41:42",
      "message":"Force defaultHtml setting of v-tooltip to be disabled\n\nSigned-off-by: Julius H\u00e4rtl <jus@bitgrid.net>",
      "author":"Julius H\u00e4rtl",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
      "files":"{'src\/components\/CollectionListItem.vue': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/nextcloud\/nextcloud-vue-collections\/raw\/8ec1fca214f003538cec4137792ede928f25f583\/src%2Fcomponents%2FCollectionListItem.vue', 'patch': \"@@ -60,6 +60,9 @@ import Action from 'nextcloud-vue\/dist\/Components\/Action'\\n import Avatar from 'nextcloud-vue\/dist\/Components\/Avatar'\\n import Tooltip from 'nextcloud-vue\/dist\/Directives\/Tooltip'\\n \\n+Tooltip.options.defaultHtml = false\\n+\\n+\\n export default {\\n \\tname: 'CollectionListItem',\\n \\tcomponents: {\"}}",
      "message_norm":"force defaulthtml setting of v-tooltip to be disabled\n\nsigned-off-by: julius h\u00e4rtl <jus@bitgrid.net>",
      "language":"en",
      "entities":"[('jus@bitgrid.net', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/components\/CollectionListItem.vue'])",
      "num_files":1.0,
      "patch_content":"From 8ec1fca214f003538cec4137792ede928f25f583 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Julius=20H=C3=A4rtl?= <jus@bitgrid.net>\nDate: Mon, 29 Jul 2019 15:41:42 +0200\nSubject: [PATCH] Force defaultHtml setting of v-tooltip to be disabled\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nSigned-off-by: Julius H\u00e4rtl <jus@bitgrid.net>\n---\n src\/components\/CollectionListItem.vue | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/src\/components\/CollectionListItem.vue b\/src\/components\/CollectionListItem.vue\nindex 146e1742..21de93cd 100644\n--- a\/src\/components\/CollectionListItem.vue\n+++ b\/src\/components\/CollectionListItem.vue\n@@ -60,6 +60,9 @@ import Action from 'nextcloud-vue\/dist\/Components\/Action'\n import Avatar from 'nextcloud-vue\/dist\/Components\/Avatar'\n import Tooltip from 'nextcloud-vue\/dist\/Directives\/Tooltip'\n \n+Tooltip.options.defaultHtml = false\n+\n+\n export default {\n \tname: 'CollectionListItem',\n \tcomponents: {",
      "code_diff":"@@ -60,6 +60,9 @@ import Action from 'nextcloud-vue\/dist\/Components\/Action'\n import Avatar from 'nextcloud-vue\/dist\/Components\/Avatar'\n import Tooltip from 'nextcloud-vue\/dist\/Directives\/Tooltip'\n \n+Tooltip.options.defaultHtml = false\n+\n+\n export default {\n \tname: 'CollectionListItem',\n \tcomponents: {"
    },
    {
      "index":10,
      "vuln_id":"GHSA-xw79-hhv6-578c",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/zeit\/serve-handler\/commit\/65b4d4183a31a8076c78c40118acb0ca1b64f620'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in serve Versions of `serve` prior to 10.0.2 are vulnerable to Cross-Site Scripting (XSS). The package does not encode output, allowing attackers to execute arbitrary JavaScript in the victim's browser if user-supplied input is rendered.\n\n\n## Recommendation\n\nUpgrade to version 10.0.2 or later.",
      "published_date":"2020-09-11",
      "chain_len":1,
      "project":"https:\/\/github.com\/zeit\/serve-handler",
      "commit_href":"https:\/\/github.com\/zeit\/serve-handler\/commit\/65b4d4183a31a8076c78c40118acb0ca1b64f620",
      "commit_sha":"65b4d4183a31a8076c78c40118acb0ca1b64f620",
      "patch":"SINGLE",
      "chain_ord":"['65b4d4183a31a8076c78c40118acb0ca1b64f620']",
      "before_first_fix_commit":"{'2b3be81a46e09fc5f8bc2c69a5311d439dac74af'}",
      "last_fix_commit":"65b4d4183a31a8076c78c40118acb0ca1b64f620",
      "chain_ord_pos":1.0,
      "commit_datetime":"09\/24\/2018, 17:05:10",
      "message":"Interpolate template variables correctly (#64)",
      "author":"Leo Lamprecht",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 4, 'total': 8}",
      "files":"{'src\/directory.jst': {'additions': 4, 'deletions': 4, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/vercel\/serve-handler\/raw\/65b4d4183a31a8076c78c40118acb0ca1b64f620\/src%2Fdirectory.jst', 'patch': '@@ -4,7 +4,7 @@\\n     <meta charset=\"utf-8\">\\n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n \\n-    <title>Files within {{=it.directory}}<\/title>\\n+    <title>Files within {{!it.directory}}<\/title>\\n \\n \\t<style>\\n \\t\\tbody {\\n@@ -187,7 +187,7 @@\\n           <i>Index of&nbsp;<\/i>\\n \\n           {{~it.paths :value:index}}\\n-            <a href=\"\/{{=value.url}}\">{{=value.name}}<\/a>\\n+            <a href=\"\/{{!value.url}}\">{{!value.name}}<\/a>\\n           {{~}}\\n         <\/h1>\\n \\n@@ -197,9 +197,9 @@\\n       <ul id=\"files\">\\n         {{~it.files :value:index}}\\n           <li>\\n-            <a href=\"{{=value.relative}}\" title=\"{{=value.title}}\" class=\"{{=value.ext}}\">{{=value.base}}<\/a>\\n+            <a href=\"{{!value.relative}}\" title=\"{{!value.title}}\" class=\"{{!value.ext}}\">{{!value.base}}<\/a>\\n \\t\\t\\t{{? value.size}}\\n-\\t\\t\\t\\t<i>{{=value.size}}<\/i>\\n+\\t\\t\\t\\t<i>{{!value.size}}<\/i>\\n \\t\\t\\t{{?}}\\n           <\/li>\\n         {{~}}'}}",
      "message_norm":"interpolate template variables correctly (#64)",
      "language":"en",
      "entities":"[('#64', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/directory.jst'])",
      "num_files":1.0,
      "patch_content":"From 65b4d4183a31a8076c78c40118acb0ca1b64f620 Mon Sep 17 00:00:00 2001\nFrom: Leo Lamprecht <mindrun@icloud.com>\nDate: Mon, 24 Sep 2018 19:05:10 +0200\nSubject: [PATCH] Interpolate template variables correctly (#64)\n\n---\n src\/directory.jst | 8 ++++----\n 1 file changed, 4 insertions(+), 4 deletions(-)\n\ndiff --git a\/src\/directory.jst b\/src\/directory.jst\nindex 31c25ec..aa3021a 100644\n--- a\/src\/directory.jst\n+++ b\/src\/directory.jst\n@@ -4,7 +4,7 @@\n     <meta charset=\"utf-8\">\n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n \n-    <title>Files within {{=it.directory}}<\/title>\n+    <title>Files within {{!it.directory}}<\/title>\n \n \t<style>\n \t\tbody {\n@@ -187,7 +187,7 @@\n           <i>Index of&nbsp;<\/i>\n \n           {{~it.paths :value:index}}\n-            <a href=\"\/{{=value.url}}\">{{=value.name}}<\/a>\n+            <a href=\"\/{{!value.url}}\">{{!value.name}}<\/a>\n           {{~}}\n         <\/h1>\n \n@@ -197,9 +197,9 @@\n       <ul id=\"files\">\n         {{~it.files :value:index}}\n           <li>\n-            <a href=\"{{=value.relative}}\" title=\"{{=value.title}}\" class=\"{{=value.ext}}\">{{=value.base}}<\/a>\n+            <a href=\"{{!value.relative}}\" title=\"{{!value.title}}\" class=\"{{!value.ext}}\">{{!value.base}}<\/a>\n \t\t\t{{? value.size}}\n-\t\t\t\t<i>{{=value.size}}<\/i>\n+\t\t\t\t<i>{{!value.size}}<\/i>\n \t\t\t{{?}}\n           <\/li>\n         {{~}}",
      "code_diff":"@@ -4,7 +4,7 @@\n     <meta charset=\"utf-8\">\n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n \n-    <title>Files within {{=it.directory}}<\/title>\n+    <title>Files within {{!it.directory}}<\/title>\n \n \t<style>\n \t\tbody {\n@@ -187,7 +187,7 @@\n           <i>Index of&nbsp;<\/i>\n \n           {{~it.paths :value:index}}\n-            <a href=\"\/{{=value.url}}\">{{=value.name}}<\/a>\n+            <a href=\"\/{{!value.url}}\">{{!value.name}}<\/a>\n           {{~}}\n         <\/h1>\n \n@@ -197,9 +197,9 @@\n       <ul id=\"files\">\n         {{~it.files :value:index}}\n           <li>\n-            <a href=\"{{=value.relative}}\" title=\"{{=value.title}}\" class=\"{{=value.ext}}\">{{=value.base}}<\/a>\n+            <a href=\"{{!value.relative}}\" title=\"{{!value.title}}\" class=\"{{!value.ext}}\">{{!value.base}}<\/a>\n \t\t\t{{? value.size}}\n-\t\t\t\t<i>{{=value.size}}<\/i>\n+\t\t\t\t<i>{{!value.size}}<\/i>\n \t\t\t{{?}}\n           <\/li>\n         {{~}}"
    },
    {
      "index":11,
      "vuln_id":"GHSA-5pg2-qg87-vmj7",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/9ebbb4dd35da74025ab6965f722829a7f8f86566'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber Cross-site Scripting (XSS) - Stored in GitHub repository microweber\/microweber prior to 1.2.19.",
      "published_date":"2022-07-02",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/9ebbb4dd35da74025ab6965f722829a7f8f86566",
      "commit_sha":"9ebbb4dd35da74025ab6965f722829a7f8f86566",
      "patch":"SINGLE",
      "chain_ord":"['9ebbb4dd35da74025ab6965f722829a7f8f86566']",
      "before_first_fix_commit":"{'c2991b3a44896320a834a4b611257db587129645'}",
      "last_fix_commit":"9ebbb4dd35da74025ab6965f722829a7f8f86566",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/01\/2022, 08:07:47",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 1, 'total': 5}",
      "files":"{'src\/MicroweberPackages\/App\/functions\/plupload.php': {'additions': 4, 'deletions': 1, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/9ebbb4dd35da74025ab6965f722829a7f8f86566\/src%2FMicroweberPackages%2FApp%2Ffunctions%2Fplupload.php', 'patch': \"@@ -336,9 +336,12 @@\\n \/\/ Make sure the fileName is unique but only if chunking is disabled\\n if ($chunks < 2 && file_exists($targetDir . DIRECTORY_SEPARATOR . $fileName)) {\\n     $ext = strrpos($fileName, '.');\\n+\\n     $fileName_a = substr($fileName, 0, $ext);\\n     $fileName_b = substr($fileName, $ext);\\n \\n+    $fileName_b = strtolower($fileName_b);\\n+\\n     $count = 1;\\n     while (file_exists($targetDir . DIRECTORY_SEPARATOR . $fileName_a . '_' . $count . $fileName_b)) {\\n         ++$count;\\n@@ -500,7 +503,7 @@\\n \\n     if (is_file($filePath) and !$chunks || $chunk == $chunks - 1) {\\n         $ext = get_file_extension($filePath);\\n-\\n+        $ext = strtolower($ext);\\n         if (function_exists('finfo_open') and function_exists('finfo_file')) {\\n             $finfo = finfo_open(FILEINFO_MIME_TYPE); \/\/ return mime type ala mimetype extension\\n             $mime = @finfo_file($finfo, $filePath);\"}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/App\/functions\/plupload.php'])",
      "num_files":1.0,
      "patch_content":"From 9ebbb4dd35da74025ab6965f722829a7f8f86566 Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Fri, 1 Jul 2022 11:07:47 +0300\nSubject: [PATCH] update\n\n---\n src\/MicroweberPackages\/App\/functions\/plupload.php | 5 ++++-\n 1 file changed, 4 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/MicroweberPackages\/App\/functions\/plupload.php b\/src\/MicroweberPackages\/App\/functions\/plupload.php\nindex 3b6e31707cb..244980968ce 100644\n--- a\/src\/MicroweberPackages\/App\/functions\/plupload.php\n+++ b\/src\/MicroweberPackages\/App\/functions\/plupload.php\n@@ -336,9 +336,12 @@\n \/\/ Make sure the fileName is unique but only if chunking is disabled\n if ($chunks < 2 && file_exists($targetDir . DIRECTORY_SEPARATOR . $fileName)) {\n     $ext = strrpos($fileName, '.');\n+\n     $fileName_a = substr($fileName, 0, $ext);\n     $fileName_b = substr($fileName, $ext);\n \n+    $fileName_b = strtolower($fileName_b);\n+\n     $count = 1;\n     while (file_exists($targetDir . DIRECTORY_SEPARATOR . $fileName_a . '_' . $count . $fileName_b)) {\n         ++$count;\n@@ -500,7 +503,7 @@\n \n     if (is_file($filePath) and !$chunks || $chunk == $chunks - 1) {\n         $ext = get_file_extension($filePath);\n-\n+        $ext = strtolower($ext);\n         if (function_exists('finfo_open') and function_exists('finfo_file')) {\n             $finfo = finfo_open(FILEINFO_MIME_TYPE); \/\/ return mime type ala mimetype extension\n             $mime = @finfo_file($finfo, $filePath);",
      "code_diff":"@@ -336,9 +336,12 @@\n \/\/ Make sure the fileName is unique but only if chunking is disabled\n if ($chunks < 2 && file_exists($targetDir . DIRECTORY_SEPARATOR . $fileName)) {\n     $ext = strrpos($fileName, '.');\n+\n     $fileName_a = substr($fileName, 0, $ext);\n     $fileName_b = substr($fileName, $ext);\n \n+    $fileName_b = strtolower($fileName_b);\n+\n     $count = 1;\n     while (file_exists($targetDir . DIRECTORY_SEPARATOR . $fileName_a . '_' . $count . $fileName_b)) {\n         ++$count;\n@@ -500,7 +503,7 @@\n \n     if (is_file($filePath) and !$chunks || $chunk == $chunks - 1) {\n         $ext = get_file_extension($filePath);\n-\n+        $ext = strtolower($ext);\n         if (function_exists('finfo_open') and function_exists('finfo_file')) {\n             $finfo = finfo_open(FILEINFO_MIME_TYPE); \/\/ return mime type ala mimetype extension\n             $mime = @finfo_file($finfo, $filePath);"
    },
    {
      "index":12,
      "vuln_id":"GHSA-5vr6-hm68-5j9p",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/librenms\/librenms\/pull\/13554\/commits\/4f231a0f49b6c953d506913364ffd7fb3a660630'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in LibreNMS LibreNMS 21.11.0 is affected by is affected by a Cross Site Scripting (XSS) vulnerability in includes\/html\/forms\/poller-groups.inc.php.",
      "published_date":"2021-12-03",
      "chain_len":1,
      "project":"https:\/\/github.com\/librenms\/librenms",
      "commit_href":"https:\/\/github.com\/librenms\/librenms\/pull\/13554\/commits\/4f231a0f49b6c953d506913364ffd7fb3a660630",
      "commit_sha":"4f231a0f49b6c953d506913364ffd7fb3a660630",
      "patch":"SINGLE",
      "chain_ord":"['4f231a0f49b6c953d506913364ffd7fb3a660630']",
      "before_first_fix_commit":"{'fff7b45a7599f8f13a55250dc5f2b957f3394194'}",
      "last_fix_commit":"4f231a0f49b6c953d506913364ffd7fb3a660630",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/22\/2021, 22:31:45",
      "message":"fix XSS vulnerability in poller-groups.inc.php",
      "author":"AL-KASSAR",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'includes\/html\/forms\/poller-groups.inc.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/librenms\/librenms\/raw\/4f231a0f49b6c953d506913364ffd7fb3a660630\/includes%2Fhtml%2Fforms%2Fpoller-groups.inc.php', 'patch': '@@ -44,5 +44,5 @@\\n if (! empty($ok)) {\\n     exit(\"$ok\");\\n } else {\\n-    exit(\"ERROR: $error\");\\n+    exit(\"ERROR: \".htmlspecialchars($error));;\\n }'}}",
      "message_norm":"fix xss vulnerability in poller-groups.inc.php",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['includes\/html\/forms\/poller-groups.inc.php'])",
      "num_files":1.0,
      "patch_content":"From 4f231a0f49b6c953d506913364ffd7fb3a660630 Mon Sep 17 00:00:00 2001\nFrom: AL-KASSAR <feras.al-kassar@sap.com>\nDate: Mon, 22 Nov 2021 23:31:45 +0100\nSubject: [PATCH] fix XSS vulnerability in poller-groups.inc.php\n\n---\n includes\/html\/forms\/poller-groups.inc.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/includes\/html\/forms\/poller-groups.inc.php b\/includes\/html\/forms\/poller-groups.inc.php\nindex f7bec45bef2f..82b12b239a80 100644\n--- a\/includes\/html\/forms\/poller-groups.inc.php\n+++ b\/includes\/html\/forms\/poller-groups.inc.php\n@@ -44,5 +44,5 @@\n if (! empty($ok)) {\n     exit(\"$ok\");\n } else {\n-    exit(\"ERROR: $error\");\n+    exit(\"ERROR: \".htmlspecialchars($error));;\n }",
      "code_diff":"@@ -44,5 +44,5 @@\n if (! empty($ok)) {\n     exit(\"$ok\");\n } else {\n-    exit(\"ERROR: $error\");\n+    exit(\"ERROR: \".htmlspecialchars($error));;\n }"
    },
    {
      "index":13,
      "vuln_id":"GHSA-5q5w-mqp6-g2gh",
      "cwe_id":"{'CWE-434', 'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/jsdecena\/laracom\/commit\/256026193ce994dc4c1365e02f414d8a0cd77ae8'}",
      "dataset":"osv",
      "summary":"Unrestricted Upload of File with Dangerous Type in jsdecena\/laracom jsdecena\/laracom prior to version 2.0.9 is vulnerable to Unrestricted Upload of File with Dangerous Type.",
      "published_date":"2022-02-06",
      "chain_len":1,
      "project":"https:\/\/github.com\/jsdecena\/laracom",
      "commit_href":"https:\/\/github.com\/jsdecena\/laracom\/commit\/256026193ce994dc4c1365e02f414d8a0cd77ae8",
      "commit_sha":"256026193ce994dc4c1365e02f414d8a0cd77ae8",
      "patch":"SINGLE",
      "chain_ord":"['256026193ce994dc4c1365e02f414d8a0cd77ae8']",
      "before_first_fix_commit":"{'8ef50622cb9c696d79a7a6b37e9b43266da6545d'}",
      "last_fix_commit":"256026193ce994dc4c1365e02f414d8a0cd77ae8",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/01\/2022, 22:16:55",
      "message":"Fix vulnerability report from hunter.dev",
      "author":"Roland Jeffrey Decena",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 1, 'total': 4}",
      "files":"{'project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php': {'additions': 3, 'deletions': 1, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jsdecena\/laracom\/raw\/256026193ce994dc4c1365e02f414d8a0cd77ae8\/project%2Fapp%2FShop%2FProducts%2FRequests%2FUpdateProductRequest.php', 'patch': \"@@ -20,7 +20,9 @@ public function rules()\\n             'quantity' => ['required', 'integer', 'min:0'],\\n             'price' => ['required', 'numeric', 'min:0'],\\n             'sale_price' => ['nullable', 'numeric'],\\n-            'weight' => ['nullable', 'numeric', 'min:0']\\n+            'weight' => ['nullable', 'numeric', 'min:0'],\\n+            'image' => 'image|mimes:jpeg,png,jpg,gif,svg|max:2048',\\n+            'cover' => 'image|mimes:jpeg,png,jpg,gif,svg|max:2048',\\n         ];\\n     }\\n }\"}}",
      "message_norm":"fix vulnerability report from hunter.dev",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php'])",
      "num_files":1.0,
      "patch_content":"From 256026193ce994dc4c1365e02f414d8a0cd77ae8 Mon Sep 17 00:00:00 2001\nFrom: Roland Jeffrey Decena <jeff.decena@publictrust.co.nz>\nDate: Wed, 2 Feb 2022 11:16:55 +1300\nSubject: [PATCH] Fix vulnerability report from hunter.dev\n\n---\n project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a\/project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php b\/project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php\nindex 2ef53f04c..15278341c 100644\n--- a\/project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php\n+++ b\/project\/app\/Shop\/Products\/Requests\/UpdateProductRequest.php\n@@ -20,7 +20,9 @@ public function rules()\n             'quantity' => ['required', 'integer', 'min:0'],\n             'price' => ['required', 'numeric', 'min:0'],\n             'sale_price' => ['nullable', 'numeric'],\n-            'weight' => ['nullable', 'numeric', 'min:0']\n+            'weight' => ['nullable', 'numeric', 'min:0'],\n+            'image' => 'image|mimes:jpeg,png,jpg,gif,svg|max:2048',\n+            'cover' => 'image|mimes:jpeg,png,jpg,gif,svg|max:2048',\n         ];\n     }\n }",
      "code_diff":"@@ -20,7 +20,9 @@ public function rules()\n             'quantity' => ['required', 'integer', 'min:0'],\n             'price' => ['required', 'numeric', 'min:0'],\n             'sale_price' => ['nullable', 'numeric'],\n-            'weight' => ['nullable', 'numeric', 'min:0']\n+            'weight' => ['nullable', 'numeric', 'min:0'],\n+            'image' => 'image|mimes:jpeg,png,jpg,gif,svg|max:2048',\n+            'cover' => 'image|mimes:jpeg,png,jpg,gif,svg|max:2048',\n         ];\n     }\n }"
    },
    {
      "index":14,
      "vuln_id":"GHSA-vpwq-6cp4-ffqc",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/ba45d19e1d77a7eea866dab30eff5da552694891'}",
      "dataset":"osv",
      "summary":"Stored Cross-site Scripting in ShowDoc ShowDoc prior to version 2.10.4 is vulnerable to stored cross-site scripting viva `axd` and `cshtml` file upload.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/ba45d19e1d77a7eea866dab30eff5da552694891",
      "commit_sha":"ba45d19e1d77a7eea866dab30eff5da552694891",
      "patch":"SINGLE",
      "chain_ord":"['ba45d19e1d77a7eea866dab30eff5da552694891']",
      "before_first_fix_commit":"{'4e6b321c0d63ee7c4480409c7a68ae116096c4bc'}",
      "last_fix_commit":"ba45d19e1d77a7eea866dab30eff5da552694891",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 02:52:48",
      "message":"bug",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/ba45d19e1d77a7eea866dab30eff5da552694891\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -309,6 +309,8 @@ public function isDangerFilename($filename){\\n \\t\\t\\t|| $isDangerStr($filename , \".aspx\")\\n \\t\\t\\t|| $isDangerStr($filename , \".xsd\")\\n \\t\\t\\t|| $isDangerStr($filename , \".asa\")\\n+\\t\\t\\t|| $isDangerStr($filename , \".cshtml\")\\n+\\t\\t\\t|| $isDangerStr($filename , \".axd\")\\n \\t\\t) {\\n \\t\\t\\treturn true;\\n \\t\\t}'}}",
      "message_norm":"bug",
      "language":"id",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From ba45d19e1d77a7eea866dab30eff5da552694891 Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Mon, 14 Mar 2022 10:52:48 +0800\nSubject: [PATCH] bug\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 3a41ecd99..b518b9b57 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -309,6 +309,8 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".aspx\")\n \t\t\t|| $isDangerStr($filename , \".xsd\")\n \t\t\t|| $isDangerStr($filename , \".asa\")\n+\t\t\t|| $isDangerStr($filename , \".cshtml\")\n+\t\t\t|| $isDangerStr($filename , \".axd\")\n \t\t) {\n \t\t\treturn true;\n \t\t}",
      "code_diff":"@@ -309,6 +309,8 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".aspx\")\n \t\t\t|| $isDangerStr($filename , \".xsd\")\n \t\t\t|| $isDangerStr($filename , \".asa\")\n+\t\t\t|| $isDangerStr($filename , \".cshtml\")\n+\t\t\t|| $isDangerStr($filename , \".axd\")\n \t\t) {\n \t\t\treturn true;\n \t\t}"
    },
    {
      "index":15,
      "vuln_id":"GHSA-j6p2-cx3w-6jcp",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/jashkenas\/backbone\/commit\/0cdc525961d3fa98e810ffae6bcc8e3838e36d93'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in backbone Affected versions of `backbone` are vulnerable to cross-site scripting when users are allowed to supply input to the `Model#Escape` function, and the output is then written to the DOM. \n\nThe vulnerability occurs as a result of the regular expression used to encode metacharacters failing to take HTML Entities such as `&#60;` into account.\n\n\n## Recommendation\n\nUpdate to version 0.5.0 or later.",
      "published_date":"2019-02-18",
      "chain_len":1,
      "project":"https:\/\/github.com\/jashkenas\/backbone",
      "commit_href":"https:\/\/github.com\/jashkenas\/backbone\/commit\/0cdc525961d3fa98e810ffae6bcc8e3838e36d93",
      "commit_sha":"0cdc525961d3fa98e810ffae6bcc8e3838e36d93",
      "patch":"SINGLE",
      "chain_ord":"['0cdc525961d3fa98e810ffae6bcc8e3838e36d93']",
      "before_first_fix_commit":"{'7216d993502da2e312fc53f4e8edc8b534c25042'}",
      "last_fix_commit":"0cdc525961d3fa98e810ffae6bcc8e3838e36d93",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/01\/2011, 21:12:24",
      "message":"Fixed escapeHTML function\nto skip not only &***;, but also &#***; and &x***;",
      "author":"Dmitry Baranovskiy",
      "comments":"{'com_1': {'author': 'alanhogan', 'datetime': '03\/06\/2011, 02:31:15', 'body': 'What are your thoughts on escaping single quotes?\\n\\nUsing single quotes around attribute values is less common than double quotes, but is certainly done:\\n\\n```\\n<p id=\\'foo\\'>\u2026<\/p>\\n```\\n\\nThis can lead to XSS just as unescaped double-quotes can:\\n\\n```\\nvar attack = \" \\' onmouseover=\\'alert(1);\\' foo=\\' \";\\nvar html = \"<p data-user-input=\\'\"+escapeHTML(attack)+\"\\'>Foo<\/p>\";\\ndocument.write(html);\\n```\\n\\nIMO, single quotes really ought to be escaped, as well.'}, 'com_2': {'author': 'alanhogan', 'datetime': '03\/06\/2011, 02:37:31', 'body': 'Demo of attack on jsfiddle: http:\/\/jsfiddle.net\/wEzNJ\/'}}",
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'backbone.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jashkenas\/backbone\/raw\/0cdc525961d3fa98e810ffae6bcc8e3838e36d93\/backbone.js', 'patch': '@@ -1079,7 +1079,7 @@\\n \\n   \/\/ Helper function to escape a string for HTML rendering.\\n   var escapeHTML = function(string) {\\n-    return string.replace(\/&(?!\\\\w+;)\/g, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\').replace(\/\"\/g, \\'&quot;\\');\\n+    return string.replace(\/&(?!\\\\w+;|#\\\\d+;|#x[\\\\da-f]+;)\/gi, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\').replace(\/\"\/g, \\'&quot;\\');\\n   };\\n \\n }).call(this);'}}",
      "message_norm":"fixed escapehtml function\nto skip not only &***;, but also &#***; and &x***;",
      "language":"en",
      "entities":"[('fixed', 'ACTION', ''), ('escapehtml', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['backbone.js'])",
      "num_files":1.0,
      "patch_content":"From 0cdc525961d3fa98e810ffae6bcc8e3838e36d93 Mon Sep 17 00:00:00 2001\nFrom: Dmitry Baranovskiy <Dmitry@Baranovskiy.com>\nDate: Wed, 2 Mar 2011 08:12:24 +1100\nSubject: [PATCH] Fixed escapeHTML function to skip not only &***;, but also\n &#***; and &x***;\n\n---\n backbone.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/backbone.js b\/backbone.js\nindex 98ba0ddc0..47e85aeb8 100644\n--- a\/backbone.js\n+++ b\/backbone.js\n@@ -1079,7 +1079,7 @@\n \n   \/\/ Helper function to escape a string for HTML rendering.\n   var escapeHTML = function(string) {\n-    return string.replace(\/&(?!\\w+;)\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n+    return string.replace(\/&(?!\\w+;|#\\d+;|#x[\\da-f]+;)\/gi, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n   };\n \n }).call(this);",
      "code_diff":"@@ -1079,7 +1079,7 @@\n \n   \/\/ Helper function to escape a string for HTML rendering.\n   var escapeHTML = function(string) {\n-    return string.replace(\/&(?!\\w+;)\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n+    return string.replace(\/&(?!\\w+;|#\\d+;|#x[\\da-f]+;)\/gi, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n   };\n \n }).call(this);"
    },
    {
      "index":16,
      "vuln_id":"GHSA-h4mx-xv96-2jgm",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/TYPO3\/typo3\/commit\/da611775f92102d7602713003f4c79606c8a445d'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in TYPO3's Frontend Login Mailer > ### Meta\n> * CVSS: `CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:R\/S:C\/C:L\/I:L\/A:N\/E:F\/RL:O\/RC:C` (4.9)\n\n### Problem\nUser submitted content was used without being properly encoded in HTML emails sent to users. The actually affected components were mail clients used to view those messages.\n\n### Solution\nUpdate to TYPO3 versions 9.5.35 ELTS, 10.4.29, 11.5.11 that fix the problem described above.\n\n### Credits\nThanks to Christian Seifert who reported this issue and to TYPO3 framework merger Andreas Fernandez who fixed the issue.\n\n### References\n* [TYPO3-CORE-SA-2022-004](https:\/\/typo3.org\/security\/advisory\/typo3-core-sa-2022-004)",
      "published_date":"2022-06-17",
      "chain_len":1,
      "project":"https:\/\/github.com\/TYPO3\/typo3",
      "commit_href":"https:\/\/github.com\/TYPO3\/typo3\/commit\/da611775f92102d7602713003f4c79606c8a445d",
      "commit_sha":"da611775f92102d7602713003f4c79606c8a445d",
      "patch":"SINGLE",
      "chain_ord":"['da611775f92102d7602713003f4c79606c8a445d']",
      "before_first_fix_commit":"{'6f2554dc4ea0b670fd5599c54fd788d4db96c4a0'}",
      "last_fix_commit":"da611775f92102d7602713003f4c79606c8a445d",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/14\/2022, 07:18:04",
      "message":"[SECURITY] Avoid HTML injection in password recovery mail\n\nThe `receiverName` variable used in the password recovery mail of the\nExtbase felogin plugin was susceptible to HTML injection due to\nmissing sanitization. The variable is now passed thru the\n`f:format.htmlspecialchars` ViewHelper.\n\nResolves: #96559\nReleases: main, 11.5, 10.4\nChange-Id: I60e23c161f7f2fcc87b8870345b10a4c31d7b8db\nSecurity-Bulletin: TYPO3-CORE-SA-2022-004\nSecurity-References: CVE-2022-31049\nReviewed-on: https:\/\/review.typo3.org\/c\/Packages\/TYPO3.CMS\/+\/74904\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
      "author":"Andreas Fernandez",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'typo3\/sysext\/felogin\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/TYPO3\/typo3\/raw\/da611775f92102d7602713003f4c79606c8a445d\/typo3%2Fsysext%2Ffelogin%2FResources%2FPrivate%2FEmail%2FTemplates%2FPasswordRecovery.html', 'patch': '@@ -9,7 +9,7 @@\\n         {f:translate(\\n         key: \\'forgot_validate_reset_password_html\\',\\n         extensionName: \\'felogin\\',\\n-        arguments: \\'{ 0: receiverName, 1: recoveryLink, 2: validUntil }\\'\\n+        arguments: \\'{ 0: \"{receiverName -> f:format.htmlspecialchars()}\", 1: recoveryLink, 2: validUntil }\\'\\n         ) -> f:format.html()}\\n     <\/f:spaceless>\\n <\/f:section>'}}",
      "message_norm":"[security] avoid html injection in password recovery mail\n\nthe `receivername` variable used in the password recovery mail of the\nextbase felogin plugin was susceptible to html injection due to\nmissing sanitization. the variable is now passed thru the\n`f:format.htmlspecialchars` viewhelper.\n\nresolves: #96559\nreleases: main, 11.5, 10.4\nchange-id: i60e23c161f7f2fcc87b8870345b10a4c31d7b8db\nsecurity-bulletin: typo3-core-sa-2022-004\nsecurity-references: cve-2022-31049\nreviewed-on: https:\/\/review.typo3.org\/c\/packages\/typo3.cms\/+\/74904\ntested-by: oliver hader <oliver.hader@typo3.org>\nreviewed-by: oliver hader <oliver.hader@typo3.org>",
      "language":"en",
      "entities":"[('security', 'SECWORD', ''), ('injection', 'SECWORD', ''), ('password', 'SECWORD', ''), ('password', 'SECWORD', ''), ('injection', 'SECWORD', ''), ('sanitization', 'SECWORD', ''), ('format.htmlspecialchars', 'SECWORD', ''), ('#96559', 'ISSUE', ''), ('security', 'SECWORD', ''), ('security', 'SECWORD', ''), ('cve-2022-31049', 'VULNID', 'CVE'), ('https:\/\/review.typo3.org\/c\/packages\/typo3.cms\/+\/74904', 'URL', ''), ('oliver.hader@typo3.org', 'EMAIL', ''), ('oliver.hader@typo3.org', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['typo3\/sysext\/felogin\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html'])",
      "num_files":1.0,
      "patch_content":"From da611775f92102d7602713003f4c79606c8a445d Mon Sep 17 00:00:00 2001\nFrom: Andreas Fernandez <a.fernandez@scripting-base.de>\nDate: Tue, 14 Jun 2022 09:18:04 +0200\nSubject: [PATCH] [SECURITY] Avoid HTML injection in password recovery mail\n\nThe `receiverName` variable used in the password recovery mail of the\nExtbase felogin plugin was susceptible to HTML injection due to\nmissing sanitization. The variable is now passed thru the\n`f:format.htmlspecialchars` ViewHelper.\n\nResolves: #96559\nReleases: main, 11.5, 10.4\nChange-Id: I60e23c161f7f2fcc87b8870345b10a4c31d7b8db\nSecurity-Bulletin: TYPO3-CORE-SA-2022-004\nSecurity-References: CVE-2022-31049\nReviewed-on: https:\/\/review.typo3.org\/c\/Packages\/TYPO3.CMS\/+\/74904\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>\n---\n ...\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html     | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/typo3\/sysext\/felogin\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html b\/typo3\/sysext\/felogin\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html\nindex b6eb95d7f04c..9ce5344654b4 100644\n--- a\/typo3\/sysext\/felogin\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html\n+++ b\/typo3\/sysext\/felogin\/Resources\/Private\/Email\/Templates\/PasswordRecovery.html\n@@ -9,7 +9,7 @@\n         {f:translate(\n         key: 'forgot_validate_reset_password_html',\n         extensionName: 'felogin',\n-        arguments: '{ 0: receiverName, 1: recoveryLink, 2: validUntil }'\n+        arguments: '{ 0: \"{receiverName -> f:format.htmlspecialchars()}\", 1: recoveryLink, 2: validUntil }'\n         ) -> f:format.html()}\n     <\/f:spaceless>\n <\/f:section>",
      "code_diff":"@@ -9,7 +9,7 @@\n         {f:translate(\n         key: 'forgot_validate_reset_password_html',\n         extensionName: 'felogin',\n-        arguments: '{ 0: receiverName, 1: recoveryLink, 2: validUntil }'\n+        arguments: '{ 0: \"{receiverName -> f:format.htmlspecialchars()}\", 1: recoveryLink, 2: validUntil }'\n         ) -> f:format.html()}\n     <\/f:spaceless>\n <\/f:section>"
    },
    {
      "index":17,
      "vuln_id":"GHSA-wx69-rvg3-x7fc",
      "cwe_id":"{'CWE-79'}",
      "score":9.0,
      "chain":"{'https:\/\/github.com\/NodeBB\/NodeBB\/commit\/1783f918bc19568f421473824461ff2ed7755e4c'}",
      "dataset":"osv",
      "summary":"XSS via prototype pollution in NodeBB  ### Impact\nA prototype pollution vulnerability in the uploader module allowed a malicious user to inject arbitrary data (i.e. javascript) into the DOM, theoretically allowing for an account takeover when used in conjunction with a path traversal vulnerability disclosed at the same time as this report.\n\n### Patches\nThe vulnerability has been patched as of v1.18.5.\n\n### Workarounds\nCherry-pick commit hash 1783f918bc19568f421473824461ff2ed7755e4c to receive this patch in lieu of a full upgrade.\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at [security@nodebb.org](mailto:security@nodebb.org)",
      "published_date":"2021-11-30",
      "chain_len":1,
      "project":"https:\/\/github.com\/NodeBB\/NodeBB",
      "commit_href":"https:\/\/github.com\/NodeBB\/NodeBB\/commit\/1783f918bc19568f421473824461ff2ed7755e4c",
      "commit_sha":"1783f918bc19568f421473824461ff2ed7755e4c",
      "patch":"SINGLE",
      "chain_ord":"['1783f918bc19568f421473824461ff2ed7755e4c']",
      "before_first_fix_commit":"{'c8b2fc46dc698db687379106b3f01c71b80f495f'}",
      "last_fix_commit":"1783f918bc19568f421473824461ff2ed7755e4c",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/25\/2021, 17:17:33",
      "message":"fix: guard against prototype pollution",
      "author":"Bar\u0131\u015f Soner U\u015fakl\u0131",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 2, 'total': 5}",
      "files":"{'src\/socket.io\/uploads.js': {'additions': 3, 'deletions': 2, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/NodeBB\/NodeBB\/raw\/1783f918bc19568f421473824461ff2ed7755e4c\/src%2Fsocket.io%2Fuploads.js', 'patch': \"@@ -15,11 +15,12 @@ uploads.upload = async function (socket, data) {\\n \\t\\t'user.updateCover': socketUser.updateCover,\\n \\t\\t'groups.cover.update': socketGroup.cover.update,\\n \\t};\\n-\\tif (!socket.uid || !data || !data.chunk || !data.params || !data.params.method || !methodToFunc[data.params.method]) {\\n+\\tif (!socket.uid || !data || !data.chunk ||\\n+\\t\\t!data.params || !data.params.method || !methodToFunc.hasOwnProperty(data.params.method)) {\\n \\t\\tthrow new Error('[[error:invalid-data]]');\\n \\t}\\n \\n-\\tinProgress[socket.id] = inProgress[socket.id] || {};\\n+\\tinProgress[socket.id] = inProgress[socket.id] || Object.create(null);\\n \\tconst socketUploads = inProgress[socket.id];\\n \\tconst { method } = data.params;\"}}",
      "message_norm":"fix: guard against prototype pollution",
      "language":"en",
      "entities":"[('prototype pollution', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/socket.io\/uploads.js'])",
      "num_files":1.0,
      "patch_content":"From 1783f918bc19568f421473824461ff2ed7755e4c Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Bar=C4=B1=C5=9F=20Soner=20U=C5=9Fakl=C4=B1?=\n <barisusakli@gmail.com>\nDate: Mon, 25 Oct 2021 13:17:33 -0400\nSubject: [PATCH] fix: guard against prototype pollution\n\n---\n src\/socket.io\/uploads.js | 5 +++--\n 1 file changed, 3 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/socket.io\/uploads.js b\/src\/socket.io\/uploads.js\nindex c3fd025e0da5..66b7266b0124 100644\n--- a\/src\/socket.io\/uploads.js\n+++ b\/src\/socket.io\/uploads.js\n@@ -15,11 +15,12 @@ uploads.upload = async function (socket, data) {\n \t\t'user.updateCover': socketUser.updateCover,\n \t\t'groups.cover.update': socketGroup.cover.update,\n \t};\n-\tif (!socket.uid || !data || !data.chunk || !data.params || !data.params.method || !methodToFunc[data.params.method]) {\n+\tif (!socket.uid || !data || !data.chunk ||\n+\t\t!data.params || !data.params.method || !methodToFunc.hasOwnProperty(data.params.method)) {\n \t\tthrow new Error('[[error:invalid-data]]');\n \t}\n \n-\tinProgress[socket.id] = inProgress[socket.id] || {};\n+\tinProgress[socket.id] = inProgress[socket.id] || Object.create(null);\n \tconst socketUploads = inProgress[socket.id];\n \tconst { method } = data.params;",
      "code_diff":"@@ -15,11 +15,12 @@ uploads.upload = async function (socket, data) {\n \t\t'user.updateCover': socketUser.updateCover,\n \t\t'groups.cover.update': socketGroup.cover.update,\n \t};\n-\tif (!socket.uid || !data || !data.chunk || !data.params || !data.params.method || !methodToFunc[data.params.method]) {\n+\tif (!socket.uid || !data || !data.chunk ||\n+\t\t!data.params || !data.params.method || !methodToFunc.hasOwnProperty(data.params.method)) {\n \t\tthrow new Error('[[error:invalid-data]]');\n \t}\n \n-\tinProgress[socket.id] = inProgress[socket.id] || {};\n+\tinProgress[socket.id] = inProgress[socket.id] || Object.create(null);\n \tconst socketUploads = inProgress[socket.id];\n \tconst { method } = data.params;"
    },
    {
      "index":18,
      "vuln_id":"GHSA-95hx-62rh-gg96",
      "cwe_id":"{'CWE-79'}",
      "score":8.0,
      "chain":"{'https:\/\/github.com\/PrestaShop\/contactform\/commit\/ecd9f5d14920ec00885766a7cb41bcc5ed8bfa09'}",
      "dataset":"osv",
      "summary":"Potential XSS injection In PrestaShop contactform ### Impact\nAn attacker is able to inject javascript while using the contact form. \n\n### Patches\nThe problem is fixed in v4.3.0\n\n### References\n[Cross-site Scripting (XSS) - Stored (CWE-79)](https:\/\/cwe.mitre.org\/data\/definitions\/79.html)",
      "published_date":"2020-09-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/PrestaShop\/contactform",
      "commit_href":"https:\/\/github.com\/PrestaShop\/contactform\/commit\/ecd9f5d14920ec00885766a7cb41bcc5ed8bfa09",
      "commit_sha":"ecd9f5d14920ec00885766a7cb41bcc5ed8bfa09",
      "patch":"SINGLE",
      "chain_ord":"['ecd9f5d14920ec00885766a7cb41bcc5ed8bfa09']",
      "before_first_fix_commit":"{'a883e56240357b4aaaf594ade573bb596e518078', 'aa3c77923734854bb7168f30db43544e42638202'}",
      "last_fix_commit":"ecd9f5d14920ec00885766a7cb41bcc5ed8bfa09",
      "chain_ord_pos":1.0,
      "commit_datetime":"09\/15\/2020, 08:03:00",
      "message":"Merge pull request from GHSA-95hx-62rh-gg96\n\nDo not unescape form message data",
      "author":"GoT",
      "comments":null,
      "stats":"{'additions': 9, 'deletions': 8, 'total': 17}",
      "files":"{'contactform.php': {'additions': 9, 'deletions': 8, 'changes': 17, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/PrestaShop\/contactform\/raw\/ecd9f5d14920ec00885766a7cb41bcc5ed8bfa09\/contactform.php', 'patch': \"@@ -317,7 +317,7 @@ public function getWidgetVariables($hookName = null, array $configuration = [])\\n             }\\n         }\\n         $this->contact['contacts'] = $this->getTemplateVarContact();\\n-        $this->contact['message'] = html_entity_decode(Tools::getValue('message'));\\n+        $this->contact['message'] = Tools::getValue('message');\\n         $this->contact['allow_file_upload'] = (bool) Configuration::get('PS_CUSTOMER_SERVICE_FILE_UPLOAD');\\n \\n         if (!(bool)Configuration::isCatalogMode()) {\\n@@ -388,9 +388,10 @@ public function getTemplateVarOrders()\\n     {\\n         $orders = [];\\n \\n-        if (!isset($this->customer_thread['id_order'])\\n+        if (empty($this->customer_thread['id_order'])\\n             && isset($this->context->customer)\\n-            && $this->context->customer->isLogged()) {\\n+            && $this->context->customer->isLogged()\\n+        ) {\\n             $customer_orders = Order::getCustomerOrders($this->context->customer->id);\\n \\n             foreach ($customer_orders as $customer_order) {\\n@@ -401,7 +402,7 @@ public function getTemplateVarOrders()\\n                     $orders[$customer_order['id_order']]['products'] = $myOrder->getProducts();\\n                 }\\n             }\\n-        } elseif (isset($this->customer_thread['id_order']) && (int)$this->customer_thread['id_order'] > 0) {\\n+        } elseif (isset($this->customer_thread['id_order']) && (int) $this->customer_thread['id_order'] > 0) {\\n             $myOrder = new Order($this->customer_thread['id_order']);\\n \\n             if (Validate::isLoadedObject($myOrder)) {\\n@@ -411,13 +412,13 @@ public function getTemplateVarOrders()\\n             }\\n         }\\n \\n-        if (isset($this->customer_thread['id_product'])) {\\n+        if (!empty($this->customer_thread['id_product'])) {\\n             $id_order = isset($this->customer_thread['id_order']) ?\\n-                      (int)$this->customer_thread['id_order'] :\\n+                      (int) $this->customer_thread['id_order'] :\\n                       0;\\n \\n             $orders[$id_order]['products'][(int)$this->customer_thread['id_product']] = $this->context->controller->objectPresenter->present(\\n-                new Product((int)$this->customer_thread['id_product'])\\n+                new Product((int) $this->customer_thread['id_product'])\\n             );\\n         }\\n \\n@@ -586,7 +587,7 @@ public function sendMessage()\\n                     '{lastname}' => '',\\n                     '{order_name}' => '-',\\n                     '{attached_file}' => '-',\\n-                    '{message}' => Tools::nl2br(Tools::stripslashes($message)),\\n+                    '{message}' => Tools::nl2br(Tools::htmlentitiesUTF8(Tools::stripslashes($message))),\\n                     '{email}' =>  $from,\\n                     '{product_name}' => '',\\n                 ];\"}}",
      "message_norm":"merge pull request from ghsa-95hx-62rh-gg96\n\ndo not unescape form message data",
      "language":"fr",
      "entities":"[('ghsa-95hx-62rh-gg96', 'VULNID', 'GHSA'), ('unescape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['contactform.php'])",
      "num_files":1.0,
      "patch_content":"From aa3c77923734854bb7168f30db43544e42638202 Mon Sep 17 00:00:00 2001\nFrom: Pierre RAMBAUD <pierre.rambaud86@gmail.com>\nDate: Mon, 10 Aug 2020 17:09:40 +0200\nSubject: [PATCH] Do not unescape form message data\n\n---\n contactform.php | 17 +++++++++--------\n 1 file changed, 9 insertions(+), 8 deletions(-)\n\ndiff --git a\/contactform.php b\/contactform.php\nindex 0f94633..3135a3f 100644\n--- a\/contactform.php\n+++ b\/contactform.php\n@@ -317,7 +317,7 @@ public function getWidgetVariables($hookName = null, array $configuration = [])\n             }\n         }\n         $this->contact['contacts'] = $this->getTemplateVarContact();\n-        $this->contact['message'] = html_entity_decode(Tools::getValue('message'));\n+        $this->contact['message'] = Tools::getValue('message');\n         $this->contact['allow_file_upload'] = (bool) Configuration::get('PS_CUSTOMER_SERVICE_FILE_UPLOAD');\n \n         if (!(bool)Configuration::isCatalogMode()) {\n@@ -388,9 +388,10 @@ public function getTemplateVarOrders()\n     {\n         $orders = [];\n \n-        if (!isset($this->customer_thread['id_order'])\n+        if (empty($this->customer_thread['id_order'])\n             && isset($this->context->customer)\n-            && $this->context->customer->isLogged()) {\n+            && $this->context->customer->isLogged()\n+        ) {\n             $customer_orders = Order::getCustomerOrders($this->context->customer->id);\n \n             foreach ($customer_orders as $customer_order) {\n@@ -401,7 +402,7 @@ public function getTemplateVarOrders()\n                     $orders[$customer_order['id_order']]['products'] = $myOrder->getProducts();\n                 }\n             }\n-        } elseif (isset($this->customer_thread['id_order']) && (int)$this->customer_thread['id_order'] > 0) {\n+        } elseif (isset($this->customer_thread['id_order']) && (int) $this->customer_thread['id_order'] > 0) {\n             $myOrder = new Order($this->customer_thread['id_order']);\n \n             if (Validate::isLoadedObject($myOrder)) {\n@@ -411,13 +412,13 @@ public function getTemplateVarOrders()\n             }\n         }\n \n-        if (isset($this->customer_thread['id_product'])) {\n+        if (!empty($this->customer_thread['id_product'])) {\n             $id_order = isset($this->customer_thread['id_order']) ?\n-                      (int)$this->customer_thread['id_order'] :\n+                      (int) $this->customer_thread['id_order'] :\n                       0;\n \n             $orders[$id_order]['products'][(int)$this->customer_thread['id_product']] = $this->context->controller->objectPresenter->present(\n-                new Product((int)$this->customer_thread['id_product'])\n+                new Product((int) $this->customer_thread['id_product'])\n             );\n         }\n \n@@ -584,7 +585,7 @@ public function sendMessage()\n                 $var_list = [\n                     '{order_name}' => '-',\n                     '{attached_file}' => '-',\n-                    '{message}' => Tools::nl2br(Tools::stripslashes($message)),\n+                    '{message}' => Tools::nl2br(Tools::htmlentitiesUTF8(Tools::stripslashes($message))),\n                     '{email}' =>  $from,\n                     '{product_name}' => '',\n                 ];",
      "code_diff":"@@ -317,7 +317,7 @@ public function getWidgetVariables($hookName = null, array $configuration = [])\n             }\n         }\n         $this->contact['contacts'] = $this->getTemplateVarContact();\n-        $this->contact['message'] = html_entity_decode(Tools::getValue('message'));\n+        $this->contact['message'] = Tools::getValue('message');\n         $this->contact['allow_file_upload'] = (bool) Configuration::get('PS_CUSTOMER_SERVICE_FILE_UPLOAD');\n \n         if (!(bool)Configuration::isCatalogMode()) {\n@@ -388,9 +388,10 @@ public function getTemplateVarOrders()\n     {\n         $orders = [];\n \n-        if (!isset($this->customer_thread['id_order'])\n+        if (empty($this->customer_thread['id_order'])\n             && isset($this->context->customer)\n-            && $this->context->customer->isLogged()) {\n+            && $this->context->customer->isLogged()\n+        ) {\n             $customer_orders = Order::getCustomerOrders($this->context->customer->id);\n \n             foreach ($customer_orders as $customer_order) {\n@@ -401,7 +402,7 @@ public function getTemplateVarOrders()\n                     $orders[$customer_order['id_order']]['products'] = $myOrder->getProducts();\n                 }\n             }\n-        } elseif (isset($this->customer_thread['id_order']) && (int)$this->customer_thread['id_order'] > 0) {\n+        } elseif (isset($this->customer_thread['id_order']) && (int) $this->customer_thread['id_order'] > 0) {\n             $myOrder = new Order($this->customer_thread['id_order']);\n \n             if (Validate::isLoadedObject($myOrder)) {\n@@ -411,13 +412,13 @@ public function getTemplateVarOrders()\n             }\n         }\n \n-        if (isset($this->customer_thread['id_product'])) {\n+        if (!empty($this->customer_thread['id_product'])) {\n             $id_order = isset($this->customer_thread['id_order']) ?\n-                      (int)$this->customer_thread['id_order'] :\n+                      (int) $this->customer_thread['id_order'] :\n                       0;\n \n             $orders[$id_order]['products'][(int)$this->customer_thread['id_product']] = $this->context->controller->objectPresenter->present(\n-                new Product((int)$this->customer_thread['id_product'])\n+                new Product((int) $this->customer_thread['id_product'])\n             );\n         }\n \n@@ -584,7 +585,7 @@ public function sendMessage()\n                 $var_list = [\n                     '{order_name}' => '-',\n                     '{attached_file}' => '-',\n-                    '{message}' => Tools::nl2br(Tools::stripslashes($message)),\n+                    '{message}' => Tools::nl2br(Tools::htmlentitiesUTF8(Tools::stripslashes($message))),\n                     '{email}' =>  $from,\n                     '{product_name}' => '',\n                 ];"
    },
    {
      "index":19,
      "vuln_id":"GHSA-82j4-vr25-x394",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/78522520892d4e29cc94148c6ec84a204a607b73'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc is vulnerable to stored cross-site scripting due to unrestricted file upload in versions 2.10.3 and prior. A patch is available and anticipated to be part of version 2.10.4.",
      "published_date":"2022-03-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/78522520892d4e29cc94148c6ec84a204a607b73",
      "commit_sha":"78522520892d4e29cc94148c6ec84a204a607b73",
      "patch":"SINGLE",
      "chain_ord":"['78522520892d4e29cc94148c6ec84a204a607b73']",
      "before_first_fix_commit":"{'52d1d902084387bec22a64e6027f100e939733c8', '830c89a4c2c5fd0dd491422bf8e97b4eb5713f55'}",
      "last_fix_commit":"78522520892d4e29cc94148c6ec84a204a607b73",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/13\/2022, 10:39:59",
      "message":"Merge pull request #1629 from ajaysenr\/master\n\nUpdate AttachmentModel.class.php",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/78522520892d4e29cc94148c6ec84a204a607b73\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -304,6 +304,7 @@ public function isDangerFilename($filename){\\n \\t\\t\\t|| $isDangerStr($filename , \"%\")\\n \\t\\t\\t|| $isDangerStr($filename , \".xml\")\\n \\t\\t\\t|| $isDangerStr($filename , \".xxhtml\")\\n+\\t\\t\\t|| $isDangerStr($filename , \".aspx\")\\t\\t\\t\\n \\t\\t) {\\n \\t\\t\\treturn true;\\n \\t\\t}'}}",
      "message_norm":"merge pull request #1629 from ajaysenr\/master\n\nupdate attachmentmodel.class.php",
      "language":"en",
      "entities":"[('#1629', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 52d1d902084387bec22a64e6027f100e939733c8 Mon Sep 17 00:00:00 2001\nFrom: Ajaysen R <40132420+ajaysenr@users.noreply.github.com>\nDate: Sun, 13 Mar 2022 09:55:17 +0000\nSubject: [PATCH] Update AttachmentModel.class.php\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 3dac201f4..ee9fd9f9c 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -304,6 +304,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \"%\")\n \t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t\t|| $isDangerStr($filename , \".xxhtml\")\n+\t\t\t|| $isDangerStr($filename , \".aspx\")\t\t\t\n \t\t) {\n \t\t\treturn true;\n \t\t}",
      "code_diff":"@@ -304,6 +304,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \"%\")\n \t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t\t|| $isDangerStr($filename , \".xxhtml\")\n+\t\t\t|| $isDangerStr($filename , \".aspx\")\t\t\t\n \t\t) {\n \t\t\treturn true;\n \t\t}"
    },
    {
      "index":20,
      "vuln_id":"GHSA-m52x-29pq-w3vv",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/mpetroff\/pannellum\/commit\/cc2f3d99953de59db908e0c6efd1c2c17f7c6914'}",
      "dataset":"osv",
      "summary":"Pannellum Cross-Site Scripting due to data not being sanitized for URIs or vbscript Versions of `pannellum` prior to 2.5.6 are vulnerable to Cross-Site Scripting (XSS). The package fails to sanitize URLs for data URIs, which may allow attackers to execute arbitrary code in a victim's browser. \n\n\n## Recommendation\n\nUpgrade to version 2.5.6 or later.",
      "published_date":"2019-11-22",
      "chain_len":1,
      "project":"https:\/\/github.com\/mpetroff\/pannellum",
      "commit_href":"https:\/\/github.com\/mpetroff\/pannellum\/commit\/cc2f3d99953de59db908e0c6efd1c2c17f7c6914",
      "commit_sha":"cc2f3d99953de59db908e0c6efd1c2c17f7c6914",
      "patch":"SINGLE",
      "chain_ord":"['cc2f3d99953de59db908e0c6efd1c2c17f7c6914']",
      "before_first_fix_commit":"{'40111b237e763821437f501c94d8511022274dc3', 'f42e80facb41bb97321a0e2056d9ef5a4779e627'}",
      "last_fix_commit":"cc2f3d99953de59db908e0c6efd1c2c17f7c6914",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/22\/2019, 01:35:45",
      "message":"Merge pull request from GHSA-m52x-29pq-w3vv\n\nFix potential XSS vulnerability",
      "author":"Matthew Petroff",
      "comments":null,
      "stats":"{'additions': 13, 'deletions': 6, 'total': 19}",
      "files":"{'src\/js\/pannellum.js': {'additions': 13, 'deletions': 6, 'changes': 19, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/mpetroff\/pannellum\/raw\/cc2f3d99953de59db908e0c6efd1c2c17f7c6914\/src%2Fjs%2Fpannellum.js', 'patch': \"@@ -1719,7 +1719,7 @@ function createHotSpot(hs) {\\n         if (config.basePath && !absoluteURL(imgp))\\n             imgp = config.basePath + imgp;\\n         a = document.createElement('a');\\n-        a.href = sanitizeURL(hs.URL ? hs.URL : imgp);\\n+        a.href = sanitizeURL(hs.URL ? hs.URL : imgp, true);\\n         a.target = '_blank';\\n         span.appendChild(a);\\n         var image = document.createElement('img');\\n@@ -1731,7 +1731,7 @@ function createHotSpot(hs) {\\n         span.style.maxWidth = 'initial';\\n     } else if (hs.URL) {\\n         a = document.createElement('a');\\n-        a.href = sanitizeURL(hs.URL);\\n+        a.href = sanitizeURL(hs.URL, true);\\n         if (hs.attributes) {\\n             for (var key in hs.attributes) {\\n                 a.setAttribute(key, hs.attributes[key]);\\n@@ -2005,7 +2005,7 @@ function processOptions(isPreview) {\\n                 var authorText = escapeHTML(config[key]);\\n                 if (config.authorURL) {\\n                     var authorLink = document.createElement('a');\\n-                    authorLink.href = sanitizeURL(config['authorURL']);\\n+                    authorLink.href = sanitizeURL(config['authorURL'], true);\\n                     authorLink.target = '_blank';\\n                     authorLink.innerHTML = escapeHTML(config[key]);\\n                     authorText = authorLink.outerHTML;\\n@@ -2016,7 +2016,7 @@ function processOptions(isPreview) {\\n             \\n             case 'fallback':\\n                 var link = document.createElement('a');\\n-                link.href = sanitizeURL(config[key]);\\n+                link.href = sanitizeURL(config[key], true);\\n                 link.target = '_blank';\\n                 link.textContent = 'Click here to view this panorama in an alternative viewer.';\\n                 var message = document.createElement('p');\\n@@ -2378,10 +2378,17 @@ function escapeHTML(s) {\\n  * The URL cannot be of protocol 'javascript'.\\n  * @private\\n  * @param {string} url - URL to sanitize\\n+ * @param {boolean} href - True if URL is for link (blocks data URIs)\\n  * @returns {string} Sanitized URL\\n  *\/\\n-function sanitizeURL(url) {\\n-    if (url.trim().toLowerCase().indexOf('javascript:') === 0) {\\n+function sanitizeURL(url, href) {\\n+    if (url.trim().toLowerCase().indexOf('javascript:') === 0 ||\\n+        url.trim().toLowerCase().indexOf('vbscript:') === 0) {\\n+        console.log('Script URL removed.');\\n+        return 'about:blank';\\n+    }\\n+    if (href && url.trim().toLowerCase().indexOf('data:') === 0) {\\n+        console.log('Data URI removed from link.');\\n         return 'about:blank';\\n     }\\n     return url;\"}}",
      "message_norm":"merge pull request from ghsa-m52x-29pq-w3vv\n\nfix potential xss vulnerability",
      "language":"ca",
      "entities":"[('ghsa-m52x-29pq-w3vv', 'VULNID', 'GHSA'), ('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/js\/pannellum.js'])",
      "num_files":1.0,
      "patch_content":"From 40111b237e763821437f501c94d8511022274dc3 Mon Sep 17 00:00:00 2001\nFrom: Matthew Petroff <matthew@mpetroff.net>\nDate: Fri, 15 Nov 2019 11:03:49 -0500\nSubject: [PATCH] Fix potential XSS vulnerability.\n\n---\n src\/js\/pannellum.js | 19 +++++++++++++------\n 1 file changed, 13 insertions(+), 6 deletions(-)\n\ndiff --git a\/src\/js\/pannellum.js b\/src\/js\/pannellum.js\nindex 5f29c0f7..f295dfd2 100644\n--- a\/src\/js\/pannellum.js\n+++ b\/src\/js\/pannellum.js\n@@ -1726,7 +1726,7 @@ function createHotSpot(hs) {\n         if (config.basePath && !absoluteURL(imgp))\n             imgp = config.basePath + imgp;\n         a = document.createElement('a');\n-        a.href = sanitizeURL(hs.URL ? hs.URL : imgp);\n+        a.href = sanitizeURL(hs.URL ? hs.URL : imgp, true);\n         a.target = '_blank';\n         span.appendChild(a);\n         var image = document.createElement('img');\n@@ -1738,7 +1738,7 @@ function createHotSpot(hs) {\n         span.style.maxWidth = 'initial';\n     } else if (hs.URL) {\n         a = document.createElement('a');\n-        a.href = sanitizeURL(hs.URL);\n+        a.href = sanitizeURL(hs.URL, true);\n         if (hs.attributes) {\n             for (var key in hs.attributes) {\n                 a.setAttribute(key, hs.attributes[key]);\n@@ -2012,7 +2012,7 @@ function processOptions(isPreview) {\n                 var authorText = escapeHTML(config[key]);\n                 if (config.authorURL) {\n                     var authorLink = document.createElement('a');\n-                    authorLink.href = sanitizeURL(config['authorURL']);\n+                    authorLink.href = sanitizeURL(config['authorURL'], true);\n                     authorLink.target = '_blank';\n                     authorLink.innerHTML = escapeHTML(config[key]);\n                     authorText = authorLink.outerHTML;\n@@ -2023,7 +2023,7 @@ function processOptions(isPreview) {\n             \n             case 'fallback':\n                 var link = document.createElement('a');\n-                link.href = sanitizeURL(config[key]);\n+                link.href = sanitizeURL(config[key], true);\n                 link.target = '_blank';\n                 link.textContent = 'Click here to view this panorama in an alternative viewer.';\n                 var message = document.createElement('p');\n@@ -2389,10 +2389,17 @@ function escapeHTML(s) {\n  * The URL cannot be of protocol 'javascript'.\n  * @private\n  * @param {string} url - URL to sanitize\n+ * @param {boolean} href - True if URL is for link (blocks data URIs)\n  * @returns {string} Sanitized URL\n  *\/\n-function sanitizeURL(url) {\n-    if (url.trim().toLowerCase().indexOf('javascript:') === 0) {\n+function sanitizeURL(url, href) {\n+    if (url.trim().toLowerCase().indexOf('javascript:') === 0 ||\n+        url.trim().toLowerCase().indexOf('vbscript:') === 0) {\n+        console.log('Script URL removed.');\n+        return 'about:blank';\n+    }\n+    if (href && url.trim().toLowerCase().indexOf('data:') === 0) {\n+        console.log('Data URI removed from link.');\n         return 'about:blank';\n     }\n     return url;",
      "code_diff":"@@ -1726,7 +1726,7 @@ function createHotSpot(hs) {\n         if (config.basePath && !absoluteURL(imgp))\n             imgp = config.basePath + imgp;\n         a = document.createElement('a');\n-        a.href = sanitizeURL(hs.URL ? hs.URL : imgp);\n+        a.href = sanitizeURL(hs.URL ? hs.URL : imgp, true);\n         a.target = '_blank';\n         span.appendChild(a);\n         var image = document.createElement('img');\n@@ -1738,7 +1738,7 @@ function createHotSpot(hs) {\n         span.style.maxWidth = 'initial';\n     } else if (hs.URL) {\n         a = document.createElement('a');\n-        a.href = sanitizeURL(hs.URL);\n+        a.href = sanitizeURL(hs.URL, true);\n         if (hs.attributes) {\n             for (var key in hs.attributes) {\n                 a.setAttribute(key, hs.attributes[key]);\n@@ -2012,7 +2012,7 @@ function processOptions(isPreview) {\n                 var authorText = escapeHTML(config[key]);\n                 if (config.authorURL) {\n                     var authorLink = document.createElement('a');\n-                    authorLink.href = sanitizeURL(config['authorURL']);\n+                    authorLink.href = sanitizeURL(config['authorURL'], true);\n                     authorLink.target = '_blank';\n                     authorLink.innerHTML = escapeHTML(config[key]);\n                     authorText = authorLink.outerHTML;\n@@ -2023,7 +2023,7 @@ function processOptions(isPreview) {\n             \n             case 'fallback':\n                 var link = document.createElement('a');\n-                link.href = sanitizeURL(config[key]);\n+                link.href = sanitizeURL(config[key], true);\n                 link.target = '_blank';\n                 link.textContent = 'Click here to view this panorama in an alternative viewer.';\n                 var message = document.createElement('p');\n@@ -2389,10 +2389,17 @@ function escapeHTML(s) {\n  * The URL cannot be of protocol 'javascript'.\n  * @private\n  * @param {string} url - URL to sanitize\n+ * @param {boolean} href - True if URL is for link (blocks data URIs)\n  * @returns {string} Sanitized URL\n  *\/\n-function sanitizeURL(url) {\n-    if (url.trim().toLowerCase().indexOf('javascript:') === 0) {\n+function sanitizeURL(url, href) {\n+    if (url.trim().toLowerCase().indexOf('javascript:') === 0 ||\n+        url.trim().toLowerCase().indexOf('vbscript:') === 0) {\n+        console.log('Script URL removed.');\n+        return 'about:blank';\n+    }\n+    if (href && url.trim().toLowerCase().indexOf('data:') === 0) {\n+        console.log('Data URI removed from link.');\n         return 'about:blank';\n     }\n     return url;"
    },
    {
      "index":21,
      "vuln_id":"GHSA-xg72-6c83-ghh4",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/d35e691e72d358430abc8e99f5ba9eb374423b9f'}",
      "dataset":"osv",
      "summary":"Microweber Stored Cross-site Scripting before v1.2.20 Microwerber prior to version 1.2.20 is vulnerable to stored Cross-site Scripting (XSS).",
      "published_date":"2022-07-23",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/d35e691e72d358430abc8e99f5ba9eb374423b9f",
      "commit_sha":"d35e691e72d358430abc8e99f5ba9eb374423b9f",
      "patch":"SINGLE",
      "chain_ord":"['d35e691e72d358430abc8e99f5ba9eb374423b9f']",
      "before_first_fix_commit":"{'b39736f1191589e89eb4e54f5f6f05b6349626e3'}",
      "last_fix_commit":"d35e691e72d358430abc8e99f5ba9eb374423b9f",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/08\/2022, 13:41:01",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 12, 'deletions': 4, 'total': 16}",
      "files":"{'src\/MicroweberPackages\/App\/functions\/plupload.php': {'additions': 12, 'deletions': 4, 'changes': 16, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/d35e691e72d358430abc8e99f5ba9eb374423b9f\/src%2FMicroweberPackages%2FApp%2Ffunctions%2Fplupload.php', 'patch': \"@@ -563,17 +563,25 @@\\n                 }\\n \\n             } else if ($ext === 'svg') {\\n-\\n+                $valid = false;\\n                 if (is_file($filePath)) {\\n                     $sanitizer = new \\\\enshrined\\\\svgSanitize\\\\Sanitizer();\\n                     \/\/ Load the dirty svg\\n                     $dirtySVG = file_get_contents($filePath);\\n                      \/\/ Pass it to the sanitizer and get it back clean\\n-                    $cleanSVG = $sanitizer->sanitize($dirtySVG);\\n-                    file_put_contents($filePath, $cleanSVG);\\n+                    try {\\n+                        $cleanSVG = $sanitizer->sanitize($dirtySVG);\\n+                        $valid = true;\\n+                    } catch (\\\\Exception $e) {\\n+                        $valid = false;\\n+                    }\\n+\\n+                    if ($valid) {\\n+                        file_put_contents($filePath, $cleanSVG);\\n+                    }\\n \\n                 }\\n-               $valid = true;\\n+\\n \\n             } else {\\n                 $valid = false;\"}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/App\/functions\/plupload.php'])",
      "num_files":1.0,
      "patch_content":"From d35e691e72d358430abc8e99f5ba9eb374423b9f Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Fri, 8 Jul 2022 16:41:01 +0300\nSubject: [PATCH] update\n\n---\n ...\/App\/functions\/plupload.php                   | 16 ++++++++++++----\n 1 file changed, 12 insertions(+), 4 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/App\/functions\/plupload.php b\/src\/MicroweberPackages\/App\/functions\/plupload.php\nindex 244980968ce..5890b2ae9ff 100644\n--- a\/src\/MicroweberPackages\/App\/functions\/plupload.php\n+++ b\/src\/MicroweberPackages\/App\/functions\/plupload.php\n@@ -563,17 +563,25 @@\n                 }\n \n             } else if ($ext === 'svg') {\n-\n+                $valid = false;\n                 if (is_file($filePath)) {\n                     $sanitizer = new \\enshrined\\svgSanitize\\Sanitizer();\n                     \/\/ Load the dirty svg\n                     $dirtySVG = file_get_contents($filePath);\n                      \/\/ Pass it to the sanitizer and get it back clean\n-                    $cleanSVG = $sanitizer->sanitize($dirtySVG);\n-                    file_put_contents($filePath, $cleanSVG);\n+                    try {\n+                        $cleanSVG = $sanitizer->sanitize($dirtySVG);\n+                        $valid = true;\n+                    } catch (\\Exception $e) {\n+                        $valid = false;\n+                    }\n+\n+                    if ($valid) {\n+                        file_put_contents($filePath, $cleanSVG);\n+                    }\n \n                 }\n-               $valid = true;\n+\n \n             } else {\n                 $valid = false;",
      "code_diff":"@@ -563,17 +563,25 @@\n                 }\n \n             } else if ($ext === 'svg') {\n-\n+                $valid = false;\n                 if (is_file($filePath)) {\n                     $sanitizer = new \\enshrined\\svgSanitize\\Sanitizer();\n                     \/\/ Load the dirty svg\n                     $dirtySVG = file_get_contents($filePath);\n                      \/\/ Pass it to the sanitizer and get it back clean\n-                    $cleanSVG = $sanitizer->sanitize($dirtySVG);\n-                    file_put_contents($filePath, $cleanSVG);\n+                    try {\n+                        $cleanSVG = $sanitizer->sanitize($dirtySVG);\n+                        $valid = true;\n+                    } catch (\\Exception $e) {\n+                        $valid = false;\n+                    }\n+\n+                    if ($valid) {\n+                        file_put_contents($filePath, $cleanSVG);\n+                    }\n \n                 }\n-               $valid = true;\n+\n \n             } else {\n                 $valid = false;"
    },
    {
      "index":22,
      "vuln_id":"GHSA-hc72-vj3g-5g2g",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/SeriaWei\/ZKEACMS\/commit\/833c5460dc5c6152092f6ad54b8b832870a59903'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ZKEACMS A cross-site scripting (XSS) vulnerability in \/navigation\/create?ParentID=%23 of ZKEACMS v3.5.2 allows attackers to execute arbitrary web scripts or HTML via a crafted payload injected into the ParentID parameter.",
      "published_date":"2022-05-26",
      "chain_len":1,
      "project":"https:\/\/github.com\/SeriaWei\/ZKEACMS",
      "commit_href":"https:\/\/github.com\/SeriaWei\/ZKEACMS\/commit\/833c5460dc5c6152092f6ad54b8b832870a59903",
      "commit_sha":"833c5460dc5c6152092f6ad54b8b832870a59903",
      "patch":"SINGLE",
      "chain_ord":"['833c5460dc5c6152092f6ad54b8b832870a59903']",
      "before_first_fix_commit":"{'53109ba58bbeac75074583ec261732772ed1ecc5'}",
      "last_fix_commit":"833c5460dc5c6152092f6ad54b8b832870a59903",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/14\/2022, 14:55:34",
      "message":"Sanitize Html\n\n#457",
      "author":"wayne",
      "comments":null,
      "stats":"{'additions': 36, 'deletions': 1, 'total': 37}",
      "files":"{'src\/ZKEACMS\/Common\/Service\/NavigationService.cs': {'additions': 36, 'deletions': 1, 'changes': 37, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/SeriaWei\/ZKEACMS\/raw\/833c5460dc5c6152092f6ad54b8b832870a59903\/src%2FZKEACMS%2FCommon%2FService%2FNavigationService.cs', 'patch': '@@ -11,13 +11,16 @@\\n using ZKEACMS.Common.Models;\\n using Easy;\\n using Microsoft.EntityFrameworkCore;\\n+using ZKEACMS.Safety;\\n \\n namespace ZKEACMS.Common.Service\\n {\\n     public class NavigationService : ServiceBase<NavigationEntity, CMSDbContext>, INavigationService\\n     {\\n-        public NavigationService(IApplicationContext applicationContext, CMSDbContext dbContext) : base(applicationContext, dbContext)\\n+        private readonly IHtmlSanitizer _htmlSanitizer;\\n+        public NavigationService(IApplicationContext applicationContext, CMSDbContext dbContext, IHtmlSanitizer htmlSanitizer) : base(applicationContext, dbContext)\\n         {\\n+            _htmlSanitizer = htmlSanitizer;\\n         }\\n         public override DbSet<NavigationEntity> CurrentDbSet => DbContext.Navigation;\\n         public override ServiceResult<NavigationEntity> Add(NavigationEntity item)\\n@@ -27,8 +30,34 @@ public override ServiceResult<NavigationEntity> Add(NavigationEntity item)\\n                 item.ParentId = \"#\";\\n             }\\n             item.ID = Guid.NewGuid().ToString(\"N\");\\n+            Santize(item);\\n             return base.Add(item);\\n         }\\n+\\n+        public override ServiceResult<NavigationEntity> AddRange(params NavigationEntity[] items)\\n+        {\\n+            foreach (var item in items)\\n+            {\\n+                Santize(item);\\n+            }\\n+            return base.AddRange(items);\\n+        }\\n+\\n+        public override ServiceResult<NavigationEntity> Update(NavigationEntity item)\\n+        {\\n+            Santize(item);\\n+            return base.Update(item);\\n+        }\\n+\\n+        public override ServiceResult<NavigationEntity> UpdateRange(params NavigationEntity[] items)\\n+        {\\n+            foreach (var item in items)\\n+            {\\n+                Santize(item);\\n+            }\\n+            return base.UpdateRange(items);\\n+        }\\n+\\n         public override void Remove(NavigationEntity item)\\n         {\\n             Remove(m => m.ParentId == item.ID);\\n@@ -73,5 +102,11 @@ public void Move(string id, string parentId, int position, int oldPosition)\\n             }\\n             Update(nav);\\n         }\\n+\\n+        private void Santize(NavigationEntity item)\\n+        {\\n+            item.Title = _htmlSanitizer.Sanitize(item.Title);\\n+            item.Html = _htmlSanitizer.Sanitize(item.Html);\\n+        }\\n     }\\n }\\n\\\\ No newline at end of file'}}",
      "message_norm":"sanitize html\n\n#457",
      "language":"sq",
      "entities":"[('sanitize', 'SECWORD', ''), ('#457', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/ZKEACMS\/Common\/Service\/NavigationService.cs'])",
      "num_files":1.0,
      "patch_content":"From 833c5460dc5c6152092f6ad54b8b832870a59903 Mon Sep 17 00:00:00 2001\nFrom: wayne <seriawei@outlook.com>\nDate: Thu, 14 Apr 2022 22:55:34 +0800\nSubject: [PATCH] Sanitize Html\n\n#457\n---\n ...\/Common\/Service\/NavigationService.cs       | 37 ++++++++++++++++++-\n 1 file changed, 36 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/ZKEACMS\/Common\/Service\/NavigationService.cs b\/src\/ZKEACMS\/Common\/Service\/NavigationService.cs\nindex c6fafc72..66ed8921 100644\n--- a\/src\/ZKEACMS\/Common\/Service\/NavigationService.cs\n+++ b\/src\/ZKEACMS\/Common\/Service\/NavigationService.cs\n@@ -11,13 +11,16 @@\n using ZKEACMS.Common.Models;\n using Easy;\n using Microsoft.EntityFrameworkCore;\n+using ZKEACMS.Safety;\n \n namespace ZKEACMS.Common.Service\n {\n     public class NavigationService : ServiceBase<NavigationEntity, CMSDbContext>, INavigationService\n     {\n-        public NavigationService(IApplicationContext applicationContext, CMSDbContext dbContext) : base(applicationContext, dbContext)\n+        private readonly IHtmlSanitizer _htmlSanitizer;\n+        public NavigationService(IApplicationContext applicationContext, CMSDbContext dbContext, IHtmlSanitizer htmlSanitizer) : base(applicationContext, dbContext)\n         {\n+            _htmlSanitizer = htmlSanitizer;\n         }\n         public override DbSet<NavigationEntity> CurrentDbSet => DbContext.Navigation;\n         public override ServiceResult<NavigationEntity> Add(NavigationEntity item)\n@@ -27,8 +30,34 @@ public override ServiceResult<NavigationEntity> Add(NavigationEntity item)\n                 item.ParentId = \"#\";\n             }\n             item.ID = Guid.NewGuid().ToString(\"N\");\n+            Santize(item);\n             return base.Add(item);\n         }\n+\n+        public override ServiceResult<NavigationEntity> AddRange(params NavigationEntity[] items)\n+        {\n+            foreach (var item in items)\n+            {\n+                Santize(item);\n+            }\n+            return base.AddRange(items);\n+        }\n+\n+        public override ServiceResult<NavigationEntity> Update(NavigationEntity item)\n+        {\n+            Santize(item);\n+            return base.Update(item);\n+        }\n+\n+        public override ServiceResult<NavigationEntity> UpdateRange(params NavigationEntity[] items)\n+        {\n+            foreach (var item in items)\n+            {\n+                Santize(item);\n+            }\n+            return base.UpdateRange(items);\n+        }\n+\n         public override void Remove(NavigationEntity item)\n         {\n             Remove(m => m.ParentId == item.ID);\n@@ -73,5 +102,11 @@ public void Move(string id, string parentId, int position, int oldPosition)\n             }\n             Update(nav);\n         }\n+\n+        private void Santize(NavigationEntity item)\n+        {\n+            item.Title = _htmlSanitizer.Sanitize(item.Title);\n+            item.Html = _htmlSanitizer.Sanitize(item.Html);\n+        }\n     }\n }\n\\ No newline at end of file",
      "code_diff":"@@ -11,13 +11,16 @@\n using ZKEACMS.Common.Models;\n using Easy;\n using Microsoft.EntityFrameworkCore;\n+using ZKEACMS.Safety;\n \n namespace ZKEACMS.Common.Service\n {\n     public class NavigationService : ServiceBase<NavigationEntity, CMSDbContext>, INavigationService\n     {\n-        public NavigationService(IApplicationContext applicationContext, CMSDbContext dbContext) : base(applicationContext, dbContext)\n+        private readonly IHtmlSanitizer _htmlSanitizer;\n+        public NavigationService(IApplicationContext applicationContext, CMSDbContext dbContext, IHtmlSanitizer htmlSanitizer) : base(applicationContext, dbContext)\n         {\n+            _htmlSanitizer = htmlSanitizer;\n         }\n         public override DbSet<NavigationEntity> CurrentDbSet => DbContext.Navigation;\n         public override ServiceResult<NavigationEntity> Add(NavigationEntity item)\n@@ -27,8 +30,34 @@ public override ServiceResult<NavigationEntity> Add(NavigationEntity item)\n                 item.ParentId = \"#\";\n             }\n             item.ID = Guid.NewGuid().ToString(\"N\");\n+            Santize(item);\n             return base.Add(item);\n         }\n+\n+        public override ServiceResult<NavigationEntity> AddRange(params NavigationEntity[] items)\n+        {\n+            foreach (var item in items)\n+            {\n+                Santize(item);\n+            }\n+            return base.AddRange(items);\n+        }\n+\n+        public override ServiceResult<NavigationEntity> Update(NavigationEntity item)\n+        {\n+            Santize(item);\n+            return base.Update(item);\n+        }\n+\n+        public override ServiceResult<NavigationEntity> UpdateRange(params NavigationEntity[] items)\n+        {\n+            foreach (var item in items)\n+            {\n+                Santize(item);\n+            }\n+            return base.UpdateRange(items);\n+        }\n+\n         public override void Remove(NavigationEntity item)\n         {\n             Remove(m => m.ParentId == item.ID);\n@@ -73,5 +102,11 @@ public void Move(string id, string parentId, int position, int oldPosition)\n             }\n             Update(nav);\n         }\n+\n+        private void Santize(NavigationEntity item)\n+        {\n+            item.Title = _htmlSanitizer.Sanitize(item.Title);\n+            item.Html = _htmlSanitizer.Sanitize(item.Html);\n+        }\n     }\n }\n\\ No newline at end of file"
    },
    {
      "index":23,
      "vuln_id":"GHSA-8xqr-4cpm-wx7g",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/tanem\/react-svg\/pull\/57\/commits\/ec7de5d678f53a085cee1348cb1aa069c9fc42fb'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in react-svg Versions of `react-svg` before 2.2.18 are vulnerable to cross-site scripting (xss). This is due to the fact that scripts found in SVG files are run by default.\n\n\n## Recommendation\n\nUpdate to version 2.2.18 or later.",
      "published_date":"2019-05-31",
      "chain_len":1,
      "project":"https:\/\/github.com\/tanem\/react-svg",
      "commit_href":"https:\/\/github.com\/tanem\/react-svg\/pull\/57\/commits\/ec7de5d678f53a085cee1348cb1aa069c9fc42fb",
      "commit_sha":"ec7de5d678f53a085cee1348cb1aa069c9fc42fb",
      "patch":"SINGLE",
      "chain_ord":"['ec7de5d678f53a085cee1348cb1aa069c9fc42fb']",
      "before_first_fix_commit":"{'9fa13da92cc4c44a10b6e2aced023d3199e8c6bb'}",
      "last_fix_commit":"ec7de5d678f53a085cee1348cb1aa069c9fc42fb",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/21\/2018, 18:37:51",
      "message":"Changed default evalScripts prop to match documentation.",
      "author":"Ron Perris",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'src\/index.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/tanem\/react-svg\/raw\/ec7de5d678f53a085cee1348cb1aa069c9fc42fb\/src%2Findex.js', 'patch': \"@@ -10,7 +10,7 @@ export default class ReactSVG extends React.Component {\\n   static defaultProps = {\\n     callback: () => {},\\n     className: null,\\n-    evalScripts: 'once',\\n+    evalScripts: 'never',\\n     style: {},\\n     wrapperClassName: null\\n   }\"}}",
      "message_norm":"changed default evalscripts prop to match documentation.",
      "language":"en",
      "entities":"[('changed', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/index.js'])",
      "num_files":1.0,
      "patch_content":"From ec7de5d678f53a085cee1348cb1aa069c9fc42fb Mon Sep 17 00:00:00 2001\nFrom: Ron Perris <ronperris@gmail.com>\nDate: Sat, 21 Apr 2018 11:37:51 -0700\nSubject: [PATCH] Changed default evalScripts prop to match documentation.\n\n---\n src\/index.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/index.js b\/src\/index.js\nindex ce4742173..9f04da8bc 100644\n--- a\/src\/index.js\n+++ b\/src\/index.js\n@@ -10,7 +10,7 @@ export default class ReactSVG extends React.Component {\n   static defaultProps = {\n     callback: () => {},\n     className: null,\n-    evalScripts: 'once',\n+    evalScripts: 'never',\n     style: {},\n     wrapperClassName: null\n   }",
      "code_diff":"@@ -10,7 +10,7 @@ export default class ReactSVG extends React.Component {\n   static defaultProps = {\n     callback: () => {},\n     className: null,\n-    evalScripts: 'once',\n+    evalScripts: 'never',\n     style: {},\n     wrapperClassName: null\n   }"
    },
    {
      "index":24,
      "vuln_id":"GHSA-h3gg-7wx2-cq3h",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/flarum\/sticky\/commit\/7ebd30462bd405c4c0570b93a6d48710e6c3db19'}",
      "dataset":"osv",
      "summary":"XSS in Flarum Sticky extension ### Impact\nA change in release beta 14 of the Sticky extension caused the plain text content of the first post of a pinned discussion to be injected as HTML on the discussion list. The issue was discovered following an internal audit.\n\nAny HTML would be injected through Mithril's `m.trust()` helper. This resulted in an HTML injection where `<script>` tags would not be executed. However it was possible to run javascript from other HTML attributes, enabling a cross-site scripting (XSS) attack to be performed.\n\nSince the exploit only happens with the first post of a pinned discussion, an attacker would need the ability to pin their own discussion, or be able to edit a discussion that was previously pinned.\n\nOn forums where all pinned posts are authored by your staff, you can be relatively certain the vulnerability has not been exploited.\n\nForums where some user-created discussions were pinned can look at the first post edit date to find whether the vulnerability might have been exploited. Because Flarum doesn't store the post content history, you cannot be certain if a malicious edit was reverted.\n\n### Patches\nThe fix will be available in version v0.1.0-beta.16 with Flarum beta 16. The fix has already been back-ported to Flarum beta 15 as version v0.1.0-beta.15.1 of the Sticky extension.\n\n### Workarounds\nForum administrators can disable the Sticky extension until they are able to apply the update. The vulnerability cannot be exploited while the extension is disabled.\n\n### References\n\n- [Release announcement](https:\/\/discuss.flarum.org\/d\/26042-security-update-to-flarum-sticky-010-beta151)\n- [Pull Request](https:\/\/github.com\/flarum\/sticky\/pull\/24)\n\n### For more information\nIf you have any questions or comments about this advisory, please start a new discussion on our [support forum](https:\/\/discuss.flarum.org\/t\/support).\n\nIf you discover a security vulnerability within Flarum, please send an e-mail to [security@flarum.org](mailto:security@flarum.org). All security vulnerabilities will be promptly addressed. More details can be found in our [security policy](https:\/\/github.com\/flarum\/core\/security\/policy).",
      "published_date":"2021-01-29",
      "chain_len":1,
      "project":"https:\/\/github.com\/flarum\/sticky",
      "commit_href":"https:\/\/github.com\/flarum\/sticky\/commit\/7ebd30462bd405c4c0570b93a6d48710e6c3db19",
      "commit_sha":"7ebd30462bd405c4c0570b93a6d48710e6c3db19",
      "patch":"SINGLE",
      "chain_ord":"['7ebd30462bd405c4c0570b93a6d48710e6c3db19']",
      "before_first_fix_commit":"{'62a74d25ab3f84f69d1c4b5920080963788a8360'}",
      "last_fix_commit":"7ebd30462bd405c4c0570b93a6d48710e6c3db19",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/22\/2021, 18:53:11",
      "message":"Fix evaluation of post content by m.trust() (#24)",
      "author":"Sami Mazouz",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
      "files":"{'js\/src\/forum\/addStickyExcerpt.js': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/flarum\/sticky\/raw\/7ebd30462bd405c4c0570b93a6d48710e6c3db19\/js%2Fsrc%2Fforum%2FaddStickyExcerpt.js', 'patch': \"@@ -21,7 +21,8 @@ export default function addStickyControl() {\\n       if (firstPost) {\\n         const excerpt = truncate(firstPost.contentPlain(), 175);\\n \\n-        items.add('excerpt', m.trust(excerpt), -100);\\n+        \/\/ Wrapping in <div> because ItemList entries need to be vnodes\\n+        items.add('excerpt', <div>{excerpt}<\/div>, -100);\\n       }\\n     }\\n   });\"}}",
      "message_norm":"fix evaluation of post content by m.trust() (#24)",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('#24', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['js\/src\/forum\/addStickyExcerpt.js'])",
      "num_files":1.0,
      "patch_content":"From 7ebd30462bd405c4c0570b93a6d48710e6c3db19 Mon Sep 17 00:00:00 2001\nFrom: Sami Mazouz <sychocouldy@gmail.com>\nDate: Fri, 22 Jan 2021 19:53:11 +0100\nSubject: [PATCH] Fix evaluation of post content by m.trust() (#24)\n\n---\n js\/src\/forum\/addStickyExcerpt.js | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/js\/src\/forum\/addStickyExcerpt.js b\/js\/src\/forum\/addStickyExcerpt.js\nindex 817e626..05e6954 100644\n--- a\/js\/src\/forum\/addStickyExcerpt.js\n+++ b\/js\/src\/forum\/addStickyExcerpt.js\n@@ -21,7 +21,8 @@ export default function addStickyControl() {\n       if (firstPost) {\n         const excerpt = truncate(firstPost.contentPlain(), 175);\n \n-        items.add('excerpt', m.trust(excerpt), -100);\n+        \/\/ Wrapping in <div> because ItemList entries need to be vnodes\n+        items.add('excerpt', <div>{excerpt}<\/div>, -100);\n       }\n     }\n   });",
      "code_diff":"@@ -21,7 +21,8 @@ export default function addStickyControl() {\n       if (firstPost) {\n         const excerpt = truncate(firstPost.contentPlain(), 175);\n \n-        items.add('excerpt', m.trust(excerpt), -100);\n+        \/\/ Wrapping in <div> because ItemList entries need to be vnodes\n+        items.add('excerpt', <div>{excerpt}<\/div>, -100);\n       }\n     }\n   });"
    },
    {
      "index":25,
      "vuln_id":"GHSA-h6wm-mr85-4h9g",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/neorazorx\/facturascripts\/commit\/73a6595ca85984d65f656c6356fabb23d1936c54'}",
      "dataset":"osv",
      "summary":"Cross site scripting in facturascripts A Cross-site Scripting (XSS) vulnerability exists in the fsNick parameter in facturascripts prior to version 2022.06",
      "published_date":"2022-06-14",
      "chain_len":1,
      "project":"https:\/\/github.com\/neorazorx\/facturascripts",
      "commit_href":"https:\/\/github.com\/neorazorx\/facturascripts\/commit\/73a6595ca85984d65f656c6356fabb23d1936c54",
      "commit_sha":"73a6595ca85984d65f656c6356fabb23d1936c54",
      "patch":"SINGLE",
      "chain_ord":"['73a6595ca85984d65f656c6356fabb23d1936c54']",
      "before_first_fix_commit":"{'298eb4b1a94c5898fde5a21e412955fc77a3ef93'}",
      "last_fix_commit":"73a6595ca85984d65f656c6356fabb23d1936c54",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/28\/2022, 09:29:31",
      "message":"Sanitized username when showing user not found message.\n------\nSaneado nombre de usuario al mostrar el mensaje de usuario no encontrado.",
      "author":"Carlos Garcia Gomez",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'Core\/App\/AppController.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/NeoRazorX\/facturascripts\/raw\/73a6595ca85984d65f656c6356fabb23d1936c54\/Core%2FApp%2FAppController.php', 'patch': \"@@ -287,7 +287,7 @@ private function userAuth()\\n         }\\n \\n         $this->ipWarning();\\n-        ToolBox::i18nLog()->warning('login-user-not-found', ['%nick%' => $nick]);\\n+        ToolBox::i18nLog()->warning('login-user-not-found', ['%nick%' => htmlspecialchars($nick)]);\\n         return false;\\n     }\"}}",
      "message_norm":"sanitized username when showing user not found message.\n------\nsaneado nombre de usuario al mostrar el mensaje de usuario no encontrado.",
      "language":"en",
      "entities":"[('sanitized', 'SECWORD', ''), ('found', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['Core\/App\/AppController.php'])",
      "num_files":1.0,
      "patch_content":"From 73a6595ca85984d65f656c6356fabb23d1936c54 Mon Sep 17 00:00:00 2001\nFrom: Carlos Garcia Gomez <neorazorx@gmail.com>\nDate: Thu, 28 Apr 2022 11:29:31 +0200\nSubject: [PATCH] Sanitized username when showing user not found message.\n ------ Saneado nombre de usuario al mostrar el mensaje de usuario no\n encontrado.\n\n---\n Core\/App\/AppController.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/Core\/App\/AppController.php b\/Core\/App\/AppController.php\nindex 83c42b7241..0dd563c518 100644\n--- a\/Core\/App\/AppController.php\n+++ b\/Core\/App\/AppController.php\n@@ -287,7 +287,7 @@ private function userAuth()\n         }\n \n         $this->ipWarning();\n-        ToolBox::i18nLog()->warning('login-user-not-found', ['%nick%' => $nick]);\n+        ToolBox::i18nLog()->warning('login-user-not-found', ['%nick%' => htmlspecialchars($nick)]);\n         return false;\n     }",
      "code_diff":"@@ -287,7 +287,7 @@ private function userAuth()\n         }\n \n         $this->ipWarning();\n-        ToolBox::i18nLog()->warning('login-user-not-found', ['%nick%' => $nick]);\n+        ToolBox::i18nLog()->warning('login-user-not-found', ['%nick%' => htmlspecialchars($nick)]);\n         return false;\n     }"
    },
    {
      "index":26,
      "vuln_id":"GHSA-pxpf-v376-7xx5",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/yairEO\/tagify\/commit\/198c0451fad188390390395ccfc84ab371def4c7'}",
      "dataset":"osv",
      "summary":"tagify can pass a malicious placeholder to initiate the cross-site scripting (XSS) payload This affects the package @yaireo\/tagify before 4.9.8. The package is used for rendering UI components inside the input or text fields, and an attacker can pass a malicious placeholder value to it to fire the cross-site scripting (XSS) payload.",
      "published_date":"2022-04-30",
      "chain_len":1,
      "project":"https:\/\/github.com\/yairEO\/tagify",
      "commit_href":"https:\/\/github.com\/yairEO\/tagify\/commit\/198c0451fad188390390395ccfc84ab371def4c7",
      "commit_sha":"198c0451fad188390390395ccfc84ab371def4c7",
      "patch":"SINGLE",
      "chain_ord":"['198c0451fad188390390395ccfc84ab371def4c7']",
      "before_first_fix_commit":"{'93f729c6d1bf45666a1dc21d5cae3aefe1b18043'}",
      "last_fix_commit":"198c0451fad188390390395ccfc84ab371def4c7",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/17\/2022, 08:16:09",
      "message":"fixes #989 - fix XSS",
      "author":"Yair Even Or",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'src\/tagify.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/yairEO\/tagify\/raw\/198c0451fad188390390395ccfc84ab371def4c7\/src%2Ftagify.js', 'patch': '@@ -101,7 +101,7 @@ Tagify.prototype = {\\n \\n         _s.disabled = input.hasAttribute(\\'disabled\\')\\n         _s.readonly = _s.readonly || input.hasAttribute(\\'readonly\\')\\n-        _s.placeholder = input.getAttribute(\\'placeholder\\') || _s.placeholder || \"\"\\n+        _s.placeholder = escapeHTML(input.getAttribute(\\'placeholder\\') || _s.placeholder || \"\")\\n         _s.required = input.hasAttribute(\\'required\\')\\n \\n         for( let name in _s.classNames )'}}",
      "message_norm":"fixes #989 - fix xss",
      "language":"ca",
      "entities":"[('fixes', 'ACTION', ''), ('#989', 'ISSUE', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/tagify.js'])",
      "num_files":1.0,
      "patch_content":"From 198c0451fad188390390395ccfc84ab371def4c7 Mon Sep 17 00:00:00 2001\nFrom: Yair Even Or <Yair.Even-Or@amdocs.com>\nDate: Thu, 17 Feb 2022 10:16:09 +0200\nSubject: [PATCH] fixes #989 - fix XSS\n\n---\n src\/tagify.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/tagify.js b\/src\/tagify.js\nindex 2929ae27..63d5d93f 100644\n--- a\/src\/tagify.js\n+++ b\/src\/tagify.js\n@@ -101,7 +101,7 @@ Tagify.prototype = {\n \n         _s.disabled = input.hasAttribute('disabled')\n         _s.readonly = _s.readonly || input.hasAttribute('readonly')\n-        _s.placeholder = input.getAttribute('placeholder') || _s.placeholder || \"\"\n+        _s.placeholder = escapeHTML(input.getAttribute('placeholder') || _s.placeholder || \"\")\n         _s.required = input.hasAttribute('required')\n \n         for( let name in _s.classNames )",
      "code_diff":"@@ -101,7 +101,7 @@ Tagify.prototype = {\n \n         _s.disabled = input.hasAttribute('disabled')\n         _s.readonly = _s.readonly || input.hasAttribute('readonly')\n-        _s.placeholder = input.getAttribute('placeholder') || _s.placeholder || \"\"\n+        _s.placeholder = escapeHTML(input.getAttribute('placeholder') || _s.placeholder || \"\")\n         _s.required = input.hasAttribute('required')\n \n         for( let name in _s.classNames )"
    },
    {
      "index":27,
      "vuln_id":"GHSA-6hjc-m38h-7jhh",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/nystudio107\/craft-seomatic\/commit\/4e46b792ce973ac0c652fb330055f41aca1981c8', 'https:\/\/github.com\/nystudio107\/craft-seomatic\/commit\/5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in SEOmatic plugin A cross-site scripting (XSS) vulnerability in the SEOmatic plugin 3.4.10 for Craft CMS 3 allows remote attackers to inject arbitrary web script via a GET to \/index.php?action=seomatic\/file\/seo-file-link with url parameter containing the base64 encoded URL of a malicious web page \/ file and fileName parameter containing an arbitrary filename with the intended content-type to be rendered in the user's browser as the extension.",
      "published_date":"2022-06-13",
      "chain_len":2,
      "project":"https:\/\/github.com\/nystudio107\/craft-seomatic",
      "commit_href":"https:\/\/github.com\/nystudio107\/craft-seomatic\/commit\/4e46b792ce973ac0c652fb330055f41aca1981c8",
      "commit_sha":"4e46b792ce973ac0c652fb330055f41aca1981c8",
      "patch":"MULTI",
      "chain_ord":"['5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873', '4e46b792ce973ac0c652fb330055f41aca1981c8']",
      "before_first_fix_commit":"{'8c0dc48d026fd076cd0a8fae917bdadc8d67cfa6'}",
      "last_fix_commit":"4e46b792ce973ac0c652fb330055f41aca1981c8",
      "chain_ord_pos":2.0,
      "commit_datetime":"09\/24\/2021, 15:01:54",
      "message":"Disallow SVGs",
      "author":"Andrew Welch",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'src\/controllers\/FileController.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/nystudio107\/craft-seomatic\/raw\/4e46b792ce973ac0c652fb330055f41aca1981c8\/src%2Fcontrollers%2FFileController.php', 'patch': \"@@ -96,7 +96,7 @@ public function actionSeoFileLink($url, $robots = '', $canonical = '', $inline =\\n             if (($ext = pathinfo($fileName, PATHINFO_EXTENSION)) !== '') {\\n                 $ext = strtolower($ext);\\n             }\\n-            if ($ext === '' || !in_array($ext, $allowedExtensions, true)) {\\n+            if ($ext === '' || $ext === 'svg' || !in_array($ext, $allowedExtensions, true)) {\\n                 throw new ServerErrorHttpException(Craft::t('seomatic', 'File format not allowed.'));\\n             }\\n             \/\/ Send the file as a stream, so it can exist anywhere\"}}",
      "message_norm":"disallow svgs",
      "language":"it",
      "entities":null,
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/controllers\/FileController.php'])",
      "num_files":1.0,
      "patch_content":"From 4e46b792ce973ac0c652fb330055f41aca1981c8 Mon Sep 17 00:00:00 2001\nFrom: Andrew Welch <andrew@keluli.local>\nDate: Fri, 24 Sep 2021 11:01:54 -0400\nSubject: [PATCH] Disallow SVGs\n\n---\n src\/controllers\/FileController.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/controllers\/FileController.php b\/src\/controllers\/FileController.php\nindex 33d7f0582..43315dfa6 100644\n--- a\/src\/controllers\/FileController.php\n+++ b\/src\/controllers\/FileController.php\n@@ -96,7 +96,7 @@ public function actionSeoFileLink($url, $robots = '', $canonical = '', $inline =\n             if (($ext = pathinfo($fileName, PATHINFO_EXTENSION)) !== '') {\n                 $ext = strtolower($ext);\n             }\n-            if ($ext === '' || !in_array($ext, $allowedExtensions, true)) {\n+            if ($ext === '' || $ext === 'svg' || !in_array($ext, $allowedExtensions, true)) {\n                 throw new ServerErrorHttpException(Craft::t('seomatic', 'File format not allowed.'));\n             }\n             \/\/ Send the file as a stream, so it can exist anywhere",
      "code_diff":"@@ -96,7 +96,7 @@ public function actionSeoFileLink($url, $robots = '', $canonical = '', $inline =\n             if (($ext = pathinfo($fileName, PATHINFO_EXTENSION)) !== '') {\n                 $ext = strtolower($ext);\n             }\n-            if ($ext === '' || !in_array($ext, $allowedExtensions, true)) {\n+            if ($ext === '' || $ext === 'svg' || !in_array($ext, $allowedExtensions, true)) {\n                 throw new ServerErrorHttpException(Craft::t('seomatic', 'File format not allowed.'));\n             }\n             \/\/ Send the file as a stream, so it can exist anywhere"
    },
    {
      "index":28,
      "vuln_id":"GHSA-9g3v-j3cr-6fc6",
      "cwe_id":"{'CWE-79'}",
      "score":6.8,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in snipe-it snipe-it is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2021-10-21",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c",
      "commit_sha":"bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c",
      "patch":"SINGLE",
      "chain_ord":"['bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c']",
      "before_first_fix_commit":"{'5d94b99035317cd23059c7af91ff5f38177f5968'}",
      "last_fix_commit":"bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/15\/2021, 16:50:52",
      "message":"Fixes possible XSS on all-file-types export\n\nSigned-off-by: snipe <snipe@snipe.net>",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
      "files":"{'resources\/views\/partials\/bootstrap-table.blade.php': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c\/resources%2Fviews%2Fpartials%2Fbootstrap-table.blade.php', 'patch': '@@ -75,6 +75,10 @@ classes: \\'table table-responsive table-no-bordered\\',\\n                 export: \\'fa-download\\',\\n                 clearSearch: \\'fa-times\\'\\n             },\\n+            exportOptions: {\\n+                htmlContent: true,\\n+            },\\n+\\n             exportTypes: [\\'csv\\', \\'excel\\', \\'doc\\', \\'txt\\',\\'json\\', \\'xml\\', \\'pdf\\'],\\n             onLoadSuccess: function () {\\n                 $(\\'[data-toggle=\"tooltip\"]\\').tooltip(); \/\/ Needed to attach tooltips after ajax call'}}",
      "message_norm":"fixes possible xss on all-file-types export\n\nsigned-off-by: snipe <snipe@snipe.net>",
      "language":"en",
      "entities":"[('xss', 'SECWORD', ''), ('snipe@snipe.net', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['resources\/views\/partials\/bootstrap-table.blade.php'])",
      "num_files":1.0,
      "patch_content":"From bda23bb1e66fd7ce42c75c69cf5eea4e80865c1c Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Fri, 15 Oct 2021 11:50:52 -0500\nSubject: [PATCH] Fixes possible XSS on all-file-types export\n\nSigned-off-by: snipe <snipe@snipe.net>\n---\n resources\/views\/partials\/bootstrap-table.blade.php | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/resources\/views\/partials\/bootstrap-table.blade.php b\/resources\/views\/partials\/bootstrap-table.blade.php\nindex 7ad14bf9059f..130bc9c2d3e1 100644\n--- a\/resources\/views\/partials\/bootstrap-table.blade.php\n+++ b\/resources\/views\/partials\/bootstrap-table.blade.php\n@@ -75,6 +75,10 @@ classes: 'table table-responsive table-no-bordered',\n                 export: 'fa-download',\n                 clearSearch: 'fa-times'\n             },\n+            exportOptions: {\n+                htmlContent: true,\n+            },\n+\n             exportTypes: ['csv', 'excel', 'doc', 'txt','json', 'xml', 'pdf'],\n             onLoadSuccess: function () {\n                 $('[data-toggle=\"tooltip\"]').tooltip(); \/\/ Needed to attach tooltips after ajax call",
      "code_diff":"@@ -75,6 +75,10 @@ classes: 'table table-responsive table-no-bordered',\n                 export: 'fa-download',\n                 clearSearch: 'fa-times'\n             },\n+            exportOptions: {\n+                htmlContent: true,\n+            },\n+\n             exportTypes: ['csv', 'excel', 'doc', 'txt','json', 'xml', 'pdf'],\n             onLoadSuccess: function () {\n                 $('[data-toggle=\"tooltip\"]').tooltip(); \/\/ Needed to attach tooltips after ajax call"
    },
    {
      "index":29,
      "vuln_id":"GHSA-6qcc-whgp-pjj2",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/8ab06bfbb5a05a1b190731d9c7476ec45f5ee878'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Pimcore Pimcore version 10.3.2 and prior is vulnerable to stored cross-site scripting. A patch is available and anticipated to be part of version 10.3.3.",
      "published_date":"2022-03-05",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/8ab06bfbb5a05a1b190731d9c7476ec45f5ee878",
      "commit_sha":"8ab06bfbb5a05a1b190731d9c7476ec45f5ee878",
      "patch":"SINGLE",
      "chain_ord":"['8ab06bfbb5a05a1b190731d9c7476ec45f5ee878']",
      "before_first_fix_commit":"{'cef6fb5a9f385f77b9a1af508ecc45a147476458'}",
      "last_fix_commit":"8ab06bfbb5a05a1b190731d9c7476ec45f5ee878",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/02\/2022, 19:06:51",
      "message":"escaping fields in SERP preview",
      "author":"JiaJia Ji",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/8ab06bfbb5a05a1b190731d9c7476ec45f5ee878\/bundles%2FAdminBundle%2FResources%2Fpublic%2Fjs%2Fpimcore%2Fdocument%2Fpages%2Fsettings.js', 'patch': '@@ -79,8 +79,8 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac\\n             var updateSerpPreview = function () {\\n \\n                 var metaPanel = this.layout.getComponent(\"metaDataPanel\");\\n-                var title = metaPanel.getComponent(\"title\").getValue();\\n-                var description = metaPanel.getComponent(\"description\").getValue();\\n+                var title = htmlspecialchars(metaPanel.getComponent(\"title\").getValue());\\n+                var description = htmlspecialchars(metaPanel.getComponent(\"description\").getValue());\\n \\n                 var truncate = function( text, n ){\\n                     if (text.length <= n) { return text; }'}}",
      "message_norm":"escaping fields in serp preview",
      "language":"en",
      "entities":"[('escaping', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js'])",
      "num_files":1.0,
      "patch_content":"From 8ab06bfbb5a05a1b190731d9c7476ec45f5ee878 Mon Sep 17 00:00:00 2001\nFrom: JiaJia Ji <kingjia90@gmail.com>\nDate: Wed, 2 Mar 2022 20:06:51 +0100\nSubject: [PATCH] escaping fields in SERP preview\n\n---\n ...\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js    | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js\nindex f14c6d28513..3737778b115 100644\n--- a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js\n+++ b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/document\/pages\/settings.js\n@@ -79,8 +79,8 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac\n             var updateSerpPreview = function () {\n \n                 var metaPanel = this.layout.getComponent(\"metaDataPanel\");\n-                var title = metaPanel.getComponent(\"title\").getValue();\n-                var description = metaPanel.getComponent(\"description\").getValue();\n+                var title = htmlspecialchars(metaPanel.getComponent(\"title\").getValue());\n+                var description = htmlspecialchars(metaPanel.getComponent(\"description\").getValue());\n \n                 var truncate = function( text, n ){\n                     if (text.length <= n) { return text; }",
      "code_diff":"@@ -79,8 +79,8 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac\n             var updateSerpPreview = function () {\n \n                 var metaPanel = this.layout.getComponent(\"metaDataPanel\");\n-                var title = metaPanel.getComponent(\"title\").getValue();\n-                var description = metaPanel.getComponent(\"description\").getValue();\n+                var title = htmlspecialchars(metaPanel.getComponent(\"title\").getValue());\n+                var description = htmlspecialchars(metaPanel.getComponent(\"description\").getValue());\n \n                 var truncate = function( text, n ){\n                     if (text.length <= n) { return text; }"
    },
    {
      "index":30,
      "vuln_id":"GHSA-4fc4-4p5g-6w89",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/ckeditor\/ckeditor4\/commit\/d158413449692d920a778503502dcb22881bc949'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in CKEditor4 ### Affected packages\nThe vulnerability has been discovered in the core HTML processing module and may affect all plugins used by CKEditor 4.\n\n### Impact\nA potential vulnerability has been discovered in CKEditor 4 HTML processing core module. The vulnerability allowed to inject malformed HTML bypassing content sanitization, which could result in executing JavaScript code. It affects all users using the CKEditor 4 at version < 4.18.0.\n\n### Patches\nThe problem has been recognized and patched. The fix will be available in version 4.18.0.\n\n### For more information\nEmail us at security@cksource.com if you have any questions or comments about this advisory.\n\n### Acknowledgements\nThe CKEditor 4 team would like to thank GHSL team member Kevin Backhouse ([@kevinbackhouse](https:\/\/github.com\/kevinbackhouse)) for recognizing and reporting this vulnerability.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/ckeditor\/ckeditor4",
      "commit_href":"https:\/\/github.com\/ckeditor\/ckeditor4\/commit\/d158413449692d920a778503502dcb22881bc949",
      "commit_sha":"d158413449692d920a778503502dcb22881bc949",
      "patch":"SINGLE",
      "chain_ord":"['d158413449692d920a778503502dcb22881bc949']",
      "before_first_fix_commit":"{'8cff1e5aee3d766068792a374ba6b54a5cb92e2d'}",
      "last_fix_commit":"d158413449692d920a778503502dcb22881bc949",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/08\/2022, 16:35:34",
      "message":"Code refactoring.",
      "author":"Tomasz Jakut",
      "comments":null,
      "stats":"{'additions': 26, 'deletions': 14, 'total': 40}",
      "files":"{'core\/htmldataprocessor.js': {'additions': 26, 'deletions': 14, 'changes': 40, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ckeditor\/ckeditor4\/raw\/d158413449692d920a778503502dcb22881bc949\/core%2Fhtmldataprocessor.js', 'patch': '@@ -50,17 +50,18 @@\\n \\t\\thtmlFilter.addRules( createBogusAndFillerRules( editor, \\'html\\' ), { applyToAll: true } );\\n \\n \\t\\teditor.on( \\'toHtml\\', function( evt ) {\\n-\\t\\t\\tvar evtData = evt.data,\\n+\\t\\t\\tvar randomNumber = generateRandomNumber(),\\n+\\t\\t\\t\\tevtData = evt.data,\\n \\t\\t\\t\\tdata = evtData.dataValue,\\n \\t\\t\\t\\tfixBodyTag;\\n \\n \\t\\t\\t\/\/ Before we start protecting markup, make sure there are no externally injected\\n \\t\\t\\t\/\/ protection keywords.\\n-\\t\\t\\tdata = removeReservedKeywords( data );\\n+\\t\\t\\tdata = removeReservedKeywords( data, randomNumber );\\n \\n \\t\\t\\t\/\/ The source data is already HTML, but we need to clean\\n \\t\\t\\t\/\/ it up and apply the filter.\\n-\\t\\t\\tdata = protectSource( data, editor );\\n+\\t\\t\\tdata = protectSource( data, editor, randomNumber );\\n \\n \\t\\t\\t\/\/ Protect content of textareas. (https:\/\/dev.ckeditor.com\/ticket\/9995)\\n \\t\\t\\t\/\/ Do this before protecting attributes to avoid breaking:\\n@@ -70,7 +71,7 @@\\n \\t\\t\\t\/\/ Before anything, we must protect the URL attributes as the\\n \\t\\t\\t\/\/ browser may changing them when setting the innerHTML later in\\n \\t\\t\\t\/\/ the code.\\n-\\t\\t\\tdata = protectAttributes( data );\\n+\\t\\t\\tdata = protectAttributes( data, randomNumber );\\n \\n \\t\\t\\t\/\/ Protect elements than can\\'t be set inside a DIV. E.g. IE removes\\n \\t\\t\\t\/\/ style tags from innerHTML. (https:\/\/dev.ckeditor.com\/ticket\/3710)\\n@@ -90,7 +91,7 @@\\n \\n \\t\\t\\t\/\/ There are attributes which may execute JavaScript code inside fixBin.\\n \\t\\t\\t\/\/ Encode them greedily. They will be unprotected right after getting HTML from fixBin. (https:\/\/dev.ckeditor.com\/ticket\/10)\\n-\\t\\t\\tdata = protectInsecureAttributes( data );\\n+\\t\\t\\tdata = protectInsecureAttributes( data, randomNumber );\\n \\n \\t\\t\\tvar fixBin = evtData.context || editor.editable().getName(),\\n \\t\\t\\t\\tisPre;\\n@@ -110,7 +111,7 @@\\n \\t\\t\\tdata = el.getHtml().substr( 1 );\\n \\n \\t\\t\\t\/\/ Restore shortly protected attribute names.\\n-\\t\\t\\tdata = data.replace( new RegExp( \\'data-cke-\\' + CKEDITOR.rnd + \\'-\\', \\'ig\\' ), \\'\\' );\\n+\\t\\t\\tdata = data.replace( new RegExp( \\'data-cke-\\' + randomNumber + \\'-\\', \\'ig\\' ), \\'\\' );\\n \\n \\t\\t\\tisPre && ( data = data.replace( \/^<pre>|<\\\\\/pre>$\/gi, \\'\\' ) );\\n \\n@@ -838,13 +839,13 @@\\n \\n \\tvar protectSelfClosingRegex = \/<cke:(param|embed)([^>]*?)\\\\\/?>(?!\\\\s*<\\\\\/cke:\\\\1)\/gi;\\n \\n-\\tfunction protectAttributes( html ) {\\n+\\tfunction protectAttributes( html, randomNumber ) {\\n \\t\\treturn html.replace( protectElementRegex, function( element, tag, attributes ) {\\n \\t\\t\\treturn \\'<\\' + tag + attributes.replace( protectAttributeRegex, function( fullAttr, attrName ) {\\n \\t\\t\\t\\t\/\/ Avoid corrupting the inline event attributes (https:\/\/dev.ckeditor.com\/ticket\/7243).\\n \\t\\t\\t\\t\/\/ We should not rewrite the existed protected attributes, e.g. clipboard content from editor. (https:\/\/dev.ckeditor.com\/ticket\/5218)\\n \\t\\t\\t\\tif ( protectAttributeNameRegex.test( attrName ) && attributes.indexOf( \\'data-cke-saved-\\' + attrName ) == -1 )\\n-\\t\\t\\t\\t\\treturn \\' data-cke-saved-\\' + fullAttr + \\' data-cke-\\' + CKEDITOR.rnd + \\'-\\' + fullAttr;\\n+\\t\\t\\t\\t\\treturn \\' data-cke-saved-\\' + fullAttr + \\' data-cke-\\' + randomNumber + \\'-\\' + fullAttr;\\n \\n \\t\\t\\t\\treturn fullAttr;\\n \\t\\t\\t} ) + \\'>\\';\\n@@ -897,8 +898,8 @@\\n \\t\/\/ * opening tags - e.g. `<onfoo`,\\n \\t\/\/ * closing tags - e.g. <\/onfoo> (tested in \"false positive 1\"),\\n \\t\/\/ * part of other attribute - e.g. `data-onfoo` or `fonfoo`.\\n-\\tfunction protectInsecureAttributes( html ) {\\n-\\t\\treturn html.replace( \/([^a-z0-9<\\\\-])(on\\\\w{3,})(?!>)\/gi, \\'$1data-cke-\\' + CKEDITOR.rnd + \\'-$2\\' );\\n+\\tfunction protectInsecureAttributes( html, randomNumber ) {\\n+\\t\\treturn html.replace( \/([^a-z0-9<\\\\-])(on\\\\w{3,})(?!>)\/gi, \\'$1data-cke-\\' + randomNumber + \\'-$2\\' );\\n \\t}\\n \\n \\tfunction unprotectRealComments( html ) {\\n@@ -917,11 +918,11 @@\\n \\t\\t} );\\n \\t}\\n \\n-\\tfunction protectSource( data, editor ) {\\n+\\tfunction protectSource( data, editor, randomNumber ) {\\n \\t\\tvar protectedHtml = [],\\n \\t\\t\\tprotectRegexes = editor.config.protectedSource,\\n \\t\\t\\tstore = editor._.dataStore || ( editor._.dataStore = { id: 1 } ),\\n-\\t\\t\\ttempRegex = \/<\\\\!--\\\\{cke_temp(comment)?\\\\}(\\\\d*?)-->\/g;\\n+\\t\\t\\ttempRegex = new RegExp(\\'<\\\\\\\\!--\\\\\\\\{cke_temp_\\' + randomNumber + \\'(comment)?\\\\\\\\}(\\\\\\\\d*?)-->\\', \\'g\\' );\\n \\n \\t\\tvar regexes = [\\n \\t\\t\\t\/\/ Script tags will also be forced to be protected, otherwise\\n@@ -940,7 +941,7 @@\\n \\t\\t\/\/ Note that we use a different tag for comments, as we need to\\n \\t\\t\/\/ transform them when applying filters.\\n \\t\\tdata = data.replace( ( \/<!--[\\\\s\\\\S]*?-->\/g ), function( match ) {\\n-\\t\\t\\treturn \\'<!--{cke_tempcomment}\\' + ( protectedHtml.push( match ) - 1 ) + \\'-->\\';\\n+\\t\\t\\treturn \\'<!--{cke_temp_\\' + randomNumber + \\'comment}\\' + ( protectedHtml.push( match ) - 1 ) + \\'-->\\';\\n \\t\\t} );\\n \\n \\t\\tfor ( var i = 0; i < regexes.length; i++ ) {\\n@@ -951,7 +952,8 @@\\n \\t\\t\\t\\t} );\\n \\n \\t\\t\\t\\t\/\/ Avoid protecting over protected, e.g. \/\\\\{.*?\\\\}\/\\n-\\t\\t\\t\\treturn ( \/cke_temp(comment)?\/ ).test( match ) ? match : \\'<!--{cke_temp}\\' + ( protectedHtml.push( match ) - 1 ) + \\'-->\\';\\n+\\t\\t\\t\\treturn ( tempRegex ).test( match ) ? match : \\'<!--{cke_temp_\\' + randomNumber + \\'}\\' +\\n+\\t\\t\\t\\t\\t( protectedHtml.push( match ) - 1 ) + \\'-->\\';\\n \\t\\t\\t} );\\n \\t\\t}\\n \\t\\tdata = data.replace( tempRegex, function( $, isComment, id ) {\\n@@ -1107,6 +1109,16 @@\\n \\t\\t\\t};\\n \\t\\t}\\n \\t} )();\\n+\\n+\\tfunction generateRandomNumber() {\\n+\\t\\tvar cryptoApi = window.crypto || window.msCrypto;\\n+\\n+\\t\\tif ( cryptoApi ) {\\n+\\t\\t\\treturn cryptoApi.getRandomValues( new Uint32Array( 1 ) )[ 0 ];\\n+\\t\\t}\\n+\\n+\\t\\treturn Math.floor( Math.random() *  9000000000 + 1000000000 );\\n+\\t}\\n } )();\\n \\n \/**'}}",
      "message_norm":"code refactoring.",
      "language":"en",
      "entities":null,
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['core\/htmldataprocessor.js'])",
      "num_files":1.0,
      "patch_content":"From d158413449692d920a778503502dcb22881bc949 Mon Sep 17 00:00:00 2001\nFrom: Tomasz Jakut <vepomoc@gmail.com>\nDate: Tue, 8 Feb 2022 17:35:34 +0100\nSubject: [PATCH] Code refactoring.\n\n---\n core\/htmldataprocessor.js | 40 +++++++++++++++++++++++++--------------\n 1 file changed, 26 insertions(+), 14 deletions(-)\n\ndiff --git a\/core\/htmldataprocessor.js b\/core\/htmldataprocessor.js\nindex a57e4b53d60..9c969631609 100644\n--- a\/core\/htmldataprocessor.js\n+++ b\/core\/htmldataprocessor.js\n@@ -50,17 +50,18 @@\n \t\thtmlFilter.addRules( createBogusAndFillerRules( editor, 'html' ), { applyToAll: true } );\n \n \t\teditor.on( 'toHtml', function( evt ) {\n-\t\t\tvar evtData = evt.data,\n+\t\t\tvar randomNumber = generateRandomNumber(),\n+\t\t\t\tevtData = evt.data,\n \t\t\t\tdata = evtData.dataValue,\n \t\t\t\tfixBodyTag;\n \n \t\t\t\/\/ Before we start protecting markup, make sure there are no externally injected\n \t\t\t\/\/ protection keywords.\n-\t\t\tdata = removeReservedKeywords( data );\n+\t\t\tdata = removeReservedKeywords( data, randomNumber );\n \n \t\t\t\/\/ The source data is already HTML, but we need to clean\n \t\t\t\/\/ it up and apply the filter.\n-\t\t\tdata = protectSource( data, editor );\n+\t\t\tdata = protectSource( data, editor, randomNumber );\n \n \t\t\t\/\/ Protect content of textareas. (https:\/\/dev.ckeditor.com\/ticket\/9995)\n \t\t\t\/\/ Do this before protecting attributes to avoid breaking:\n@@ -70,7 +71,7 @@\n \t\t\t\/\/ Before anything, we must protect the URL attributes as the\n \t\t\t\/\/ browser may changing them when setting the innerHTML later in\n \t\t\t\/\/ the code.\n-\t\t\tdata = protectAttributes( data );\n+\t\t\tdata = protectAttributes( data, randomNumber );\n \n \t\t\t\/\/ Protect elements than can't be set inside a DIV. E.g. IE removes\n \t\t\t\/\/ style tags from innerHTML. (https:\/\/dev.ckeditor.com\/ticket\/3710)\n@@ -90,7 +91,7 @@\n \n \t\t\t\/\/ There are attributes which may execute JavaScript code inside fixBin.\n \t\t\t\/\/ Encode them greedily. They will be unprotected right after getting HTML from fixBin. (https:\/\/dev.ckeditor.com\/ticket\/10)\n-\t\t\tdata = protectInsecureAttributes( data );\n+\t\t\tdata = protectInsecureAttributes( data, randomNumber );\n \n \t\t\tvar fixBin = evtData.context || editor.editable().getName(),\n \t\t\t\tisPre;\n@@ -110,7 +111,7 @@\n \t\t\tdata = el.getHtml().substr( 1 );\n \n \t\t\t\/\/ Restore shortly protected attribute names.\n-\t\t\tdata = data.replace( new RegExp( 'data-cke-' + CKEDITOR.rnd + '-', 'ig' ), '' );\n+\t\t\tdata = data.replace( new RegExp( 'data-cke-' + randomNumber + '-', 'ig' ), '' );\n \n \t\t\tisPre && ( data = data.replace( \/^<pre>|<\\\/pre>$\/gi, '' ) );\n \n@@ -838,13 +839,13 @@\n \n \tvar protectSelfClosingRegex = \/<cke:(param|embed)([^>]*?)\\\/?>(?!\\s*<\\\/cke:\\1)\/gi;\n \n-\tfunction protectAttributes( html ) {\n+\tfunction protectAttributes( html, randomNumber ) {\n \t\treturn html.replace( protectElementRegex, function( element, tag, attributes ) {\n \t\t\treturn '<' + tag + attributes.replace( protectAttributeRegex, function( fullAttr, attrName ) {\n \t\t\t\t\/\/ Avoid corrupting the inline event attributes (https:\/\/dev.ckeditor.com\/ticket\/7243).\n \t\t\t\t\/\/ We should not rewrite the existed protected attributes, e.g. clipboard content from editor. (https:\/\/dev.ckeditor.com\/ticket\/5218)\n \t\t\t\tif ( protectAttributeNameRegex.test( attrName ) && attributes.indexOf( 'data-cke-saved-' + attrName ) == -1 )\n-\t\t\t\t\treturn ' data-cke-saved-' + fullAttr + ' data-cke-' + CKEDITOR.rnd + '-' + fullAttr;\n+\t\t\t\t\treturn ' data-cke-saved-' + fullAttr + ' data-cke-' + randomNumber + '-' + fullAttr;\n \n \t\t\t\treturn fullAttr;\n \t\t\t} ) + '>';\n@@ -897,8 +898,8 @@\n \t\/\/ * opening tags - e.g. `<onfoo`,\n \t\/\/ * closing tags - e.g. <\/onfoo> (tested in \"false positive 1\"),\n \t\/\/ * part of other attribute - e.g. `data-onfoo` or `fonfoo`.\n-\tfunction protectInsecureAttributes( html ) {\n-\t\treturn html.replace( \/([^a-z0-9<\\-])(on\\w{3,})(?!>)\/gi, '$1data-cke-' + CKEDITOR.rnd + '-$2' );\n+\tfunction protectInsecureAttributes( html, randomNumber ) {\n+\t\treturn html.replace( \/([^a-z0-9<\\-])(on\\w{3,})(?!>)\/gi, '$1data-cke-' + randomNumber + '-$2' );\n \t}\n \n \tfunction unprotectRealComments( html ) {\n@@ -917,11 +918,11 @@\n \t\t} );\n \t}\n \n-\tfunction protectSource( data, editor ) {\n+\tfunction protectSource( data, editor, randomNumber ) {\n \t\tvar protectedHtml = [],\n \t\t\tprotectRegexes = editor.config.protectedSource,\n \t\t\tstore = editor._.dataStore || ( editor._.dataStore = { id: 1 } ),\n-\t\t\ttempRegex = \/<\\!--\\{cke_temp(comment)?\\}(\\d*?)-->\/g;\n+\t\t\ttempRegex = new RegExp('<\\\\!--\\\\{cke_temp_' + randomNumber + '(comment)?\\\\}(\\\\d*?)-->', 'g' );\n \n \t\tvar regexes = [\n \t\t\t\/\/ Script tags will also be forced to be protected, otherwise\n@@ -940,7 +941,7 @@\n \t\t\/\/ Note that we use a different tag for comments, as we need to\n \t\t\/\/ transform them when applying filters.\n \t\tdata = data.replace( ( \/<!--[\\s\\S]*?-->\/g ), function( match ) {\n-\t\t\treturn '<!--{cke_tempcomment}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n+\t\t\treturn '<!--{cke_temp_' + randomNumber + 'comment}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n \t\t} );\n \n \t\tfor ( var i = 0; i < regexes.length; i++ ) {\n@@ -951,7 +952,8 @@\n \t\t\t\t} );\n \n \t\t\t\t\/\/ Avoid protecting over protected, e.g. \/\\{.*?\\}\/\n-\t\t\t\treturn ( \/cke_temp(comment)?\/ ).test( match ) ? match : '<!--{cke_temp}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n+\t\t\t\treturn ( tempRegex ).test( match ) ? match : '<!--{cke_temp_' + randomNumber + '}' +\n+\t\t\t\t\t( protectedHtml.push( match ) - 1 ) + '-->';\n \t\t\t} );\n \t\t}\n \t\tdata = data.replace( tempRegex, function( $, isComment, id ) {\n@@ -1107,6 +1109,16 @@\n \t\t\t};\n \t\t}\n \t} )();\n+\n+\tfunction generateRandomNumber() {\n+\t\tvar cryptoApi = window.crypto || window.msCrypto;\n+\n+\t\tif ( cryptoApi ) {\n+\t\t\treturn cryptoApi.getRandomValues( new Uint32Array( 1 ) )[ 0 ];\n+\t\t}\n+\n+\t\treturn Math.floor( Math.random() *  9000000000 + 1000000000 );\n+\t}\n } )();\n \n \/**",
      "code_diff":"@@ -50,17 +50,18 @@\n \t\thtmlFilter.addRules( createBogusAndFillerRules( editor, 'html' ), { applyToAll: true } );\n \n \t\teditor.on( 'toHtml', function( evt ) {\n-\t\t\tvar evtData = evt.data,\n+\t\t\tvar randomNumber = generateRandomNumber(),\n+\t\t\t\tevtData = evt.data,\n \t\t\t\tdata = evtData.dataValue,\n \t\t\t\tfixBodyTag;\n \n \t\t\t\/\/ Before we start protecting markup, make sure there are no externally injected\n \t\t\t\/\/ protection keywords.\n-\t\t\tdata = removeReservedKeywords( data );\n+\t\t\tdata = removeReservedKeywords( data, randomNumber );\n \n \t\t\t\/\/ The source data is already HTML, but we need to clean\n \t\t\t\/\/ it up and apply the filter.\n-\t\t\tdata = protectSource( data, editor );\n+\t\t\tdata = protectSource( data, editor, randomNumber );\n \n \t\t\t\/\/ Protect content of textareas. (https:\/\/dev.ckeditor.com\/ticket\/9995)\n \t\t\t\/\/ Do this before protecting attributes to avoid breaking:\n@@ -70,7 +71,7 @@\n \t\t\t\/\/ Before anything, we must protect the URL attributes as the\n \t\t\t\/\/ browser may changing them when setting the innerHTML later in\n \t\t\t\/\/ the code.\n-\t\t\tdata = protectAttributes( data );\n+\t\t\tdata = protectAttributes( data, randomNumber );\n \n \t\t\t\/\/ Protect elements than can't be set inside a DIV. E.g. IE removes\n \t\t\t\/\/ style tags from innerHTML. (https:\/\/dev.ckeditor.com\/ticket\/3710)\n@@ -90,7 +91,7 @@\n \n \t\t\t\/\/ There are attributes which may execute JavaScript code inside fixBin.\n \t\t\t\/\/ Encode them greedily. They will be unprotected right after getting HTML from fixBin. (https:\/\/dev.ckeditor.com\/ticket\/10)\n-\t\t\tdata = protectInsecureAttributes( data );\n+\t\t\tdata = protectInsecureAttributes( data, randomNumber );\n \n \t\t\tvar fixBin = evtData.context || editor.editable().getName(),\n \t\t\t\tisPre;\n@@ -110,7 +111,7 @@\n \t\t\tdata = el.getHtml().substr( 1 );\n \n \t\t\t\/\/ Restore shortly protected attribute names.\n-\t\t\tdata = data.replace( new RegExp( 'data-cke-' + CKEDITOR.rnd + '-', 'ig' ), '' );\n+\t\t\tdata = data.replace( new RegExp( 'data-cke-' + randomNumber + '-', 'ig' ), '' );\n \n \t\t\tisPre && ( data = data.replace( \/^<pre>|<\\\/pre>$\/gi, '' ) );\n \n@@ -838,13 +839,13 @@\n \n \tvar protectSelfClosingRegex = \/<cke:(param|embed)([^>]*?)\\\/?>(?!\\s*<\\\/cke:\\1)\/gi;\n \n-\tfunction protectAttributes( html ) {\n+\tfunction protectAttributes( html, randomNumber ) {\n \t\treturn html.replace( protectElementRegex, function( element, tag, attributes ) {\n \t\t\treturn '<' + tag + attributes.replace( protectAttributeRegex, function( fullAttr, attrName ) {\n \t\t\t\t\/\/ Avoid corrupting the inline event attributes (https:\/\/dev.ckeditor.com\/ticket\/7243).\n \t\t\t\t\/\/ We should not rewrite the existed protected attributes, e.g. clipboard content from editor. (https:\/\/dev.ckeditor.com\/ticket\/5218)\n \t\t\t\tif ( protectAttributeNameRegex.test( attrName ) && attributes.indexOf( 'data-cke-saved-' + attrName ) == -1 )\n-\t\t\t\t\treturn ' data-cke-saved-' + fullAttr + ' data-cke-' + CKEDITOR.rnd + '-' + fullAttr;\n+\t\t\t\t\treturn ' data-cke-saved-' + fullAttr + ' data-cke-' + randomNumber + '-' + fullAttr;\n \n \t\t\t\treturn fullAttr;\n \t\t\t} ) + '>';\n@@ -897,8 +898,8 @@\n \t\/\/ * opening tags - e.g. `<onfoo`,\n \t\/\/ * closing tags - e.g. <\/onfoo> (tested in \"false positive 1\"),\n \t\/\/ * part of other attribute - e.g. `data-onfoo` or `fonfoo`.\n-\tfunction protectInsecureAttributes( html ) {\n-\t\treturn html.replace( \/([^a-z0-9<\\-])(on\\w{3,})(?!>)\/gi, '$1data-cke-' + CKEDITOR.rnd + '-$2' );\n+\tfunction protectInsecureAttributes( html, randomNumber ) {\n+\t\treturn html.replace( \/([^a-z0-9<\\-])(on\\w{3,})(?!>)\/gi, '$1data-cke-' + randomNumber + '-$2' );\n \t}\n \n \tfunction unprotectRealComments( html ) {\n@@ -917,11 +918,11 @@\n \t\t} );\n \t}\n \n-\tfunction protectSource( data, editor ) {\n+\tfunction protectSource( data, editor, randomNumber ) {\n \t\tvar protectedHtml = [],\n \t\t\tprotectRegexes = editor.config.protectedSource,\n \t\t\tstore = editor._.dataStore || ( editor._.dataStore = { id: 1 } ),\n-\t\t\ttempRegex = \/<\\!--\\{cke_temp(comment)?\\}(\\d*?)-->\/g;\n+\t\t\ttempRegex = new RegExp('<\\\\!--\\\\{cke_temp_' + randomNumber + '(comment)?\\\\}(\\\\d*?)-->', 'g' );\n \n \t\tvar regexes = [\n \t\t\t\/\/ Script tags will also be forced to be protected, otherwise\n@@ -940,7 +941,7 @@\n \t\t\/\/ Note that we use a different tag for comments, as we need to\n \t\t\/\/ transform them when applying filters.\n \t\tdata = data.replace( ( \/<!--[\\s\\S]*?-->\/g ), function( match ) {\n-\t\t\treturn '<!--{cke_tempcomment}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n+\t\t\treturn '<!--{cke_temp_' + randomNumber + 'comment}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n \t\t} );\n \n \t\tfor ( var i = 0; i < regexes.length; i++ ) {\n@@ -951,7 +952,8 @@\n \t\t\t\t} );\n \n \t\t\t\t\/\/ Avoid protecting over protected, e.g. \/\\{.*?\\}\/\n-\t\t\t\treturn ( \/cke_temp(comment)?\/ ).test( match ) ? match : '<!--{cke_temp}' + ( protectedHtml.push( match ) - 1 ) + '-->';\n+\t\t\t\treturn ( tempRegex ).test( match ) ? match : '<!--{cke_temp_' + randomNumber + '}' +\n+\t\t\t\t\t( protectedHtml.push( match ) - 1 ) + '-->';\n \t\t\t} );\n \t\t}\n \t\tdata = data.replace( tempRegex, function( $, isComment, id ) {\n@@ -1107,6 +1109,16 @@\n \t\t\t};\n \t\t}\n \t} )();\n+\n+\tfunction generateRandomNumber() {\n+\t\tvar cryptoApi = window.crypto || window.msCrypto;\n+\n+\t\tif ( cryptoApi ) {\n+\t\t\treturn cryptoApi.getRandomValues( new Uint32Array( 1 ) )[ 0 ];\n+\t\t}\n+\n+\t\treturn Math.floor( Math.random() *  9000000000 + 1000000000 );\n+\t}\n } )();\n \n \/**"
    },
    {
      "index":31,
      "vuln_id":"GHSA-fp76-f299-v3hj",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/neorazorx\/facturascripts\/commit\/1d1edb40b40016d7fd2893b410b98569d7facca1'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in FacturaScripts Cross-site Scripting (XSS) - Stored in GitHub repository neorazorx\/facturascripts prior to 2022.06.",
      "published_date":"2022-06-14",
      "chain_len":1,
      "project":"https:\/\/github.com\/neorazorx\/facturascripts",
      "commit_href":"https:\/\/github.com\/neorazorx\/facturascripts\/commit\/1d1edb40b40016d7fd2893b410b98569d7facca1",
      "commit_sha":"1d1edb40b40016d7fd2893b410b98569d7facca1",
      "patch":"SINGLE",
      "chain_ord":"['1d1edb40b40016d7fd2893b410b98569d7facca1']",
      "before_first_fix_commit":"{'73a6595ca85984d65f656c6356fabb23d1936c54'}",
      "last_fix_commit":"1d1edb40b40016d7fd2893b410b98569d7facca1",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/28\/2022, 09:55:32",
      "message":"Force to download SVG files to prevent security problems.\n------\nForzamos a descargar los archivos SVG para evitar problemas de seguridad.",
      "author":"Carlos Garcia Gomez",
      "comments":null,
      "stats":"{'additions': 19, 'deletions': 10, 'total': 29}",
      "files":"{'Core\/App\/AppRouter.php': {'additions': 19, 'deletions': 10, 'changes': 29, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/NeoRazorX\/facturascripts\/raw\/1d1edb40b40016d7fd2893b410b98569d7facca1\/Core%2FApp%2FAppRouter.php', 'patch': '@@ -127,8 +127,7 @@ public function getFile(): bool\\n         $allowedFolders = [\\'node_modules\\', \\'vendor\\', \\'Dinamic\\', \\'Core\\', \\'Plugins\\', \\'MyFiles\/Public\\'];\\n         foreach ($allowedFolders as $folder) {\\n             if (\\'\/\\' . $folder === substr($uri, 0, 1 + strlen($folder))) {\\n-                header(\\'Content-Type: \\' . $this->getMime($filePath));\\n-                readfile($filePath);\\n+                $this->download($filePath);\\n                 return true;\\n             }\\n         }\\n@@ -137,14 +136,7 @@ public function getFile(): bool\\n         $token = filter_input(INPUT_GET, \\'myft\\');\\n         $fixedFilePath = substr(urldecode($uri), 1);\\n         if (\\'\/MyFiles\/\\' === substr($uri, 0, 9) && $token && MyFilesToken::validate($fixedFilePath, $token)) {\\n-            header(\\'Content-Type: \\' . $this->getMime($filePath));\\n-\\n-            \/\/ disable the buffer if enabled\\n-            if (ob_get_contents()) {\\n-                ob_end_flush();\\n-            }\\n-\\n-            readfile($filePath);\\n+            $this->download($filePath);\\n             return true;\\n         }\\n \\n@@ -205,6 +197,23 @@ private function deploy()\\n         }\\n     }\\n \\n+    private function download(string $filePath)\\n+    {\\n+        header(\\'Content-Type: \\' . $this->getMime($filePath));\\n+\\n+        \/\/ disable the buffer if enabled\\n+        if (ob_get_contents()) {\\n+            ob_end_flush();\\n+        }\\n+\\n+        \/\/ force to download svg files to prevent XSS attacks\\n+        if (strpos($filePath, \\'.svg\\') !== false) {\\n+            header(\\'Content-Disposition: attachment; filename=\"\\' . basename($filePath) . \\'\"\\');\\n+        }\\n+\\n+        readfile($filePath);\\n+    }\\n+\\n     \/**\\n      * Return the mime type from given file.\\n      *'}}",
      "message_norm":"force to download svg files to prevent security problems.\n------\nforzamos a descargar los archivos svg para evitar problemas de seguridad.",
      "language":"es",
      "entities":"[('prevent', 'ACTION', ''), ('security', 'SECWORD', ''), ('problems', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['Core\/App\/AppRouter.php'])",
      "num_files":1.0,
      "patch_content":"From 1d1edb40b40016d7fd2893b410b98569d7facca1 Mon Sep 17 00:00:00 2001\nFrom: Carlos Garcia Gomez <neorazorx@gmail.com>\nDate: Thu, 28 Apr 2022 11:55:32 +0200\nSubject: [PATCH] Force to download SVG files to prevent security problems.\n ------ Forzamos a descargar los archivos SVG para evitar problemas de\n seguridad.\n\n---\n Core\/App\/AppRouter.php | 29 +++++++++++++++++++----------\n 1 file changed, 19 insertions(+), 10 deletions(-)\n\ndiff --git a\/Core\/App\/AppRouter.php b\/Core\/App\/AppRouter.php\nindex 1eed63f833..1de2d09bc9 100644\n--- a\/Core\/App\/AppRouter.php\n+++ b\/Core\/App\/AppRouter.php\n@@ -127,8 +127,7 @@ public function getFile(): bool\n         $allowedFolders = ['node_modules', 'vendor', 'Dinamic', 'Core', 'Plugins', 'MyFiles\/Public'];\n         foreach ($allowedFolders as $folder) {\n             if ('\/' . $folder === substr($uri, 0, 1 + strlen($folder))) {\n-                header('Content-Type: ' . $this->getMime($filePath));\n-                readfile($filePath);\n+                $this->download($filePath);\n                 return true;\n             }\n         }\n@@ -137,14 +136,7 @@ public function getFile(): bool\n         $token = filter_input(INPUT_GET, 'myft');\n         $fixedFilePath = substr(urldecode($uri), 1);\n         if ('\/MyFiles\/' === substr($uri, 0, 9) && $token && MyFilesToken::validate($fixedFilePath, $token)) {\n-            header('Content-Type: ' . $this->getMime($filePath));\n-\n-            \/\/ disable the buffer if enabled\n-            if (ob_get_contents()) {\n-                ob_end_flush();\n-            }\n-\n-            readfile($filePath);\n+            $this->download($filePath);\n             return true;\n         }\n \n@@ -205,6 +197,23 @@ private function deploy()\n         }\n     }\n \n+    private function download(string $filePath)\n+    {\n+        header('Content-Type: ' . $this->getMime($filePath));\n+\n+        \/\/ disable the buffer if enabled\n+        if (ob_get_contents()) {\n+            ob_end_flush();\n+        }\n+\n+        \/\/ force to download svg files to prevent XSS attacks\n+        if (strpos($filePath, '.svg') !== false) {\n+            header('Content-Disposition: attachment; filename=\"' . basename($filePath) . '\"');\n+        }\n+\n+        readfile($filePath);\n+    }\n+\n     \/**\n      * Return the mime type from given file.\n      *",
      "code_diff":"@@ -127,8 +127,7 @@ public function getFile(): bool\n         $allowedFolders = ['node_modules', 'vendor', 'Dinamic', 'Core', 'Plugins', 'MyFiles\/Public'];\n         foreach ($allowedFolders as $folder) {\n             if ('\/' . $folder === substr($uri, 0, 1 + strlen($folder))) {\n-                header('Content-Type: ' . $this->getMime($filePath));\n-                readfile($filePath);\n+                $this->download($filePath);\n                 return true;\n             }\n         }\n@@ -137,14 +136,7 @@ public function getFile(): bool\n         $token = filter_input(INPUT_GET, 'myft');\n         $fixedFilePath = substr(urldecode($uri), 1);\n         if ('\/MyFiles\/' === substr($uri, 0, 9) && $token && MyFilesToken::validate($fixedFilePath, $token)) {\n-            header('Content-Type: ' . $this->getMime($filePath));\n-\n-            \/\/ disable the buffer if enabled\n-            if (ob_get_contents()) {\n-                ob_end_flush();\n-            }\n-\n-            readfile($filePath);\n+            $this->download($filePath);\n             return true;\n         }\n \n@@ -205,6 +197,23 @@ private function deploy()\n         }\n     }\n \n+    private function download(string $filePath)\n+    {\n+        header('Content-Type: ' . $this->getMime($filePath));\n+\n+        \/\/ disable the buffer if enabled\n+        if (ob_get_contents()) {\n+            ob_end_flush();\n+        }\n+\n+        \/\/ force to download svg files to prevent XSS attacks\n+        if (strpos($filePath, '.svg') !== false) {\n+            header('Content-Disposition: attachment; filename=\"' . basename($filePath) . '\"');\n+        }\n+\n+        readfile($filePath);\n+    }\n+\n     \/**\n      * Return the mime type from given file.\n      *"
    },
    {
      "index":32,
      "vuln_id":"GHSA-mxvc-fwgx-j778",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/benbusby\/whoogle-search\/commit\/abc30d7da3b5c67be7ce84d4699f327442d44606'}",
      "dataset":"osv",
      "summary":"Whoogle Search Cross-site Scripting via string parameter The package whoogle-search before 0.7.2 is vulnerable to Cross-site Scripting (XSS) via the query string parameter q. In the case where it does not contain the http string, it is used to build the error_message that is then rendered in the error.html template, using the [flask.render_template](https:\/\/flask.palletsprojects.com\/en\/2.1.x\/api\/flask.render_template) function. However, the error_message is rendered using the [| safe filter](https:\/\/jinja.palletsprojects.com\/en\/3.1.x\/templates\/working-with-automatic-escaping), meaning the user input is not escaped.",
      "published_date":"2022-07-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/benbusby\/whoogle-search",
      "commit_href":"https:\/\/github.com\/benbusby\/whoogle-search\/commit\/abc30d7da3b5c67be7ce84d4699f327442d44606",
      "commit_sha":"abc30d7da3b5c67be7ce84d4699f327442d44606",
      "patch":"SINGLE",
      "chain_ord":"['abc30d7da3b5c67be7ce84d4699f327442d44606']",
      "before_first_fix_commit":"{'d62ceb84239ee0df677851f46eb885c40e98211f'}",
      "last_fix_commit":"abc30d7da3b5c67be7ce84d4699f327442d44606",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/26\/2022, 15:28:05",
      "message":"Render error message w\/o `safe` filter\n\nThe error message shown in the error template does not need to be\nrendered using the safe filter, and furthermore opens up an XSS\nvulnerability.",
      "author":"Ben Busby",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/templates\/error.html': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/benbusby\/whoogle-search\/raw\/abc30d7da3b5c67be7ce84d4699f327442d44606\/app%2Ftemplates%2Ferror.html', 'patch': '@@ -16,7 +16,7 @@\\n <div>\\n     <h1>Error<\/h1>\\n     <p>\\n-        {{ error_message|safe }}\\n+        {{ error_message }}\\n     <\/p>\\n     <hr>\\n     <p>'}}",
      "message_norm":"render error message w\/o `safe` filter\n\nthe error message shown in the error template does not need to be\nrendered using the safe filter, and furthermore opens up an xss\nvulnerability.",
      "language":"en",
      "entities":"[('error', 'FLAW', ''), ('safe', 'SECWORD', ''), ('error', 'FLAW', ''), ('error', 'FLAW', ''), ('safe', 'SECWORD', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/templates\/error.html'])",
      "num_files":1.0,
      "patch_content":"From abc30d7da3b5c67be7ce84d4699f327442d44606 Mon Sep 17 00:00:00 2001\nFrom: Ben Busby <contact@benbusby.com>\nDate: Tue, 26 Apr 2022 09:28:05 -0600\nSubject: [PATCH] Render error message w\/o `safe` filter\n\nThe error message shown in the error template does not need to be\nrendered using the safe filter, and furthermore opens up an XSS\nvulnerability.\n---\n app\/templates\/error.html | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/templates\/error.html b\/app\/templates\/error.html\nindex 58f7f4271e..708f74911c 100644\n--- a\/app\/templates\/error.html\n+++ b\/app\/templates\/error.html\n@@ -16,7 +16,7 @@\n <div>\n     <h1>Error<\/h1>\n     <p>\n-        {{ error_message|safe }}\n+        {{ error_message }}\n     <\/p>\n     <hr>\n     <p>",
      "code_diff":"@@ -16,7 +16,7 @@\n <div>\n     <h1>Error<\/h1>\n     <p>\n-        {{ error_message|safe }}\n+        {{ error_message }}\n     <\/p>\n     <hr>\n     <p>"
    },
    {
      "index":33,
      "vuln_id":"GHSA-c65v-p733-9796",
      "cwe_id":"{'CWE-79'}",
      "score":8.0,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/7ce5993f5ae9d713a0955c2fd8e2dff7a7ce886e'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in snipe\/snipe-it snipe-it is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2021-11-23",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/7ce5993f5ae9d713a0955c2fd8e2dff7a7ce886e",
      "commit_sha":"7ce5993f5ae9d713a0955c2fd8e2dff7a7ce886e",
      "patch":"SINGLE",
      "chain_ord":"['7ce5993f5ae9d713a0955c2fd8e2dff7a7ce886e']",
      "before_first_fix_commit":"{'e75a5f13ecb77a53d93d67c23e9f1b3580fe8092', 'f7b483358ff114b56c753ee9c2964059a55a3bd2'}",
      "last_fix_commit":"7ce5993f5ae9d713a0955c2fd8e2dff7a7ce886e",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/16\/2021, 04:33:51",
      "message":"Merge pull request #10315 from snipe\/fixes\/escape_custom_fields_in_api_response\n\nEscape custom field values in API response",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 5, 'total': 10}",
      "files":"{'app\/Http\/Transformers\/AssetsTransformer.php': {'additions': 5, 'deletions': 5, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/7ce5993f5ae9d713a0955c2fd8e2dff7a7ce886e\/app%2FHttp%2FTransformers%2FAssetsTransformer.php', 'patch': \"@@ -93,15 +93,15 @@ public function transformAsset(Asset $asset)\\n                     $value = (Gate::allows('superadmin')) ? $decrypted : strtoupper(trans('admin\/custom_fields\/general.encrypted'));\\n \\n                     $fields_array[$field->name] = [\\n-                            'field' => $field->convertUnicodeDbSlug(),\\n-                            'value' => $value,\\n+                            'field' => e($field->convertUnicodeDbSlug()),\\n+                            'value' => e($value),\\n                             'field_format' => $field->format,\\n                         ];\\n \\n                 } else {\\n                     $fields_array[$field->name] = [\\n-                        'field' => $field->convertUnicodeDbSlug(),\\n-                        'value' => $asset->{$field->convertUnicodeDbSlug()},\\n+                        'field' => e($field->convertUnicodeDbSlug()),\\n+                        'value' => e($asset->{$field->convertUnicodeDbSlug()}),\\n                         'field_format' => $field->format,\\n                     ];\\n \\n@@ -134,7 +134,7 @@ public function transformAsset(Asset $asset)\\n                         \\n                             'id' => $component->id,\\n                             'pivot_id' => $component->pivot->id,\\n-                            'name' => $component->name,\\n+                            'name' => e($component->name),\\n                             'qty' => $component->pivot->assigned_qty,\\n                             'price_cost' => $component->purchase_cost,\\n                             'purchase_total' => $component->purchase_cost * $component->pivot->assigned_qty,\"}}",
      "message_norm":"merge pull request #10315 from snipe\/fixes\/escape_custom_fields_in_api_response\n\nescape custom field values in api response",
      "language":"ca",
      "entities":"[('#10315', 'ISSUE', ''), ('escape_custom_fields_in_api_response', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Transformers\/AssetsTransformer.php'])",
      "num_files":1.0,
      "patch_content":"From f7b483358ff114b56c753ee9c2964059a55a3bd2 Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Mon, 15 Nov 2021 20:32:59 -0800\nSubject: [PATCH] Escape custom field values in API response\n\nSigned-off-by: snipe <snipe@snipe.net>\n---\n app\/Http\/Transformers\/AssetsTransformer.php | 10 +++++-----\n 1 file changed, 5 insertions(+), 5 deletions(-)\n\ndiff --git a\/app\/Http\/Transformers\/AssetsTransformer.php b\/app\/Http\/Transformers\/AssetsTransformer.php\nindex c323241cf01b..0da314002f54 100644\n--- a\/app\/Http\/Transformers\/AssetsTransformer.php\n+++ b\/app\/Http\/Transformers\/AssetsTransformer.php\n@@ -93,15 +93,15 @@ public function transformAsset(Asset $asset)\n                     $value = (Gate::allows('superadmin')) ? $decrypted : strtoupper(trans('admin\/custom_fields\/general.encrypted'));\n \n                     $fields_array[$field->name] = [\n-                            'field' => $field->convertUnicodeDbSlug(),\n-                            'value' => $value,\n+                            'field' => e($field->convertUnicodeDbSlug()),\n+                            'value' => e($value),\n                             'field_format' => $field->format,\n                         ];\n \n                 } else {\n                     $fields_array[$field->name] = [\n-                        'field' => $field->convertUnicodeDbSlug(),\n-                        'value' => $asset->{$field->convertUnicodeDbSlug()},\n+                        'field' => e($field->convertUnicodeDbSlug()),\n+                        'value' => e($asset->{$field->convertUnicodeDbSlug()}),\n                         'field_format' => $field->format,\n                     ];\n \n@@ -134,7 +134,7 @@ public function transformAsset(Asset $asset)\n                         \n                             'id' => $component->id,\n                             'pivot_id' => $component->pivot->id,\n-                            'name' => $component->name,\n+                            'name' => e($component->name),\n                             'qty' => $component->pivot->assigned_qty,\n                             'price_cost' => $component->purchase_cost,\n                             'purchase_total' => $component->purchase_cost * $component->pivot->assigned_qty,",
      "code_diff":"@@ -93,15 +93,15 @@ public function transformAsset(Asset $asset)\n                     $value = (Gate::allows('superadmin')) ? $decrypted : strtoupper(trans('admin\/custom_fields\/general.encrypted'));\n \n                     $fields_array[$field->name] = [\n-                            'field' => $field->convertUnicodeDbSlug(),\n-                            'value' => $value,\n+                            'field' => e($field->convertUnicodeDbSlug()),\n+                            'value' => e($value),\n                             'field_format' => $field->format,\n                         ];\n \n                 } else {\n                     $fields_array[$field->name] = [\n-                        'field' => $field->convertUnicodeDbSlug(),\n-                        'value' => $asset->{$field->convertUnicodeDbSlug()},\n+                        'field' => e($field->convertUnicodeDbSlug()),\n+                        'value' => e($asset->{$field->convertUnicodeDbSlug()}),\n                         'field_format' => $field->format,\n                     ];\n \n@@ -134,7 +134,7 @@ public function transformAsset(Asset $asset)\n                         \n                             'id' => $component->id,\n                             'pivot_id' => $component->pivot->id,\n-                            'name' => $component->name,\n+                            'name' => e($component->name),\n                             'qty' => $component->pivot->assigned_qty,\n                             'price_cost' => $component->purchase_cost,\n                             'purchase_total' => $component->purchase_cost * $component->pivot->assigned_qty,"
    },
    {
      "index":34,
      "vuln_id":"GHSA-m8rp-q82r-c5mf",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/b64ef574b82dbf89a908e1569d790c7012d1ccd7'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber Cross-site Scripting (XSS) - Stored in Packagist microweber\/microweber prior to 1.2.11.",
      "published_date":"2022-01-21",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/b64ef574b82dbf89a908e1569d790c7012d1ccd7",
      "commit_sha":"b64ef574b82dbf89a908e1569d790c7012d1ccd7",
      "patch":"SINGLE",
      "chain_ord":"['b64ef574b82dbf89a908e1569d790c7012d1ccd7']",
      "before_first_fix_commit":"{'e17f3e94289b2dac7187e8039e1a3429779e273c'}",
      "last_fix_commit":"b64ef574b82dbf89a908e1569d790c7012d1ccd7",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/19\/2022, 09:56:21",
      "message":"xss on contact form fix",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 3, 'total': 5}",
      "files":"{'userfiles\/modules\/admin\/notifications\/notif_form_entry.php': {'additions': 2, 'deletions': 3, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/b64ef574b82dbf89a908e1569d790c7012d1ccd7\/userfiles%2Fmodules%2Fadmin%2Fnotifications%2Fnotif_form_entry.php', 'patch': '@@ -91,7 +91,6 @@\\n             <hr class=\"thin\" \/>\\n             <div class=\"row\">\\n \\n-\\n                 <?php\\n                 $iformVr=0;\\n                 foreach ($form_values_formated as $form_values_row) {\\n@@ -106,12 +105,12 @@\\n                             <?php if (!is_array($val1)){ ?>\\n                                 <div>\\n                                     <small class=\"text-muted\"><?php echo str_replace(\\'_\\', \\' \\', $key); ?>:<\/small>\\n-                                    <p><?php print $val1; ?><\/p>\\n+                                    <p><?php print htmlentities($val1); ?><\/p>\\n                                 <\/div>\\n                             <?php } else { ?>\\n                                 <small class=\"text-muted\"><?php echo str_replace(\\'_\\', \\' \\', $key); ?>:<\/small>\\n                                 <?php foreach ($val1 as $val1_1){ ?>\\n-                                    <p><?php print $val1_1 . \\'<br \/>\\'; ?><\/p>\\n+                                    <p><?php print htmlentities($val1_1) . \\'<br \/>\\'; ?><\/p>\\n                                 <?php }?>\\n                             <?php } ?>\\n                         <?php } ?>'}}",
      "message_norm":"xss on contact form fix",
      "language":"en",
      "entities":"[('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['userfiles\/modules\/admin\/notifications\/notif_form_entry.php'])",
      "num_files":1.0,
      "patch_content":"From b64ef574b82dbf89a908e1569d790c7012d1ccd7 Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Wed, 19 Jan 2022 11:56:21 +0200\nSubject: [PATCH] xss on contact form fix\n\n---\n userfiles\/modules\/admin\/notifications\/notif_form_entry.php | 5 ++---\n 1 file changed, 2 insertions(+), 3 deletions(-)\n\ndiff --git a\/userfiles\/modules\/admin\/notifications\/notif_form_entry.php b\/userfiles\/modules\/admin\/notifications\/notif_form_entry.php\nindex 586de353b63..dc92f12cbbc 100644\n--- a\/userfiles\/modules\/admin\/notifications\/notif_form_entry.php\n+++ b\/userfiles\/modules\/admin\/notifications\/notif_form_entry.php\n@@ -91,7 +91,6 @@\n             <hr class=\"thin\" \/>\n             <div class=\"row\">\n \n-\n                 <?php\n                 $iformVr=0;\n                 foreach ($form_values_formated as $form_values_row) {\n@@ -106,12 +105,12 @@\n                             <?php if (!is_array($val1)){ ?>\n                                 <div>\n                                     <small class=\"text-muted\"><?php echo str_replace('_', ' ', $key); ?>:<\/small>\n-                                    <p><?php print $val1; ?><\/p>\n+                                    <p><?php print htmlentities($val1); ?><\/p>\n                                 <\/div>\n                             <?php } else { ?>\n                                 <small class=\"text-muted\"><?php echo str_replace('_', ' ', $key); ?>:<\/small>\n                                 <?php foreach ($val1 as $val1_1){ ?>\n-                                    <p><?php print $val1_1 . '<br \/>'; ?><\/p>\n+                                    <p><?php print htmlentities($val1_1) . '<br \/>'; ?><\/p>\n                                 <?php }?>\n                             <?php } ?>\n                         <?php } ?>",
      "code_diff":"@@ -91,7 +91,6 @@\n             <hr class=\"thin\" \/>\n             <div class=\"row\">\n \n-\n                 <?php\n                 $iformVr=0;\n                 foreach ($form_values_formated as $form_values_row) {\n@@ -106,12 +105,12 @@\n                             <?php if (!is_array($val1)){ ?>\n                                 <div>\n                                     <small class=\"text-muted\"><?php echo str_replace('_', ' ', $key); ?>:<\/small>\n-                                    <p><?php print $val1; ?><\/p>\n+                                    <p><?php print htmlentities($val1); ?><\/p>\n                                 <\/div>\n                             <?php } else { ?>\n                                 <small class=\"text-muted\"><?php echo str_replace('_', ' ', $key); ?>:<\/small>\n                                 <?php foreach ($val1 as $val1_1){ ?>\n-                                    <p><?php print $val1_1 . '<br \/>'; ?><\/p>\n+                                    <p><?php print htmlentities($val1_1) . '<br \/>'; ?><\/p>\n                                 <?php }?>\n                             <?php } ?>\n                         <?php } ?>"
    },
    {
      "index":35,
      "vuln_id":"GHSA-3j58-p785-f27x",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/fc7e1a026735b93f0e0047700d08c44954fce9ce'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber There is a reflected cross sitem scripting attack in microweber via url parameters.",
      "published_date":"2022-01-28",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/fc7e1a026735b93f0e0047700d08c44954fce9ce",
      "commit_sha":"fc7e1a026735b93f0e0047700d08c44954fce9ce",
      "patch":"SINGLE",
      "chain_ord":"['fc7e1a026735b93f0e0047700d08c44954fce9ce']",
      "before_first_fix_commit":"{'6e9fcaa043b4211ef21a494f9892dd19ba8a572c'}",
      "last_fix_commit":"fc7e1a026735b93f0e0047700d08c44954fce9ce",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/19\/2022, 10:33:18",
      "message":"fix xss on module api call in value parameters",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 4, 'total': 8}",
      "files":"{'src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php': {'additions': 4, 'deletions': 4, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/fc7e1a026735b93f0e0047700d08c44954fce9ce\/src%2FMicroweberPackages%2FApp%2FHttp%2FControllers%2FApiController.php', 'patch': \"@@ -17,9 +17,6 @@\\n class ApiController  extends FrontendController\\n {\\n \\n-\\n-\\n-\\n     public function api_html()\\n     {\\n         if (!defined('MW_API_HTML_OUTPUT')) {\\n@@ -609,12 +606,14 @@ public function module()\\n \\n         $request_data = array_merge($_GET, $_POST);\\n \\n-\\n         \/\/ sanitize attributes\\n         if($request_data){\\n             $request_data_new = [];\\n             $antixss = new AntiXSS();\\n             foreach ($request_data as $k=>$v){\\n+\\n+                $v = $antixss->xss_clean($v);\\n+\\n                 if(is_string($k)){\\n                     $k = $antixss->xss_clean($k);\\n                     if($k){\\n@@ -623,6 +622,7 @@ public function module()\\n                 } else {\\n                     $request_data_new[$k] = $v;\\n                 }\\n+                \\n             }\\n             $request_data = $request_data_new;\\n         }\"}}",
      "message_norm":"fix xss on module api call in value parameters",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php'])",
      "num_files":1.0,
      "patch_content":"From fc7e1a026735b93f0e0047700d08c44954fce9ce Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Wed, 19 Jan 2022 12:33:18 +0200\nSubject: [PATCH] fix xss on module api call in value parameters\n\n---\n ...\/App\/Http\/Controllers\/ApiController.php                | 8 ++++----\n 1 file changed, 4 insertions(+), 4 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php b\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php\nindex 7973615d77b..6d628263d5b 100644\n--- a\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php\n+++ b\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php\n@@ -17,9 +17,6 @@\n class ApiController  extends FrontendController\n {\n \n-\n-\n-\n     public function api_html()\n     {\n         if (!defined('MW_API_HTML_OUTPUT')) {\n@@ -609,12 +606,14 @@ public function module()\n \n         $request_data = array_merge($_GET, $_POST);\n \n-\n         \/\/ sanitize attributes\n         if($request_data){\n             $request_data_new = [];\n             $antixss = new AntiXSS();\n             foreach ($request_data as $k=>$v){\n+\n+                $v = $antixss->xss_clean($v);\n+\n                 if(is_string($k)){\n                     $k = $antixss->xss_clean($k);\n                     if($k){\n@@ -623,6 +622,7 @@ public function module()\n                 } else {\n                     $request_data_new[$k] = $v;\n                 }\n+                \n             }\n             $request_data = $request_data_new;\n         }",
      "code_diff":"@@ -17,9 +17,6 @@\n class ApiController  extends FrontendController\n {\n \n-\n-\n-\n     public function api_html()\n     {\n         if (!defined('MW_API_HTML_OUTPUT')) {\n@@ -609,12 +606,14 @@ public function module()\n \n         $request_data = array_merge($_GET, $_POST);\n \n-\n         \/\/ sanitize attributes\n         if($request_data){\n             $request_data_new = [];\n             $antixss = new AntiXSS();\n             foreach ($request_data as $k=>$v){\n+\n+                $v = $antixss->xss_clean($v);\n+\n                 if(is_string($k)){\n                     $k = $antixss->xss_clean($k);\n                     if($k){\n@@ -623,6 +622,7 @@ public function module()\n                 } else {\n                     $request_data_new[$k] = $v;\n                 }\n+                \n             }\n             $request_data = $request_data_new;\n         }"
    },
    {
      "index":36,
      "vuln_id":"GHSA-7c82-mp33-r854",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/snapappointments\/bootstrap-select\/commit\/ab6e068748040cf3cda5859f6349b382402b8767'}",
      "dataset":"osv",
      "summary":"Cross-site scripting in bootstrap-select bootstrap-select before 1.13.6 allows Cross-Site Scripting (XSS). It does not escape title values in OPTION elements. This may allow attackers to execute arbitrary JavaScript in a victim's browser.",
      "published_date":"2021-05-07",
      "chain_len":1,
      "project":"https:\/\/github.com\/snapappointments\/bootstrap-select",
      "commit_href":"https:\/\/github.com\/snapappointments\/bootstrap-select\/commit\/ab6e068748040cf3cda5859f6349b382402b8767",
      "commit_sha":"ab6e068748040cf3cda5859f6349b382402b8767",
      "patch":"SINGLE",
      "chain_ord":"['ab6e068748040cf3cda5859f6349b382402b8767']",
      "before_first_fix_commit":"{'bbd306de22fbcede9016cf7e335fd8ce34d6629d'}",
      "last_fix_commit":"ab6e068748040cf3cda5859f6349b382402b8767",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/07\/2019, 23:05:50",
      "message":"add sanitize option for data-content (#2199)",
      "author":"Casey Holzer",
      "comments":null,
      "stats":"{'additions': 167, 'deletions': 6, 'total': 173}",
      "files":"{'js\/bootstrap-select.js': {'additions': 167, 'deletions': 6, 'changes': 173, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snapappointments\/bootstrap-select\/raw\/ab6e068748040cf3cda5859f6349b382402b8767\/js%2Fbootstrap-select.js', 'patch': \"@@ -1,6 +1,128 @@\\n (function ($) {\\n   'use strict';\\n \\n+  var DISALLOWED_ATTRIBUTES = ['sanitize', 'whiteList', 'sanitizeFn'];\\n+\\n+  var uriAttrs = [\\n+    'background',\\n+    'cite',\\n+    'href',\\n+    'itemtype',\\n+    'longdesc',\\n+    'poster',\\n+    'src',\\n+    'xlink:href'\\n+  ];\\n+\\n+  var ARIA_ATTRIBUTE_PATTERN = \/^aria-[\\\\w-]*$\/i;\\n+\\n+  var DefaultWhitelist = {\\n+    \/\/ Global attributes allowed on any supplied element below.\\n+    '*': ['class', 'dir', 'id', 'lang', 'role', 'tabindex', 'style', ARIA_ATTRIBUTE_PATTERN],\\n+    a: ['target', 'href', 'title', 'rel'],\\n+    area: [],\\n+    b: [],\\n+    br: [],\\n+    col: [],\\n+    code: [],\\n+    div: [],\\n+    em: [],\\n+    hr: [],\\n+    h1: [],\\n+    h2: [],\\n+    h3: [],\\n+    h4: [],\\n+    h5: [],\\n+    h6: [],\\n+    i: [],\\n+    img: ['src', 'alt', 'title', 'width', 'height'],\\n+    li: [],\\n+    ol: [],\\n+    p: [],\\n+    pre: [],\\n+    s: [],\\n+    small: [],\\n+    span: [],\\n+    sub: [],\\n+    sup: [],\\n+    strong: [],\\n+    u: [],\\n+    ul: []\\n+  }\\n+\\n+  \/**\\n+   * A pattern that recognizes a commonly useful subset of URLs that are safe.\\n+   *\\n+   * Shoutout to Angular 7 https:\/\/github.com\/angular\/angular\/blob\/7.2.4\/packages\/core\/src\/sanitization\/url_sanitizer.ts\\n+   *\/\\n+  var SAFE_URL_PATTERN = \/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))\/gi;\\n+\\n+  \/**\\n+   * A pattern that matches safe data URLs. Only matches image, video and audio types.\\n+   *\\n+   * Shoutout to Angular 7 https:\/\/github.com\/angular\/angular\/blob\/7.2.4\/packages\/core\/src\/sanitization\/url_sanitizer.ts\\n+   *\/\\n+  var DATA_URL_PATTERN = \/^data:(?:image\\\\\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\\\\\/(?:mpeg|mp4|ogg|webm)|audio\\\\\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$\/i;\\n+\\n+  function allowedAttribute (attr, allowedAttributeList) {\\n+    var attrName = attr.nodeName.toLowerCase()\\n+\\n+    if ($.inArray(attrName, allowedAttributeList) !== -1) {\\n+      if ($.inArray(attrName, uriAttrs) !== -1) {\\n+        return Boolean(attr.nodeValue.match(SAFE_URL_PATTERN) || attr.nodeValue.match(DATA_URL_PATTERN))\\n+      }\\n+\\n+      return true\\n+    }\\n+\\n+    var regExp = $(allowedAttributeList).filter(function (index, value) {\\n+      return value instanceof RegExp\\n+    })\\n+\\n+    \/\/ Check if a regular expression validates the attribute.\\n+    for (var i = 0, l = regExp.length; i < l; i++) {\\n+      if (attrName.match(regExp[i])) {\\n+        return true\\n+      }\\n+    }\\n+\\n+    return false\\n+  }\\n+\\n+  function sanitizeHtml (unsafeElements, whiteList, sanitizeFn) {\\n+    if (sanitizeFn && typeof sanitizeFn === 'function') {\\n+      return sanitizeFn(unsafeElements);\\n+    }\\n+\\n+    var whitelistKeys = Object.keys(whiteList);\\n+\\n+    for (var i = 0, len = unsafeElements.length; i < len; i++) {\\n+      var elements = unsafeElements[i].querySelectorAll('*');\\n+\\n+      for (var j = 0, len2 = elements.length; j < len2; j++) {\\n+        var el = elements[j];\\n+        var elName = el.nodeName.toLowerCase();\\n+\\n+        if (whitelistKeys.indexOf(elName) === -1) {\\n+          el.parentNode.removeChild(el);\\n+\\n+          continue;\\n+        }\\n+\\n+        var attributeList = [].slice.call(el.attributes);\\n+        var whitelistedAttributes = [].concat(whiteList['*'] || [], whiteList[elName] || []);\\n+\\n+        for (var k = 0, len3 = attributeList.length; k < len3; k++) {\\n+          var attr = attributeList[k];\\n+\\n+          if (!allowedAttribute(attr, whitelistedAttributes)) {\\n+            el.removeAttribute(attr.nodeName);\\n+          }\\n+        }\\n+      }\\n+    }\\n+  }\\n+\\n   \/\/ Polyfill for browsers with no classList support\\n   \/\/ Remove in v2\\n   if (!('classList' in document.createElement('_'))) {\\n@@ -745,7 +867,10 @@\\n     dropdownAlignRight: false,\\n     windowPadding: 0,\\n     virtualScroll: 600,\\n-    display: false\\n+    display: false,\\n+    sanitize: true,\\n+    sanitizeFn: null,\\n+    whiteList: DefaultWhitelist\\n   };\\n \\n   if (version.major === '4') {\\n@@ -1100,13 +1225,35 @@\\n                 emptyMenu = menuInner.firstChild.cloneNode(false),\\n                 marginTop,\\n                 marginBottom,\\n-                elements = isVirtual === true ? that.selectpicker.view.visibleElements : that.selectpicker.current.elements;\\n+                elements = isVirtual === true ? that.selectpicker.view.visibleElements : that.selectpicker.current.elements,\\n+                toSanitize = [];\\n \\n             \/\/ replace the existing UL with an empty one - this is faster than $.empty()\\n             menuInner.replaceChild(emptyMenu, menuInner.firstChild);\\n \\n             for (var i = 0, visibleElementsLen = elements.length; i < visibleElementsLen; i++) {\\n-              menuFragment.appendChild(elements[i]);\\n+              var element = elements[i],\\n+                  elText,\\n+                  elementData;\\n+\\n+              if (that.options.sanitize) {\\n+                elText = element.lastChild;\\n+\\n+                if (elText) {\\n+                  elementData = that.selectpicker.current.data[i + that.selectpicker.view.position0].data;\\n+\\n+                  if (elementData && elementData.content && !elementData.sanitized) {\\n+                    toSanitize.push(elText);\\n+                    elementData.sanitized = true;\\n+                  }\\n+                }\\n+              }\\n+\\n+              menuFragment.appendChild(element);\\n+            }\\n+\\n+            if (that.options.sanitize && toSanitize.length) {\\n+              sanitizeHtml(toSanitize, that.options.whiteList, that.options.sanitizeFn);\\n             }\\n \\n             if (isVirtual === true) {\\n@@ -1469,7 +1616,8 @@\\n           multipleSeparator = document.createTextNode(this.options.multipleSeparator),\\n           titleFragment = elementTemplates.fragment.cloneNode(false),\\n           showCount,\\n-          countMax;\\n+          countMax,\\n+          hasContent = false;\\n \\n       this.togglePlaceholder();\\n \\n@@ -1506,6 +1654,7 @@\\n                 titleOptions.text = option.title;\\n               } else if (thisData.content && that.options.showContent) {\\n                 titleOptions.optionContent = thisData.content.toString();\\n+                hasContent = true;\\n               } else {\\n                 if (that.options.showIcon) {\\n                   titleOptions.optionIcon = thisData.icon;\\n@@ -1554,6 +1703,10 @@\\n       \/\/ strip all HTML tags and trim the result, then unescape any escaped tags\\n       this.$button[0].title = titleFragment.textContent.replace(\/<[^>]*>?\/g, '').trim();\\n \\n+      if (this.options.sanitize && hasContent) {\\n+        sanitizeHtml([titleFragment], that.options.whiteList, that.options.sanitizeFn);\\n+      }\\n+\\n       buttonInner.innerHTML = '';\\n       buttonInner.appendChild(titleFragment);\\n \\n@@ -2833,8 +2986,16 @@\\n             options = typeof _option == 'object' && _option;\\n \\n         if (!data) {\\n-          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);\\n-          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), $this.data().template, options.template);\\n+          var dataAttributes = $this.data();\\n+\\n+          for (var dataAttr in dataAttributes) {\\n+            if (dataAttributes.hasOwnProperty(dataAttr) && $.inArray(dataAttr, DISALLOWED_ATTRIBUTES) !== -1) {\\n+              delete dataAttributes[dataAttr];\\n+            }\\n+          }\\n+\\n+          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, dataAttributes, options);\\n+          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), dataAttributes.template, options.template);\\n           $this.data('selectpicker', (data = new Selectpicker(this, config)));\\n         } else if (options) {\\n           for (var i in options) {\"}}",
      "message_norm":"add sanitize option for data-content (#2199)",
      "language":"it",
      "entities":"[('add', 'ACTION', ''), ('sanitize', 'SECWORD', ''), ('#2199', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['js\/bootstrap-select.js'])",
      "num_files":1.0,
      "patch_content":"From ab6e068748040cf3cda5859f6349b382402b8767 Mon Sep 17 00:00:00 2001\nFrom: Casey Holzer <caseyh@snapappointments.com>\nDate: Thu, 7 Mar 2019 16:05:50 -0700\nSubject: [PATCH] add sanitize option for data-content (#2199)\n\n---\n js\/bootstrap-select.js | 173 +++++++++++++++++++++++++++++++++++++++--\n 1 file changed, 167 insertions(+), 6 deletions(-)\n\ndiff --git a\/js\/bootstrap-select.js b\/js\/bootstrap-select.js\nindex 78d09f4ab..aca9fc454 100644\n--- a\/js\/bootstrap-select.js\n+++ b\/js\/bootstrap-select.js\n@@ -1,6 +1,128 @@\n (function ($) {\n   'use strict';\n \n+  var DISALLOWED_ATTRIBUTES = ['sanitize', 'whiteList', 'sanitizeFn'];\n+\n+  var uriAttrs = [\n+    'background',\n+    'cite',\n+    'href',\n+    'itemtype',\n+    'longdesc',\n+    'poster',\n+    'src',\n+    'xlink:href'\n+  ];\n+\n+  var ARIA_ATTRIBUTE_PATTERN = \/^aria-[\\w-]*$\/i;\n+\n+  var DefaultWhitelist = {\n+    \/\/ Global attributes allowed on any supplied element below.\n+    '*': ['class', 'dir', 'id', 'lang', 'role', 'tabindex', 'style', ARIA_ATTRIBUTE_PATTERN],\n+    a: ['target', 'href', 'title', 'rel'],\n+    area: [],\n+    b: [],\n+    br: [],\n+    col: [],\n+    code: [],\n+    div: [],\n+    em: [],\n+    hr: [],\n+    h1: [],\n+    h2: [],\n+    h3: [],\n+    h4: [],\n+    h5: [],\n+    h6: [],\n+    i: [],\n+    img: ['src', 'alt', 'title', 'width', 'height'],\n+    li: [],\n+    ol: [],\n+    p: [],\n+    pre: [],\n+    s: [],\n+    small: [],\n+    span: [],\n+    sub: [],\n+    sup: [],\n+    strong: [],\n+    u: [],\n+    ul: []\n+  }\n+\n+  \/**\n+   * A pattern that recognizes a commonly useful subset of URLs that are safe.\n+   *\n+   * Shoutout to Angular 7 https:\/\/github.com\/angular\/angular\/blob\/7.2.4\/packages\/core\/src\/sanitization\/url_sanitizer.ts\n+   *\/\n+  var SAFE_URL_PATTERN = \/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))\/gi;\n+\n+  \/**\n+   * A pattern that matches safe data URLs. Only matches image, video and audio types.\n+   *\n+   * Shoutout to Angular 7 https:\/\/github.com\/angular\/angular\/blob\/7.2.4\/packages\/core\/src\/sanitization\/url_sanitizer.ts\n+   *\/\n+  var DATA_URL_PATTERN = \/^data:(?:image\\\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\\\/(?:mpeg|mp4|ogg|webm)|audio\\\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$\/i;\n+\n+  function allowedAttribute (attr, allowedAttributeList) {\n+    var attrName = attr.nodeName.toLowerCase()\n+\n+    if ($.inArray(attrName, allowedAttributeList) !== -1) {\n+      if ($.inArray(attrName, uriAttrs) !== -1) {\n+        return Boolean(attr.nodeValue.match(SAFE_URL_PATTERN) || attr.nodeValue.match(DATA_URL_PATTERN))\n+      }\n+\n+      return true\n+    }\n+\n+    var regExp = $(allowedAttributeList).filter(function (index, value) {\n+      return value instanceof RegExp\n+    })\n+\n+    \/\/ Check if a regular expression validates the attribute.\n+    for (var i = 0, l = regExp.length; i < l; i++) {\n+      if (attrName.match(regExp[i])) {\n+        return true\n+      }\n+    }\n+\n+    return false\n+  }\n+\n+  function sanitizeHtml (unsafeElements, whiteList, sanitizeFn) {\n+    if (sanitizeFn && typeof sanitizeFn === 'function') {\n+      return sanitizeFn(unsafeElements);\n+    }\n+\n+    var whitelistKeys = Object.keys(whiteList);\n+\n+    for (var i = 0, len = unsafeElements.length; i < len; i++) {\n+      var elements = unsafeElements[i].querySelectorAll('*');\n+\n+      for (var j = 0, len2 = elements.length; j < len2; j++) {\n+        var el = elements[j];\n+        var elName = el.nodeName.toLowerCase();\n+\n+        if (whitelistKeys.indexOf(elName) === -1) {\n+          el.parentNode.removeChild(el);\n+\n+          continue;\n+        }\n+\n+        var attributeList = [].slice.call(el.attributes);\n+        var whitelistedAttributes = [].concat(whiteList['*'] || [], whiteList[elName] || []);\n+\n+        for (var k = 0, len3 = attributeList.length; k < len3; k++) {\n+          var attr = attributeList[k];\n+\n+          if (!allowedAttribute(attr, whitelistedAttributes)) {\n+            el.removeAttribute(attr.nodeName);\n+          }\n+        }\n+      }\n+    }\n+  }\n+\n   \/\/ Polyfill for browsers with no classList support\n   \/\/ Remove in v2\n   if (!('classList' in document.createElement('_'))) {\n@@ -745,7 +867,10 @@\n     dropdownAlignRight: false,\n     windowPadding: 0,\n     virtualScroll: 600,\n-    display: false\n+    display: false,\n+    sanitize: true,\n+    sanitizeFn: null,\n+    whiteList: DefaultWhitelist\n   };\n \n   if (version.major === '4') {\n@@ -1100,13 +1225,35 @@\n                 emptyMenu = menuInner.firstChild.cloneNode(false),\n                 marginTop,\n                 marginBottom,\n-                elements = isVirtual === true ? that.selectpicker.view.visibleElements : that.selectpicker.current.elements;\n+                elements = isVirtual === true ? that.selectpicker.view.visibleElements : that.selectpicker.current.elements,\n+                toSanitize = [];\n \n             \/\/ replace the existing UL with an empty one - this is faster than $.empty()\n             menuInner.replaceChild(emptyMenu, menuInner.firstChild);\n \n             for (var i = 0, visibleElementsLen = elements.length; i < visibleElementsLen; i++) {\n-              menuFragment.appendChild(elements[i]);\n+              var element = elements[i],\n+                  elText,\n+                  elementData;\n+\n+              if (that.options.sanitize) {\n+                elText = element.lastChild;\n+\n+                if (elText) {\n+                  elementData = that.selectpicker.current.data[i + that.selectpicker.view.position0].data;\n+\n+                  if (elementData && elementData.content && !elementData.sanitized) {\n+                    toSanitize.push(elText);\n+                    elementData.sanitized = true;\n+                  }\n+                }\n+              }\n+\n+              menuFragment.appendChild(element);\n+            }\n+\n+            if (that.options.sanitize && toSanitize.length) {\n+              sanitizeHtml(toSanitize, that.options.whiteList, that.options.sanitizeFn);\n             }\n \n             if (isVirtual === true) {\n@@ -1469,7 +1616,8 @@\n           multipleSeparator = document.createTextNode(this.options.multipleSeparator),\n           titleFragment = elementTemplates.fragment.cloneNode(false),\n           showCount,\n-          countMax;\n+          countMax,\n+          hasContent = false;\n \n       this.togglePlaceholder();\n \n@@ -1506,6 +1654,7 @@\n                 titleOptions.text = option.title;\n               } else if (thisData.content && that.options.showContent) {\n                 titleOptions.optionContent = thisData.content.toString();\n+                hasContent = true;\n               } else {\n                 if (that.options.showIcon) {\n                   titleOptions.optionIcon = thisData.icon;\n@@ -1554,6 +1703,10 @@\n       \/\/ strip all HTML tags and trim the result, then unescape any escaped tags\n       this.$button[0].title = titleFragment.textContent.replace(\/<[^>]*>?\/g, '').trim();\n \n+      if (this.options.sanitize && hasContent) {\n+        sanitizeHtml([titleFragment], that.options.whiteList, that.options.sanitizeFn);\n+      }\n+\n       buttonInner.innerHTML = '';\n       buttonInner.appendChild(titleFragment);\n \n@@ -2833,8 +2986,16 @@\n             options = typeof _option == 'object' && _option;\n \n         if (!data) {\n-          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);\n-          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), $this.data().template, options.template);\n+          var dataAttributes = $this.data();\n+\n+          for (var dataAttr in dataAttributes) {\n+            if (dataAttributes.hasOwnProperty(dataAttr) && $.inArray(dataAttr, DISALLOWED_ATTRIBUTES) !== -1) {\n+              delete dataAttributes[dataAttr];\n+            }\n+          }\n+\n+          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, dataAttributes, options);\n+          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), dataAttributes.template, options.template);\n           $this.data('selectpicker', (data = new Selectpicker(this, config)));\n         } else if (options) {\n           for (var i in options) {",
      "code_diff":"@@ -1,6 +1,128 @@\n (function ($) {\n   'use strict';\n \n+  var DISALLOWED_ATTRIBUTES = ['sanitize', 'whiteList', 'sanitizeFn'];\n+\n+  var uriAttrs = [\n+    'background',\n+    'cite',\n+    'href',\n+    'itemtype',\n+    'longdesc',\n+    'poster',\n+    'src',\n+    'xlink:href'\n+  ];\n+\n+  var ARIA_ATTRIBUTE_PATTERN = \/^aria-[\\w-]*$\/i;\n+\n+  var DefaultWhitelist = {\n+    \/\/ Global attributes allowed on any supplied element below.\n+    '*': ['class', 'dir', 'id', 'lang', 'role', 'tabindex', 'style', ARIA_ATTRIBUTE_PATTERN],\n+    a: ['target', 'href', 'title', 'rel'],\n+    area: [],\n+    b: [],\n+    br: [],\n+    col: [],\n+    code: [],\n+    div: [],\n+    em: [],\n+    hr: [],\n+    h1: [],\n+    h2: [],\n+    h3: [],\n+    h4: [],\n+    h5: [],\n+    h6: [],\n+    i: [],\n+    img: ['src', 'alt', 'title', 'width', 'height'],\n+    li: [],\n+    ol: [],\n+    p: [],\n+    pre: [],\n+    s: [],\n+    small: [],\n+    span: [],\n+    sub: [],\n+    sup: [],\n+    strong: [],\n+    u: [],\n+    ul: []\n+  }\n+\n+  \/**\n+   * A pattern that recognizes a commonly useful subset of URLs that are safe.\n+   *\n+   * Shoutout to Angular 7 https:\/\/github.com\/angular\/angular\/blob\/7.2.4\/packages\/core\/src\/sanitization\/url_sanitizer.ts\n+   *\/\n+  var SAFE_URL_PATTERN = \/^(?:(?:https?|mailto|ftp|tel|file):|[^&:\/?#]*(?:[\/?#]|$))\/gi;\n+\n+  \/**\n+   * A pattern that matches safe data URLs. Only matches image, video and audio types.\n+   *\n+   * Shoutout to Angular 7 https:\/\/github.com\/angular\/angular\/blob\/7.2.4\/packages\/core\/src\/sanitization\/url_sanitizer.ts\n+   *\/\n+  var DATA_URL_PATTERN = \/^data:(?:image\\\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\\\/(?:mpeg|mp4|ogg|webm)|audio\\\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$\/i;\n+\n+  function allowedAttribute (attr, allowedAttributeList) {\n+    var attrName = attr.nodeName.toLowerCase()\n+\n+    if ($.inArray(attrName, allowedAttributeList) !== -1) {\n+      if ($.inArray(attrName, uriAttrs) !== -1) {\n+        return Boolean(attr.nodeValue.match(SAFE_URL_PATTERN) || attr.nodeValue.match(DATA_URL_PATTERN))\n+      }\n+\n+      return true\n+    }\n+\n+    var regExp = $(allowedAttributeList).filter(function (index, value) {\n+      return value instanceof RegExp\n+    })\n+\n+    \/\/ Check if a regular expression validates the attribute.\n+    for (var i = 0, l = regExp.length; i < l; i++) {\n+      if (attrName.match(regExp[i])) {\n+        return true\n+      }\n+    }\n+\n+    return false\n+  }\n+\n+  function sanitizeHtml (unsafeElements, whiteList, sanitizeFn) {\n+    if (sanitizeFn && typeof sanitizeFn === 'function') {\n+      return sanitizeFn(unsafeElements);\n+    }\n+\n+    var whitelistKeys = Object.keys(whiteList);\n+\n+    for (var i = 0, len = unsafeElements.length; i < len; i++) {\n+      var elements = unsafeElements[i].querySelectorAll('*');\n+\n+      for (var j = 0, len2 = elements.length; j < len2; j++) {\n+        var el = elements[j];\n+        var elName = el.nodeName.toLowerCase();\n+\n+        if (whitelistKeys.indexOf(elName) === -1) {\n+          el.parentNode.removeChild(el);\n+\n+          continue;\n+        }\n+\n+        var attributeList = [].slice.call(el.attributes);\n+        var whitelistedAttributes = [].concat(whiteList['*'] || [], whiteList[elName] || []);\n+\n+        for (var k = 0, len3 = attributeList.length; k < len3; k++) {\n+          var attr = attributeList[k];\n+\n+          if (!allowedAttribute(attr, whitelistedAttributes)) {\n+            el.removeAttribute(attr.nodeName);\n+          }\n+        }\n+      }\n+    }\n+  }\n+\n   \/\/ Polyfill for browsers with no classList support\n   \/\/ Remove in v2\n   if (!('classList' in document.createElement('_'))) {\n@@ -745,7 +867,10 @@\n     dropdownAlignRight: false,\n     windowPadding: 0,\n     virtualScroll: 600,\n-    display: false\n+    display: false,\n+    sanitize: true,\n+    sanitizeFn: null,\n+    whiteList: DefaultWhitelist\n   };\n \n   if (version.major === '4') {\n@@ -1100,13 +1225,35 @@\n                 emptyMenu = menuInner.firstChild.cloneNode(false),\n                 marginTop,\n                 marginBottom,\n-                elements = isVirtual === true ? that.selectpicker.view.visibleElements : that.selectpicker.current.elements;\n+                elements = isVirtual === true ? that.selectpicker.view.visibleElements : that.selectpicker.current.elements,\n+                toSanitize = [];\n \n             \/\/ replace the existing UL with an empty one - this is faster than $.empty()\n             menuInner.replaceChild(emptyMenu, menuInner.firstChild);\n \n             for (var i = 0, visibleElementsLen = elements.length; i < visibleElementsLen; i++) {\n-              menuFragment.appendChild(elements[i]);\n+              var element = elements[i],\n+                  elText,\n+                  elementData;\n+\n+              if (that.options.sanitize) {\n+                elText = element.lastChild;\n+\n+                if (elText) {\n+                  elementData = that.selectpicker.current.data[i + that.selectpicker.view.position0].data;\n+\n+                  if (elementData && elementData.content && !elementData.sanitized) {\n+                    toSanitize.push(elText);\n+                    elementData.sanitized = true;\n+                  }\n+                }\n+              }\n+\n+              menuFragment.appendChild(element);\n+            }\n+\n+            if (that.options.sanitize && toSanitize.length) {\n+              sanitizeHtml(toSanitize, that.options.whiteList, that.options.sanitizeFn);\n             }\n \n             if (isVirtual === true) {\n@@ -1469,7 +1616,8 @@\n           multipleSeparator = document.createTextNode(this.options.multipleSeparator),\n           titleFragment = elementTemplates.fragment.cloneNode(false),\n           showCount,\n-          countMax;\n+          countMax,\n+          hasContent = false;\n \n       this.togglePlaceholder();\n \n@@ -1506,6 +1654,7 @@\n                 titleOptions.text = option.title;\n               } else if (thisData.content && that.options.showContent) {\n                 titleOptions.optionContent = thisData.content.toString();\n+                hasContent = true;\n               } else {\n                 if (that.options.showIcon) {\n                   titleOptions.optionIcon = thisData.icon;\n@@ -1554,6 +1703,10 @@\n       \/\/ strip all HTML tags and trim the result, then unescape any escaped tags\n       this.$button[0].title = titleFragment.textContent.replace(\/<[^>]*>?\/g, '').trim();\n \n+      if (this.options.sanitize && hasContent) {\n+        sanitizeHtml([titleFragment], that.options.whiteList, that.options.sanitizeFn);\n+      }\n+\n       buttonInner.innerHTML = '';\n       buttonInner.appendChild(titleFragment);\n \n@@ -2833,8 +2986,16 @@\n             options = typeof _option == 'object' && _option;\n \n         if (!data) {\n-          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, $this.data(), options);\n-          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), $this.data().template, options.template);\n+          var dataAttributes = $this.data();\n+\n+          for (var dataAttr in dataAttributes) {\n+            if (dataAttributes.hasOwnProperty(dataAttr) && $.inArray(dataAttr, DISALLOWED_ATTRIBUTES) !== -1) {\n+              delete dataAttributes[dataAttr];\n+            }\n+          }\n+\n+          var config = $.extend({}, Selectpicker.DEFAULTS, $.fn.selectpicker.defaults || {}, dataAttributes, options);\n+          config.template = $.extend({}, Selectpicker.DEFAULTS.template, ($.fn.selectpicker.defaults ? $.fn.selectpicker.defaults.template : {}), dataAttributes.template, options.template);\n           $this.data('selectpicker', (data = new Selectpicker(this, config)));\n         } else if (options) {\n           for (var i in options) {"
    },
    {
      "index":37,
      "vuln_id":"GHSA-x7r7-wmj8-vv5g",
      "cwe_id":"{'CWE-79'}",
      "score":7.5,
      "chain":"{'https:\/\/github.com\/octoprint\/octoprint\/commit\/8087528e4a7ddd15c7d95ff662deb5ef7de90045'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in OctoPrint Cross-site Scripting (XSS) - DOM in GitHub repository octoprint\/octoprint prior to 1.8.0. The login endpoint allows for javascript injection which may lead to account takeover in a phishing scenario.",
      "published_date":"2022-05-19",
      "chain_len":1,
      "project":"https:\/\/github.com\/octoprint\/octoprint",
      "commit_href":"https:\/\/github.com\/octoprint\/octoprint\/commit\/8087528e4a7ddd15c7d95ff662deb5ef7de90045",
      "commit_sha":"8087528e4a7ddd15c7d95ff662deb5ef7de90045",
      "patch":"SINGLE",
      "chain_ord":"['8087528e4a7ddd15c7d95ff662deb5ef7de90045']",
      "before_first_fix_commit":"{'700034d028ff3518b563a7b4ba4dacc920142d07'}",
      "last_fix_commit":"8087528e4a7ddd15c7d95ff662deb5ef7de90045",
      "chain_ord_pos":1.0,
      "commit_datetime":"05\/11\/2022, 11:02:52",
      "message":"\ud83d\udd12\ufe0f Sanitize and validate login redirect\n\nFixes an XSS and an open redirect issue.",
      "author":"Gina H\u00e4u\u00dfge",
      "comments":null,
      "stats":"{'additions': 11, 'deletions': 1, 'total': 12}",
      "files":"{'src\/octoprint\/server\/views.py': {'additions': 11, 'deletions': 1, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/OctoPrint\/OctoPrint\/raw\/8087528e4a7ddd15c7d95ff662deb5ef7de90045\/src%2Foctoprint%2Fserver%2Fviews.py', 'patch': '@@ -8,6 +8,7 @@\\n import os\\n import re\\n from collections import defaultdict\\n+from urllib.parse import urlparse\\n \\n from flask import (\\n     Response,\\n@@ -170,7 +171,16 @@ def _add_additional_assets(hook):\\n def login():\\n     from flask_login import current_user\\n \\n-    redirect_url = request.args.get(\"redirect\", request.script_root + url_for(\"index\"))\\n+    default_redirect_url = request.script_root + url_for(\"index\")\\n+    redirect_url = request.args.get(\"redirect\", default_redirect_url)\\n+\\n+    parsed = urlparse(redirect_url)  # check if redirect url is valid\\n+    if parsed.scheme != \"\" or parsed.netloc != \"\":\\n+        _logger.warning(\\n+            f\"Got an invalid redirect URL with the login attempt, misconfiguration or attack attempt: {redirect_url}\"\\n+        )\\n+        redirect_url = default_redirect_url\\n+\\n     permissions = sorted(\\n         filter(\\n             lambda x: x is not None and isinstance(x, OctoPrintPermission),'}}",
      "message_norm":"\ud83d\udd12\ufe0f sanitize and validate login redirect\n\nfixes an xss and an open redirect issue.",
      "language":"en",
      "entities":"[('sanitize', 'SECWORD', ''), ('validate', 'ACTION', ''), ('login', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('xss', 'SECWORD', ''), ('open redirect', 'SECWORD', ''), ('issue', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/octoprint\/server\/views.py'])",
      "num_files":1.0,
      "patch_content":"From 8087528e4a7ddd15c7d95ff662deb5ef7de90045 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Gina=20H=C3=A4u=C3=9Fge?= <gina@octoprint.org>\nDate: Wed, 11 May 2022 13:02:52 +0200\nSubject: [PATCH] =?UTF-8?q?=F0=9F=94=92=EF=B8=8F=20Sanitize=20and=20valida?=\n =?UTF-8?q?te=20login=20redirect?=\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\nFixes an XSS and an open redirect issue.\n---\n src\/octoprint\/server\/views.py | 12 +++++++++++-\n 1 file changed, 11 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/octoprint\/server\/views.py b\/src\/octoprint\/server\/views.py\nindex 235e15f011..d1db66b267 100644\n--- a\/src\/octoprint\/server\/views.py\n+++ b\/src\/octoprint\/server\/views.py\n@@ -8,6 +8,7 @@\n import os\n import re\n from collections import defaultdict\n+from urllib.parse import urlparse\n \n from flask import (\n     Response,\n@@ -170,7 +171,16 @@ def _add_additional_assets(hook):\n def login():\n     from flask_login import current_user\n \n-    redirect_url = request.args.get(\"redirect\", request.script_root + url_for(\"index\"))\n+    default_redirect_url = request.script_root + url_for(\"index\")\n+    redirect_url = request.args.get(\"redirect\", default_redirect_url)\n+\n+    parsed = urlparse(redirect_url)  # check if redirect url is valid\n+    if parsed.scheme != \"\" or parsed.netloc != \"\":\n+        _logger.warning(\n+            f\"Got an invalid redirect URL with the login attempt, misconfiguration or attack attempt: {redirect_url}\"\n+        )\n+        redirect_url = default_redirect_url\n+\n     permissions = sorted(\n         filter(\n             lambda x: x is not None and isinstance(x, OctoPrintPermission),",
      "code_diff":"@@ -8,6 +8,7 @@\n import os\n import re\n from collections import defaultdict\n+from urllib.parse import urlparse\n \n from flask import (\n     Response,\n@@ -170,7 +171,16 @@ def _add_additional_assets(hook):\n def login():\n     from flask_login import current_user\n \n-    redirect_url = request.args.get(\"redirect\", request.script_root + url_for(\"index\"))\n+    default_redirect_url = request.script_root + url_for(\"index\")\n+    redirect_url = request.args.get(\"redirect\", default_redirect_url)\n+\n+    parsed = urlparse(redirect_url)  # check if redirect url is valid\n+    if parsed.scheme != \"\" or parsed.netloc != \"\":\n+        _logger.warning(\n+            f\"Got an invalid redirect URL with the login attempt, misconfiguration or attack attempt: {redirect_url}\"\n+        )\n+        redirect_url = default_redirect_url\n+\n     permissions = sorted(\n         filter(\n             lambda x: x is not None and isinstance(x, OctoPrintPermission),"
    },
    {
      "index":38,
      "vuln_id":"GHSA-2cqg-q7jm-j35c",
      "cwe_id":"{'CWE-79'}",
      "score":3.9,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/9ed1442bd124710f4178992cc4eca5236c7396b9'}",
      "dataset":"osv",
      "summary":"snipe-it is vulnerable to Cross-site Scripting snipe-it is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').",
      "published_date":"2021-11-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/9ed1442bd124710f4178992cc4eca5236c7396b9",
      "commit_sha":"9ed1442bd124710f4178992cc4eca5236c7396b9",
      "patch":"SINGLE",
      "chain_ord":"['9ed1442bd124710f4178992cc4eca5236c7396b9']",
      "before_first_fix_commit":"{'edf98cb7951a922cdef7505e1efd115f92d1afd9', '3ea209a507fbcc992e0a9152e2074709e8459b47'}",
      "last_fix_commit":"9ed1442bd124710f4178992cc4eca5236c7396b9",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/09\/2021, 04:32:02",
      "message":"Merge pull request #10286 from uberbrady\/fix_bulk_audit_xss\n\nEscape asset_tag attribute at controller level for bulk checkout",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/Http\/Controllers\/Api\/AssetsController.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/9ed1442bd124710f4178992cc4eca5236c7396b9\/app%2FHttp%2FControllers%2FApi%2FAssetsController.php', 'patch': \"@@ -910,7 +910,7 @@ public function audit(Request $request) {\\n             }\\n         }\\n \\n-        return response()->json(Helper::formatStandardApiResponse('error', ['asset_tag'=> e($request->input('asset_tag'))], 'Asset with tag '.$request->input('asset_tag').' not found'));\\n+        return response()->json(Helper::formatStandardApiResponse('error', ['asset_tag'=> e($request->input('asset_tag'))], 'Asset with tag '.e($request->input('asset_tag')).' not found'));\"}}",
      "message_norm":"merge pull request #10286 from uberbrady\/fix_bulk_audit_xss\n\nescape asset_tag attribute at controller level for bulk checkout",
      "language":"en",
      "entities":"[('#10286', 'ISSUE', ''), ('fix_bulk_audit_xss', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Controllers\/Api\/AssetsController.php'])",
      "num_files":1.0,
      "patch_content":"From 3ea209a507fbcc992e0a9152e2074709e8459b47 Mon Sep 17 00:00:00 2001\nFrom: Brady Wetherington <bwetherington@grokability.com>\nDate: Mon, 8 Nov 2021 20:27:43 -0800\nSubject: [PATCH] Escape asset_tag attribute at controller level for\n consumption in bulk checkout\n\n---\n app\/Http\/Controllers\/Api\/AssetsController.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/Http\/Controllers\/Api\/AssetsController.php b\/app\/Http\/Controllers\/Api\/AssetsController.php\nindex db1b1404ecd0..a9362188c186 100644\n--- a\/app\/Http\/Controllers\/Api\/AssetsController.php\n+++ b\/app\/Http\/Controllers\/Api\/AssetsController.php\n@@ -910,7 +910,7 @@ public function audit(Request $request) {\n             }\n         }\n \n-        return response()->json(Helper::formatStandardApiResponse('error', ['asset_tag'=> e($request->input('asset_tag'))], 'Asset with tag '.$request->input('asset_tag').' not found'));\n+        return response()->json(Helper::formatStandardApiResponse('error', ['asset_tag'=> e($request->input('asset_tag'))], 'Asset with tag '.e($request->input('asset_tag')).' not found'));",
      "code_diff":"@@ -910,7 +910,7 @@ public function audit(Request $request) {\n             }\n         }\n \n-        return response()->json(Helper::formatStandardApiResponse('error', ['asset_tag'=> e($request->input('asset_tag'))], 'Asset with tag '.$request->input('asset_tag').' not found'));\n+        return response()->json(Helper::formatStandardApiResponse('error', ['asset_tag'=> e($request->input('asset_tag'))], 'Asset with tag '.e($request->input('asset_tag')).' not found'));"
    },
    {
      "index":39,
      "vuln_id":"GHSA-mg5h-9rhq-4cqx",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/42c0d9813df3035728b36116a6ce9116e6fa8ed3'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc is vulnerable to stored cross-site scripting through file upload in versions 2.10.3 and prior. A patch is available and anticipated to be part of version 2.10.4.",
      "published_date":"2022-03-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/42c0d9813df3035728b36116a6ce9116e6fa8ed3",
      "commit_sha":"42c0d9813df3035728b36116a6ce9116e6fa8ed3",
      "patch":"SINGLE",
      "chain_ord":"['42c0d9813df3035728b36116a6ce9116e6fa8ed3']",
      "before_first_fix_commit":"{'818d7fe731f452acccacf731ce47ec27ad68049c'}",
      "last_fix_commit":"42c0d9813df3035728b36116a6ce9116e6fa8ed3",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/13\/2022, 02:27:22",
      "message":"file upload bug",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/42c0d9813df3035728b36116a6ce9116e6fa8ed3\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -300,6 +300,7 @@ public function isDangerFilename($filename){\\n \\t\\t\\t $isDangerStr($filename , \".php\")\\n \\t\\t\\t|| $isDangerStr($filename , \".svg\")\\n \\t\\t\\t|| $isDangerStr($filename , \".htm\")\\n+\\t\\t\\t|| $isDangerStr($filename , \".shtm\")\\n \\t\\t\\t|| $isDangerStr($filename , \"%\")\\n \\t\\t\\t|| $isDangerStr($filename , \".xml\")\\n \\t\\t) {'}}",
      "message_norm":"file upload bug",
      "language":"ro",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 42c0d9813df3035728b36116a6ce9116e6fa8ed3 Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Sun, 13 Mar 2022 10:27:22 +0800\nSubject: [PATCH] file upload bug\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex d84898984..32fb24799 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -300,6 +300,7 @@ public function isDangerFilename($filename){\n \t\t\t $isDangerStr($filename , \".php\")\n \t\t\t|| $isDangerStr($filename , \".svg\")\n \t\t\t|| $isDangerStr($filename , \".htm\")\n+\t\t\t|| $isDangerStr($filename , \".shtm\")\n \t\t\t|| $isDangerStr($filename , \"%\")\n \t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t) {",
      "code_diff":"@@ -300,6 +300,7 @@ public function isDangerFilename($filename){\n \t\t\t $isDangerStr($filename , \".php\")\n \t\t\t|| $isDangerStr($filename , \".svg\")\n \t\t\t|| $isDangerStr($filename , \".htm\")\n+\t\t\t|| $isDangerStr($filename , \".shtm\")\n \t\t\t|| $isDangerStr($filename , \"%\")\n \t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t) {"
    },
    {
      "index":40,
      "vuln_id":"GHSA-x92h-wmg2-6hp7",
      "cwe_id":"{'CWE-89', 'CWE-79'}",
      "score":9.8,
      "chain":"{'https:\/\/github.com\/symfony\/symfony\/commit\/944e60f083c3bffbc6a0b5112db127a10a66a8ec'}",
      "dataset":"osv",
      "summary":"Invalid HTTP method overrides allow possible XSS or other attacks in Symfony In Symfony before 2.7.51, 2.8.x before 2.8.50, 3.x before 3.4.26, 4.x before 4.1.12, and 4.2.x before 4.2.7, HTTP Methods provided as verbs or using the override header may be treated as trusted input, but they are not validated, possibly causing SQL injection or XSS. This is related to symfony\/http-foundation.",
      "published_date":"2019-12-02",
      "chain_len":1,
      "project":"https:\/\/github.com\/symfony\/symfony",
      "commit_href":"https:\/\/github.com\/symfony\/symfony\/commit\/944e60f083c3bffbc6a0b5112db127a10a66a8ec",
      "commit_sha":"944e60f083c3bffbc6a0b5112db127a10a66a8ec",
      "patch":"SINGLE",
      "chain_ord":"['944e60f083c3bffbc6a0b5112db127a10a66a8ec']",
      "before_first_fix_commit":"{'b7bdf2ce435b0aeb8edb8349f0456f7ca3d21035'}",
      "last_fix_commit":"944e60f083c3bffbc6a0b5112db127a10a66a8ec",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/02\/2019, 16:28:16",
      "message":"[HttpFoundation] reject invalid method override",
      "author":"Nicolas Grekas",
      "comments":"{'com_1': {'author': 'jirayutza1', 'datetime': '12\/04\/2019, 20:11:46', 'body': '944e60f'}}",
      "stats":"{'additions': 29, 'deletions': 14, 'total': 43}",
      "files":"{'src\/Symfony\/Component\/HttpFoundation\/Request.php': {'additions': 29, 'deletions': 14, 'changes': 43, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/symfony\/symfony\/raw\/944e60f083c3bffbc6a0b5112db127a10a66a8ec\/src%2FSymfony%2FComponent%2FHttpFoundation%2FRequest.php', 'patch': '@@ -1346,22 +1346,37 @@ public function setMethod($method)\\n      *\/\\n     public function getMethod()\\n     {\\n-        if (null === $this->method) {\\n-            $this->method = strtoupper($this->server->get(\\'REQUEST_METHOD\\', \\'GET\\'));\\n-\\n-            if (\\'POST\\' === $this->method) {\\n-                if ($method = $this->headers->get(\\'X-HTTP-METHOD-OVERRIDE\\')) {\\n-                    $this->method = strtoupper($method);\\n-                } elseif (self::$httpMethodParameterOverride) {\\n-                    $method = $this->request->get(\\'_method\\', $this->query->get(\\'_method\\', \\'POST\\'));\\n-                    if (\\\\is_string($method)) {\\n-                        $this->method = strtoupper($method);\\n-                    }\\n-                }\\n-            }\\n+        if (null !== $this->method) {\\n+            return $this->method;\\n+        }\\n+\\n+        $this->method = strtoupper($this->server->get(\\'REQUEST_METHOD\\', \\'GET\\'));\\n+\\n+        if (\\'POST\\' !== $this->method) {\\n+            return $this->method;\\n+        }\\n+\\n+        $method = $this->headers->get(\\'X-HTTP-METHOD-OVERRIDE\\');\\n+\\n+        if (!$method && self::$httpMethodParameterOverride) {\\n+            $method = $this->request->get(\\'_method\\', $this->query->get(\\'_method\\', \\'POST\\'));\\n+        }\\n+\\n+        if (!\\\\is_string($method)) {\\n+            return $this->method;\\n+        }\\n+\\n+        $method = strtoupper($method);\\n+\\n+        if (\\\\in_array($method, [\\'GET\\', \\'HEAD\\', \\'POST\\', \\'PUT\\', \\'DELETE\\', \\'CONNECT\\', \\'OPTIONS\\', \\'PATCH\\', \\'PURGE\\', \\'TRACE\\'], true)) {\\n+            return $this->method = $method;\\n+        }\\n+\\n+        if (!preg_match(\\'\/^[A-Z]++$\/D\\', $method)) {\\n+            throw new SuspiciousOperationException(sprintf(\\'Invalid method override \"%s\".\\', $method));\\n         }\\n \\n-        return $this->method;\\n+        return $this->method = $method;\\n     }\\n \\n     \/**'}}",
      "message_norm":"[httpfoundation] reject invalid method override",
      "language":"en",
      "entities":null,
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/Symfony\/Component\/HttpFoundation\/Request.php'])",
      "num_files":1.0,
      "patch_content":"From 944e60f083c3bffbc6a0b5112db127a10a66a8ec Mon Sep 17 00:00:00 2001\nFrom: Nicolas Grekas <nicolas.grekas@gmail.com>\nDate: Tue, 2 Apr 2019 18:28:16 +0200\nSubject: [PATCH] [HttpFoundation] reject invalid method override\n\n---\n ...\/Component\/HttpFoundation\/Request.php      | 43 +++++++++++++------\n 1 file changed, 29 insertions(+), 14 deletions(-)\n\ndiff --git a\/src\/Symfony\/Component\/HttpFoundation\/Request.php b\/src\/Symfony\/Component\/HttpFoundation\/Request.php\nindex fe1a33a597a3e..ae3f51b1724fc 100644\n--- a\/src\/Symfony\/Component\/HttpFoundation\/Request.php\n+++ b\/src\/Symfony\/Component\/HttpFoundation\/Request.php\n@@ -1346,22 +1346,37 @@ public function setMethod($method)\n      *\/\n     public function getMethod()\n     {\n-        if (null === $this->method) {\n-            $this->method = strtoupper($this->server->get('REQUEST_METHOD', 'GET'));\n-\n-            if ('POST' === $this->method) {\n-                if ($method = $this->headers->get('X-HTTP-METHOD-OVERRIDE')) {\n-                    $this->method = strtoupper($method);\n-                } elseif (self::$httpMethodParameterOverride) {\n-                    $method = $this->request->get('_method', $this->query->get('_method', 'POST'));\n-                    if (\\is_string($method)) {\n-                        $this->method = strtoupper($method);\n-                    }\n-                }\n-            }\n+        if (null !== $this->method) {\n+            return $this->method;\n+        }\n+\n+        $this->method = strtoupper($this->server->get('REQUEST_METHOD', 'GET'));\n+\n+        if ('POST' !== $this->method) {\n+            return $this->method;\n+        }\n+\n+        $method = $this->headers->get('X-HTTP-METHOD-OVERRIDE');\n+\n+        if (!$method && self::$httpMethodParameterOverride) {\n+            $method = $this->request->get('_method', $this->query->get('_method', 'POST'));\n+        }\n+\n+        if (!\\is_string($method)) {\n+            return $this->method;\n+        }\n+\n+        $method = strtoupper($method);\n+\n+        if (\\in_array($method, ['GET', 'HEAD', 'POST', 'PUT', 'DELETE', 'CONNECT', 'OPTIONS', 'PATCH', 'PURGE', 'TRACE'], true)) {\n+            return $this->method = $method;\n+        }\n+\n+        if (!preg_match('\/^[A-Z]++$\/D', $method)) {\n+            throw new SuspiciousOperationException(sprintf('Invalid method override \"%s\".', $method));\n         }\n \n-        return $this->method;\n+        return $this->method = $method;\n     }\n \n     \/**",
      "code_diff":"@@ -1346,22 +1346,37 @@ public function setMethod($method)\n      *\/\n     public function getMethod()\n     {\n-        if (null === $this->method) {\n-            $this->method = strtoupper($this->server->get('REQUEST_METHOD', 'GET'));\n-\n-            if ('POST' === $this->method) {\n-                if ($method = $this->headers->get('X-HTTP-METHOD-OVERRIDE')) {\n-                    $this->method = strtoupper($method);\n-                } elseif (self::$httpMethodParameterOverride) {\n-                    $method = $this->request->get('_method', $this->query->get('_method', 'POST'));\n-                    if (\\is_string($method)) {\n-                        $this->method = strtoupper($method);\n-                    }\n-                }\n-            }\n+        if (null !== $this->method) {\n+            return $this->method;\n+        }\n+\n+        $this->method = strtoupper($this->server->get('REQUEST_METHOD', 'GET'));\n+\n+        if ('POST' !== $this->method) {\n+            return $this->method;\n+        }\n+\n+        $method = $this->headers->get('X-HTTP-METHOD-OVERRIDE');\n+\n+        if (!$method && self::$httpMethodParameterOverride) {\n+            $method = $this->request->get('_method', $this->query->get('_method', 'POST'));\n+        }\n+\n+        if (!\\is_string($method)) {\n+            return $this->method;\n+        }\n+\n+        $method = strtoupper($method);\n+\n+        if (\\in_array($method, ['GET', 'HEAD', 'POST', 'PUT', 'DELETE', 'CONNECT', 'OPTIONS', 'PATCH', 'PURGE', 'TRACE'], true)) {\n+            return $this->method = $method;\n+        }\n+\n+        if (!preg_match('\/^[A-Z]++$\/D', $method)) {\n+            throw new SuspiciousOperationException(sprintf('Invalid method override \"%s\".', $method));\n         }\n \n-        return $this->method;\n+        return $this->method = $method;\n     }\n \n     \/**"
    },
    {
      "index":41,
      "vuln_id":"GHSA-54qq-9chj-rxhv",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/livehelperchat\/livehelperchat\/commit\/8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in LiveHelperChat LiveHelperChat prior to version 3.93 contains a cross-site scripting vulnerability.",
      "published_date":"2022-01-29",
      "chain_len":1,
      "project":"https:\/\/github.com\/livehelperchat\/livehelperchat",
      "commit_href":"https:\/\/github.com\/livehelperchat\/livehelperchat\/commit\/8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb",
      "commit_sha":"8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb",
      "patch":"SINGLE",
      "chain_ord":"['8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb']",
      "before_first_fix_commit":"{'d7b85466c217b3750eaccc8703ce54ba8785c4d3'}",
      "last_fix_commit":"8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/27\/2022, 20:08:18",
      "message":"Escape in user box",
      "author":"Remigijus Kiminas",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'lhc_web\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/LiveHelperChat\/livehelperchat\/raw\/8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb\/lhc_web%2Fdesign%2Fdefaulttheme%2Ftpl%2Fpagelayouts%2Fparts%2Fuser_box.tpl.php', 'patch': '@@ -12,7 +12,7 @@\\n \\n ?>\\n <li class=\"nav-item dropleft\">\\n-    <a href=\"#\" class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\"><?php echo htmlspecialchars($UserData->name),\\' \\',htmlspecialchars($UserData->surname)?><\/a>\\n+    <a href=\"#\" class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\" ng-non-bindable><?php echo htmlspecialchars($UserData->name),\\' \\',htmlspecialchars($UserData->surname)?><\/a>\\n     <div class=\"dropdown-menu\" style=\"min-width: 25rem;\" role=\"menu\">\\n \\n         <div class=\"row\">'}}",
      "message_norm":"escape in user box",
      "language":"en",
      "entities":"[('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['lhc_web\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php'])",
      "num_files":1.0,
      "patch_content":"From 8fdb4f67ac1a095331aa0fb4630ef9dfe8e75dcb Mon Sep 17 00:00:00 2001\nFrom: Remigijus Kiminas <remdex@gmail.com>\nDate: Thu, 27 Jan 2022 15:08:18 -0500\nSubject: [PATCH] Escape in user box\n\n---\n ...\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php  | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lhc_web\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php b\/lhc_web\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php\nindex 9e5ea86a27..2c1b42a521 100644\n--- a\/lhc_web\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php\n+++ b\/lhc_web\/design\/defaulttheme\/tpl\/pagelayouts\/parts\/user_box.tpl.php\n@@ -12,7 +12,7 @@\n \n ?>\n <li class=\"nav-item dropleft\">\n-    <a href=\"#\" class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\"><?php echo htmlspecialchars($UserData->name),' ',htmlspecialchars($UserData->surname)?><\/a>\n+    <a href=\"#\" class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\" ng-non-bindable><?php echo htmlspecialchars($UserData->name),' ',htmlspecialchars($UserData->surname)?><\/a>\n     <div class=\"dropdown-menu\" style=\"min-width: 25rem;\" role=\"menu\">\n \n         <div class=\"row\">",
      "code_diff":"@@ -12,7 +12,7 @@\n \n ?>\n <li class=\"nav-item dropleft\">\n-    <a href=\"#\" class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\"><?php echo htmlspecialchars($UserData->name),' ',htmlspecialchars($UserData->surname)?><\/a>\n+    <a href=\"#\" class=\"nav-link dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\" ng-non-bindable><?php echo htmlspecialchars($UserData->name),' ',htmlspecialchars($UserData->surname)?><\/a>\n     <div class=\"dropdown-menu\" style=\"min-width: 25rem;\" role=\"menu\">\n \n         <div class=\"row\">"
    },
    {
      "index":42,
      "vuln_id":"GHSA-mrvj-7q4f-5p42",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/ezsystems\/ezpublish-kernel\/commit\/29fecd2afe86f763510f10c02f14962d028f311b'}",
      "dataset":"osv",
      "summary":"Cross-site scripting in eZ Platform Kernel ### Impact\nIn file upload it is possible by certain means to upload files like .html and .js. These may contain XSS exploits which will be run when links to them are accessed by victims.\n\n### Patches\nThe fix consists simply of adding common types of scriptable file types to the configuration of the already existing filetype blacklist feature. See \"Patched versions\". As such, this can also be done manually, without installing the patched versions. This may be relevant if you are currently running a considerably older version of the kernel package and don't want to upgrade it at this time. Please see the settting \"ezsettings.default.io.file_storage.file_type_blacklist\" at:\nhttps:\/\/github.com\/ezsystems\/ezplatform-kernel\/blob\/master\/eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml#L109\n\n### Important note\nYou should adapt this setting to your needs. Do not add file types to the blacklist that you actually need to be able to upload. For instance, if you need your editors to be able to upload SVG files, then don't blacklist that. Instead, you could e.g. use an approval workflow for such content.",
      "published_date":"2021-03-19",
      "chain_len":1,
      "project":"https:\/\/github.com\/ezsystems\/ezpublish-kernel",
      "commit_href":"https:\/\/github.com\/ezsystems\/ezpublish-kernel\/commit\/29fecd2afe86f763510f10c02f14962d028f311b",
      "commit_sha":"29fecd2afe86f763510f10c02f14962d028f311b",
      "patch":"SINGLE",
      "chain_ord":"['29fecd2afe86f763510f10c02f14962d028f311b']",
      "before_first_fix_commit":"{'4a538dbfd28fecd404f11fa0816b69a5a9e93a16'}",
      "last_fix_commit":"29fecd2afe86f763510f10c02f14962d028f311b",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/17\/2021, 15:03:30",
      "message":"Merge pull request from GHSA-mrvj-7q4f-5p42\n\nCo-authored-by: Gunnstein Lye <gunnstein.lye@ibexa.co>",
      "author":"Gunnstein Lye",
      "comments":null,
      "stats":"{'additions': 10, 'deletions': 0, 'total': 10}",
      "files":"{'eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml': {'additions': 10, 'deletions': 0, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ezsystems\/ezpublish-kernel\/raw\/29fecd2afe86f763510f10c02f14962d028f311b\/eZ%2FBundle%2FEzPublishCoreBundle%2FResources%2Fconfig%2Fdefault_settings.yml', 'patch': '@@ -89,6 +89,16 @@ parameters:\\n         - pht\\n         - phtml\\n         - pgif\\n+        - hta\\n+        - htm\\n+        - html\\n+        - xhtm\\n+        - xhtml\\n+        - jar\\n+        - js\\n+        - jse\\n+        - svg\\n+        - swf\\n \\n     # Content settings\\n     ezsettings.default.content.view_cache: true         # Whether to use content view cache or not (Etag\/Last-Modified based)'}}",
      "message_norm":"merge pull request from ghsa-mrvj-7q4f-5p42\n\nco-authored-by: gunnstein lye <gunnstein.lye@ibexa.co>",
      "language":"en",
      "entities":"[('ghsa-mrvj-7q4f-5p42', 'VULNID', 'GHSA'), ('gunnstein.lye@ibexa.co', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml'])",
      "num_files":1.0,
      "patch_content":"From 29fecd2afe86f763510f10c02f14962d028f311b Mon Sep 17 00:00:00 2001\nFrom: Gunnstein Lye <gunnstein.lye@ez.no>\nDate: Wed, 17 Mar 2021 16:03:30 +0100\nSubject: [PATCH] Merge pull request from GHSA-mrvj-7q4f-5p42\n\nCo-authored-by: Gunnstein Lye <gunnstein.lye@ibexa.co>\n---\n ...\/Resources\/config\/default_settings.yml              | 10 ++++++++++\n 1 file changed, 10 insertions(+)\n\ndiff --git a\/eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml b\/eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml\nindex 42e5c2ee251..bdd60ec7012 100644\n--- a\/eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml\n+++ b\/eZ\/Bundle\/EzPublishCoreBundle\/Resources\/config\/default_settings.yml\n@@ -89,6 +89,16 @@ parameters:\n         - pht\n         - phtml\n         - pgif\n+        - hta\n+        - htm\n+        - html\n+        - xhtm\n+        - xhtml\n+        - jar\n+        - js\n+        - jse\n+        - svg\n+        - swf\n \n     # Content settings\n     ezsettings.default.content.view_cache: true         # Whether to use content view cache or not (Etag\/Last-Modified based)",
      "code_diff":"@@ -89,6 +89,16 @@ parameters:\n         - pht\n         - phtml\n         - pgif\n+        - hta\n+        - htm\n+        - html\n+        - xhtm\n+        - xhtml\n+        - jar\n+        - js\n+        - jse\n+        - svg\n+        - swf\n \n     # Content settings\n     ezsettings.default.content.view_cache: true         # Whether to use content view cache or not (Etag\/Last-Modified based)"
    },
    {
      "index":43,
      "vuln_id":"GHSA-jq4v-f5q6-mjqq",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/lxml\/lxml\/pull\/316\/commits\/10ec1b4e9f93713513a3264ed6158af22492f270', 'https:\/\/github.com\/lxml\/lxml\/commit\/a5f9cb52079dc57477c460dbe6ba0f775e14a999', 'https:\/\/github.com\/lxml\/lxml\/commit\/2d01a1ba8984e0483ce6619b972832377f208a0d'}",
      "dataset":"osv",
      "summary":"lxml before 4.6.3 vulnerable to Cross-Site Scripting  An XSS vulnerability was discovered in the python `lxml` clean module versions before 4.6.3. When disabling `the safe_attrs_only` and `forms` arguments, the `Cleaner` class does not remove the `formaction` attribute allowing for JS to bypass the sanitizer. A remote attacker could exploit this flaw to run arbitrary JS code on users who interact with incorrectly sanitized HTML. This issue is patched in `lxml` 4.6.3.",
      "published_date":"2021-03-22",
      "chain_len":3,
      "project":"https:\/\/github.com\/lxml\/lxml",
      "commit_href":"https:\/\/github.com\/lxml\/lxml\/pull\/316\/commits\/10ec1b4e9f93713513a3264ed6158af22492f270",
      "commit_sha":"10ec1b4e9f93713513a3264ed6158af22492f270",
      "patch":"MULTI",
      "chain_ord":"['10ec1b4e9f93713513a3264ed6158af22492f270', '2d01a1ba8984e0483ce6619b972832377f208a0d', 'a5f9cb52079dc57477c460dbe6ba0f775e14a999']",
      "before_first_fix_commit":"{'2d01a1ba8984e0483ce6619b972832377f208a0d'}",
      "last_fix_commit":"a5f9cb52079dc57477c460dbe6ba0f775e14a999",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/20\/2021, 06:49:25",
      "message":"Add formaction attribute to defs.link_attrs",
      "author":"Kevin Chung",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
      "files":"{'src\/lxml\/html\/defs.py': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/lxml\/lxml\/raw\/10ec1b4e9f93713513a3264ed6158af22492f270\/src%2Flxml%2Fhtml%2Fdefs.py', 'patch': \"@@ -23,6 +23,8 @@\\n     'usemap',\\n     # Not standard:\\n     'dynsrc', 'lowsrc',\\n+    # HTML5 formaction\\n+    'formaction'\\n     ])\\n \\n # Not in the HTML 4 spec:\"}}",
      "message_norm":"add formaction attribute to defs.link_attrs",
      "language":"en",
      "entities":"[('add', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/lxml\/html\/defs.py'])",
      "num_files":1.0,
      "patch_content":"From 10ec1b4e9f93713513a3264ed6158af22492f270 Mon Sep 17 00:00:00 2001\nFrom: Kevin Chung <kchung@nyu.edu>\nDate: Sat, 20 Mar 2021 02:49:25 -0400\nSubject: [PATCH] Add formaction attribute to defs.link_attrs\n\n---\n src\/lxml\/html\/defs.py | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/src\/lxml\/html\/defs.py b\/src\/lxml\/html\/defs.py\nindex 1b3a75b36..2058ea330 100644\n--- a\/src\/lxml\/html\/defs.py\n+++ b\/src\/lxml\/html\/defs.py\n@@ -23,6 +23,8 @@\n     'usemap',\n     # Not standard:\n     'dynsrc', 'lowsrc',\n+    # HTML5 formaction\n+    'formaction'\n     ])\n \n # Not in the HTML 4 spec:",
      "code_diff":"@@ -23,6 +23,8 @@\n     'usemap',\n     # Not standard:\n     'dynsrc', 'lowsrc',\n+    # HTML5 formaction\n+    'formaction'\n     ])\n \n # Not in the HTML 4 spec:"
    },
    {
      "index":44,
      "vuln_id":"GHSA-8x44-pwr2-rgc6",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/832c34aeb9f21f213295a0c28377132df996352a'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in pimcore Pimcore settings module is vulnerable to stored cross site scripting",
      "published_date":"2022-01-28",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/832c34aeb9f21f213295a0c28377132df996352a",
      "commit_sha":"832c34aeb9f21f213295a0c28377132df996352a",
      "patch":"SINGLE",
      "chain_ord":"['832c34aeb9f21f213295a0c28377132df996352a']",
      "before_first_fix_commit":"{'e94591dd8f5006452667a04c93e4422b05234eea'}",
      "last_fix_commit":"832c34aeb9f21f213295a0c28377132df996352a",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/26\/2022, 13:08:27",
      "message":"added escape function to the icon field",
      "author":"Jia Jia Ji",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/832c34aeb9f21f213295a0c28377132df996352a\/bundles%2FAdminBundle%2FController%2FAdmin%2FDataObject%2FClassController.php', 'patch': \"@@ -119,7 +119,7 @@ public function getTreeAction(Request $request)\\n                 'id' => $class->getId(),\\n                 'text' => $text,\\n                 'leaf' => true,\\n-                'icon' => $class->getIcon() ? $class->getIcon() : $defaultIcon,\\n+                'icon' => $class->getIcon() ? htmlspecialchars($class->getIcon()) : $defaultIcon,\\n                 'cls' => 'pimcore_class_icon',\\n                 'propertyVisibility' => $class->getPropertyVisibility(),\\n                 'enableGridLocking' => $class->isEnableGridLocking(),\"}}",
      "message_norm":"added escape function to the icon field",
      "language":"en",
      "entities":"[('added', 'ACTION', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php'])",
      "num_files":1.0,
      "patch_content":"From 832c34aeb9f21f213295a0c28377132df996352a Mon Sep 17 00:00:00 2001\nFrom: Jia Jia Ji <kingjia90@gmail.com>\nDate: Wed, 26 Jan 2022 14:08:27 +0100\nSubject: [PATCH] added escape function to the icon field\n\n---\n ...\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php b\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php\nindex 84582a8c58f..93339ef2069 100644\n--- a\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php\n+++ b\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php\n@@ -119,7 +119,7 @@ public function getTreeAction(Request $request)\n                 'id' => $class->getId(),\n                 'text' => $text,\n                 'leaf' => true,\n-                'icon' => $class->getIcon() ? $class->getIcon() : $defaultIcon,\n+                'icon' => $class->getIcon() ? htmlspecialchars($class->getIcon()) : $defaultIcon,\n                 'cls' => 'pimcore_class_icon',\n                 'propertyVisibility' => $class->getPropertyVisibility(),\n                 'enableGridLocking' => $class->isEnableGridLocking(),",
      "code_diff":"@@ -119,7 +119,7 @@ public function getTreeAction(Request $request)\n                 'id' => $class->getId(),\n                 'text' => $text,\n                 'leaf' => true,\n-                'icon' => $class->getIcon() ? $class->getIcon() : $defaultIcon,\n+                'icon' => $class->getIcon() ? htmlspecialchars($class->getIcon()) : $defaultIcon,\n                 'cls' => 'pimcore_class_icon',\n                 'propertyVisibility' => $class->getPropertyVisibility(),\n                 'enableGridLocking' => $class->isEnableGridLocking(),"
    },
    {
      "index":45,
      "vuln_id":"GHSA-3j9m-hcv9-rpj8",
      "cwe_id":"{'CWE-79'}",
      "score":6.9,
      "chain":"{'https:\/\/github.com\/grafana\/grafana\/commit\/3cb5214fa45eb5a571fd70d6c6edf0d729983f82', 'https:\/\/github.com\/grafana\/grafana\/commit\/fb85ed691290d211a5baa44d9a641ab137f0de88', 'https:\/\/github.com\/grafana\/grafana\/commit\/31b78d51c693d828720a5b285107a50e6024c912'}",
      "dataset":"osv",
      "summary":"XSS vulnerability allowing arbitrary JavaScript execution Today we are releasing Grafana 8.2.3. This patch release includes an important security fix for an issue that affects all Grafana versions from 8.0.0-beta1.\n\n[Grafana Cloud](https:\/\/grafana.com\/cloud) instances have already been patched and an audit did not find any usage of this attack vector. [Grafana Enterprise](https:\/\/grafana.com\/products\/enterprise) customers were provided with updated binaries under embargo.\n\n## CVE-2021-41174 XSS vulnerability on unauthenticated pages\n\n### Summary\n\nCVSS Score: 6.9 Medium\nCVSS:[CVSS:3.0\/AV:N\/AC:H\/PR:N\/UI:R\/S:C\/C:L\/I:H\/A:N\/E:U\/RL:O\/RC:R\/CR:L\/MAV:N\/MAC:H\/MPR:N\/MUI:R\/MS:C\/MC:N\/MI:H\/MA:L](https:\/\/www.first.org\/cvss\/calculator\/3.0#CVSS:3.0\/AV:N\/AC:H\/PR:N\/UI:R\/S:C\/C:L\/I:H\/A:N\/E:U\/RL:O\/RC:R\/CR:L\/MAV:N\/MAC:H\/MPR:N\/MUI:R\/MS:C\/MC:N\/MI:H\/MA:L)\n\nWe received a security report to security@grafana.com on 2021-10-21 about a vulnerability in Grafana regarding the XSS vulnerability.\n\nIt was later identified as affecting Grafana versions from 8.0.0-beta1 to 8.2.2. [CVE-2021-41174](https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2021-41174) has been assigned to this vulnerability.\n\n### Impact\n\nIf an attacker is able to convince a victim to visit a URL referencing a vulnerable page, arbitrary JavaScript content may be executed within the context of the victim's browser.\n\nThe user visiting the malicious link must be unauthenticated and the link must be for a page that contains the login button in the menu bar.\n\nThere are two ways an unauthenticated user can open a page in Grafana that contains the login button:\n- Anonymous authentication is enabled. This means all pages in Grafana would be open for the attack.\n- The link is to an unauthenticated page. The following pages are vulnerable:\n  - `\/dashboard-solo\/snapshot\/*`\n  - `\/dashboard\/snapshot\/*`\n  - `\/invite\/:code`\n\nThe url has to be crafted to exploit AngularJS rendering and contain the interpolation binding for AngularJS expressions. AngularJS uses double curly braces for interpolation binding: {{ }} \n\nAn example of an expression would be: `{{constructor.constructor(\u2018alert(1)\u2019)()}}`. This can be included in the link URL like this: \n\nhttps:\/\/play.grafana.org\/dashboard\/snapshot\/%7B%7Bconstructor.constructor('alert(1)')()%7D%7D?orgId=1\n\nWhen the user follows the link and the page renders, the login button will contain the original link with a query parameter to force a redirect to the login page. The URL is not validated and the AngularJS rendering engine will execute the JavaScript expression contained in the URL.\n\n### Attack audit\n\nWe can not guarantee that the below will identify all attacks, so if you find something using the audit process described below, you should consider doing a full assessment.\n\n#### Through reverse proxy\/load balancer logs\n\nTo determine if your Grafana installation has been exploited for this vulnerability, search through your reverse proxy\/load balancer access logs for instances where the path contains `{{` followed by something that would invoke JavaScript code. For example, this could be code that attempts to show a fake login page or to steal browser or session data. The [OWASP cheat sheet](https:\/\/cheatsheetseries.owasp.org\/cheatsheets\/XSS_Filter_Evasion_Cheat_Sheet.html) has several examples of XSS attacks.\n\n#### Through the Grafana Enterprise audit feature\n\nIf you enabled \u201cLog web requests\u201d in your configuration with `router_logging = true`, look for requests where `path` contains `{{` followed by something that would invoke JavaScript code.\n\n### Patched versions\n\nRelease 8.2.3:\n\n- [Download Grafana 8.2.3](https:\/\/grafana.com\/grafana\/download\/8.2.3)\n- [Release notes](https:\/\/grafana.com\/docs\/grafana\/latest\/release-notes\/release-notes-8-2-3\/)\n\n### Solutions and mitigations\n\nDownload and install the appropriate patch for your version of Grafana.\n\n[Grafana Cloud](https:\/\/grafana.com\/cloud) instances have already been patched, and [Grafana Enterprise](https:\/\/grafana.com\/products\/enterprise) customers were provided with updated binaries under embargo.\n\n### Workaround\n\nIf for some reason you cannot upgrade, you can use a reverse proxy or similar to block access to block the literal string `{{` in the path.\n\nExample of an Nginx rule to block the literal string `{{`:\n\n```\nlocation ~ \\{\\{ {\n    deny all;\n}\n```\n### Timeline and postmortem\n\nHere is a detailed timeline starting from when we originally learned of the issue. All times in UTC. \n\n* 2021-10-21 23:13: Security researcher sends the initial report about an XSS vulnerability.\n* 2021-10-21 23:13: Confirmed to be reproducible in at least versions 8.0.5 and 8.2.2.\n* 2021-10-22 02:02 MEDIUM severity declared.\n* 2021-10-22 09:22: it is discovered that Grafana instances with anonymous auth turned on are vulnerable. This includes https:\/\/play.grafana.org\/ .\n* 2021-10-22 09:50: Anonymous access disabled for all instances on Grafana Cloud as a mitigation measure.\n* 2021-10-22 11:15: Workaround deployed on Grafana Cloud that blocks malicious requests.\n* 2021-10-22 12:35: Enabled anonymous access for instances on Grafana Cloud. \n* 2021-10-22 12:51: All instances protected by the workaround. From this point forward, Grafana Cloud is no longer affected.\n* 2021-10-22 14:05 Grafana Cloud instances updated with a fix.\n* 2021-10-22 19:23 :Determination that no weekend work is needed as the issue is of MEDIUM severity and the root cause has been identified.\n* 2021-10-25 14:13: Audit of Grafana Cloud concluded, no evidence of exploitation.\n* 2021-10-27 12:00: Grafana Enterprise images released to customers under embargo.\n* 2021-11-03 12:00: Public release.\n\n## Reporting security issues\n\nIf you think you have found a security vulnerability, please send a report to [security@grafana.com](mailto:security@grafana.com). This address can be used for all of\nGrafana Labs' open source and commercial products (including but not limited to Grafana, Tempo, Loki, k6, Tanka, and  Grafana Cloud, Grafana Enterprise, and grafana.com). We only accept vulnerability reports at this address. We would prefer that you encrypt your message to us using our PGP key. The key fingerprint is:\n\nF988 7BEA 027A 049F AE8E  5CAA D125 8932 BE24 C5CA\n\nThe key is available from [ keyserver.ubuntu.com]( https:\/\/keyserver.ubuntu.com\/pks\/lookup?op=get&fingerprint=on&search=0xD1258932BE24C5CA) by searching for [security@grafana]( https:\/\/keyserver.ubuntu.com\/pks\/lookup?search=security@grafana&fingerprint=on&op=index).\n\n## Security announcements\n\nThere is a Security [category](https:\/\/grafana.com\/tags\/security\/) on the Grafana blog where we will post a summary, remediation, and mitigation details for any patch containing security fixes and you can subscribe to updates from our [Security Announcements RSS feed](https:\/\/grafana.com\/tags\/security\/index.xml).",
      "published_date":"2021-11-08",
      "chain_len":3,
      "project":"https:\/\/github.com\/grafana\/grafana",
      "commit_href":"https:\/\/github.com\/grafana\/grafana\/commit\/fb85ed691290d211a5baa44d9a641ab137f0de88",
      "commit_sha":"fb85ed691290d211a5baa44d9a641ab137f0de88",
      "patch":"MULTI",
      "chain_ord":"['31b78d51c693d828720a5b285107a50e6024c912', '3cb5214fa45eb5a571fd70d6c6edf0d729983f82', 'fb85ed691290d211a5baa44d9a641ab137f0de88']",
      "before_first_fix_commit":"{'3cb5214fa45eb5a571fd70d6c6edf0d729983f82', 'a3dc30546fce2e437d858c140f1ff307a04365d6'}",
      "last_fix_commit":"fb85ed691290d211a5baa44d9a641ab137f0de88",
      "chain_ord_pos":3.0,
      "commit_datetime":"10\/25\/2021, 07:45:05",
      "message":"Merge pull request #147 from grafana\/axelav\/sanitized-nav-links-8-2-3\n\nSanitized NavBar children links to remove angular interpolation v8.2.3",
      "author":"Oscar Kilhed",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 3, 'total': 8}",
      "files":"{'public\/app\/core\/components\/NavBar\/DropdownChild.tsx': {'additions': 5, 'deletions': 3, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/grafana\/grafana\/raw\/fb85ed691290d211a5baa44d9a641ab137f0de88\/public%2Fapp%2Fcore%2Fcomponents%2FNavBar%2FDropdownChild.tsx', 'patch': '@@ -1,6 +1,6 @@\\n import React from \\'react\\';\\n import { css } from \\'@emotion\/css\\';\\n-import { GrafanaTheme2 } from \\'@grafana\/data\\';\\n+import { GrafanaTheme2, textUtil } from \\'@grafana\/data\\';\\n import { Icon, IconName, Link, useTheme2 } from \\'@grafana\/ui\\';\\n \\n export interface Props {\\n@@ -29,13 +29,15 @@ const DropdownChild = ({ isDivider = false, icon, onClick, target, text, url }:\\n     <\/button>\\n   );\\n   if (url) {\\n+    const sanitizedUrl = textUtil.sanitizeAngularInterpolation(url);\\n+\\n     element =\\n       !target && url.startsWith(\\'\/\\') ? (\\n-        <Link className={styles.element} onClick={onClick} href={url}>\\n+        <Link className={styles.element} onClick={onClick} href={sanitizedUrl}>\\n           {linkContent}\\n         <\/Link>\\n       ) : (\\n-        <a className={styles.element} href={url} target={target} rel=\"noopener\" onClick={onClick}>\\n+        <a className={styles.element} href={sanitizedUrl} target={target} rel=\"noopener\" onClick={onClick}>\\n           {linkContent}\\n         <\/a>\\n       );'}}",
      "message_norm":"merge pull request #147 from grafana\/axelav\/sanitized-nav-links-8-2-3\n\nsanitized navbar children links to remove angular interpolation v8.2.3",
      "language":"en",
      "entities":"[('#147', 'ISSUE', ''), ('sanitized', 'SECWORD', ''), ('sanitized', 'SECWORD', ''), ('remove', 'ACTION', ''), ('v8.2.3', 'VERSION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['public\/app\/core\/components\/NavBar\/DropdownChild.tsx'])",
      "num_files":1.0,
      "patch_content":"From a3dc30546fce2e437d858c140f1ff307a04365d6 Mon Sep 17 00:00:00 2001\nFrom: Alexandra Vargas <alexa1866@gmail.com>\nDate: Fri, 22 Oct 2021 17:40:31 +0200\nSubject: [PATCH] NavBar: Add sanitize to children items\n\n---\n public\/app\/core\/components\/NavBar\/DropdownChild.tsx | 8 +++++---\n 1 file changed, 5 insertions(+), 3 deletions(-)\n\ndiff --git a\/public\/app\/core\/components\/NavBar\/DropdownChild.tsx b\/public\/app\/core\/components\/NavBar\/DropdownChild.tsx\nindex 6badadb67d7e..22c2516a9b1b 100644\n--- a\/public\/app\/core\/components\/NavBar\/DropdownChild.tsx\n+++ b\/public\/app\/core\/components\/NavBar\/DropdownChild.tsx\n@@ -1,6 +1,6 @@\n import React from 'react';\n import { css } from '@emotion\/css';\n-import { GrafanaTheme2 } from '@grafana\/data';\n+import { GrafanaTheme2, textUtil } from '@grafana\/data';\n import { Icon, IconName, Link, useTheme2 } from '@grafana\/ui';\n \n export interface Props {\n@@ -29,13 +29,15 @@ const DropdownChild = ({ isDivider = false, icon, onClick, target, text, url }:\n     <\/button>\n   );\n   if (url) {\n+    const sanitizedUrl = textUtil.sanitizeAngularInterpolation(url);\n+\n     element =\n       !target && url.startsWith('\/') ? (\n-        <Link className={styles.element} onClick={onClick} href={url}>\n+        <Link className={styles.element} onClick={onClick} href={sanitizedUrl}>\n           {linkContent}\n         <\/Link>\n       ) : (\n-        <a className={styles.element} href={url} target={target} rel=\"noopener\" onClick={onClick}>\n+        <a className={styles.element} href={sanitizedUrl} target={target} rel=\"noopener\" onClick={onClick}>\n           {linkContent}\n         <\/a>\n       );",
      "code_diff":"@@ -1,6 +1,6 @@\n import React from 'react';\n import { css } from '@emotion\/css';\n-import { GrafanaTheme2 } from '@grafana\/data';\n+import { GrafanaTheme2, textUtil } from '@grafana\/data';\n import { Icon, IconName, Link, useTheme2 } from '@grafana\/ui';\n \n export interface Props {\n@@ -29,13 +29,15 @@ const DropdownChild = ({ isDivider = false, icon, onClick, target, text, url }:\n     <\/button>\n   );\n   if (url) {\n+    const sanitizedUrl = textUtil.sanitizeAngularInterpolation(url);\n+\n     element =\n       !target && url.startsWith('\/') ? (\n-        <Link className={styles.element} onClick={onClick} href={url}>\n+        <Link className={styles.element} onClick={onClick} href={sanitizedUrl}>\n           {linkContent}\n         <\/Link>\n       ) : (\n-        <a className={styles.element} href={url} target={target} rel=\"noopener\" onClick={onClick}>\n+        <a className={styles.element} href={sanitizedUrl} target={target} rel=\"noopener\" onClick={onClick}>\n           {linkContent}\n         <\/a>\n       );"
    },
    {
      "index":46,
      "vuln_id":"GHSA-wg4r-q74r-p7c8",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/4b6e6603c714aab1de346c5f5cb0bbb4c871be1f'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc is vulnerable to stored cross-site scripting due to unrestricted file upload in versions 2.10.3 and prior. A patch is available and anticipated to be part of version 2.10.4.",
      "published_date":"2022-03-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/4b6e6603c714aab1de346c5f5cb0bbb4c871be1f",
      "commit_sha":"4b6e6603c714aab1de346c5f5cb0bbb4c871be1f",
      "patch":"SINGLE",
      "chain_ord":"['4b6e6603c714aab1de346c5f5cb0bbb4c871be1f']",
      "before_first_fix_commit":"{'d4363f73fb50193c9701982b59642696edf834a1', '61a23da1925119454d8477e9cf884b6cba93364c'}",
      "last_fix_commit":"4b6e6603c714aab1de346c5f5cb0bbb4c871be1f",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/13\/2022, 12:16:25",
      "message":"Merge pull request #1630 from ajaysenr\/master\n\nUpdate AttachmentModel.class.php",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/4b6e6603c714aab1de346c5f5cb0bbb4c871be1f\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -305,6 +305,7 @@ public function isDangerFilename($filename){\\n \\t\\t\\t|| $isDangerStr($filename , \".xml\")\\n \\t\\t\\t|| $isDangerStr($filename , \".xxhtml\")\\n \\t\\t\\t|| $isDangerStr($filename , \".asp\")\\t\\t\\t\\n+\\t\\t\\t|| $isDangerStr($filename , \".xsl\")\\n \\t\\t) {\\n \\t\\t\\treturn true;\\n \\t\\t}'}}",
      "message_norm":"merge pull request #1630 from ajaysenr\/master\n\nupdate attachmentmodel.class.php",
      "language":"en",
      "entities":"[('#1630', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 61a23da1925119454d8477e9cf884b6cba93364c Mon Sep 17 00:00:00 2001\nFrom: Ajaysen R <40132420+ajaysenr@users.noreply.github.com>\nDate: Sun, 13 Mar 2022 12:01:44 +0000\nSubject: [PATCH] Update AttachmentModel.class.php\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 8a17a6c3c..3f33fde76 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -305,6 +305,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t\t|| $isDangerStr($filename , \".xxhtml\")\n \t\t\t|| $isDangerStr($filename , \".asp\")\t\t\t\n+\t\t\t|| $isDangerStr($filename , \".xsl\")\n \t\t) {\n \t\t\treturn true;\n \t\t}",
      "code_diff":"@@ -305,6 +305,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t\t|| $isDangerStr($filename , \".xxhtml\")\n \t\t\t|| $isDangerStr($filename , \".asp\")\t\t\t\n+\t\t\t|| $isDangerStr($filename , \".xsl\")\n \t\t) {\n \t\t\treturn true;\n \t\t}"
    },
    {
      "index":47,
      "vuln_id":"GHSA-4p92-fv6v-fhfj",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/15e519a86e4b24526abaf9e6dc81cb1af86843a5'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber Microweber prior to 1.2.11 is vulnerable to reflected cross-site scripting.",
      "published_date":"2022-02-27",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/15e519a86e4b24526abaf9e6dc81cb1af86843a5",
      "commit_sha":"15e519a86e4b24526abaf9e6dc81cb1af86843a5",
      "patch":"SINGLE",
      "chain_ord":"['15e519a86e4b24526abaf9e6dc81cb1af86843a5']",
      "before_first_fix_commit":"{'c897d0dc159849763a813184d9b75b966c6360bf'}",
      "last_fix_commit":"15e519a86e4b24526abaf9e6dc81cb1af86843a5",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/25\/2022, 10:57:48",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 0, 'deletions': 0, 'total': 0}",
      "files":"{'.github\/workflows\/templates.yml': {'additions': 0, 'deletions': 0, 'changes': 0, 'status': 'renamed', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/15e519a86e4b24526abaf9e6dc81cb1af86843a5\/.github%2Fworkflows%2Ftemplates.yml', 'patch': None}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['.github\/workflows\/templates.yml'])",
      "num_files":1.0,
      "patch_content":"From 15e519a86e4b24526abaf9e6dc81cb1af86843a5 Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Fri, 25 Feb 2022 12:57:48 +0200\nSubject: [PATCH] update\n\n---\n .github\/workflows\/{templates.yml.backup => templates.yml} | 0\n 1 file changed, 0 insertions(+), 0 deletions(-)\n rename .github\/workflows\/{templates.yml.backup => templates.yml} (100%)\n\ndiff --git a\/.github\/workflows\/templates.yml.backup b\/.github\/workflows\/templates.yml\nsimilarity index 100%\nrename from .github\/workflows\/templates.yml.backup\nrename to .github\/workflows\/templates.yml",
      "code_diff":"similarity index 100%\nrename from .github\/workflows\/templates.yml.backup\nrename to .github\/workflows\/templates.yml"
    },
    {
      "index":48,
      "vuln_id":"GHSA-mq35-wqvf-r23c",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/sinatra\/sinatra\/commit\/12786867d6faaceaec62c7c2cb5b0e2dc074d71a'}",
      "dataset":"osv",
      "summary":"Sinatra has XSS via 400 Bad Request page via params parser exception Sinatra before 2.0.2 has XSS via the 400 Bad Request page that occurs upon a params parser exception.",
      "published_date":"2018-06-05",
      "chain_len":1,
      "project":"https:\/\/github.com\/sinatra\/sinatra",
      "commit_href":"https:\/\/github.com\/sinatra\/sinatra\/commit\/12786867d6faaceaec62c7c2cb5b0e2dc074d71a",
      "commit_sha":"12786867d6faaceaec62c7c2cb5b0e2dc074d71a",
      "patch":"SINGLE",
      "chain_ord":"['12786867d6faaceaec62c7c2cb5b0e2dc074d71a']",
      "before_first_fix_commit":"{'5149dc9e0b0e281231b91223c6a414c905ad3a96'}",
      "last_fix_commit":"12786867d6faaceaec62c7c2cb5b0e2dc074d71a",
      "chain_ord_pos":1.0,
      "commit_datetime":"05\/30\/2018, 16:05:27",
      "message":"escape invalid query params, fixes #1428",
      "author":"Kunpei Sakai",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'lib\/sinatra\/base.rb': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/sinatra\/sinatra\/raw\/12786867d6faaceaec62c7c2cb5b0e2dc074d71a\/lib%2Fsinatra%2Fbase.rb', 'patch': '@@ -78,7 +78,7 @@ def unlink?\\n     def params\\n       super\\n     rescue Rack::Utils::ParameterTypeError, Rack::Utils::InvalidParameterError => e\\n-      raise BadRequest, \"Invalid query parameters: #{e.message}\"\\n+      raise BadRequest, \"Invalid query parameters: #{Rack::Utils.escape_html(e.message)}\"\\n     end\\n \\n     private'}}",
      "message_norm":"escape invalid query params, fixes #1428",
      "language":"ca",
      "entities":"[('escape', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('#1428', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['lib\/sinatra\/base.rb'])",
      "num_files":1.0,
      "patch_content":"From 12786867d6faaceaec62c7c2cb5b0e2dc074d71a Mon Sep 17 00:00:00 2001\nFrom: Kunpei Sakai <namusyaka@gmail.com>\nDate: Thu, 31 May 2018 01:05:27 +0900\nSubject: [PATCH] escape invalid query params, fixes #1428\n\n---\n lib\/sinatra\/base.rb | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lib\/sinatra\/base.rb b\/lib\/sinatra\/base.rb\nindex 6843b4d375..727078d815 100644\n--- a\/lib\/sinatra\/base.rb\n+++ b\/lib\/sinatra\/base.rb\n@@ -78,7 +78,7 @@ def unlink?\n     def params\n       super\n     rescue Rack::Utils::ParameterTypeError, Rack::Utils::InvalidParameterError => e\n-      raise BadRequest, \"Invalid query parameters: #{e.message}\"\n+      raise BadRequest, \"Invalid query parameters: #{Rack::Utils.escape_html(e.message)}\"\n     end\n \n     private",
      "code_diff":"@@ -78,7 +78,7 @@ def unlink?\n     def params\n       super\n     rescue Rack::Utils::ParameterTypeError, Rack::Utils::InvalidParameterError => e\n-      raise BadRequest, \"Invalid query parameters: #{e.message}\"\n+      raise BadRequest, \"Invalid query parameters: #{Rack::Utils.escape_html(e.message)}\"\n     end\n \n     private"
    },
    {
      "index":49,
      "vuln_id":"GHSA-p885-prv3-m4xv",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/f211c11034baf4281aa62e7b5e0347248d995ee9'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in snipe-it Stored Cross Site Scripting vulnerability in Item name parameter in GitHub repository snipe\/snipe-it prior to v5.4.3. The vulnerability is capable of stolen the user Cookie.",
      "published_date":"2022-04-17",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/f211c11034baf4281aa62e7b5e0347248d995ee9",
      "commit_sha":"f211c11034baf4281aa62e7b5e0347248d995ee9",
      "patch":"SINGLE",
      "chain_ord":"['f211c11034baf4281aa62e7b5e0347248d995ee9']",
      "before_first_fix_commit":"{'698c7f4904f8fd843c5b9761053c9c68819ec288', '7479f5f12d73f73d9bc8c479651e0e5602ad1791'}",
      "last_fix_commit":"f211c11034baf4281aa62e7b5e0347248d995ee9",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/15\/2022, 11:25:56",
      "message":"Merge pull request #10942 from snipe\/fixes\/xss_user_requested\n\nFixes potential XSS vuln in user requestable results",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 5, 'total': 10}",
      "files":"{'app\/Http\/Controllers\/Api\/ProfileController.php': {'additions': 5, 'deletions': 5, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/f211c11034baf4281aa62e7b5e0347248d995ee9\/app%2FHttp%2FControllers%2FApi%2FProfileController.php', 'patch': \"@@ -30,11 +30,11 @@ public function requestedAssets()\\n             \/\/ Make sure the asset and request still exist\\n             if ($checkoutRequest && $checkoutRequest->itemRequested()) {\\n                 $results['rows'][] = [\\n-                    'image' => $checkoutRequest->itemRequested()->present()->getImageUrl(),\\n-                    'name' => $checkoutRequest->itemRequested()->present()->name(),\\n-                    'type' => $checkoutRequest->itemType(),\\n-                    'qty' => $checkoutRequest->quantity,\\n-                    'location' => ($checkoutRequest->location()) ? $checkoutRequest->location()->name : null,\\n+                    'image' => e($checkoutRequest->itemRequested()->present()->getImageUrl()),\\n+                    'name' => e($checkoutRequest->itemRequested()->present()->name()),\\n+                    'type' => e($checkoutRequest->itemType()),\\n+                    'qty' => (int) $checkoutRequest->quantity,\\n+                    'location' => ($checkoutRequest->location()) ? e($checkoutRequest->location()->name) : null,\\n                     'expected_checkin' => Helper::getFormattedDateObject($checkoutRequest->itemRequested()->expected_checkin, 'datetime'),\\n                     'request_date' => Helper::getFormattedDateObject($checkoutRequest->created_at, 'datetime'),\\n                 ];\"}}",
      "message_norm":"merge pull request #10942 from snipe\/fixes\/xss_user_requested\n\nfixes potential xss vuln in user requestable results",
      "language":"ca",
      "entities":"[('#10942', 'ISSUE', ''), ('xss_user_requested', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Controllers\/Api\/ProfileController.php'])",
      "num_files":1.0,
      "patch_content":"From 698c7f4904f8fd843c5b9761053c9c68819ec288 Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Fri, 15 Apr 2022 12:22:20 +0100\nSubject: [PATCH] Fixes potential XSS vuln in user requestable results\n\nSigned-off-by: snipe <snipe@snipe.net>\n---\n app\/Http\/Controllers\/Api\/ProfileController.php | 10 +++++-----\n 1 file changed, 5 insertions(+), 5 deletions(-)\n\ndiff --git a\/app\/Http\/Controllers\/Api\/ProfileController.php b\/app\/Http\/Controllers\/Api\/ProfileController.php\nindex f6c31d5db15a..47e299e61516 100644\n--- a\/app\/Http\/Controllers\/Api\/ProfileController.php\n+++ b\/app\/Http\/Controllers\/Api\/ProfileController.php\n@@ -30,11 +30,11 @@ public function requestedAssets()\n             \/\/ Make sure the asset and request still exist\n             if ($checkoutRequest && $checkoutRequest->itemRequested()) {\n                 $results['rows'][] = [\n-                    'image' => $checkoutRequest->itemRequested()->present()->getImageUrl(),\n-                    'name' => $checkoutRequest->itemRequested()->present()->name(),\n-                    'type' => $checkoutRequest->itemType(),\n-                    'qty' => $checkoutRequest->quantity,\n-                    'location' => ($checkoutRequest->location()) ? $checkoutRequest->location()->name : null,\n+                    'image' => e($checkoutRequest->itemRequested()->present()->getImageUrl()),\n+                    'name' => e($checkoutRequest->itemRequested()->present()->name()),\n+                    'type' => e($checkoutRequest->itemType()),\n+                    'qty' => (int) $checkoutRequest->quantity,\n+                    'location' => ($checkoutRequest->location()) ? e($checkoutRequest->location()->name) : null,\n                     'expected_checkin' => Helper::getFormattedDateObject($checkoutRequest->itemRequested()->expected_checkin, 'datetime'),\n                     'request_date' => Helper::getFormattedDateObject($checkoutRequest->created_at, 'datetime'),\n                 ];",
      "code_diff":"@@ -30,11 +30,11 @@ public function requestedAssets()\n             \/\/ Make sure the asset and request still exist\n             if ($checkoutRequest && $checkoutRequest->itemRequested()) {\n                 $results['rows'][] = [\n-                    'image' => $checkoutRequest->itemRequested()->present()->getImageUrl(),\n-                    'name' => $checkoutRequest->itemRequested()->present()->name(),\n-                    'type' => $checkoutRequest->itemType(),\n-                    'qty' => $checkoutRequest->quantity,\n-                    'location' => ($checkoutRequest->location()) ? $checkoutRequest->location()->name : null,\n+                    'image' => e($checkoutRequest->itemRequested()->present()->getImageUrl()),\n+                    'name' => e($checkoutRequest->itemRequested()->present()->name()),\n+                    'type' => e($checkoutRequest->itemType()),\n+                    'qty' => (int) $checkoutRequest->quantity,\n+                    'location' => ($checkoutRequest->location()) ? e($checkoutRequest->location()->name) : null,\n                     'expected_checkin' => Helper::getFormattedDateObject($checkoutRequest->itemRequested()->expected_checkin, 'datetime'),\n                     'request_date' => Helper::getFormattedDateObject($checkoutRequest->created_at, 'datetime'),\n                 ];"
    },
    {
      "index":50,
      "vuln_id":"GHSA-7vvq-7r29-5vg3",
      "cwe_id":"{'CWE-79'}",
      "score":7.1,
      "chain":"{'https:\/\/github.com\/mrdoob\/three.js\/commit\/0c31bc605e21965aad8a6479bb1969351773f76d'}",
      "dataset":"osv",
      "summary":"Cross site scripting in three.js # CVE has been withdrawn\n\nVersions of three.js prior to 0.137.0 load untrusted iframes and allow for attackers to inject arbitrary javascript into a users browser.",
      "published_date":"2022-01-27",
      "chain_len":1,
      "project":"https:\/\/github.com\/mrdoob\/three.js",
      "commit_href":"https:\/\/github.com\/mrdoob\/three.js\/commit\/0c31bc605e21965aad8a6479bb1969351773f76d",
      "commit_sha":"0c31bc605e21965aad8a6479bb1969351773f76d",
      "patch":"SINGLE",
      "chain_ord":"['0c31bc605e21965aad8a6479bb1969351773f76d']",
      "before_first_fix_commit":"{'55d4f24cb50e995b0dfee73979305e8237384a53'}",
      "last_fix_commit":"0c31bc605e21965aad8a6479bb1969351773f76d",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/24\/2022, 17:39:24",
      "message":"Only load trusted iframe (#23245)",
      "author":"Rohan Sharma",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'docs\/index.html': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/mrdoob\/three.js\/raw\/0c31bc605e21965aad8a6479bb1969351773f76d\/docs%2Findex.html', 'patch': '@@ -498,7 +498,7 @@ <h1><a href=\"https:\/\/threejs.org\">three.js<\/a><\/h1>\\n \\t\\t\\tconst oldIframe = iframe;\\n \\t\\t\\tiframe = oldIframe.cloneNode();\\n \\n-\\t\\t\\tif ( hash ) {\\n+\\t\\t\\tif ( hash && titles[ splitHash[ 0 ] ] ) {\\n \\n \\t\\t\\t\\tiframe.src = splitHash[ 0 ] + \\'.html\\' + splitHash[ 1 ];\\n \\t\\t\\t\\tsubtitle = titles[ splitHash[ 0 ] ] + splitHash[ 1 ] + \\' \u2013 \\';'}}",
      "message_norm":"only load trusted iframe (#23245)",
      "language":"en",
      "entities":"[('#23245', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['docs\/index.html'])",
      "num_files":1.0,
      "patch_content":"From 0c31bc605e21965aad8a6479bb1969351773f76d Mon Sep 17 00:00:00 2001\nFrom: Rohan Sharma <i.am.lone.survivor@protonmail.com>\nDate: Mon, 24 Jan 2022 23:09:24 +0530\nSubject: [PATCH] Only load trusted iframe (#23245)\n\n---\n docs\/index.html | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/docs\/index.html b\/docs\/index.html\nindex a793da74a23b48..c8a41b4b2b1e73 100644\n--- a\/docs\/index.html\n+++ b\/docs\/index.html\n@@ -498,7 +498,7 @@ <h1><a href=\"https:\/\/threejs.org\">three.js<\/a><\/h1>\n \t\t\tconst oldIframe = iframe;\n \t\t\tiframe = oldIframe.cloneNode();\n \n-\t\t\tif ( hash ) {\n+\t\t\tif ( hash && titles[ splitHash[ 0 ] ] ) {\n \n \t\t\t\tiframe.src = splitHash[ 0 ] + '.html' + splitHash[ 1 ];\n \t\t\t\tsubtitle = titles[ splitHash[ 0 ] ] + splitHash[ 1 ] + ' \u2013 ';",
      "code_diff":"@@ -498,7 +498,7 @@ <h1><a href=\"https:\/\/threejs.org\">three.js<\/a><\/h1>\n \t\t\tconst oldIframe = iframe;\n \t\t\tiframe = oldIframe.cloneNode();\n \n-\t\t\tif ( hash ) {\n+\t\t\tif ( hash && titles[ splitHash[ 0 ] ] ) {\n \n \t\t\t\tiframe.src = splitHash[ 0 ] + '.html' + splitHash[ 1 ];\n \t\t\t\tsubtitle = titles[ splitHash[ 0 ] ] + splitHash[ 1 ] + ' \u2013 ';"
    },
    {
      "index":51,
      "vuln_id":"GHSA-72p5-2r6g-fm6v",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/totaljs\/cms\/commit\/75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad', 'https:\/\/github.com\/totaljs\/cms\/commit\/8b9d7dada998c08d172481d9f0fc0397c4b3c78d'}",
      "dataset":"osv",
      "summary":"Moderate severity vulnerability that affects total.js Total.js CMS 12.0.0 has XSS related to themes\/admin\/views\/index.html (item.message) and themes\/admin\/public\/ui.js (column.format).",
      "published_date":"2019-04-02",
      "chain_len":2,
      "project":"https:\/\/github.com\/totaljs\/cms",
      "commit_href":"https:\/\/github.com\/totaljs\/cms\/commit\/75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad",
      "commit_sha":"75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad",
      "patch":"MULTI",
      "chain_ord":"['75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad', '8b9d7dada998c08d172481d9f0fc0397c4b3c78d']",
      "before_first_fix_commit":"{'75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad'}",
      "last_fix_commit":"8b9d7dada998c08d172481d9f0fc0397c4b3c78d",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/13\/2019, 19:29:24",
      "message":"Fixed XSS.",
      "author":"Peter S\u030cirka",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'themes\/admin\/public\/ui.js': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/totaljs\/cms\/raw\/75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad\/themes%2Fadmin%2Fpublic%2Fui.js', 'patch': \"@@ -559,7 +559,7 @@ COMPONENT('grid', 'filter:true;external:false;fillcount:50;filterlabel:Filtering\\n \\t\\t\\tfor (var j = 0, jl = columns.length; j < jl; j++) {\\n \\t\\t\\t\\tvar column = columns[j];\\n \\t\\t\\t\\tvar val = items[i][column.name];\\n-\\t\\t\\t\\tm.value = column.template ? column.template(items[i], column) : column.render ? column.render(val, column, items[i]) : val == null ? '' : (column.format ? val.format(column.format) : val);\\n+\\t\\t\\t\\tm.value = column.template ? column.template(items[i], column) : column.render ? column.render(val, column, items[i]) : val == null ? '' : Thelpers.encode((column.format ? val.format(column.format) : val));\\n \\t\\t\\t\\tm.index = j;\\n \\t\\t\\t\\tm.align = column.align;\\n \\t\\t\\t\\tm.background = column.background;\"}}",
      "message_norm":"fixed xss.",
      "language":"en",
      "entities":"[('fixed', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['themes\/admin\/public\/ui.js'])",
      "num_files":1.0,
      "patch_content":"From 75205f93009db3cf8c0b0f4f1fc8ab82d70da8ad Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Peter=20S=CC=8Cirka?= <petersirka@gmail.com>\nDate: Wed, 13 Feb 2019 20:29:24 +0100\nSubject: [PATCH] Fixed XSS.\n\n---\n themes\/admin\/public\/ui.js | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/themes\/admin\/public\/ui.js b\/themes\/admin\/public\/ui.js\nindex 2667788..a893966 100755\n--- a\/themes\/admin\/public\/ui.js\n+++ b\/themes\/admin\/public\/ui.js\n@@ -559,7 +559,7 @@ COMPONENT('grid', 'filter:true;external:false;fillcount:50;filterlabel:Filtering\n \t\t\tfor (var j = 0, jl = columns.length; j < jl; j++) {\n \t\t\t\tvar column = columns[j];\n \t\t\t\tvar val = items[i][column.name];\n-\t\t\t\tm.value = column.template ? column.template(items[i], column) : column.render ? column.render(val, column, items[i]) : val == null ? '' : (column.format ? val.format(column.format) : val);\n+\t\t\t\tm.value = column.template ? column.template(items[i], column) : column.render ? column.render(val, column, items[i]) : val == null ? '' : Thelpers.encode((column.format ? val.format(column.format) : val));\n \t\t\t\tm.index = j;\n \t\t\t\tm.align = column.align;\n \t\t\t\tm.background = column.background;",
      "code_diff":"@@ -559,7 +559,7 @@ COMPONENT('grid', 'filter:true;external:false;fillcount:50;filterlabel:Filtering\n \t\t\tfor (var j = 0, jl = columns.length; j < jl; j++) {\n \t\t\t\tvar column = columns[j];\n \t\t\t\tvar val = items[i][column.name];\n-\t\t\t\tm.value = column.template ? column.template(items[i], column) : column.render ? column.render(val, column, items[i]) : val == null ? '' : (column.format ? val.format(column.format) : val);\n+\t\t\t\tm.value = column.template ? column.template(items[i], column) : column.render ? column.render(val, column, items[i]) : val == null ? '' : Thelpers.encode((column.format ? val.format(column.format) : val));\n \t\t\t\tm.index = j;\n \t\t\t\tm.align = column.align;\n \t\t\t\tm.background = column.background;"
    },
    {
      "index":52,
      "vuln_id":"GHSA-q67f-3jq4-mww2",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/e786fd44aac46febdbf916ed6c328fbe645d80bf'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Pimcore Pimcore version 10.3.2 and prior is vulnerable to stored cross-site scripting. A patch is available and anticipated to be part of version 10.3.3.",
      "published_date":"2022-03-05",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/e786fd44aac46febdbf916ed6c328fbe645d80bf",
      "commit_sha":"e786fd44aac46febdbf916ed6c328fbe645d80bf",
      "patch":"SINGLE",
      "chain_ord":"['e786fd44aac46febdbf916ed6c328fbe645d80bf']",
      "before_first_fix_commit":"{'ce5c01f4c9f477444aeceb640b60f3b6199e7c22'}",
      "last_fix_commit":"e786fd44aac46febdbf916ed6c328fbe645d80bf",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/02\/2022, 20:15:07",
      "message":"escaping 'key' custom property field in elements",
      "author":"JiaJia Ji",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 2, 'total': 5}",
      "files":"{'bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/element\/properties.js': {'additions': 3, 'deletions': 2, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/e786fd44aac46febdbf916ed6c328fbe645d80bf\/bundles%2FAdminBundle%2FResources%2Fpublic%2Fjs%2Fpimcore%2Felement%2Fproperties.js', 'patch': '@@ -568,10 +568,11 @@ pimcore.element.properties = Class.create({\\n \\n     addSetFromUserDefined: function (customKey, customType) {\\n         try {\\n-            if (in_array(customKey.getValue(), this.disallowedKeys)) {\\n+            let key = htmlspecialchars(customKey.getValue());\\n+            if (in_array(key, this.disallowedKeys)) {\\n                 Ext.MessageBox.alert(t(\"error\"), t(\"name_is_not_allowed\"));\\n             }\\n-            this.add(customKey.getValue(), customType.getValue(), false, false, false, true);\\n+            this.add(key, customType.getValue(), false, false, false, true);\\n         } catch (e) {\\n             console.log(e);\\n         }'}}",
      "message_norm":"escaping 'key' custom property field in elements",
      "language":"en",
      "entities":"[('escaping', 'SECWORD', ''), ('key', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/element\/properties.js'])",
      "num_files":1.0,
      "patch_content":"From e786fd44aac46febdbf916ed6c328fbe645d80bf Mon Sep 17 00:00:00 2001\nFrom: JiaJia Ji <kingjia90@gmail.com>\nDate: Wed, 2 Mar 2022 21:15:07 +0100\nSubject: [PATCH] escaping 'key' custom property field in elements\n\n---\n ...\/Resources\/public\/js\/pimcore\/element\/properties.js        | 5 +++--\n 1 file changed, 3 insertions(+), 2 deletions(-)\n\ndiff --git a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/element\/properties.js b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/element\/properties.js\nindex 16466f0a5ad..0517e3163ee 100644\n--- a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/element\/properties.js\n+++ b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/element\/properties.js\n@@ -568,10 +568,11 @@ pimcore.element.properties = Class.create({\n \n     addSetFromUserDefined: function (customKey, customType) {\n         try {\n-            if (in_array(customKey.getValue(), this.disallowedKeys)) {\n+            let key = htmlspecialchars(customKey.getValue());\n+            if (in_array(key, this.disallowedKeys)) {\n                 Ext.MessageBox.alert(t(\"error\"), t(\"name_is_not_allowed\"));\n             }\n-            this.add(customKey.getValue(), customType.getValue(), false, false, false, true);\n+            this.add(key, customType.getValue(), false, false, false, true);\n         } catch (e) {\n             console.log(e);\n         }",
      "code_diff":"@@ -568,10 +568,11 @@ pimcore.element.properties = Class.create({\n \n     addSetFromUserDefined: function (customKey, customType) {\n         try {\n-            if (in_array(customKey.getValue(), this.disallowedKeys)) {\n+            let key = htmlspecialchars(customKey.getValue());\n+            if (in_array(key, this.disallowedKeys)) {\n                 Ext.MessageBox.alert(t(\"error\"), t(\"name_is_not_allowed\"));\n             }\n-            this.add(customKey.getValue(), customType.getValue(), false, false, false, true);\n+            this.add(key, customType.getValue(), false, false, false, true);\n         } catch (e) {\n             console.log(e);\n         }"
    },
    {
      "index":53,
      "vuln_id":"GHSA-jr37-66pj-36v7",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/Bottelet\/DaybydayCRM\/commit\/002dc75f400cf307bd00b71a5a93f1e26e52cee2'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in DayByDay CRM In Daybyday CRM, version 2.2.0 is vulnerable to Stored Cross-Site Scripting (XSS) vulnerability that allows low privileged application users to store malicious scripts in the title field of new tasks. These scripts are executed in a victim\u2019s browser when they open the \u201c\/tasks\u201d page to view all the tasks.",
      "published_date":"2022-01-08",
      "chain_len":1,
      "project":"https:\/\/github.com\/Bottelet\/DaybydayCRM",
      "commit_href":"https:\/\/github.com\/Bottelet\/DaybydayCRM\/commit\/002dc75f400cf307bd00b71a5a93f1e26e52cee2",
      "commit_sha":"002dc75f400cf307bd00b71a5a93f1e26e52cee2",
      "patch":"SINGLE",
      "chain_ord":"['002dc75f400cf307bd00b71a5a93f1e26e52cee2']",
      "before_first_fix_commit":"{'fe842ea5ede237443f1f45a99aeb839133115d8b'}",
      "last_fix_commit":"002dc75f400cf307bd00b71a5a93f1e26e52cee2",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/25\/2021, 19:53:06",
      "message":"fix xss for tasks index",
      "author":"Casper Bottelet",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/Http\/Controllers\/TasksController.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/Bottelet\/DaybydayCRM\/raw\/002dc75f400cf307bd00b71a5a93f1e26e52cee2\/app%2FHttp%2FControllers%2FTasksController.php', 'patch': '@@ -82,7 +82,7 @@ public function anyData()\\n             })\\n             ->addColumn(\\'view\\', function ($tasks) {\\n                 return \\'<a href=\"\\' . route(\"tasks.show\", $tasks->external_id) . \\'\" class=\"btn btn-link\">\\' . __(\\'View\\') .\\'<\/a>\\'\\n-                . \\'<a data-toggle=\"modal\" data-id=\"\\'. route(\\'tasks.destroy\\',$tasks->external_id) . \\'\" data-title=\"\\'. $tasks->title . \\'\" data-target=\"#deletion\" class=\"btn btn-link\">\\' . __(\\'Delete\\') .\\'<\/a>\\'\\n+                . \\'<a data-toggle=\"modal\" data-id=\"\\'. route(\\'tasks.destroy\\',$tasks->external_id) . \\'\" data-target=\"#deletion\" class=\"btn btn-link\">\\' . __(\\'Delete\\') .\\'<\/a>\\'\\n                 ;\\n             })\\n             ->rawColumns([\\'titlelink\\',\\'view\\', \\'status_id\\'])'}}",
      "message_norm":"fix xss for tasks index",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Controllers\/TasksController.php'])",
      "num_files":1.0,
      "patch_content":"From 002dc75f400cf307bd00b71a5a93f1e26e52cee2 Mon Sep 17 00:00:00 2001\nFrom: Casper Bottelet <cbottelet@gmail.com>\nDate: Fri, 25 Jun 2021 21:53:06 +0200\nSubject: [PATCH] fix xss for tasks index\n\n---\n app\/Http\/Controllers\/TasksController.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/Http\/Controllers\/TasksController.php b\/app\/Http\/Controllers\/TasksController.php\nindex 629437d21..831cd76dd 100644\n--- a\/app\/Http\/Controllers\/TasksController.php\n+++ b\/app\/Http\/Controllers\/TasksController.php\n@@ -82,7 +82,7 @@ public function anyData()\n             })\n             ->addColumn('view', function ($tasks) {\n                 return '<a href=\"' . route(\"tasks.show\", $tasks->external_id) . '\" class=\"btn btn-link\">' . __('View') .'<\/a>'\n-                . '<a data-toggle=\"modal\" data-id=\"'. route('tasks.destroy',$tasks->external_id) . '\" data-title=\"'. $tasks->title . '\" data-target=\"#deletion\" class=\"btn btn-link\">' . __('Delete') .'<\/a>'\n+                . '<a data-toggle=\"modal\" data-id=\"'. route('tasks.destroy',$tasks->external_id) . '\" data-target=\"#deletion\" class=\"btn btn-link\">' . __('Delete') .'<\/a>'\n                 ;\n             })\n             ->rawColumns(['titlelink','view', 'status_id'])",
      "code_diff":"@@ -82,7 +82,7 @@ public function anyData()\n             })\n             ->addColumn('view', function ($tasks) {\n                 return '<a href=\"' . route(\"tasks.show\", $tasks->external_id) . '\" class=\"btn btn-link\">' . __('View') .'<\/a>'\n-                . '<a data-toggle=\"modal\" data-id=\"'. route('tasks.destroy',$tasks->external_id) . '\" data-title=\"'. $tasks->title . '\" data-target=\"#deletion\" class=\"btn btn-link\">' . __('Delete') .'<\/a>'\n+                . '<a data-toggle=\"modal\" data-id=\"'. route('tasks.destroy',$tasks->external_id) . '\" data-target=\"#deletion\" class=\"btn btn-link\">' . __('Delete') .'<\/a>'\n                 ;\n             })\n             ->rawColumns(['titlelink','view', 'status_id'])"
    },
    {
      "index":54,
      "vuln_id":"GHSA-9w7h-3wwh-6m5q",
      "cwe_id":"{'CWE-79'}",
      "score":6.3,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/ad3928f67b2cd4443f4323d858b666d35a919ba8'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Microweber Microweber prior to 1.2.15 is vulnerable to reflected cross-site scripting on demo.microweber.org\/demo\/module\/. This allows the execution of arbitrary JavaScript as the attacked user.",
      "published_date":"2022-04-23",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/ad3928f67b2cd4443f4323d858b666d35a919ba8",
      "commit_sha":"ad3928f67b2cd4443f4323d858b666d35a919ba8",
      "patch":"SINGLE",
      "chain_ord":"['ad3928f67b2cd4443f4323d858b666d35a919ba8']",
      "before_first_fix_commit":"{'3e47c4f1933aa3ffd0975e24e34b7af35de947b4'}",
      "last_fix_commit":"ad3928f67b2cd4443f4323d858b666d35a919ba8",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/22\/2022, 16:26:41",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 7, 'deletions': 2, 'total': 9}",
      "files":"{'src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php': {'additions': 7, 'deletions': 2, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/ad3928f67b2cd4443f4323d858b666d35a919ba8\/src%2FMicroweberPackages%2FApp%2FHttp%2FControllers%2FApiController.php', 'patch': \"@@ -611,18 +611,23 @@ public function module()\\n             $request_data_new = [];\\n             $antixss = new AntiXSS();\\n             foreach ($request_data as $k=>$v){\\n-\\n+                if(is_string($v)) {\\n+                    $v = str_replace('<', '-', $v);\\n+                    $v = str_replace('>', '-', $v);\\n+                }\\n                 $v = $antixss->xss_clean($v);\\n \\n                 if(is_string($k)){\\n+                    $k = str_replace('<', '-', $k);\\n+                    $k = str_replace('>', '-', $k);\\n                     $k = $antixss->xss_clean($k);\\n                     if($k){\\n                         $request_data_new[$k] = $v;\\n                     }\\n                 } else {\\n                     $request_data_new[$k] = $v;\\n                 }\\n-                \\n+\\n             }\\n             $request_data = $request_data_new;\\n         }\"}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php'])",
      "num_files":1.0,
      "patch_content":"From ad3928f67b2cd4443f4323d858b666d35a919ba8 Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Fri, 22 Apr 2022 19:26:41 +0300\nSubject: [PATCH] update\n\n---\n ...\/App\/Http\/Controllers\/ApiController.php               | 9 +++++++--\n 1 file changed, 7 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php b\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php\nindex 6d628263d5b..9e72121a9e6 100644\n--- a\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php\n+++ b\/src\/MicroweberPackages\/App\/Http\/Controllers\/ApiController.php\n@@ -611,10 +611,15 @@ public function module()\n             $request_data_new = [];\n             $antixss = new AntiXSS();\n             foreach ($request_data as $k=>$v){\n-\n+                if(is_string($v)) {\n+                    $v = str_replace('<', '-', $v);\n+                    $v = str_replace('>', '-', $v);\n+                }\n                 $v = $antixss->xss_clean($v);\n \n                 if(is_string($k)){\n+                    $k = str_replace('<', '-', $k);\n+                    $k = str_replace('>', '-', $k);\n                     $k = $antixss->xss_clean($k);\n                     if($k){\n                         $request_data_new[$k] = $v;\n@@ -622,7 +627,7 @@ public function module()\n                 } else {\n                     $request_data_new[$k] = $v;\n                 }\n-                \n+\n             }\n             $request_data = $request_data_new;\n         }",
      "code_diff":"@@ -611,10 +611,15 @@ public function module()\n             $request_data_new = [];\n             $antixss = new AntiXSS();\n             foreach ($request_data as $k=>$v){\n-\n+                if(is_string($v)) {\n+                    $v = str_replace('<', '-', $v);\n+                    $v = str_replace('>', '-', $v);\n+                }\n                 $v = $antixss->xss_clean($v);\n \n                 if(is_string($k)){\n+                    $k = str_replace('<', '-', $k);\n+                    $k = str_replace('>', '-', $k);\n                     $k = $antixss->xss_clean($k);\n                     if($k){\n                         $request_data_new[$k] = $v;\n@@ -622,7 +627,7 @@ public function module()\n                 } else {\n                     $request_data_new[$k] = $v;\n                 }\n-                \n+\n             }\n             $request_data = $request_data_new;\n         }"
    },
    {
      "index":55,
      "vuln_id":"GHSA-hj8g-cw8x-2c6m",
      "cwe_id":"{'CWE-79'}",
      "score":7.6,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/a5925f74d39775771d4c37c8d4c1acbb762fda0a'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Microweber Microweber prior to version 1.3 is vulnerable to reflected cross-site scripting.",
      "published_date":"2022-02-24",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/a5925f74d39775771d4c37c8d4c1acbb762fda0a",
      "commit_sha":"a5925f74d39775771d4c37c8d4c1acbb762fda0a",
      "patch":"SINGLE",
      "chain_ord":"['a5925f74d39775771d4c37c8d4c1acbb762fda0a']",
      "before_first_fix_commit":"{'0b6b1eb5ba85ffc8f74e6f5f5be9dc9f9f7e9d8f'}",
      "last_fix_commit":"a5925f74d39775771d4c37c8d4c1acbb762fda0a",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/22\/2022, 10:18:26",
      "message":"Update UrlManager.php",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
      "files":"{'src\/MicroweberPackages\/Helper\/UrlManager.php': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/a5925f74d39775771d4c37c8d4c1acbb762fda0a\/src%2FMicroweberPackages%2FHelper%2FUrlManager.php', 'patch': '@@ -276,7 +276,8 @@ public function string($skip_ajax = false)\\n \\n         \/\/ clear request params\\n         $cleanParam = new HTMLClean();\\n-        $u1 = $cleanParam->cleanArray($u1);\\n+        $u1 = $cleanParam->clean($u1);\\n+\\n \\n         return $u1;\\n     }'}}",
      "message_norm":"update urlmanager.php",
      "language":"sv",
      "entities":null,
      "classification_level_1":"POORLY_DOCUMENTED",
      "classification_level_2":"SUBMIT_CENTERED",
      "list_files":"dict_keys(['src\/MicroweberPackages\/Helper\/UrlManager.php'])",
      "num_files":1.0,
      "patch_content":"From a5925f74d39775771d4c37c8d4c1acbb762fda0a Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Tue, 22 Feb 2022 12:18:26 +0200\nSubject: [PATCH] Update UrlManager.php\n\n---\n src\/MicroweberPackages\/Helper\/UrlManager.php | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/MicroweberPackages\/Helper\/UrlManager.php b\/src\/MicroweberPackages\/Helper\/UrlManager.php\nindex 4e277892b04..74996d7aa52 100644\n--- a\/src\/MicroweberPackages\/Helper\/UrlManager.php\n+++ b\/src\/MicroweberPackages\/Helper\/UrlManager.php\n@@ -276,7 +276,8 @@ public function string($skip_ajax = false)\n \n         \/\/ clear request params\n         $cleanParam = new HTMLClean();\n-        $u1 = $cleanParam->cleanArray($u1);\n+        $u1 = $cleanParam->clean($u1);\n+\n \n         return $u1;\n     }",
      "code_diff":"@@ -276,7 +276,8 @@ public function string($skip_ajax = false)\n \n         \/\/ clear request params\n         $cleanParam = new HTMLClean();\n-        $u1 = $cleanParam->cleanArray($u1);\n+        $u1 = $cleanParam->clean($u1);\n+\n \n         return $u1;\n     }"
    },
    {
      "index":56,
      "vuln_id":"GHSA-pxcf-v868-m492",
      "cwe_id":"{'CWE-74', 'CWE-79'}",
      "score":7.6,
      "chain":"{'https:\/\/github.com\/jperelli\/osm-static-maps\/commit\/97355d29e08753d1cfe99b1281dbaa06f4e651b0'}",
      "dataset":"osv",
      "summary":"Injection and Cross-site Scripting in osm-static-maps This affects all versions of package osm-static-maps under 3.9.0. User input given to the package is passed directly to a template without escaping ({{{ ... }}}). As such, it is possible for an attacker to inject arbitrary HTML\/JS code and depending on the context. It will be outputted as an HTML on the page which gives opportunity for XSS or rendered on the server (puppeteer) which also gives opportunity for SSRF and Local File Read.",
      "published_date":"2021-05-10",
      "chain_len":1,
      "project":"https:\/\/github.com\/jperelli\/osm-static-maps",
      "commit_href":"https:\/\/github.com\/jperelli\/osm-static-maps\/commit\/97355d29e08753d1cfe99b1281dbaa06f4e651b0",
      "commit_sha":"97355d29e08753d1cfe99b1281dbaa06f4e651b0",
      "patch":"SINGLE",
      "chain_ord":"['97355d29e08753d1cfe99b1281dbaa06f4e651b0']",
      "before_first_fix_commit":"{'6bce2e2a8dd4cbbbbe083820e494ba858be74b16'}",
      "last_fix_commit":"97355d29e08753d1cfe99b1281dbaa06f4e651b0",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/11\/2020, 23:25:42",
      "message":"fix: escape special characters before insertion to template",
      "author":"snoopysecurity",
      "comments":null,
      "stats":"{'additions': 25, 'deletions': 6, 'total': 31}",
      "files":"{'src\/server.js': {'additions': 25, 'deletions': 6, 'changes': 31, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jperelli\/osm-static-maps\/raw\/97355d29e08753d1cfe99b1281dbaa06f4e651b0\/src%2Fserver.js', 'patch': '@@ -19,6 +19,23 @@ app.use((req, res, next) => {\\n   next();\\n });\\n \\n+\\n+function htmlEscape(text) {\\n+  return text.replace(\/&\/g, \\'&amp;\\').\\n+  replace(\/<\/g, \\'&lt;\\').\\n+  replace(\/\"\/g, \\'&quot;\\').\\n+  replace(\/\\'\/g, \\'&#039;\\');\\n+}\\n+\\n+\\n+function sanitize(params) {\\n+  result = {}\\n+  for (let [key, value] of Object.entries(params)) {\\n+      result[key] = htmlEscape(value)\\n+  }\\n+  return result;\\n+}\\n+\\n app.get(\"\/health\", (req, res) => res.sendStatus(200));\\n \\n const handler = (res, params) => {\\n@@ -40,12 +57,14 @@ const handler = (res, params) => {\\n app.get(\"\/\", (req, res) => handler(res, req.query));\\n app.post(\"\/\", (req, res) => handler(res, req.body));\\n \\n-app.get(\"\/dynamic\", (req, res) =>\\n-  handler(res, { ...req.query, renderToHtml: true })\\n-);\\n+app.get(\"\/dynamic\", (req, res) => {\\n+  var sanitized = sanitize(req.query)\\n+  handler(res, { ...sanitized, renderToHtml: true })\\n+})\\n \\n-app.post(\"\/dynamic\", (req, res) =>\\n-  handler(res, { ...req.body, renderToHtml: true })\\n-);\\n+app.post(\"\/dynamic\", (req, res) => {\\n+  var sanitized = sanitize(req.body)\\n+  handler(res, { ...sanitized, renderToHtml: true })\\n+})\\n \\n module.exports = http.createServer(app);'}}",
      "message_norm":"fix: escape special characters before insertion to template",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/server.js'])",
      "num_files":1.0,
      "patch_content":"From 97355d29e08753d1cfe99b1281dbaa06f4e651b0 Mon Sep 17 00:00:00 2001\nFrom: snoopysecurity <sams@snyk.io>\nDate: Mon, 12 Oct 2020 00:25:42 +0100\nSubject: [PATCH] fix: escape special characters before insertion to template\n\n---\n src\/server.js | 31 +++++++++++++++++++++++++------\n 1 file changed, 25 insertions(+), 6 deletions(-)\n\ndiff --git a\/src\/server.js b\/src\/server.js\nindex 2485f49..4944708 100644\n--- a\/src\/server.js\n+++ b\/src\/server.js\n@@ -19,6 +19,23 @@ app.use((req, res, next) => {\n   next();\n });\n \n+\n+function htmlEscape(text) {\n+  return text.replace(\/&\/g, '&amp;').\n+  replace(\/<\/g, '&lt;').\n+  replace(\/\"\/g, '&quot;').\n+  replace(\/'\/g, '&#039;');\n+}\n+\n+\n+function sanitize(params) {\n+  result = {}\n+  for (let [key, value] of Object.entries(params)) {\n+      result[key] = htmlEscape(value)\n+  }\n+  return result;\n+}\n+\n app.get(\"\/health\", (req, res) => res.sendStatus(200));\n \n const handler = (res, params) => {\n@@ -40,12 +57,14 @@ const handler = (res, params) => {\n app.get(\"\/\", (req, res) => handler(res, req.query));\n app.post(\"\/\", (req, res) => handler(res, req.body));\n \n-app.get(\"\/dynamic\", (req, res) =>\n-  handler(res, { ...req.query, renderToHtml: true })\n-);\n+app.get(\"\/dynamic\", (req, res) => {\n+  var sanitized = sanitize(req.query)\n+  handler(res, { ...sanitized, renderToHtml: true })\n+})\n \n-app.post(\"\/dynamic\", (req, res) =>\n-  handler(res, { ...req.body, renderToHtml: true })\n-);\n+app.post(\"\/dynamic\", (req, res) => {\n+  var sanitized = sanitize(req.body)\n+  handler(res, { ...sanitized, renderToHtml: true })\n+})\n \n module.exports = http.createServer(app);",
      "code_diff":"@@ -19,6 +19,23 @@ app.use((req, res, next) => {\n   next();\n });\n \n+\n+function htmlEscape(text) {\n+  return text.replace(\/&\/g, '&amp;').\n+  replace(\/<\/g, '&lt;').\n+  replace(\/\"\/g, '&quot;').\n+  replace(\/'\/g, '&#039;');\n+}\n+\n+\n+function sanitize(params) {\n+  result = {}\n+  for (let [key, value] of Object.entries(params)) {\n+      result[key] = htmlEscape(value)\n+  }\n+  return result;\n+}\n+\n app.get(\"\/health\", (req, res) => res.sendStatus(200));\n \n const handler = (res, params) => {\n@@ -40,12 +57,14 @@ const handler = (res, params) => {\n app.get(\"\/\", (req, res) => handler(res, req.query));\n app.post(\"\/\", (req, res) => handler(res, req.body));\n \n-app.get(\"\/dynamic\", (req, res) =>\n-  handler(res, { ...req.query, renderToHtml: true })\n-);\n+app.get(\"\/dynamic\", (req, res) => {\n+  var sanitized = sanitize(req.query)\n+  handler(res, { ...sanitized, renderToHtml: true })\n+})\n \n-app.post(\"\/dynamic\", (req, res) =>\n-  handler(res, { ...req.body, renderToHtml: true })\n-);\n+app.post(\"\/dynamic\", (req, res) => {\n+  var sanitized = sanitize(req.body)\n+  handler(res, { ...sanitized, renderToHtml: true })\n+})\n \n module.exports = http.createServer(app);"
    },
    {
      "index":57,
      "vuln_id":"GHSA-rf66-hmqf-q3fc",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/pull\/6831\/commits\/5848d9a10c7d62c73ff6a3858edfae96a429402a'}",
      "dataset":"osv",
      "summary":"Improper Neutralization of Input During Web Page Generation in Select2 In Select2 through 4.0.5, as used in Snipe-IT and other products, rich selectlists allow XSS. This affects use cases with Ajax remote data loading when HTML templates are used to display listbox data.",
      "published_date":"2022-05-14",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/pull\/6831\/commits\/5848d9a10c7d62c73ff6a3858edfae96a429402a",
      "commit_sha":"5848d9a10c7d62c73ff6a3858edfae96a429402a",
      "patch":"SINGLE",
      "chain_ord":"['5848d9a10c7d62c73ff6a3858edfae96a429402a']",
      "before_first_fix_commit":"{'bd8548325d6b4210015bd0ddeb144c61ae8949be'}",
      "last_fix_commit":"5848d9a10c7d62c73ff6a3858edfae96a429402a",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/19\/2019, 02:29:30",
      "message":"Janky fix for Select2 bug",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 12, 'deletions': 1, 'total': 13}",
      "files":"{'resources\/assets\/js\/snipeit.js': {'additions': 12, 'deletions': 1, 'changes': 13, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/5848d9a10c7d62c73ff6a3858edfae96a429402a\/resources%2Fassets%2Fjs%2Fsnipeit.js', 'patch': '@@ -260,7 +260,18 @@ $(document).ready(function () {\\n     }\\n \\n     function formatDataSelection (datalist) {\\n-        return datalist.text;\\n+        \/\/ This a heinous workaround for a known bug in Select2.\\n+        \/\/ Without this, the rich selectlists are vulnerable to XSS.\\n+        \/\/ Many thanks to @uberbrady for this fix. It ain\\'t pretty,\\n+        \/\/ but it resolves the issue until Select2 addresses it on their end.\\n+        \/\/\\n+        \/\/ Bug was reported in 2016 :{\\n+        \/\/ https:\/\/github.com\/select2\/select2\/issues\/4587\\n+\\n+        return datalist.text.replace(\/>\/g, \\'&gt;\\')\\n+            .replace(\/<\/g, \\'&lt;\\')\\n+            .replace(\/\"\/g, \\'&quot;\\')\\n+            .replace(\/\\'\/g, \\'&#039;\\');\\n     }\\n \\n     \/\/ This handles the radio button selectors for the checkout-to-foo options'}}",
      "message_norm":"janky fix for select2 bug",
      "language":"en",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['resources\/assets\/js\/snipeit.js'])",
      "num_files":1.0,
      "patch_content":"From 5848d9a10c7d62c73ff6a3858edfae96a429402a Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Mon, 18 Mar 2019 19:29:30 -0700\nSubject: [PATCH] Janky fix for Select2 bug\n\n---\n resources\/assets\/js\/snipeit.js | 13 ++++++++++++-\n 1 file changed, 12 insertions(+), 1 deletion(-)\n\ndiff --git a\/resources\/assets\/js\/snipeit.js b\/resources\/assets\/js\/snipeit.js\nindex 4e3cb24b4ab5..e2e1dde39cc8 100755\n--- a\/resources\/assets\/js\/snipeit.js\n+++ b\/resources\/assets\/js\/snipeit.js\n@@ -260,7 +260,18 @@ $(document).ready(function () {\n     }\n \n     function formatDataSelection (datalist) {\n-        return datalist.text;\n+        \/\/ This a heinous workaround for a known bug in Select2.\n+        \/\/ Without this, the rich selectlists are vulnerable to XSS.\n+        \/\/ Many thanks to @uberbrady for this fix. It ain't pretty,\n+        \/\/ but it resolves the issue until Select2 addresses it on their end.\n+        \/\/\n+        \/\/ Bug was reported in 2016 :{\n+        \/\/ https:\/\/github.com\/select2\/select2\/issues\/4587\n+\n+        return datalist.text.replace(\/>\/g, '&gt;')\n+            .replace(\/<\/g, '&lt;')\n+            .replace(\/\"\/g, '&quot;')\n+            .replace(\/'\/g, '&#039;');\n     }\n \n     \/\/ This handles the radio button selectors for the checkout-to-foo options",
      "code_diff":"@@ -260,7 +260,18 @@ $(document).ready(function () {\n     }\n \n     function formatDataSelection (datalist) {\n-        return datalist.text;\n+        \/\/ This a heinous workaround for a known bug in Select2.\n+        \/\/ Without this, the rich selectlists are vulnerable to XSS.\n+        \/\/ Many thanks to @uberbrady for this fix. It ain't pretty,\n+        \/\/ but it resolves the issue until Select2 addresses it on their end.\n+        \/\/\n+        \/\/ Bug was reported in 2016 :{\n+        \/\/ https:\/\/github.com\/select2\/select2\/issues\/4587\n+\n+        return datalist.text.replace(\/>\/g, '&gt;')\n+            .replace(\/<\/g, '&lt;')\n+            .replace(\/\"\/g, '&quot;')\n+            .replace(\/'\/g, '&#039;');\n     }\n \n     \/\/ This handles the radio button selectors for the checkout-to-foo options"
    },
    {
      "index":58,
      "vuln_id":"GHSA-hxmr-5gv9-6p8v",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/librenms\/librenms\/commit\/4f86915866703e2fcd1e34b3fc1181ec2ad78e54'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in librenms Cross-site Scripting (XSS) - Stored in Packagist librenms\/librenms prior to 22.2.0.",
      "published_date":"2022-02-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/librenms\/librenms",
      "commit_href":"https:\/\/github.com\/librenms\/librenms\/commit\/4f86915866703e2fcd1e34b3fc1181ec2ad78e54",
      "commit_sha":"4f86915866703e2fcd1e34b3fc1181ec2ad78e54",
      "patch":"SINGLE",
      "chain_ord":"['4f86915866703e2fcd1e34b3fc1181ec2ad78e54']",
      "before_first_fix_commit":"{'3ac0de16b2767d4d4df25b89aa9439daf070b24c'}",
      "last_fix_commit":"4f86915866703e2fcd1e34b3fc1181ec2ad78e54",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/13\/2022, 18:07:37",
      "message":"XSS fix, cont. (#13776)\n\nhttps:\/\/huntr.dev\/bounties\/13951f51-deed-4a3d-8275-52306cc5a87d\/",
      "author":"PipoCanaja",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 3, 'total': 6}",
      "files":"{'includes\/html\/pages\/addhost.inc.php': {'additions': 3, 'deletions': 3, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/librenms\/librenms\/raw\/4f86915866703e2fcd1e34b3fc1181ec2ad78e54\/includes%2Fhtml%2Fpages%2Faddhost.inc.php', 'patch': \"@@ -45,9 +45,9 @@\\n             $snmpver = 'v2c';\\n             $additional = [\\n                 'snmp_disable' => 1,\\n-                'os'           => $_POST['os'] ? $_POST['os_id'] : 'ping',\\n-                'hardware'     => $_POST['hardware'],\\n-                'sysName'      => $_POST['sysName'],\\n+                'os'           => $_POST['os'] ? strip_tags($_POST['os_id']) : 'ping',\\n+                'hardware'     => strip_tags($_POST['hardware']),\\n+                'sysName'      => strip_tags($_POST['sysName']),\\n             ];\\n         } elseif ($_POST['snmpver'] === 'v2c' || $_POST['snmpver'] === 'v1') {\\n             if ($_POST['community']) {\"}}",
      "message_norm":"xss fix, cont. (#13776)\n\nhttps:\/\/huntr.dev\/bounties\/13951f51-deed-4a3d-8275-52306cc5a87d\/",
      "language":"ca",
      "entities":"[('xss', 'SECWORD', ''), ('#13776', 'ISSUE', ''), ('https:\/\/huntr.dev\/bounties\/13951f51-deed-4a3d-8275-52306cc5a87d\/', 'URL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['includes\/html\/pages\/addhost.inc.php'])",
      "num_files":1.0,
      "patch_content":"From 4f86915866703e2fcd1e34b3fc1181ec2ad78e54 Mon Sep 17 00:00:00 2001\nFrom: PipoCanaja <38363551+PipoCanaja@users.noreply.github.com>\nDate: Sun, 13 Feb 2022 19:07:37 +0100\nSubject: [PATCH] XSS fix, cont. (#13776)\n\nhttps:\/\/huntr.dev\/bounties\/13951f51-deed-4a3d-8275-52306cc5a87d\/\n---\n includes\/html\/pages\/addhost.inc.php | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\ndiff --git a\/includes\/html\/pages\/addhost.inc.php b\/includes\/html\/pages\/addhost.inc.php\nindex 07dc9e44ade5..c95135673560 100644\n--- a\/includes\/html\/pages\/addhost.inc.php\n+++ b\/includes\/html\/pages\/addhost.inc.php\n@@ -45,9 +45,9 @@\n             $snmpver = 'v2c';\n             $additional = [\n                 'snmp_disable' => 1,\n-                'os'           => $_POST['os'] ? $_POST['os_id'] : 'ping',\n-                'hardware'     => $_POST['hardware'],\n-                'sysName'      => $_POST['sysName'],\n+                'os'           => $_POST['os'] ? strip_tags($_POST['os_id']) : 'ping',\n+                'hardware'     => strip_tags($_POST['hardware']),\n+                'sysName'      => strip_tags($_POST['sysName']),\n             ];\n         } elseif ($_POST['snmpver'] === 'v2c' || $_POST['snmpver'] === 'v1') {\n             if ($_POST['community']) {",
      "code_diff":"@@ -45,9 +45,9 @@\n             $snmpver = 'v2c';\n             $additional = [\n                 'snmp_disable' => 1,\n-                'os'           => $_POST['os'] ? $_POST['os_id'] : 'ping',\n-                'hardware'     => $_POST['hardware'],\n-                'sysName'      => $_POST['sysName'],\n+                'os'           => $_POST['os'] ? strip_tags($_POST['os_id']) : 'ping',\n+                'hardware'     => strip_tags($_POST['hardware']),\n+                'sysName'      => strip_tags($_POST['sysName']),\n             ];\n         } elseif ($_POST['snmpver'] === 'v2c' || $_POST['snmpver'] === 'v1') {\n             if ($_POST['community']) {"
    },
    {
      "index":59,
      "vuln_id":"GHSA-mxh3-2699-98g9",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/b5a9ad65e5a4dde1916f02019f8686ad835681ce'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting pimcore pimcore version 10.3.0 and prior is vulnerable to cross-site scripting.",
      "published_date":"2022-02-09",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/b5a9ad65e5a4dde1916f02019f8686ad835681ce",
      "commit_sha":"b5a9ad65e5a4dde1916f02019f8686ad835681ce",
      "patch":"SINGLE",
      "chain_ord":"['b5a9ad65e5a4dde1916f02019f8686ad835681ce']",
      "before_first_fix_commit":"{'6ccb5c12fc1be065ebce9c89c4677ee939b88597'}",
      "last_fix_commit":"b5a9ad65e5a4dde1916f02019f8686ad835681ce",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/07\/2022, 14:23:39",
      "message":"[Admin] DataObject - Escape class definitions group properly",
      "author":"dpahuja",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/b5a9ad65e5a4dde1916f02019f8686ad835681ce\/bundles%2FAdminBundle%2FController%2FAdmin%2FDataObject%2FClassController.php', 'patch': \"@@ -861,7 +861,7 @@ public function fieldcollectionTreeAction(Request $request, EventDispatcherInter\\n                 if (!isset($groups[$item->getGroup()])) {\\n                     $groups[$item->getGroup()] = [\\n                         'id' => 'group_' . $item->getKey(),\\n-                        'text' => $item->getGroup(),\\n+                        'text' => htmlspecialchars($item->getGroup()),\\n                         'expandable' => true,\\n                         'leaf' => false,\\n                         'allowChildren' => true,\\n@@ -1266,7 +1266,7 @@ public function objectbrickTreeAction(Request $request, EventDispatcherInterface\\n                 if (!isset($groups[$item->getGroup()])) {\\n                     $groups[$item->getGroup()] = [\\n                         'id' => 'group_' . $item->getKey(),\\n-                        'text' => $item->getGroup(),\\n+                        'text' => htmlspecialchars($item->getGroup()),\\n                         'expandable' => true,\\n                         'leaf' => false,\\n                         'allowChildren' => true,\"}}",
      "message_norm":"[admin] dataobject - escape class definitions group properly",
      "language":"fr",
      "entities":"[('admin', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php'])",
      "num_files":1.0,
      "patch_content":"From b5a9ad65e5a4dde1916f02019f8686ad835681ce Mon Sep 17 00:00:00 2001\nFrom: dpahuja <divesh.pahuja@pimcore.com>\nDate: Mon, 7 Feb 2022 15:23:39 +0100\nSubject: [PATCH] [Admin] DataObject - Escape class definitions group properly\n\n---\n ...\/Controller\/Admin\/DataObject\/ClassController.php           | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php b\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php\nindex ac818bca628..a041274b7b3 100644\n--- a\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php\n+++ b\/bundles\/AdminBundle\/Controller\/Admin\/DataObject\/ClassController.php\n@@ -861,7 +861,7 @@ public function fieldcollectionTreeAction(Request $request, EventDispatcherInter\n                 if (!isset($groups[$item->getGroup()])) {\n                     $groups[$item->getGroup()] = [\n                         'id' => 'group_' . $item->getKey(),\n-                        'text' => $item->getGroup(),\n+                        'text' => htmlspecialchars($item->getGroup()),\n                         'expandable' => true,\n                         'leaf' => false,\n                         'allowChildren' => true,\n@@ -1266,7 +1266,7 @@ public function objectbrickTreeAction(Request $request, EventDispatcherInterface\n                 if (!isset($groups[$item->getGroup()])) {\n                     $groups[$item->getGroup()] = [\n                         'id' => 'group_' . $item->getKey(),\n-                        'text' => $item->getGroup(),\n+                        'text' => htmlspecialchars($item->getGroup()),\n                         'expandable' => true,\n                         'leaf' => false,\n                         'allowChildren' => true,",
      "code_diff":"@@ -861,7 +861,7 @@ public function fieldcollectionTreeAction(Request $request, EventDispatcherInter\n                 if (!isset($groups[$item->getGroup()])) {\n                     $groups[$item->getGroup()] = [\n                         'id' => 'group_' . $item->getKey(),\n-                        'text' => $item->getGroup(),\n+                        'text' => htmlspecialchars($item->getGroup()),\n                         'expandable' => true,\n                         'leaf' => false,\n                         'allowChildren' => true,\n@@ -1266,7 +1266,7 @@ public function objectbrickTreeAction(Request $request, EventDispatcherInterface\n                 if (!isset($groups[$item->getGroup()])) {\n                     $groups[$item->getGroup()] = [\n                         'id' => 'group_' . $item->getKey(),\n-                        'text' => $item->getGroup(),\n+                        'text' => htmlspecialchars($item->getGroup()),\n                         'expandable' => true,\n                         'leaf' => false,\n                         'allowChildren' => true,"
    },
    {
      "index":60,
      "vuln_id":"GHSA-5jgj-h9wp-53fr",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/idno\/known\/commit\/80b716a8392fb71cfce84d03aaf7c045c62f6350'}",
      "dataset":"osv",
      "summary":"Known vulnerable to code execution via SVG file in v1.3.1 An issue in the isSVG() function of Known v1.3.1 allows attackers to execute arbitrary code via a crafted SVG file.\n\nThe researcher report indicates that versions 1.3.1 and prior are vulnerable. Version 1.2.2 is the last version tagged on GitHub and in Packagist, and development related to the 1.3.x branch is currently on the `dev` branch of the idno\/known repository.",
      "published_date":"2022-07-09",
      "chain_len":1,
      "project":"https:\/\/github.com\/idno\/known",
      "commit_href":"https:\/\/github.com\/idno\/known\/commit\/80b716a8392fb71cfce84d03aaf7c045c62f6350",
      "commit_sha":"80b716a8392fb71cfce84d03aaf7c045c62f6350",
      "patch":"SINGLE",
      "chain_ord":"['80b716a8392fb71cfce84d03aaf7c045c62f6350']",
      "before_first_fix_commit":"{'e86e779cf1db93cd488ee578e92a16008132a114'}",
      "last_fix_commit":"80b716a8392fb71cfce84d03aaf7c045c62f6350",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/18\/2021, 15:44:26",
      "message":"Checking for script tags in GIFs etc (#3017)",
      "author":"Ben Werdmuller",
      "comments":null,
      "stats":"{'additions': 14, 'deletions': 0, 'total': 14}",
      "files":"{'Idno\/Entities\/File.php': {'additions': 14, 'deletions': 0, 'changes': 14, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/idno\/known\/raw\/80b716a8392fb71cfce84d03aaf7c045c62f6350\/Idno%2FEntities%2FFile.php', 'patch': \"@@ -285,6 +285,20 @@ public static function isImage($file_path)\\n             return false;\\n         }\\n \\n+        \/**\\n+         * Detects whether the file contains PHP or script tags, eg to check for embedded code in GIFs\\n+         * @param $file_path\\n+         * @return bool\\n+         *\/\\n+        public static function isFileFreeFromScriptTags($file_path)\\n+        {\\n+            if ($contents = file_get_contents($file_path)) {\\n+                if (stripos($contents, '<script') || strpos($contents, '<?')) return false;\\n+                return true;\\n+            }\\n+            return false;\\n+        }\\n+\\n         \/**\\n          * Retrieve a file by ID\\n          *\"}}",
      "message_norm":"checking for script tags in gifs etc (#3017)",
      "language":"en",
      "entities":"[('#3017', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['Idno\/Entities\/File.php'])",
      "num_files":1.0,
      "patch_content":"From 80b716a8392fb71cfce84d03aaf7c045c62f6350 Mon Sep 17 00:00:00 2001\nFrom: Ben Werdmuller <ben@benwerd.com>\nDate: Thu, 18 Nov 2021 10:44:26 -0500\nSubject: [PATCH] Checking for script tags in GIFs etc (#3017)\n\n---\n Idno\/Entities\/File.php | 14 ++++++++++++++\n 1 file changed, 14 insertions(+)\n\ndiff --git a\/Idno\/Entities\/File.php b\/Idno\/Entities\/File.php\nindex 568a3b2e48..fffa8301c3 100644\n--- a\/Idno\/Entities\/File.php\n+++ b\/Idno\/Entities\/File.php\n@@ -285,6 +285,20 @@ public static function isImage($file_path)\n             return false;\n         }\n \n+        \/**\n+         * Detects whether the file contains PHP or script tags, eg to check for embedded code in GIFs\n+         * @param $file_path\n+         * @return bool\n+         *\/\n+        public static function isFileFreeFromScriptTags($file_path)\n+        {\n+            if ($contents = file_get_contents($file_path)) {\n+                if (stripos($contents, '<script') || strpos($contents, '<?')) return false;\n+                return true;\n+            }\n+            return false;\n+        }\n+\n         \/**\n          * Retrieve a file by ID\n          *",
      "code_diff":"@@ -285,6 +285,20 @@ public static function isImage($file_path)\n             return false;\n         }\n \n+        \/**\n+         * Detects whether the file contains PHP or script tags, eg to check for embedded code in GIFs\n+         * @param $file_path\n+         * @return bool\n+         *\/\n+        public static function isFileFreeFromScriptTags($file_path)\n+        {\n+            if ($contents = file_get_contents($file_path)) {\n+                if (stripos($contents, '<script') || strpos($contents, '<?')) return false;\n+                return true;\n+            }\n+            return false;\n+        }\n+\n         \/**\n          * Retrieve a file by ID\n          *"
    },
    {
      "index":61,
      "vuln_id":"GHSA-cg3h-rc9q-g8v9",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/6ccb5c12fc1be065ebce9c89c4677ee939b88597'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in pimcore pimcore version 10.3.0 and prior is vulnerable to cross-site scripting.",
      "published_date":"2022-02-09",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/6ccb5c12fc1be065ebce9c89c4677ee939b88597",
      "commit_sha":"6ccb5c12fc1be065ebce9c89c4677ee939b88597",
      "patch":"SINGLE",
      "chain_ord":"['6ccb5c12fc1be065ebce9c89c4677ee939b88597']",
      "before_first_fix_commit":"{'7b6b2229ed3f19da1632afcbf9b8fec6d768faad'}",
      "last_fix_commit":"6ccb5c12fc1be065ebce9c89c4677ee939b88597",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/07\/2022, 12:03:58",
      "message":"[Admin] Website Settings - Escape grid values properly",
      "author":"dpahuja",
      "comments":null,
      "stats":"{'additions': 19, 'deletions': 7, 'total': 26}",
      "files":"{'bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/settings\/website.js': {'additions': 19, 'deletions': 7, 'changes': 26, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/6ccb5c12fc1be065ebce9c89c4677ee939b88597\/bundles%2FAdminBundle%2FResources%2Fpublic%2Fjs%2Fpimcore%2Fsettings%2Fwebsite.js', 'patch': '@@ -36,7 +36,7 @@ pimcore.settings.website = Class.create({\\n                 border:false,\\n                 layout:\"fit\",\\n                 closable:true,\\n-                items:[this.getRowEditor()]\\n+                items:[this.getRowEditor()],\\n             });\\n \\n             var tabPanel = Ext.getCmp(\"pimcore_panel_tabs\");\\n@@ -133,6 +133,7 @@ pimcore.settings.website = Class.create({\\n                 dataIndex: \\'data\\',\\n                 flex: 300,\\n                 editable: true,\\n+                editor: new Ext.form.TextField({}),\\n                 renderer: this.getCellRenderer.bind(this),\\n             },\\n             {text: t(\"site\"), flex: 100, sortable:true, dataIndex: \"siteId\",\\n@@ -303,7 +304,10 @@ pimcore.settings.website = Class.create({\\n             bodyCls: \"pimcore_editable_grid\",\\n             stripeRows:true,\\n             columns : {\\n-                items: typesColumns\\n+                items: typesColumns,\\n+                defaults: {\\n+                    renderer: Ext.util.Format.htmlEncode\\n+                },\\n             },\\n             sm:  Ext.create(\\'Ext.selection.RowModel\\', {}),\\n             bbar:this.pagingtoolbar,\\n@@ -359,15 +363,23 @@ pimcore.settings.website = Class.create({\\n     },\\n \\n     getCellEditor: function (record) {\\n-        var data = record.data;\\n+        let data = record.data;\\n \\n-        var type = data.type;\\n-        var property;\\n+        let type = data.type;\\n+        let property;\\n \\n         if (type === \"text\") {\\n-            property = Ext.create(\\'Ext.form.TextField\\');\\n+            property = {\\n+                xtype: \\'textfield\\',\\n+                flex: 1,\\n+                value: data.data\\n+            }\\n         } else if (type == \"textarea\") {\\n-            property = Ext.create(\\'Ext.form.TextArea\\');\\n+            property = {\\n+                xtype: \"textarea\",\\n+                flex: 1,\\n+                value: data.data\\n+            }\\n         } else if (type == \"document\" || type == \"asset\" || type == \"object\") {\\n             property = {\\n                 xtype: \\'textfield\\','}}",
      "message_norm":"[admin] website settings - escape grid values properly",
      "language":"af",
      "entities":"[('admin', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/settings\/website.js'])",
      "num_files":1.0,
      "patch_content":"From 6ccb5c12fc1be065ebce9c89c4677ee939b88597 Mon Sep 17 00:00:00 2001\nFrom: dpahuja <divesh.pahuja@pimcore.com>\nDate: Mon, 7 Feb 2022 13:03:58 +0100\nSubject: [PATCH] [Admin] Website Settings - Escape grid values properly\n\n---\n ...\/public\/js\/pimcore\/settings\/website.js     | 26 ++++++++++++++-----\n 1 file changed, 19 insertions(+), 7 deletions(-)\n\ndiff --git a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/settings\/website.js b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/settings\/website.js\nindex b522d6fd2d3..f19115b0e41 100644\n--- a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/settings\/website.js\n+++ b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/settings\/website.js\n@@ -36,7 +36,7 @@ pimcore.settings.website = Class.create({\n                 border:false,\n                 layout:\"fit\",\n                 closable:true,\n-                items:[this.getRowEditor()]\n+                items:[this.getRowEditor()],\n             });\n \n             var tabPanel = Ext.getCmp(\"pimcore_panel_tabs\");\n@@ -133,6 +133,7 @@ pimcore.settings.website = Class.create({\n                 dataIndex: 'data',\n                 flex: 300,\n                 editable: true,\n+                editor: new Ext.form.TextField({}),\n                 renderer: this.getCellRenderer.bind(this),\n             },\n             {text: t(\"site\"), flex: 100, sortable:true, dataIndex: \"siteId\",\n@@ -303,7 +304,10 @@ pimcore.settings.website = Class.create({\n             bodyCls: \"pimcore_editable_grid\",\n             stripeRows:true,\n             columns : {\n-                items: typesColumns\n+                items: typesColumns,\n+                defaults: {\n+                    renderer: Ext.util.Format.htmlEncode\n+                },\n             },\n             sm:  Ext.create('Ext.selection.RowModel', {}),\n             bbar:this.pagingtoolbar,\n@@ -359,15 +363,23 @@ pimcore.settings.website = Class.create({\n     },\n \n     getCellEditor: function (record) {\n-        var data = record.data;\n+        let data = record.data;\n \n-        var type = data.type;\n-        var property;\n+        let type = data.type;\n+        let property;\n \n         if (type === \"text\") {\n-            property = Ext.create('Ext.form.TextField');\n+            property = {\n+                xtype: 'textfield',\n+                flex: 1,\n+                value: data.data\n+            }\n         } else if (type == \"textarea\") {\n-            property = Ext.create('Ext.form.TextArea');\n+            property = {\n+                xtype: \"textarea\",\n+                flex: 1,\n+                value: data.data\n+            }\n         } else if (type == \"document\" || type == \"asset\" || type == \"object\") {\n             property = {\n                 xtype: 'textfield',",
      "code_diff":"@@ -36,7 +36,7 @@ pimcore.settings.website = Class.create({\n                 border:false,\n                 layout:\"fit\",\n                 closable:true,\n-                items:[this.getRowEditor()]\n+                items:[this.getRowEditor()],\n             });\n \n             var tabPanel = Ext.getCmp(\"pimcore_panel_tabs\");\n@@ -133,6 +133,7 @@ pimcore.settings.website = Class.create({\n                 dataIndex: 'data',\n                 flex: 300,\n                 editable: true,\n+                editor: new Ext.form.TextField({}),\n                 renderer: this.getCellRenderer.bind(this),\n             },\n             {text: t(\"site\"), flex: 100, sortable:true, dataIndex: \"siteId\",\n@@ -303,7 +304,10 @@ pimcore.settings.website = Class.create({\n             bodyCls: \"pimcore_editable_grid\",\n             stripeRows:true,\n             columns : {\n-                items: typesColumns\n+                items: typesColumns,\n+                defaults: {\n+                    renderer: Ext.util.Format.htmlEncode\n+                },\n             },\n             sm:  Ext.create('Ext.selection.RowModel', {}),\n             bbar:this.pagingtoolbar,\n@@ -359,15 +363,23 @@ pimcore.settings.website = Class.create({\n     },\n \n     getCellEditor: function (record) {\n-        var data = record.data;\n+        let data = record.data;\n \n-        var type = data.type;\n-        var property;\n+        let type = data.type;\n+        let property;\n \n         if (type === \"text\") {\n-            property = Ext.create('Ext.form.TextField');\n+            property = {\n+                xtype: 'textfield',\n+                flex: 1,\n+                value: data.data\n+            }\n         } else if (type == \"textarea\") {\n-            property = Ext.create('Ext.form.TextArea');\n+            property = {\n+                xtype: \"textarea\",\n+                flex: 1,\n+                value: data.data\n+            }\n         } else if (type == \"document\" || type == \"asset\" || type == \"object\") {\n             property = {\n                 xtype: 'textfield',"
    },
    {
      "index":62,
      "vuln_id":"GHSA-73q9-7pwj-gm46",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/icecoder\/icecoder\/commit\/51cf24b2a39138e6a7b5739ef59eb38cd7c39763'}",
      "dataset":"osv",
      "summary":"icecoder is vulnerable to Cross-site Scripting icecoder is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2022-01-21",
      "chain_len":1,
      "project":"https:\/\/github.com\/icecoder\/icecoder",
      "commit_href":"https:\/\/github.com\/icecoder\/icecoder\/commit\/51cf24b2a39138e6a7b5739ef59eb38cd7c39763",
      "commit_sha":"51cf24b2a39138e6a7b5739ef59eb38cd7c39763",
      "patch":"SINGLE",
      "chain_ord":"['51cf24b2a39138e6a7b5739ef59eb38cd7c39763']",
      "before_first_fix_commit":"{'cd964f816f31828011593405e024ee3b4c0f6ed3'}",
      "last_fix_commit":"51cf24b2a39138e6a7b5739ef59eb38cd7c39763",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/17\/2022, 12:38:29",
      "message":"rXSS cleaned username in editor info display",
      "author":"Matt Pass",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'editor.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/icecoder\/ICEcoder\/raw\/51cf24b2a39138e6a7b5739ef59eb38cd7c39763\/editor.php', 'patch': '@@ -150,7 +150,7 @@\\n             ?>\\n             <h2><?php echo $t[\\'multi-user\\']; ?><\/h2>\\n             <span class=\"heading\"><?php echo $t[\\'Username\\']; ?><\/span><br>\\n-            <?php echo $_SESSION[\\'username\\'];?><br><br>\\n+            <?php echo xssClean($_SESSION[\\'username\\'], \"html\");?><br><br>\\n             <?php\\n         }\\n         ?>'}}",
      "message_norm":"rxss cleaned username in editor info display",
      "language":"en",
      "entities":"[('rxss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['editor.php'])",
      "num_files":1.0,
      "patch_content":"From 51cf24b2a39138e6a7b5739ef59eb38cd7c39763 Mon Sep 17 00:00:00 2001\nFrom: Matt Pass <matt@mattpass.com>\nDate: Mon, 17 Jan 2022 12:38:29 +0000\nSubject: [PATCH] rXSS cleaned username in editor info display\n\n---\n editor.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/editor.php b\/editor.php\nindex 417ba43f..7b7fa26f 100644\n--- a\/editor.php\n+++ b\/editor.php\n@@ -150,7 +150,7 @@\n             ?>\n             <h2><?php echo $t['multi-user']; ?><\/h2>\n             <span class=\"heading\"><?php echo $t['Username']; ?><\/span><br>\n-            <?php echo $_SESSION['username'];?><br><br>\n+            <?php echo xssClean($_SESSION['username'], \"html\");?><br><br>\n             <?php\n         }\n         ?>",
      "code_diff":"@@ -150,7 +150,7 @@\n             ?>\n             <h2><?php echo $t['multi-user']; ?><\/h2>\n             <span class=\"heading\"><?php echo $t['Username']; ?><\/span><br>\n-            <?php echo $_SESSION['username'];?><br><br>\n+            <?php echo xssClean($_SESSION['username'], \"html\");?><br><br>\n             <?php\n         }\n         ?>"
    },
    {
      "index":63,
      "vuln_id":"GHSA-fc38-mxwr-pfhx",
      "cwe_id":"{'CWE-79'}",
      "score":8.0,
      "chain":"{'https:\/\/github.com\/shopware\/platform\/commit\/abe9f69e1f667800f974acccd3047b4930e4b423'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting via SVG media files ### Impact\nCross-Site Scripting via SVG media files\n\n### Patches\nWe recommend updating to the current version 6.4.3.1. You can get the update to 6.4.3.1 regularly via the Auto-Updater or directly via the download overview.\n\nhttps:\/\/www.shopware.com\/en\/download\/#shopware-6\n\n### Workarounds\nFor older versions of 6.1, 6.2, and 6.3, corresponding security measures are also available via a plugin. For the full range of functions, we recommend updating to the latest Shopware version.",
      "published_date":"2021-08-23",
      "chain_len":1,
      "project":"https:\/\/github.com\/shopware\/platform",
      "commit_href":"https:\/\/github.com\/shopware\/platform\/commit\/abe9f69e1f667800f974acccd3047b4930e4b423",
      "commit_sha":"abe9f69e1f667800f974acccd3047b4930e4b423",
      "patch":"SINGLE",
      "chain_ord":"['abe9f69e1f667800f974acccd3047b4930e4b423']",
      "before_first_fix_commit":"{'912b96de3b839c6c5525c98cbb58f537c2d838be'}",
      "last_fix_commit":"abe9f69e1f667800f974acccd3047b4930e4b423",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/27\/2021, 13:31:10",
      "message":"NEXT-15677 - Fix XSS for SVG files",
      "author":"Jonas Elfering",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'public\/.htaccess.dist': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/shopware\/platform\/raw\/abe9f69e1f667800f974acccd3047b4930e4b423\/public%2F.htaccess.dist', 'patch': '@@ -36,7 +36,7 @@ DirectoryIndex index.php\\n <\/IfModule>\\n \\n <IfModule mod_headers.c>\\n-    <FilesMatch \"\\\\.svg$\">\\n+    <FilesMatch \"\\\\.(?i:svg)$\">\\n         Header set Content-Security-Policy \"script-src \\'none\\'\"\\n     <\/FilesMatch>\\n <\/IfModule>'}}",
      "message_norm":"next-15677 - fix xss for svg files",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['public\/.htaccess.dist'])",
      "num_files":1.0,
      "patch_content":"From abe9f69e1f667800f974acccd3047b4930e4b423 Mon Sep 17 00:00:00 2001\nFrom: Jonas Elfering <j.elfering@shopware.com>\nDate: Tue, 27 Jul 2021 15:31:10 +0200\nSubject: [PATCH] NEXT-15677 - Fix XSS for SVG files\n\n---\n public\/.htaccess.dist | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/public\/.htaccess.dist b\/public\/.htaccess.dist\nindex c81ffef81e5..62601e581c2 100644\n--- a\/public\/.htaccess.dist\n+++ b\/public\/.htaccess.dist\n@@ -36,7 +36,7 @@ DirectoryIndex index.php\n <\/IfModule>\n \n <IfModule mod_headers.c>\n-    <FilesMatch \"\\.svg$\">\n+    <FilesMatch \"\\.(?i:svg)$\">\n         Header set Content-Security-Policy \"script-src 'none'\"\n     <\/FilesMatch>\n <\/IfModule>",
      "code_diff":"@@ -36,7 +36,7 @@ DirectoryIndex index.php\n <\/IfModule>\n \n <IfModule mod_headers.c>\n-    <FilesMatch \"\\.svg$\">\n+    <FilesMatch \"\\.(?i:svg)$\">\n         Header set Content-Security-Policy \"script-src 'none'\"\n     <\/FilesMatch>\n <\/IfModule>"
    },
    {
      "index":64,
      "vuln_id":"GHSA-2v5j-q74q-r53f",
      "cwe_id":"{'CWE-79'}",
      "score":8.8,
      "chain":"{'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/a22eb0673fe0b7784f99c6b5fd343b64a6700f06'}",
      "dataset":"osv",
      "summary":"django-helpdesk is vulnerable to Cross-site Scripting django-helpdesk is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').",
      "published_date":"2021-12-03",
      "chain_len":1,
      "project":"https:\/\/github.com\/django-helpdesk\/django-helpdesk",
      "commit_href":"https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/a22eb0673fe0b7784f99c6b5fd343b64a6700f06",
      "commit_sha":"a22eb0673fe0b7784f99c6b5fd343b64a6700f06",
      "patch":"SINGLE",
      "chain_ord":"['a22eb0673fe0b7784f99c6b5fd343b64a6700f06']",
      "before_first_fix_commit":"{'7097c9c4c0b255ec1f10f3ea14fa2b9c47f6c706'}",
      "last_fix_commit":"a22eb0673fe0b7784f99c6b5fd343b64a6700f06",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/19\/2021, 16:11:33",
      "message":"Update pattern",
      "author":"noobpk",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'helpdesk\/models.py': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/raw\/a22eb0673fe0b7784f99c6b5fd343b64a6700f06\/helpdesk%2Fmodels.py', 'patch': '@@ -56,7 +56,7 @@ def get_markdown(text):\\n     if not text:\\n         return \"\"\\n \\n-    pattern = fr\\'([\\\\[\\\\s\\\\S\\\\]]*?)\\\\(([\\\\s\\\\S]*?):([\\\\[\\\\s\\\\S\\\\]]*?)\\\\)\\'\\n+    pattern = fr\\'([\\\\[\\\\s\\\\S\\\\]]*?)\\\\(([\\\\s\\\\S]*?):([\\\\s\\\\S]*?)\\\\)\\'\\n     # Regex check\\n     if re.match(pattern, text):\\n         # get get value of group regex'}}",
      "message_norm":"update pattern",
      "language":"it",
      "entities":null,
      "classification_level_1":"POORLY_DOCUMENTED",
      "classification_level_2":"REDUNDANT_MESSAGE",
      "list_files":"dict_keys(['helpdesk\/models.py'])",
      "num_files":1.0,
      "patch_content":"From a22eb0673fe0b7784f99c6b5fd343b64a6700f06 Mon Sep 17 00:00:00 2001\nFrom: noobpk <ltp.noobpk@gmail.com>\nDate: Fri, 19 Nov 2021 23:11:33 +0700\nSubject: [PATCH] Update pattern\n\n---\n helpdesk\/models.py | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/helpdesk\/models.py b\/helpdesk\/models.py\nindex 31bed5df6..f8ffb8b11 100644\n--- a\/helpdesk\/models.py\n+++ b\/helpdesk\/models.py\n@@ -56,7 +56,7 @@ def get_markdown(text):\n     if not text:\n         return \"\"\n \n-    pattern = fr'([\\[\\s\\S\\]]*?)\\(([\\s\\S]*?):([\\[\\s\\S\\]]*?)\\)'\n+    pattern = fr'([\\[\\s\\S\\]]*?)\\(([\\s\\S]*?):([\\s\\S]*?)\\)'\n     # Regex check\n     if re.match(pattern, text):\n         # get get value of group regex",
      "code_diff":"@@ -56,7 +56,7 @@ def get_markdown(text):\n     if not text:\n         return \"\"\n \n-    pattern = fr'([\\[\\s\\S\\]]*?)\\(([\\s\\S]*?):([\\[\\s\\S\\]]*?)\\)'\n+    pattern = fr'([\\[\\s\\S\\]]*?)\\(([\\s\\S]*?):([\\s\\S]*?)\\)'\n     # Regex check\n     if re.match(pattern, text):\n         # get get value of group regex"
    },
    {
      "index":65,
      "vuln_id":"GHSA-rfw2-x9f8-2f6m",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/linkedin\/oncall\/commit\/843bc106a1c1b1699e9e52b6b0d01c7efe1d6225'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting LinkedIn Oncall through 1.4.0 allows reflected XSS via \/query because of mishandling of the \"No results found for\" message in the search bar.",
      "published_date":"2021-04-30",
      "chain_len":1,
      "project":"https:\/\/github.com\/linkedin\/oncall",
      "commit_href":"https:\/\/github.com\/linkedin\/oncall\/commit\/843bc106a1c1b1699e9e52b6b0d01c7efe1d6225",
      "commit_sha":"843bc106a1c1b1699e9e52b6b0d01c7efe1d6225",
      "patch":"SINGLE",
      "chain_ord":"['843bc106a1c1b1699e9e52b6b0d01c7efe1d6225']",
      "before_first_fix_commit":"{'605d10ef5d68181b2c516dc857fdc3c8575539cd'}",
      "last_fix_commit":"843bc106a1c1b1699e9e52b6b0d01c7efe1d6225",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/05\/2021, 23:30:43",
      "message":"prevent potential XSS from searchbar results (#342)\n\n* prevent potential XSS from searchbar results\r\n\r\n* use built in handlebars expression escaping\r\n\r\n* use handlebars encodeURIComponent",
      "author":"Diego Cepeda",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 4, 'total': 8}",
      "files":"{'src\/oncall\/ui\/static\/js\/oncall.js': {'additions': 4, 'deletions': 4, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/linkedin\/oncall\/raw\/843bc106a1c1b1699e9e52b6b0d01c7efe1d6225\/src%2Foncall%2Fui%2Fstatic%2Fjs%2Foncall.js', 'patch': '@@ -579,11 +579,11 @@ var oncall = {\\n               },\\n               footer: function(resp){\\n                 if (teamsCt > typeaheadLimit) {\\n-                  return \\'<div class=\"tt-see-all\"><a href=\"\/query\/\\' + resp.query + \\'\/teams\" data-navigo> See all \\' + teamsCt + \\' results for teams \u00bb<\/a><\/div>\\';\\n+                  return \\'<div class=\"tt-see-all\"><a href=\"\/query\/\\' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + \\'\/teams\" data-navigo> See all \\' + teamsCt + \\' results for teams \u00bb<\/a><\/div>\\';\\n                 }\\n               },\\n               empty: function(resp){\\n-                return \\'<h4> No results found for \"\\' + resp.query + \\'\" <\/h4>\\';\\n+                return \\'<h4> No results found for \"\\' + Handlebars.escapeExpression(resp.query) + \\'\" <\/h4>\\';\\n               }\\n             }\\n           },\\n@@ -604,7 +604,7 @@ var oncall = {\\n               },\\n               footer: function(resp){\\n                 if (servicesCt > typeaheadLimit) {\\n-                  return \\'<div class=\"tt-see-all\"><a href=\"\/query\/\\' + resp.query + \\'\/services\" data-navigo> See all \\' + servicesCt + \\' results for services \u00bb<\/a><\/div>\\';\\n+                  return \\'<div class=\"tt-see-all\"><a href=\"\/query\/\\' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + \\'\/services\" data-navigo> See all \\' + servicesCt + \\' results for services \u00bb<\/a><\/div>\\';\\n                 }\\n               }\\n             }\\n@@ -626,7 +626,7 @@ var oncall = {\\n               },\\n               footer: function(resp){\\n                 if (usersCt > typeaheadLimit) {\\n-                  return \\'<div class=\"tt-see-all\"><a href=\"\/query\/\\' + resp.query + \\'\/users\" data-navigo> See all \\' + usersCt + \\' results for users \u00bb<\/a><\/div>\\';\\n+                  return \\'<div class=\"tt-see-all\"><a href=\"\/query\/\\' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + \\'\/users\" data-navigo> See all \\' + usersCt + \\' results for users \u00bb<\/a><\/div>\\';\\n                 }\\n               }\\n             }'}}",
      "message_norm":"prevent potential xss from searchbar results (#342)\n\n* prevent potential xss from searchbar results\r\n\r\n* use built in handlebars expression escaping\r\n\r\n* use handlebars encodeuricomponent",
      "language":"en",
      "entities":"[('prevent', 'ACTION', ''), ('xss', 'SECWORD', ''), ('#342', 'ISSUE', ''), ('prevent', 'ACTION', ''), ('xss', 'SECWORD', ''), ('escaping', 'SECWORD', ''), ('encodeuricomponent', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/oncall\/ui\/static\/js\/oncall.js'])",
      "num_files":1.0,
      "patch_content":"From 843bc106a1c1b1699e9e52b6b0d01c7efe1d6225 Mon Sep 17 00:00:00 2001\nFrom: Diego Cepeda <dcepeda@linkedin.com>\nDate: Fri, 5 Feb 2021 15:30:43 -0800\nSubject: [PATCH] prevent potential XSS from searchbar results (#342)\n\n* prevent potential XSS from searchbar results\n\n* use built in handlebars expression escaping\n\n* use handlebars encodeURIComponent\n---\n src\/oncall\/ui\/static\/js\/oncall.js | 8 ++++----\n 1 file changed, 4 insertions(+), 4 deletions(-)\n\ndiff --git a\/src\/oncall\/ui\/static\/js\/oncall.js b\/src\/oncall\/ui\/static\/js\/oncall.js\nindex 9189bd8d..022985e2 100644\n--- a\/src\/oncall\/ui\/static\/js\/oncall.js\n+++ b\/src\/oncall\/ui\/static\/js\/oncall.js\n@@ -579,11 +579,11 @@ var oncall = {\n               },\n               footer: function(resp){\n                 if (teamsCt > typeaheadLimit) {\n-                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + resp.query + '\/teams\" data-navigo> See all ' + teamsCt + ' results for teams \u00bb<\/a><\/div>';\n+                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + '\/teams\" data-navigo> See all ' + teamsCt + ' results for teams \u00bb<\/a><\/div>';\n                 }\n               },\n               empty: function(resp){\n-                return '<h4> No results found for \"' + resp.query + '\" <\/h4>';\n+                return '<h4> No results found for \"' + Handlebars.escapeExpression(resp.query) + '\" <\/h4>';\n               }\n             }\n           },\n@@ -604,7 +604,7 @@ var oncall = {\n               },\n               footer: function(resp){\n                 if (servicesCt > typeaheadLimit) {\n-                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + resp.query + '\/services\" data-navigo> See all ' + servicesCt + ' results for services \u00bb<\/a><\/div>';\n+                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + '\/services\" data-navigo> See all ' + servicesCt + ' results for services \u00bb<\/a><\/div>';\n                 }\n               }\n             }\n@@ -626,7 +626,7 @@ var oncall = {\n               },\n               footer: function(resp){\n                 if (usersCt > typeaheadLimit) {\n-                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + resp.query + '\/users\" data-navigo> See all ' + usersCt + ' results for users \u00bb<\/a><\/div>';\n+                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + '\/users\" data-navigo> See all ' + usersCt + ' results for users \u00bb<\/a><\/div>';\n                 }\n               }\n             }",
      "code_diff":"@@ -579,11 +579,11 @@ var oncall = {\n               },\n               footer: function(resp){\n                 if (teamsCt > typeaheadLimit) {\n-                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + resp.query + '\/teams\" data-navigo> See all ' + teamsCt + ' results for teams \u00bb<\/a><\/div>';\n+                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + '\/teams\" data-navigo> See all ' + teamsCt + ' results for teams \u00bb<\/a><\/div>';\n                 }\n               },\n               empty: function(resp){\n-                return '<h4> No results found for \"' + resp.query + '\" <\/h4>';\n+                return '<h4> No results found for \"' + Handlebars.escapeExpression(resp.query) + '\" <\/h4>';\n               }\n             }\n           },\n@@ -604,7 +604,7 @@ var oncall = {\n               },\n               footer: function(resp){\n                 if (servicesCt > typeaheadLimit) {\n-                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + resp.query + '\/services\" data-navigo> See all ' + servicesCt + ' results for services \u00bb<\/a><\/div>';\n+                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + '\/services\" data-navigo> See all ' + servicesCt + ' results for services \u00bb<\/a><\/div>';\n                 }\n               }\n             }\n@@ -626,7 +626,7 @@ var oncall = {\n               },\n               footer: function(resp){\n                 if (usersCt > typeaheadLimit) {\n-                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + resp.query + '\/users\" data-navigo> See all ' + usersCt + ' results for users \u00bb<\/a><\/div>';\n+                  return '<div class=\"tt-see-all\"><a href=\"\/query\/' + Handlebars.escapeExpression(encodeURIComponent(resp.query)) + '\/users\" data-navigo> See all ' + usersCt + ' results for users \u00bb<\/a><\/div>';\n                 }\n               }\n             }"
    },
    {
      "index":66,
      "vuln_id":"GHSA-jff5-55xj-4jcq",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/jenkinsci\/jenkins\/commit\/307ed31caba68a46426b8c73a787a05add2c7489'}",
      "dataset":"osv",
      "summary":"Improper Neutralization of Input During Web Page Generation in Jenkins jenkins before versions 2.44, 2.32.2 is vulnerable to a persisted cross-site scripting in search suggestions due to improperly escaping users with less-than and greater-than characters in their names (SECURITY-388).",
      "published_date":"2022-05-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/jenkinsci\/jenkins",
      "commit_href":"https:\/\/github.com\/jenkinsci\/jenkins\/commit\/307ed31caba68a46426b8c73a787a05add2c7489",
      "commit_sha":"307ed31caba68a46426b8c73a787a05add2c7489",
      "patch":"SINGLE",
      "chain_ord":"['307ed31caba68a46426b8c73a787a05add2c7489']",
      "before_first_fix_commit":"{'97a61a9fe55f4c16168c123f98301a5173b9fa86', '7ae469770fd10c79bebc07511cd0ab1cafd33292'}",
      "last_fix_commit":"307ed31caba68a46426b8c73a787a05add2c7489",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/10\/2017, 22:21:40",
      "message":"Merge pull request #98 from jenkinsci-cert\/SECURITY-388\n\n[SECURITY-388] Escape metacharacters in the search box",
      "author":"Jesse Glick",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'war\/src\/main\/webapp\/scripts\/hudson-behavior.js': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jenkinsci\/jenkins\/raw\/307ed31caba68a46426b8c73a787a05add2c7489\/war%2Fsrc%2Fmain%2Fwebapp%2Fscripts%2Fhudson-behavior.js', 'patch': '@@ -2168,6 +2168,7 @@ function createSearchBox(searchURL) {\\n     var ac = new YAHOO.widget.AutoComplete(\"search-box\",\"search-box-completion\",ds);\\n     ac.typeAhead = false;\\n     ac.autoHighlight = false;\\n+    ac.formatResult = ac.formatEscapedResult;\\n \\n     var box   = $(\"search-box\");\\n     var sizer = $(\"search-box-sizer\");'}}",
      "message_norm":"merge pull request #98 from jenkinsci-cert\/security-388\n\n[security-388] escape metacharacters in the search box",
      "language":"en",
      "entities":"[('#98', 'ISSUE', ''), ('security-388', 'SECWORD', ''), ('security-388', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['war\/src\/main\/webapp\/scripts\/hudson-behavior.js'])",
      "num_files":1.0,
      "patch_content":"From 7ae469770fd10c79bebc07511cd0ab1cafd33292 Mon Sep 17 00:00:00 2001\nFrom: Jesse Glick <jglick@cloudbees.com>\nDate: Fri, 6 Jan 2017 14:26:57 -0500\nSubject: [PATCH] [SECURITY-388] Escape metacharacters in the search box.\n\n---\n war\/src\/main\/webapp\/scripts\/hudson-behavior.js | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js b\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js\nindex 22d85fd27ed9..77a4c41b34e3 100644\n--- a\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js\n+++ b\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js\n@@ -2168,6 +2168,7 @@ function createSearchBox(searchURL) {\n     var ac = new YAHOO.widget.AutoComplete(\"search-box\",\"search-box-completion\",ds);\n     ac.typeAhead = false;\n     ac.autoHighlight = false;\n+    ac.formatResult = ac.formatEscapedResult;\n \n     var box   = $(\"search-box\");\n     var sizer = $(\"search-box-sizer\");",
      "code_diff":"@@ -2168,6 +2168,7 @@ function createSearchBox(searchURL) {\n     var ac = new YAHOO.widget.AutoComplete(\"search-box\",\"search-box-completion\",ds);\n     ac.typeAhead = false;\n     ac.autoHighlight = false;\n+    ac.formatResult = ac.formatEscapedResult;\n \n     var box   = $(\"search-box\");\n     var sizer = $(\"search-box-sizer\");"
    },
    {
      "index":67,
      "vuln_id":"GHSA-wvh5-78h5-gmgr",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/moodle\/moodle\/commit\/6abe964bbac41b5e40a81b40962f7044b0dc201e'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in moodle A flaw was found in moodle where ID numbers displayed when bulk allocating markers to assignments required additional sanitizing to prevent a stored XSS risk.",
      "published_date":"2022-05-19",
      "chain_len":1,
      "project":"https:\/\/github.com\/moodle\/moodle",
      "commit_href":"https:\/\/github.com\/moodle\/moodle\/commit\/6abe964bbac41b5e40a81b40962f7044b0dc201e",
      "commit_sha":"6abe964bbac41b5e40a81b40962f7044b0dc201e",
      "patch":"SINGLE",
      "chain_ord":"['6abe964bbac41b5e40a81b40962f7044b0dc201e']",
      "before_first_fix_commit":"{'11b2cc4cb5cf0693414f0e84cb790e487ae33a24'}",
      "last_fix_commit":"6abe964bbac41b5e40a81b40962f7044b0dc201e",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/15\/2022, 00:10:25",
      "message":"MDL-74204 mod_assign: escape identity fields in allocate marker form.",
      "author":"Paul Holden",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'mod\/assign\/classes\/output\/renderer.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/moodle\/moodle\/raw\/6abe964bbac41b5e40a81b40962f7044b0dc201e\/mod%2Fassign%2Fclasses%2Foutput%2Frenderer.php', 'patch': \"@@ -168,7 +168,7 @@ public function render_assign_user_summary(\\\\assign_user_summary $summary) {\\n             $fullname = fullname($summary->user, $summary->viewfullnames);\\n             $extrainfo = array();\\n             foreach ($summary->extrauserfields as $extrafield) {\\n-                $extrainfo[] = $summary->user->$extrafield;\\n+                $extrainfo[] = s($summary->user->$extrafield);\\n             }\\n             if (count($extrainfo)) {\\n                 $fullname .= ' (' . implode(', ', $extrainfo) . ')';\"}}",
      "message_norm":"mdl-74204 mod_assign: escape identity fields in allocate marker form.",
      "language":"en",
      "entities":"[('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['mod\/assign\/classes\/output\/renderer.php'])",
      "num_files":1.0,
      "patch_content":"From 6abe964bbac41b5e40a81b40962f7044b0dc201e Mon Sep 17 00:00:00 2001\nFrom: Paul Holden <paulh@moodle.com>\nDate: Tue, 15 Mar 2022 00:10:25 +0000\nSubject: [PATCH] MDL-74204 mod_assign: escape identity fields in allocate\n marker form.\n\n---\n mod\/assign\/classes\/output\/renderer.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/mod\/assign\/classes\/output\/renderer.php b\/mod\/assign\/classes\/output\/renderer.php\nindex 45e60caf347a6..098fd15c4193e 100644\n--- a\/mod\/assign\/classes\/output\/renderer.php\n+++ b\/mod\/assign\/classes\/output\/renderer.php\n@@ -168,7 +168,7 @@ public function render_assign_user_summary(\\assign_user_summary $summary) {\n             $fullname = fullname($summary->user, $summary->viewfullnames);\n             $extrainfo = array();\n             foreach ($summary->extrauserfields as $extrafield) {\n-                $extrainfo[] = $summary->user->$extrafield;\n+                $extrainfo[] = s($summary->user->$extrafield);\n             }\n             if (count($extrainfo)) {\n                 $fullname .= ' (' . implode(', ', $extrainfo) . ')';",
      "code_diff":"@@ -168,7 +168,7 @@ public function render_assign_user_summary(\\assign_user_summary $summary) {\n             $fullname = fullname($summary->user, $summary->viewfullnames);\n             $extrainfo = array();\n             foreach ($summary->extrauserfields as $extrafield) {\n-                $extrainfo[] = $summary->user->$extrafield;\n+                $extrainfo[] = s($summary->user->$extrafield);\n             }\n             if (count($extrainfo)) {\n                 $fullname .= ' (' . implode(', ', $extrainfo) . ')';"
    },
    {
      "index":68,
      "vuln_id":"GHSA-98gj-wwxm-cj3h",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/lepture\/mistune\/commit\/5f06d724bc05580e7f203db2d4a4905fc1127f98'}",
      "dataset":"osv",
      "summary":"Moderate severity vulnerability that affects mistune Cross-site scripting (XSS) vulnerability in the _keyify function in mistune.py in Mistune before 0.8.1 allows remote attackers to inject arbitrary web script or HTML by leveraging failure to escape the \"key\" argument.",
      "published_date":"2019-01-04",
      "chain_len":1,
      "project":"https:\/\/github.com\/lepture\/mistune",
      "commit_href":"https:\/\/github.com\/lepture\/mistune\/commit\/5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "commit_sha":"5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "patch":"SINGLE",
      "chain_ord":"['5f06d724bc05580e7f203db2d4a4905fc1127f98']",
      "before_first_fix_commit":"{'7f7f106a717e6cf58012304e56b41d6fb2b98e5f'}",
      "last_fix_commit":"5f06d724bc05580e7f203db2d4a4905fc1127f98",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/20\/2017, 15:15:09",
      "message":"Fix CVE-2017-16876",
      "author":"Hsiaoming Yang",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 3, 'total': 8}",
      "files":"{'mistune.py': {'additions': 5, 'deletions': 3, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/lepture\/mistune\/raw\/5f06d724bc05580e7f203db2d4a4905fc1127f98\/mistune.py', 'patch': \"@@ -11,7 +11,7 @@\\n import re\\n import inspect\\n \\n-__version__ = '0.8'\\n+__version__ = '0.8.1'\\n __author__ = 'Hsiaoming Yang <me@lepture.com>'\\n __all__ = [\\n     'BlockGrammar', 'BlockLexer',\\n@@ -48,7 +48,8 @@ def _pure_pattern(regex):\\n \\n \\n def _keyify(key):\\n-    return _key_pattern.sub(' ', key.lower())\\n+    key = escape(key.lower(), quote=True)\\n+    return _key_pattern.sub(' ', key)\\n \\n \\n def escape(text, quote=False, smart_amp=True):\\n@@ -445,7 +446,8 @@ class InlineGrammar(object):\\n     inline_html = re.compile(\\n         r'^(?:%s|%s|%s)' % (\\n             r'<!--[\\\\s\\\\S]*?-->',\\n-            r'<(\\\\w+%s)((?:%s)*?)\\\\s*>([\\\\s\\\\S]*?)<\\\\\/\\\\1>' % (_valid_end, _valid_attr),\\n+            r'<(\\\\w+%s)((?:%s)*?)\\\\s*>([\\\\s\\\\S]*?)<\\\\\/\\\\1>' % (\\n+                _valid_end, _valid_attr),\\n             r'<\\\\w+%s(?:%s)*?\\\\s*\\\\\/?>' % (_valid_end, _valid_attr),\\n         )\\n     )\"}}",
      "message_norm":"fix cve-2017-16876",
      "language":"fr",
      "entities":"[('fix', 'ACTION', ''), ('cve-2017-16876', 'VULNID', 'CVE')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['mistune.py'])",
      "num_files":1.0,
      "patch_content":"From 5f06d724bc05580e7f203db2d4a4905fc1127f98 Mon Sep 17 00:00:00 2001\nFrom: Hsiaoming Yang <me@lepture.com>\nDate: Tue, 21 Nov 2017 00:15:09 +0900\nSubject: [PATCH] Fix CVE-2017-16876\n\n---\n mistune.py | 8 +++++---\n 1 file changed, 5 insertions(+), 3 deletions(-)\n\ndiff --git a\/mistune.py b\/mistune.py\nindex d6ecf7e..5b05fcb 100644\n--- a\/mistune.py\n+++ b\/mistune.py\n@@ -11,7 +11,7 @@\n import re\n import inspect\n \n-__version__ = '0.8'\n+__version__ = '0.8.1'\n __author__ = 'Hsiaoming Yang <me@lepture.com>'\n __all__ = [\n     'BlockGrammar', 'BlockLexer',\n@@ -48,7 +48,8 @@ def _pure_pattern(regex):\n \n \n def _keyify(key):\n-    return _key_pattern.sub(' ', key.lower())\n+    key = escape(key.lower(), quote=True)\n+    return _key_pattern.sub(' ', key)\n \n \n def escape(text, quote=False, smart_amp=True):\n@@ -445,7 +446,8 @@ class InlineGrammar(object):\n     inline_html = re.compile(\n         r'^(?:%s|%s|%s)' % (\n             r'<!--[\\s\\S]*?-->',\n-            r'<(\\w+%s)((?:%s)*?)\\s*>([\\s\\S]*?)<\\\/\\1>' % (_valid_end, _valid_attr),\n+            r'<(\\w+%s)((?:%s)*?)\\s*>([\\s\\S]*?)<\\\/\\1>' % (\n+                _valid_end, _valid_attr),\n             r'<\\w+%s(?:%s)*?\\s*\\\/?>' % (_valid_end, _valid_attr),\n         )\n     )",
      "code_diff":"@@ -11,7 +11,7 @@\n import re\n import inspect\n \n-__version__ = '0.8'\n+__version__ = '0.8.1'\n __author__ = 'Hsiaoming Yang <me@lepture.com>'\n __all__ = [\n     'BlockGrammar', 'BlockLexer',\n@@ -48,7 +48,8 @@ def _pure_pattern(regex):\n \n \n def _keyify(key):\n-    return _key_pattern.sub(' ', key.lower())\n+    key = escape(key.lower(), quote=True)\n+    return _key_pattern.sub(' ', key)\n \n \n def escape(text, quote=False, smart_amp=True):\n@@ -445,7 +446,8 @@ class InlineGrammar(object):\n     inline_html = re.compile(\n         r'^(?:%s|%s|%s)' % (\n             r'<!--[\\s\\S]*?-->',\n-            r'<(\\w+%s)((?:%s)*?)\\s*>([\\s\\S]*?)<\\\/\\1>' % (_valid_end, _valid_attr),\n+            r'<(\\w+%s)((?:%s)*?)\\s*>([\\s\\S]*?)<\\\/\\1>' % (\n+                _valid_end, _valid_attr),\n             r'<\\w+%s(?:%s)*?\\s*\\\/?>' % (_valid_end, _valid_attr),\n         )\n     )"
    },
    {
      "index":69,
      "vuln_id":"GHSA-5ppx-rgw2-xg23",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/jenkinsci\/jenkins\/commit\/f67068170b55633571e5462e52b6124b23d7cb84'}",
      "dataset":"osv",
      "summary":"Improper Neutralization of Input During Web Page Generation in Jenkins Jenkins 2.88 and earlier; 2.73.2 and earlier Autocompletion suggestions for text fields were not escaped, resulting in a persisted cross-site scripting vulnerability if the source for the suggestions allowed specifying text that includes HTML metacharacters like less-than and greater-than characters.",
      "published_date":"2022-05-14",
      "chain_len":1,
      "project":"https:\/\/github.com\/jenkinsci\/jenkins",
      "commit_href":"https:\/\/github.com\/jenkinsci\/jenkins\/commit\/f67068170b55633571e5462e52b6124b23d7cb84",
      "commit_sha":"f67068170b55633571e5462e52b6124b23d7cb84",
      "patch":"SINGLE",
      "chain_ord":"['f67068170b55633571e5462e52b6124b23d7cb84']",
      "before_first_fix_commit":"{'566a8ddb885f0bef9bc848e60455c0aabbf0c1d3'}",
      "last_fix_commit":"f67068170b55633571e5462e52b6124b23d7cb84",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/24\/2017, 16:01:03",
      "message":"[SECURITY-641] Escape autocompletion suggestions",
      "author":"Daniel Beck",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'war\/src\/main\/webapp\/scripts\/hudson-behavior.js': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jenkinsci\/jenkins\/raw\/f67068170b55633571e5462e52b6124b23d7cb84\/war%2Fsrc%2Fmain%2Fwebapp%2Fscripts%2Fhudson-behavior.js', 'patch': '@@ -712,6 +712,7 @@ var jenkinsRules = {\\n         };\\n         ac.prehighlightClassName = \"yui-ac-prehighlight\";\\n         ac.animSpeed = 0;\\n+        ac.formatResult = ac.formatEscapedResult;\\n         ac.useShadow = true;\\n         ac.autoSnapContainer = true;\\n         ac.delimChar = e.getAttribute(\"autoCompleteDelimChar\");'}}",
      "message_norm":"[security-641] escape autocompletion suggestions",
      "language":"fr",
      "entities":"[('security-641', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['war\/src\/main\/webapp\/scripts\/hudson-behavior.js'])",
      "num_files":1.0,
      "patch_content":"From f67068170b55633571e5462e52b6124b23d7cb84 Mon Sep 17 00:00:00 2001\nFrom: Daniel Beck <daniel-beck@users.noreply.github.com>\nDate: Tue, 24 Oct 2017 12:01:03 -0400\nSubject: [PATCH] [SECURITY-641] Escape autocompletion suggestions\n\n---\n war\/src\/main\/webapp\/scripts\/hudson-behavior.js | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js b\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js\nindex 5e39b3491125..c63e5782cf76 100644\n--- a\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js\n+++ b\/war\/src\/main\/webapp\/scripts\/hudson-behavior.js\n@@ -712,6 +712,7 @@ var jenkinsRules = {\n         };\n         ac.prehighlightClassName = \"yui-ac-prehighlight\";\n         ac.animSpeed = 0;\n+        ac.formatResult = ac.formatEscapedResult;\n         ac.useShadow = true;\n         ac.autoSnapContainer = true;\n         ac.delimChar = e.getAttribute(\"autoCompleteDelimChar\");",
      "code_diff":"@@ -712,6 +712,7 @@ var jenkinsRules = {\n         };\n         ac.prehighlightClassName = \"yui-ac-prehighlight\";\n         ac.animSpeed = 0;\n+        ac.formatResult = ac.formatEscapedResult;\n         ac.useShadow = true;\n         ac.autoSnapContainer = true;\n         ac.delimChar = e.getAttribute(\"autoCompleteDelimChar\");"
    },
    {
      "index":70,
      "vuln_id":"GHSA-gmh3-x5w7-jg5m",
      "cwe_id":"{'CWE-79'}",
      "score":6.3,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/79c6914bab8c9da07ac950fda17648d08c68b130'}",
      "dataset":"osv",
      "summary":"Microweber before v1.2.20 vulnerable to cross-site scripting Prior to Microweber v1.2.20, due to improper neutralization of input, an attacker can steal tokens to perform cross-site request forgery (CSRF), fetch contents from same-site and redirect a user.",
      "published_date":"2022-07-10",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/79c6914bab8c9da07ac950fda17648d08c68b130",
      "commit_sha":"79c6914bab8c9da07ac950fda17648d08c68b130",
      "patch":"SINGLE",
      "chain_ord":"['79c6914bab8c9da07ac950fda17648d08c68b130']",
      "before_first_fix_commit":"{'d35e691e72d358430abc8e99f5ba9eb374423b9f'}",
      "last_fix_commit":"79c6914bab8c9da07ac950fda17648d08c68b130",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/08\/2022, 17:31:13",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 14, 'deletions': 2, 'total': 16}",
      "files":"{'userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php': {'additions': 14, 'deletions': 2, 'changes': 16, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/79c6914bab8c9da07ac950fda17648d08c68b130\/userfiles%2Fmodules%2Fmicroweber%2Ftoolbar%2Feditor_tools%2Fmodule_settings%2Findex.php', 'patch': '@@ -87,14 +87,24 @@\\n     if (isset($_GET[\\'autosize\\'])) {\\n         $autoSize = $_GET[\\'autosize\\'];\\n     }\\n-    $autoSize = xss_clean($autoSize);\\n+    $autoSize = intval($autoSize);\\n \\n     $type = \\'\\';\\n     if (isset($_GET[\\'type\\'])) {\\n         $type = $_GET[\\'type\\'];\\n     }\\n     $type = xss_clean($type);\\n \\n+            $other = [\\n+                \\';\\',\\n+                \\'\\\\\\'\\',\\n+                \\'\/\/\\',\\n+                \\'`\\',\\n+                \\'\\\\\\\\\\',\\n+\\n+            ];\\n+    $type = str_replace($other, \\'\\', $type);\\n+\\n     $mod_id = $mod_orig_id = false;\\n     $is_linked_mod = false;\\n \\n@@ -108,6 +118,8 @@\\n     if ($mod_id != $mod_orig_id) {\\n         $is_linked_mod = true;\\n     }\\n+\\n+\\n     ?>\\n \\n     <script type=\"text\/javascript\">\\n@@ -124,7 +136,7 @@\\n         addIcon();\\n \\n         autoSize = <?php  print $autoSize; ?>;\\n-        settingsType = \\'<?php print $type; ?>\\';\\n+        settingsType = \\'<?php print htmlentities($type); ?>\\';\\n \\n         window.onbeforeunload = function () {\\n             $(document.body).addClass(\"mw-external-loading\")'}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php'])",
      "num_files":1.0,
      "patch_content":"From 79c6914bab8c9da07ac950fda17648d08c68b130 Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Fri, 8 Jul 2022 20:31:13 +0300\nSubject: [PATCH] update\n\n---\n ...\/editor_tools\/module_settings\/index.php       | 16 ++++++++++++++--\n 1 file changed, 14 insertions(+), 2 deletions(-)\n\ndiff --git a\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php b\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php\nindex a6bc6821ccd..b8a55eed45d 100644\n--- a\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php\n+++ b\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php\n@@ -87,7 +87,7 @@\n     if (isset($_GET['autosize'])) {\n         $autoSize = $_GET['autosize'];\n     }\n-    $autoSize = xss_clean($autoSize);\n+    $autoSize = intval($autoSize);\n \n     $type = '';\n     if (isset($_GET['type'])) {\n@@ -95,6 +95,16 @@\n     }\n     $type = xss_clean($type);\n \n+            $other = [\n+                ';',\n+                '\\'',\n+                '\/\/',\n+                '`',\n+                '\\\\',\n+\n+            ];\n+    $type = str_replace($other, '', $type);\n+\n     $mod_id = $mod_orig_id = false;\n     $is_linked_mod = false;\n \n@@ -108,6 +118,8 @@\n     if ($mod_id != $mod_orig_id) {\n         $is_linked_mod = true;\n     }\n+\n+\n     ?>\n \n     <script type=\"text\/javascript\">\n@@ -124,7 +136,7 @@\n         addIcon();\n \n         autoSize = <?php  print $autoSize; ?>;\n-        settingsType = '<?php print $type; ?>';\n+        settingsType = '<?php print htmlentities($type); ?>';\n \n         window.onbeforeunload = function () {\n             $(document.body).addClass(\"mw-external-loading\")",
      "code_diff":"@@ -87,7 +87,7 @@\n     if (isset($_GET['autosize'])) {\n         $autoSize = $_GET['autosize'];\n     }\n-    $autoSize = xss_clean($autoSize);\n+    $autoSize = intval($autoSize);\n \n     $type = '';\n     if (isset($_GET['type'])) {\n@@ -95,6 +95,16 @@\n     }\n     $type = xss_clean($type);\n \n+            $other = [\n+                ';',\n+                '\\'',\n+                '\/\/',\n+                '`',\n+                '\\\\',\n+\n+            ];\n+    $type = str_replace($other, '', $type);\n+\n     $mod_id = $mod_orig_id = false;\n     $is_linked_mod = false;\n \n@@ -108,6 +118,8 @@\n     if ($mod_id != $mod_orig_id) {\n         $is_linked_mod = true;\n     }\n+\n+\n     ?>\n \n     <script type=\"text\/javascript\">\n@@ -124,7 +136,7 @@\n         addIcon();\n \n         autoSize = <?php  print $autoSize; ?>;\n-        settingsType = '<?php print $type; ?>';\n+        settingsType = '<?php print htmlentities($type); ?>';\n \n         window.onbeforeunload = function () {\n             $(document.body).addClass(\"mw-external-loading\")"
    },
    {
      "index":71,
      "vuln_id":"GHSA-f655-xhvm-cwp4",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/jenkinsci\/gitlab-plugin\/commit\/24e9a99d8151b5345109ef12cddc1ab323baa4ee'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Jenkins GitLab Plugin Jenkins GitLab Plugin 1.5.34 and earlier does not escape multiple fields inserted into the description of webhook-triggered builds, resulting in a stored cross-site scripting (XSS) vulnerability exploitable by attackers with Item\/Configure permission.",
      "published_date":"2022-07-01",
      "chain_len":1,
      "project":"https:\/\/github.com\/jenkinsci\/gitlab-plugin",
      "commit_href":"https:\/\/github.com\/jenkinsci\/gitlab-plugin\/commit\/24e9a99d8151b5345109ef12cddc1ab323baa4ee",
      "commit_sha":"24e9a99d8151b5345109ef12cddc1ab323baa4ee",
      "patch":"SINGLE",
      "chain_ord":"['24e9a99d8151b5345109ef12cddc1ab323baa4ee']",
      "before_first_fix_commit":"{'316f8aa1190c646e0cddf6614e3d881d1490be7f'}",
      "last_fix_commit":"24e9a99d8151b5345109ef12cddc1ab323baa4ee",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/29\/2022, 15:15:16",
      "message":"[SECURITY-2316]",
      "author":"Daniel Beck",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
      "files":"{'src\/main\/resources\/com\/dabsquared\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jenkinsci\/gitlab-plugin\/raw\/24e9a99d8151b5345109ef12cddc1ab323baa4ee\/src%2Fmain%2Fresources%2Fcom%2Fdabsquared%2Fgitlabjenkins%2Fcause%2FGitLabWebHookCause%2Fdescription.jelly', 'patch': '@@ -1,4 +1,5 @@\\n <?jelly escape-by-default=\\'true\\'?>\\n <j:jelly xmlns:j=\"jelly:core\">\\n-  <span><j:out value=\"${it.shortDescription}\" \/><\/span>\\n+  <!-- SECURITY-2316: This used to show the HTML-formatted it.shortDescription, but that does not properly neutralize user-provided input -->\\n+  <span>Triggered by GitLab Webhook<\/span>\\n <\/j:jelly>'}}",
      "message_norm":"[security-2316]",
      "language":"en",
      "entities":"[('security-2316', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/main\/resources\/com\/dabsquared\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly'])",
      "num_files":1.0,
      "patch_content":"From 24e9a99d8151b5345109ef12cddc1ab323baa4ee Mon Sep 17 00:00:00 2001\nFrom: Daniel Beck <daniel-beck@users.noreply.github.com>\nDate: Wed, 29 Jun 2022 17:15:16 +0200\nSubject: [PATCH] [SECURITY-2316]\n\n---\n ...\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly   | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/main\/resources\/com\/dabsquared\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly b\/src\/main\/resources\/com\/dabsquared\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly\nindex 37e85ef37..1c0244b0d 100644\n--- a\/src\/main\/resources\/com\/dabsquared\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly\n+++ b\/src\/main\/resources\/com\/dabsquared\/gitlabjenkins\/cause\/GitLabWebHookCause\/description.jelly\n@@ -1,4 +1,5 @@\n <?jelly escape-by-default='true'?>\n <j:jelly xmlns:j=\"jelly:core\">\n-  <span><j:out value=\"${it.shortDescription}\" \/><\/span>\n+  <!-- SECURITY-2316: This used to show the HTML-formatted it.shortDescription, but that does not properly neutralize user-provided input -->\n+  <span>Triggered by GitLab Webhook<\/span>\n <\/j:jelly>",
      "code_diff":"@@ -1,4 +1,5 @@\n <?jelly escape-by-default='true'?>\n <j:jelly xmlns:j=\"jelly:core\">\n-  <span><j:out value=\"${it.shortDescription}\" \/><\/span>\n+  <!-- SECURITY-2316: This used to show the HTML-formatted it.shortDescription, but that does not properly neutralize user-provided input -->\n+  <span>Triggered by GitLab Webhook<\/span>\n <\/j:jelly>"
    },
    {
      "index":72,
      "vuln_id":"GHSA-fj93-7wm4-8x2g",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/jquery\/jquery-mobile\/commit\/b0d9cc758a48f13321750d7409fb7655dcdf2b50'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in jquery-mobile All version of `jquery-mobile` are vulnerable to Cross-Site Scripting. The package checks for content in `location.hash` and if a URL is found it does an XmlHttpRequest (XHR) to the URL and renders the response with `innerHTML`. It fails to validate the `Content-Type` of the response, allowing attackers to include malicious payloads as part of query parameters that are reflected back to the user. A response such as `{\"q\":\"<iframe\/src='javascript:alert(1)'><\/iframe>\",\"results\":[]}` would be parsed as HTML and the JavaScript payload executed.\n\n\n## Recommendation\n\nNo fix is currently available. Consider using an alternative package until a fix is made available.",
      "published_date":"2020-09-02",
      "chain_len":1,
      "project":"https:\/\/github.com\/jquery\/jquery-mobile",
      "commit_href":"https:\/\/github.com\/jquery\/jquery-mobile\/commit\/b0d9cc758a48f13321750d7409fb7655dcdf2b50",
      "commit_sha":"b0d9cc758a48f13321750d7409fb7655dcdf2b50",
      "patch":"SINGLE",
      "chain_ord":"['b0d9cc758a48f13321750d7409fb7655dcdf2b50']",
      "before_first_fix_commit":"{'1f0cec9bcb9d75998e733d580d6f1144c963326e'}",
      "last_fix_commit":"b0d9cc758a48f13321750d7409fb7655dcdf2b50",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/13\/2019, 17:42:26",
      "message":"Check Content-Type header before parsing AJAX response as HTML (#8649)\n\nFix for issue #8640 (possible XSS vulnerability)",
      "author":"Denis Ryabov",
      "comments":null,
      "stats":"{'additions': 9, 'deletions': 0, 'total': 9}",
      "files":"{'js\/widgets\/pagecontainer.js': {'additions': 9, 'deletions': 0, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jquery-archive\/jquery-mobile\/raw\/b0d9cc758a48f13321750d7409fb7655dcdf2b50\/js%2Fwidgets%2Fpagecontainer.js', 'patch': '@@ -564,6 +564,15 @@ $.widget( \"mobile.pagecontainer\", {\\n \\n \\t\\treturn $.proxy( function( html, textStatus, xhr ) {\\n \\n+\\t\\t\\t\/\/ Check that Content-Type is \"text\/html\" (https:\/\/github.com\/jquery\/jquery-mobile\/issues\/8640)\\n+\\t\\t\\tif ( !\/^text\\\\\/html\\\\b\/.test( xhr.getResponseHeader(\\'Content-Type\\') ) ) {\\n+\\t\\t\\t\\t\/\/ Display error message for unsupported content type\\n+\\t\\t\\t\\tif ( settings.showLoadMsg ) {\\n+\\t\\t\\t\\t\\tthis._showError();\\n+\\t\\t\\t\\t}\\n+\\t\\t\\t\\treturn;\\n+\\t\\t\\t}\\n+\\n \\t\\t\\t\/\/ Pre-parse html to check for a data-url, use it as the new fileUrl, base path, etc\\n \\t\\t\\tvar content,'}}",
      "message_norm":"check content-type header before parsing ajax response as html (#8649)\n\nfix for issue #8640 (possible xss vulnerability)",
      "language":"en",
      "entities":"[('#8649', 'ISSUE', ''), ('issue', 'FLAW', ''), ('#8640', 'ISSUE', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['js\/widgets\/pagecontainer.js'])",
      "num_files":1.0,
      "patch_content":"From b0d9cc758a48f13321750d7409fb7655dcdf2b50 Mon Sep 17 00:00:00 2001\nFrom: Denis Ryabov <dryabov@yandex.ru>\nDate: Thu, 13 Jun 2019 20:42:26 +0300\nSubject: [PATCH] Check Content-Type header before parsing AJAX response as\n HTML (#8649)\n\nFix for issue #8640 (possible XSS vulnerability)\n---\n js\/widgets\/pagecontainer.js | 9 +++++++++\n 1 file changed, 9 insertions(+)\n\ndiff --git a\/js\/widgets\/pagecontainer.js b\/js\/widgets\/pagecontainer.js\nindex 6e973688caf..5e3272e9779 100644\n--- a\/js\/widgets\/pagecontainer.js\n+++ b\/js\/widgets\/pagecontainer.js\n@@ -564,6 +564,15 @@ $.widget( \"mobile.pagecontainer\", {\n \n \t\treturn $.proxy( function( html, textStatus, xhr ) {\n \n+\t\t\t\/\/ Check that Content-Type is \"text\/html\" (https:\/\/github.com\/jquery\/jquery-mobile\/issues\/8640)\n+\t\t\tif ( !\/^text\\\/html\\b\/.test( xhr.getResponseHeader('Content-Type') ) ) {\n+\t\t\t\t\/\/ Display error message for unsupported content type\n+\t\t\t\tif ( settings.showLoadMsg ) {\n+\t\t\t\t\tthis._showError();\n+\t\t\t\t}\n+\t\t\t\treturn;\n+\t\t\t}\n+\n \t\t\t\/\/ Pre-parse html to check for a data-url, use it as the new fileUrl, base path, etc\n \t\t\tvar content,",
      "code_diff":"@@ -564,6 +564,15 @@ $.widget( \"mobile.pagecontainer\", {\n \n \t\treturn $.proxy( function( html, textStatus, xhr ) {\n \n+\t\t\t\/\/ Check that Content-Type is \"text\/html\" (https:\/\/github.com\/jquery\/jquery-mobile\/issues\/8640)\n+\t\t\tif ( !\/^text\\\/html\\b\/.test( xhr.getResponseHeader('Content-Type') ) ) {\n+\t\t\t\t\/\/ Display error message for unsupported content type\n+\t\t\t\tif ( settings.showLoadMsg ) {\n+\t\t\t\t\tthis._showError();\n+\t\t\t\t}\n+\t\t\t\treturn;\n+\t\t\t}\n+\n \t\t\t\/\/ Pre-parse html to check for a data-url, use it as the new fileUrl, base path, etc\n \t\t\tvar content,"
    },
    {
      "index":73,
      "vuln_id":"GHSA-xjrf-8x4f-43h4",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/spring-projects\/spring-framework\/commit\/9982b4c01a8c7be0961e58b58ed83731c40449ff', 'https:\/\/github.com\/spring-projects\/spring-framework\/commit\/7a7df6637478607bef0277bf52a4e0a03e20a248', 'https:\/\/github.com\/spring-projects\/spring-framework\/commit\/f5c9fe69a444607af667911bd4c5074b5b073e7b'}",
      "dataset":"osv",
      "summary":"Improper Neutralization of Input During Web Page Generation in Spring Framework The JavaScriptUtils.javaScriptEscape method in web\/util\/JavaScriptUtils.java in Spring MVC in Spring Framework before 3.2.2 does not properly escape certain characters, which allows remote attackers to conduct cross-site scripting (XSS) attacks via a (1) line separator or (2) paragraph separator Unicode character or (3) left or (4) right angle bracket.",
      "published_date":"2022-05-05",
      "chain_len":3,
      "project":"https:\/\/github.com\/spring-projects\/spring-framework",
      "commit_href":"https:\/\/github.com\/spring-projects\/spring-framework\/commit\/9982b4c01a8c7be0961e58b58ed83731c40449ff",
      "commit_sha":"9982b4c01a8c7be0961e58b58ed83731c40449ff",
      "patch":"MULTI",
      "chain_ord":"['9982b4c01a8c7be0961e58b58ed83731c40449ff', 'f5c9fe69a444607af667911bd4c5074b5b073e7b', '7a7df6637478607bef0277bf52a4e0a03e20a248']",
      "before_first_fix_commit":"{'63bff1f068f0c749f938abacba1d38b7d0ca3cf9'}",
      "last_fix_commit":"7a7df6637478607bef0277bf52a4e0a03e20a248",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/23\/2013, 18:35:14",
      "message":"Add BS and VT char escape sequences to JavaScriptUtils\n\nIssue: SPR-9983",
      "author":"Rossen Stoyanchev",
      "comments":null,
      "stats":"{'additions': 14, 'deletions': 7, 'total': 21}",
      "files":"{'spring-web\/src\/main\/java\/org\/springframework\/web\/util\/JavaScriptUtils.java': {'additions': 14, 'deletions': 7, 'changes': 21, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/spring-projects\/spring-framework\/raw\/9982b4c01a8c7be0961e58b58ed83731c40449ff\/spring-web%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fweb%2Futil%2FJavaScriptUtils.java', 'patch': '@@ -1,5 +1,5 @@\\n \/*\\n- * Copyright 2002-2008 the original author or authors.\\n+ * Copyright 2002-2013 the original author or authors.\\n  *\\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\\n  * you may not use this file except in compliance with the License.\\n@@ -21,21 +21,21 @@\\n  * Escapes based on the JavaScript 1.5 recommendation.\\n  *\\n  * <p>Reference:\\n- * <a href=\"http:\/\/developer.mozilla.org\/en\/docs\/Core_JavaScript_1.5_Guide:Literals#String_Literals\">\\n- * Core JavaScript 1.5 Guide\\n- * <\/a>\\n+ * <a href=\"https:\/\/developer.mozilla.org\/en-US\/docs\/JavaScript\/Guide\/Values,_variables,_and_literals#String_literals\">\\n+ * JavaScript Guide<\/a> on Mozilla Developer Network.\\n  *\\n  * @author Juergen Hoeller\\n  * @author Rob Harrop\\n+ * @author Rossen Stoyanchev\\n  * @since 1.1.1\\n  *\/\\n public class JavaScriptUtils {\\n \\n \\t\/**\\n-\\t * Turn special characters into escaped characters conforming to JavaScript.\\n-\\t * Handles complete character set defined in HTML 4.01 recommendation.\\n+\\t * Turn JavaScript special characters into escaped characters.\\n+\\t *\\n \\t * @param input the input string\\n-\\t * @return the escaped string\\n+\\t * @return the string with escaped characters\\n \\t *\/\\n \\tpublic static String javaScriptEscape(String input) {\\n \\t\\tif (input == null) {\\n@@ -73,6 +73,13 @@ else if (c == \\'\\\\r\\') {\\n \\t\\t\\telse if (c == \\'\\\\f\\') {\\n \\t\\t\\t\\tfiltered.append(\"\\\\\\\\f\");\\n \\t\\t\\t}\\n+\\t\\t\\telse if (c == \\'\\\\b\\') {\\n+\\t\\t\\t\\tfiltered.append(\"\\\\\\\\b\");\\n+\\t\\t\\t}\\n+\\t\\t\\t\/\/ No \\'\\\\v\\' in Java, use octal value for VT ascii char\\n+\\t\\t\\telse if (c == \\'\\\\013\\') {\\n+\\t\\t\\t\\tfiltered.append(\"\\\\\\\\v\");\\n+\\t\\t\\t}\\n \\t\\t\\telse {\\n \\t\\t\\t\\tfiltered.append(c);\\n \\t\\t\\t}'}}",
      "message_norm":"add bs and vt char escape sequences to javascriptutils\n\nissue: spr-9983",
      "language":"ca",
      "entities":"[('add', 'ACTION', ''), ('escape', 'SECWORD', ''), ('issue', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['spring-web\/src\/main\/java\/org\/springframework\/web\/util\/JavaScriptUtils.java'])",
      "num_files":1.0,
      "patch_content":"From 9982b4c01a8c7be0961e58b58ed83731c40449ff Mon Sep 17 00:00:00 2001\nFrom: Rossen Stoyanchev <rstoyanchev@vmware.com>\nDate: Wed, 23 Jan 2013 13:35:14 -0500\nSubject: [PATCH] Add BS and VT char escape sequences to JavaScriptUtils\n\nIssue: SPR-9983\n---\n ...\/web\/util\/JavaScriptUtils.java             | 21 ++++++++++++-------\n 1 file changed, 14 insertions(+), 7 deletions(-)\n\ndiff --git a\/spring-web\/src\/main\/java\/org\/springframework\/web\/util\/JavaScriptUtils.java b\/spring-web\/src\/main\/java\/org\/springframework\/web\/util\/JavaScriptUtils.java\nindex b28d398687f1..0ee697f6d9a5 100644\n--- a\/spring-web\/src\/main\/java\/org\/springframework\/web\/util\/JavaScriptUtils.java\n+++ b\/spring-web\/src\/main\/java\/org\/springframework\/web\/util\/JavaScriptUtils.java\n@@ -1,5 +1,5 @@\n \/*\n- * Copyright 2002-2008 the original author or authors.\n+ * Copyright 2002-2013 the original author or authors.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -21,21 +21,21 @@\n  * Escapes based on the JavaScript 1.5 recommendation.\n  *\n  * <p>Reference:\n- * <a href=\"http:\/\/developer.mozilla.org\/en\/docs\/Core_JavaScript_1.5_Guide:Literals#String_Literals\">\n- * Core JavaScript 1.5 Guide\n- * <\/a>\n+ * <a href=\"https:\/\/developer.mozilla.org\/en-US\/docs\/JavaScript\/Guide\/Values,_variables,_and_literals#String_literals\">\n+ * JavaScript Guide<\/a> on Mozilla Developer Network.\n  *\n  * @author Juergen Hoeller\n  * @author Rob Harrop\n+ * @author Rossen Stoyanchev\n  * @since 1.1.1\n  *\/\n public class JavaScriptUtils {\n \n \t\/**\n-\t * Turn special characters into escaped characters conforming to JavaScript.\n-\t * Handles complete character set defined in HTML 4.01 recommendation.\n+\t * Turn JavaScript special characters into escaped characters.\n+\t *\n \t * @param input the input string\n-\t * @return the escaped string\n+\t * @return the string with escaped characters\n \t *\/\n \tpublic static String javaScriptEscape(String input) {\n \t\tif (input == null) {\n@@ -73,6 +73,13 @@ else if (c == '\\r') {\n \t\t\telse if (c == '\\f') {\n \t\t\t\tfiltered.append(\"\\\\f\");\n \t\t\t}\n+\t\t\telse if (c == '\\b') {\n+\t\t\t\tfiltered.append(\"\\\\b\");\n+\t\t\t}\n+\t\t\t\/\/ No '\\v' in Java, use octal value for VT ascii char\n+\t\t\telse if (c == '\\013') {\n+\t\t\t\tfiltered.append(\"\\\\v\");\n+\t\t\t}\n \t\t\telse {\n \t\t\t\tfiltered.append(c);\n \t\t\t}",
      "code_diff":"@@ -1,5 +1,5 @@\n \/*\n- * Copyright 2002-2008 the original author or authors.\n+ * Copyright 2002-2013 the original author or authors.\n  *\n  * Licensed under the Apache License, Version 2.0 (the \"License\");\n  * you may not use this file except in compliance with the License.\n@@ -21,21 +21,21 @@\n  * Escapes based on the JavaScript 1.5 recommendation.\n  *\n  * <p>Reference:\n- * <a href=\"http:\/\/developer.mozilla.org\/en\/docs\/Core_JavaScript_1.5_Guide:Literals#String_Literals\">\n- * Core JavaScript 1.5 Guide\n- * <\/a>\n+ * <a href=\"https:\/\/developer.mozilla.org\/en-US\/docs\/JavaScript\/Guide\/Values,_variables,_and_literals#String_literals\">\n+ * JavaScript Guide<\/a> on Mozilla Developer Network.\n  *\n  * @author Juergen Hoeller\n  * @author Rob Harrop\n+ * @author Rossen Stoyanchev\n  * @since 1.1.1\n  *\/\n public class JavaScriptUtils {\n \n \t\/**\n-\t * Turn special characters into escaped characters conforming to JavaScript.\n-\t * Handles complete character set defined in HTML 4.01 recommendation.\n+\t * Turn JavaScript special characters into escaped characters.\n+\t *\n \t * @param input the input string\n-\t * @return the escaped string\n+\t * @return the string with escaped characters\n \t *\/\n \tpublic static String javaScriptEscape(String input) {\n \t\tif (input == null) {\n@@ -73,6 +73,13 @@ else if (c == '\\r') {\n \t\t\telse if (c == '\\f') {\n \t\t\t\tfiltered.append(\"\\\\f\");\n \t\t\t}\n+\t\t\telse if (c == '\\b') {\n+\t\t\t\tfiltered.append(\"\\\\b\");\n+\t\t\t}\n+\t\t\t\/\/ No '\\v' in Java, use octal value for VT ascii char\n+\t\t\telse if (c == '\\013') {\n+\t\t\t\tfiltered.append(\"\\\\v\");\n+\t\t\t}\n \t\t\telse {\n \t\t\t\tfiltered.append(c);\n \t\t\t}"
    },
    {
      "index":74,
      "vuln_id":"GHSA-4mv4-gmmf-q382",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/DataTables\/DataTablesSrc\/commit\/ccf86dc5982bd8e16d11a0815c940f5b256874c9', 'https:\/\/github.com\/DataTables\/DataTablesSrc\/commit\/9780a3693572757d87bf70e48bd7555faf974f28'}",
      "dataset":"osv",
      "summary":"DataTable Vulnerable to Cross-Site Scripting Cross-site scripting (XSS) vulnerability in the DataTables plugin 1.10.8 and earlier for jQuery allows remote attackers to inject arbitrary web script or HTML via the scripts parameter to media\/unit_testing\/templates\/6776.php.\n\n\n## Recommendation\n\nUpdate to a version greater than 1.10.8. A [fix](https:\/\/github.com\/DataTables\/DataTablesSrc\/commit\/ccf86dc5982bd8e16d) appears in [version 1.10.10](https:\/\/github.com\/DataTables\/DataTablesSrc\/commits\/1.10.10?after=9780a3693572757d87bf70e48bd7555faf974f28+34&branch=1.10.10&qualified_name=refs%2Ftags%2F1.10.10).",
      "published_date":"2020-08-31",
      "chain_len":2,
      "project":"https:\/\/github.com\/DataTables\/DataTablesSrc",
      "commit_href":"https:\/\/github.com\/DataTables\/DataTablesSrc\/commit\/9780a3693572757d87bf70e48bd7555faf974f28",
      "commit_sha":"9780a3693572757d87bf70e48bd7555faf974f28",
      "patch":"MULTI",
      "chain_ord":"['ccf86dc5982bd8e16d11a0815c940f5b256874c9', '9780a3693572757d87bf70e48bd7555faf974f28']",
      "before_first_fix_commit":"{'51fa58e1c6baf456fe83fbfc7bfa4082be850365'}",
      "last_fix_commit":"9780a3693572757d87bf70e48bd7555faf974f28",
      "chain_ord_pos":2.0,
      "commit_datetime":"11\/06\/2015, 15:33:43",
      "message":"Version - 1.10.10 ready",
      "author":"Allan Jardine",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 3, 'total': 6}",
      "files":"{'js\/DataTables.js': {'additions': 3, 'deletions': 3, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DataTables\/DataTablesSrc\/raw\/9780a3693572757d87bf70e48bd7555faf974f28\/js%2FDataTables.js', 'patch': '@@ -1,11 +1,11 @@\\n-\/*! DataTables 1.10.10-dev\\n+\/*! DataTables 1.10.10\\n  * \u00a92008-2015 SpryMedia Ltd - datatables.net\/license\\n  *\/\\n \\n \/**\\n  * @summary     DataTables\\n  * @description Paginate, search and order HTML tables\\n- * @version     1.10.10-dev\\n+ * @version     1.10.10\\n  * @file        jquery.dataTables.js\\n  * @author      SpryMedia Ltd (www.sprymedia.co.uk)\\n  * @contact     www.sprymedia.co.uk\/contact\\n@@ -170,7 +170,7 @@\\n \\t *  @type string\\n \\t *  @default Version number\\n \\t *\/\\n-\\tDataTable.version = \"1.10.10-dev\";\\n+\\tDataTable.version = \"1.10.10\";\\n \\n \\t\/**\\n \\t * Private data store, containing all of the settings objects that are'}}",
      "message_norm":"version - 1.10.10 ready",
      "language":"en",
      "entities":"[('1.10.10', 'VERSION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['js\/DataTables.js'])",
      "num_files":1.0,
      "patch_content":"From 9780a3693572757d87bf70e48bd7555faf974f28 Mon Sep 17 00:00:00 2001\nFrom: Allan Jardine <allan.jardine@sprymedia.co.uk>\nDate: Fri, 6 Nov 2015 15:33:43 +0000\nSubject: [PATCH] Version - 1.10.10 ready\n\n---\n js\/DataTables.js | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\ndiff --git a\/js\/DataTables.js b\/js\/DataTables.js\nindex 27644401e..24deef67a 100644\n--- a\/js\/DataTables.js\n+++ b\/js\/DataTables.js\n@@ -1,11 +1,11 @@\n-\/*! DataTables 1.10.10-dev\n+\/*! DataTables 1.10.10\n  * \u00a92008-2015 SpryMedia Ltd - datatables.net\/license\n  *\/\n \n \/**\n  * @summary     DataTables\n  * @description Paginate, search and order HTML tables\n- * @version     1.10.10-dev\n+ * @version     1.10.10\n  * @file        jquery.dataTables.js\n  * @author      SpryMedia Ltd (www.sprymedia.co.uk)\n  * @contact     www.sprymedia.co.uk\/contact\n@@ -170,7 +170,7 @@\n \t *  @type string\n \t *  @default Version number\n \t *\/\n-\tDataTable.version = \"1.10.10-dev\";\n+\tDataTable.version = \"1.10.10\";\n \n \t\/**\n \t * Private data store, containing all of the settings objects that are",
      "code_diff":"@@ -1,11 +1,11 @@\n-\/*! DataTables 1.10.10-dev\n+\/*! DataTables 1.10.10\n  * \u00a92008-2015 SpryMedia Ltd - datatables.net\/license\n  *\/\n \n \/**\n  * @summary     DataTables\n  * @description Paginate, search and order HTML tables\n- * @version     1.10.10-dev\n+ * @version     1.10.10\n  * @file        jquery.dataTables.js\n  * @author      SpryMedia Ltd (www.sprymedia.co.uk)\n  * @contact     www.sprymedia.co.uk\/contact\n@@ -170,7 +170,7 @@\n \t *  @type string\n \t *  @default Version number\n \t *\/\n-\tDataTable.version = \"1.10.10-dev\";\n+\tDataTable.version = \"1.10.10\";\n \n \t\/**\n \t * Private data store, containing all of the settings objects that are"
    },
    {
      "index":75,
      "vuln_id":"GHSA-q3x2-jvp3-wj78",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/975fc1d6d3fba598ee550849ceb81af23ce72e08'}",
      "dataset":"osv",
      "summary":"Unrestricted XML files leading to cross-site scripting in Microweber Microweber prior to 1.2.12 allows unrestricted upload of XML files, which malicious actors can exploit to cause a stored cross-site scripting attack.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/975fc1d6d3fba598ee550849ceb81af23ce72e08",
      "commit_sha":"975fc1d6d3fba598ee550849ceb81af23ce72e08",
      "patch":"SINGLE",
      "chain_ord":"['975fc1d6d3fba598ee550849ceb81af23ce72e08']",
      "before_first_fix_commit":"{'27622f02c39d4cce67c43e5da38a6ab504202e13'}",
      "last_fix_commit":"975fc1d6d3fba598ee550849ceb81af23ce72e08",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 15:29:28",
      "message":"Update Files.php",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'src\/MicroweberPackages\/Utils\/System\/Files.php': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/975fc1d6d3fba598ee550849ceb81af23ce72e08\/src%2FMicroweberPackages%2FUtils%2FSystem%2FFiles.php', 'patch': \"@@ -1154,11 +1154,11 @@ function get_allowed_files_extensions_for_upload($fileTypes = 'images', $returnA\\n                 break;\\n             case 'file':\\n             case 'files':\\n-                $are_allowed .= ',doc,docx,pdf,json,rtf,txt,zip,gzip,rar,cad,xml,psd,xlsx,csv,7z';\\n+                $are_allowed .= ',doc,docx,pdf,json,rtf,txt,zip,gzip,rar,cad,psd,xlsx,csv,7z'; \\n                 break;\\n             case 'documents':\\n             case 'doc':\\n-                $are_allowed .= ',doc,docx,pdf,log,msg,odt,pages,rtf,tex,txt,wpd,wps,pps,ppt,pptx,xml,xlr,xls,xlsx';\\n+                $are_allowed .= ',doc,docx,pdf,log,msg,odt,pages,rtf,tex,txt,wpd,wps,pps,ppt,pptx,xlr,xls,xlsx';\\n                 break;\\n             case 'archives':\\n             case 'arc':\"}}",
      "message_norm":"update files.php",
      "language":"fr",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/Utils\/System\/Files.php'])",
      "num_files":1.0,
      "patch_content":"From 975fc1d6d3fba598ee550849ceb81af23ce72e08 Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Mon, 14 Mar 2022 17:29:28 +0200\nSubject: [PATCH] Update Files.php\n\n---\n src\/MicroweberPackages\/Utils\/System\/Files.php | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/Utils\/System\/Files.php b\/src\/MicroweberPackages\/Utils\/System\/Files.php\nindex b9542762a82..c3567cb2aa0 100644\n--- a\/src\/MicroweberPackages\/Utils\/System\/Files.php\n+++ b\/src\/MicroweberPackages\/Utils\/System\/Files.php\n@@ -1154,11 +1154,11 @@ function get_allowed_files_extensions_for_upload($fileTypes = 'images', $returnA\n                 break;\n             case 'file':\n             case 'files':\n-                $are_allowed .= ',doc,docx,pdf,json,rtf,txt,zip,gzip,rar,cad,xml,psd,xlsx,csv,7z';\n+                $are_allowed .= ',doc,docx,pdf,json,rtf,txt,zip,gzip,rar,cad,psd,xlsx,csv,7z'; \n                 break;\n             case 'documents':\n             case 'doc':\n-                $are_allowed .= ',doc,docx,pdf,log,msg,odt,pages,rtf,tex,txt,wpd,wps,pps,ppt,pptx,xml,xlr,xls,xlsx';\n+                $are_allowed .= ',doc,docx,pdf,log,msg,odt,pages,rtf,tex,txt,wpd,wps,pps,ppt,pptx,xlr,xls,xlsx';\n                 break;\n             case 'archives':\n             case 'arc':",
      "code_diff":"@@ -1154,11 +1154,11 @@ function get_allowed_files_extensions_for_upload($fileTypes = 'images', $returnA\n                 break;\n             case 'file':\n             case 'files':\n-                $are_allowed .= ',doc,docx,pdf,json,rtf,txt,zip,gzip,rar,cad,xml,psd,xlsx,csv,7z';\n+                $are_allowed .= ',doc,docx,pdf,json,rtf,txt,zip,gzip,rar,cad,psd,xlsx,csv,7z'; \n                 break;\n             case 'documents':\n             case 'doc':\n-                $are_allowed .= ',doc,docx,pdf,log,msg,odt,pages,rtf,tex,txt,wpd,wps,pps,ppt,pptx,xml,xlr,xls,xlsx';\n+                $are_allowed .= ',doc,docx,pdf,log,msg,odt,pages,rtf,tex,txt,wpd,wps,pps,ppt,pptx,xlr,xls,xlsx';\n                 break;\n             case 'archives':\n             case 'arc':"
    },
    {
      "index":76,
      "vuln_id":"GHSA-hhqj-cfjx-vj25",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/hakimel\/reveal.js\/commit\/32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2'}",
      "dataset":"osv",
      "summary":"Cross site scripting in reveal.js The onmessage event listener in \/plugin\/notes\/speaker-view.html does not check the origin of postMessage before adding the content to the webpage. The vulnerable code allows any origin to postMessage on the browser window and feeds attacker's input to parts using which attacker can execute arbitrary javascript code on victim's browser window hosting reveal.js",
      "published_date":"2022-03-02",
      "chain_len":1,
      "project":"https:\/\/github.com\/hakimel\/reveal.js",
      "commit_href":"https:\/\/github.com\/hakimel\/reveal.js\/commit\/32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2",
      "commit_sha":"32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2",
      "patch":"SINGLE",
      "chain_ord":"['32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2']",
      "before_first_fix_commit":"{'e33c3c72f93d4c70ded3a90f5918f60082c96451'}",
      "last_fix_commit":"32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/26\/2022, 11:46:18",
      "message":"Fix DOM XSS",
      "author":"r0hanSH",
      "comments":"{'com_1': {'author': 'Zhila136', 'datetime': '06\/16\/2022, 03:13:17', 'body': '\u062e\u062f\u0645\u0627\u062a: \u0647\u0645\u0631\u0627\u0647 \u06a9\u0627\u0631\u062a \\r\\n\u0646\u0648\u0639 \u0633\u0631\u0648\u06cc\u0633: \u0647\u0645\u0631\u0627\u0647 \u06a9\u0627\u0631\u062a \u0633\u067e\u0647\\r\\n\u0634\u0645\u0627\u0631\u0647 \u06a9\u0627\u0631\u062a: 9243 3628 1010 5892\\r\\n\u0628\u0646\u0627\u0645: \u0627\u0628\u0631\u0627\u0647\u06cc\u0645 \u0645\u0631\u0627\u062f\u06cc \u0627\u0633\u062a\u06cc\u0627\u0631\\r\\n\u0645\u0648\u062c\u0648\u062f\u06cc \u06a9\u0627\u0631\u062a:\\r\\n147,000,000,000,000\u0631\u06cc\u0627\u0644\\r\\n\u0645\u0628\u0644\u063a \u0642\u0627\u0628\u0644 \u0628\u0631\u062f\u0627\u0634\u062a:\\r\\n147,000,000,000,000\u0631\u06cc\u0627\u0644\\r\\n\u06a9\u062f \u067e\u06cc\u06af\u06cc\u0631\u06cc:963877\\r\\n\u0634\u0645\u0627\u0631\u0647 \u0645\u0631\u062c\u0639:94382963877\\r\\n\u06a9\u062f\u0633\u062f\u0627\u062f:20060530\\r\\nCODETRANSFER:G0956DVY87\\r\\nCOMMON ACCOUNT:947022366\\r\\nISIN:XS2111948803\\r\\nCFI CODE:DBFUFB\\r\\n\\r\\n\u0648\u0636\u0639\u06cc\u062a \u06a9\u0627\u0631\u062a: \u0627\u06a9\u062a\u06cc\u0648 \u0648 \u0642\u0627\u0628\u0644 \u062f\u0633\u062a\u0631\u0633\u06cc\\r\\n            \u0633\u0631\u0648\u0631 \u0628\u0627\u0646\u06a9 \u0633\u067e\u0647'}, 'com_2': {'author': 'Zhila136', 'datetime': '06\/16\/2022, 03:13:31', 'body': '> \u062e\u062f\u0645\u0627\u062a: \u0647\u0645\u0631\u0627\u0647 \u06a9\u0627\u0631\u062a \u0646\u0648\u0639 \u0633\u0631\u0648\u06cc\u0633: \u0647\u0645\u0631\u0627\u0647 \u06a9\u0627\u0631\u062a \u0633\u067e\u0647 \u0634\u0645\u0627\u0631\u0647 \u06a9\u0627\u0631\u062a: 9243 3628 1010 5892 \u0628\u0646\u0627\u0645: \u0627\u0628\u0631\u0627\u0647\u06cc\u0645 \u0645\u0631\u0627\u062f\u06cc \u0627\u0633\u062a\u06cc\u0627\u0631 \u0645\u0648\u062c\u0648\u062f\u06cc \u06a9\u0627\u0631\u062a: 147,000,000,000,000\u0631\u06cc\u0627\u0644 \u0645\u0628\u0644\u063a \u0642\u0627\u0628\u0644 \u0628\u0631\u062f\u0627\u0634\u062a: 147,000,000,000,000\u0631\u06cc\u0627\u0644 \u06a9\u062f \u067e\u06cc\u06af\u06cc\u0631\u06cc:963877 \u0634\u0645\u0627\u0631\u0647 \u0645\u0631\u062c\u0639:94382963877 \u06a9\u062f\u0633\u062f\u0627\u062f:20060530 CODETRANSFER:G0956DVY87 COMMON ACCOUNT: 947022366 ISIN:XS2111948803 \u06a9\u062f CFI:DBFUFB\\r\\n> \\r\\n> \u06a9\u0627\u0631\u062a \u0648\u0636\u0639\u06cc\u062a: \u0627\u06a9\u062a\u06cc\u0648 \u0648 \u0642\u0627\u0628\u0644 \u062f\u0633\u062a\u0631\u0633\u06cc \u0633\u0631\u0648\u0631 \u0628\u0627\u0646\u06a9 \u0633\u067e\u0647'}, 'com_3': {'author': 'Zhila136', 'datetime': '06\/16\/2022, 03:13:50', 'body': '![\u06f2\u06f0\u06f2\u06f2\u06f0\u06f6\u06f1\u06f6_\u06f0\u06f7\u06f3\u06f7\u06f4\u06f0](https:\/\/user-images.githubusercontent.com\/97744031\/173983277-3cf21aef-9310-4a21-b681-3457044107ad.jpg)'}}",
      "stats":"{'additions': 4, 'deletions': 0, 'total': 4}",
      "files":"{'plugin\/notes\/speaker-view.html': {'additions': 4, 'deletions': 0, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/hakimel\/reveal.js\/raw\/32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2\/plugin%2Fnotes%2Fspeaker-view.html', 'patch': '@@ -368,6 +368,10 @@ <h4 class=\"label\">Notes<\/h4>\\n \\n \\t\\t\\t\\twindow.addEventListener( \\'message\\', function( event ) {\\n \\n+\\t\\t\\t\\t\\tif (window.location.origin !== event.origin){\\n+\\t\\t\\t\\t\\t\\treturn;\\n+\\t\\t\\t\\t\\t}\\n+\\n \\t\\t\\t\\t\\tclearTimeout( connectionTimeout );\\n \\t\\t\\t\\t\\tconnectionStatus.style.display = \\'none\\';'}}",
      "message_norm":"fix dom xss",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['plugin\/notes\/speaker-view.html'])",
      "num_files":1.0,
      "patch_content":"From 32cdd3b1872ba8e2267c9e87ae216cb55f40f4d2 Mon Sep 17 00:00:00 2001\nFrom: r0hanSH <i.am.lone.survivor@protonmail.com>\nDate: Sat, 26 Feb 2022 17:16:18 +0530\nSubject: [PATCH] Fix DOM XSS\n\n---\n plugin\/notes\/speaker-view.html | 4 ++++\n 1 file changed, 4 insertions(+)\n\ndiff --git a\/plugin\/notes\/speaker-view.html b\/plugin\/notes\/speaker-view.html\nindex 3cf492db1a9..0c77390caea 100644\n--- a\/plugin\/notes\/speaker-view.html\n+++ b\/plugin\/notes\/speaker-view.html\n@@ -368,6 +368,10 @@ <h4 class=\"label\">Notes<\/h4>\n \n \t\t\t\twindow.addEventListener( 'message', function( event ) {\n \n+\t\t\t\t\tif (window.location.origin !== event.origin){\n+\t\t\t\t\t\treturn;\n+\t\t\t\t\t}\n+\n \t\t\t\t\tclearTimeout( connectionTimeout );\n \t\t\t\t\tconnectionStatus.style.display = 'none';",
      "code_diff":"@@ -368,6 +368,10 @@ <h4 class=\"label\">Notes<\/h4>\n \n \t\t\t\twindow.addEventListener( 'message', function( event ) {\n \n+\t\t\t\t\tif (window.location.origin !== event.origin){\n+\t\t\t\t\t\treturn;\n+\t\t\t\t\t}\n+\n \t\t\t\t\tclearTimeout( connectionTimeout );\n \t\t\t\t\tconnectionStatus.style.display = 'none';"
    },
    {
      "index":77,
      "vuln_id":"GHSA-h24f-9mm4-w336",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/omphalos\/crud-file-server\/commit\/4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting (XSS) - Stored in crud-file-server Versions of `crud-file-server` before 0.8.0 are vulnerable to stored cross-site scripting (XSS). This is due to insufficient santiziation of filenames when directory index is served by `crud-file-server`.\n\n\n## Recommendation\n\nUpdate to version 0.8.0 or later.",
      "published_date":"2018-07-18",
      "chain_len":1,
      "project":"https:\/\/github.com\/omphalos\/crud-file-server",
      "commit_href":"https:\/\/github.com\/omphalos\/crud-file-server\/commit\/4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa",
      "commit_sha":"4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa",
      "patch":"SINGLE",
      "chain_ord":"['4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa']",
      "before_first_fix_commit":"{'0c45fc64f0c0aeb23fe515c95e29f6485803de65'}",
      "last_fix_commit":"4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/14\/2018, 23:29:21",
      "message":"Fix not sanitizing file names rendered in html",
      "author":"omphalos",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 1, 'total': 4}",
      "files":"{'crud-file-server.js': {'additions': 3, 'deletions': 1, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/omphalos\/crud-file-server\/raw\/4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa\/crud-file-server.js', 'patch': '@@ -140,7 +140,9 @@ exports.handleRequest = function(vpath, path, req, res, readOnly, logHeadRequest\\n \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tvar name = results[f].name;\\r\\n \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tvar normalized = url + \\'\/\\' + name;\\r\\n \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\twhile(normalized[0] == \\'\/\\') { normalized = normalized.slice(1, normalized.length); }\\r\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tres.write(\\'\\\\r\\\\n<p><a href=\"\/\\' + normalized + \\'\">\\' + name + \\'<\/a><\/p>\\');\\r\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tif(normalized.indexOf(\\'\"\\') >= 0) throw new Error(\\'unsupported file name\\')\\r\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tname = name.replace(\/&\/g, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\');\\r\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tres.write(\\'\\\\r\\\\n<p><a href=\"\/\\' + normalized + \\'\"><span>\\' + name + \\'<\/span><\/a><\/p>\\');\\r\\n \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t}\\r\\n \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\tres.end(\\'\\\\r\\\\n<\/body><\/html>\\');\\r\\n \\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t}'}}",
      "message_norm":"fix not sanitizing file names rendered in html",
      "language":"en",
      "entities":"[('sanitizing', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['crud-file-server.js'])",
      "num_files":1.0,
      "patch_content":"From 4155bfe068bf211b49a0b3ffd06e78cbaf1b40fa Mon Sep 17 00:00:00 2001\nFrom: omphalos <omph.alos@yahoo.com>\nDate: Wed, 14 Feb 2018 17:29:21 -0600\nSubject: [PATCH] Fix not sanitizing file names rendered in html\n\n---\n crud-file-server.js | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a\/crud-file-server.js b\/crud-file-server.js\nindex ad8ae00..c6147c2 100644\n--- a\/crud-file-server.js\n+++ b\/crud-file-server.js\n@@ -140,7 +140,9 @@ exports.handleRequest = function(vpath, path, req, res, readOnly, logHeadRequest\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar name = results[f].name;\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar normalized = url + '\/' + name;\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhile(normalized[0] == '\/') { normalized = normalized.slice(1, normalized.length); }\r\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.write('\\r\\n<p><a href=\"\/' + normalized + '\">' + name + '<\/a><\/p>');\r\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(normalized.indexOf('\"') >= 0) throw new Error('unsupported file name')\r\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname = name.replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;');\r\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.write('\\r\\n<p><a href=\"\/' + normalized + '\"><span>' + name + '<\/span><\/a><\/p>');\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t\tres.end('\\r\\n<\/body><\/html>');\r\n \t\t\t\t\t\t\t\t\t\t\t\t\t}",
      "code_diff":"@@ -140,7 +140,9 @@ exports.handleRequest = function(vpath, path, req, res, readOnly, logHeadRequest\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar name = results[f].name;\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar normalized = url + '\/' + name;\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t\twhile(normalized[0] == '\/') { normalized = normalized.slice(1, normalized.length); }\n-\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.write('\\r\\n<p><a href=\"\/' + normalized + '\">' + name + '<\/a><\/p>');\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(normalized.indexOf('\"') >= 0) throw new Error('unsupported file name')\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname = name.replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;');\n+\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tres.write('\\r\\n<p><a href=\"\/' + normalized + '\"><span>' + name + '<\/span><\/a><\/p>');\n \t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\t\t\t\t\t\t\tres.end('\\r\\n<\/body><\/html>');\n \t\t\t\t\t\t\t\t\t\t\t\t\t}"
    },
    {
      "index":78,
      "vuln_id":"GHSA-jpj5-hg26-6jgc",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/Xhofe\/alist\/commit\/6af17e2509a400979420f613fd7f2f9721fdcd6e'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Alist Alist versions 2.0.10 through 2.1.0 were discovered to contain a cross-site scripting (XSS) vulnerability via \/i\/:data\/ipa.plist. This issue was fixed in version 2.1.1.",
      "published_date":"2022-03-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/Xhofe\/alist",
      "commit_href":"https:\/\/github.com\/Xhofe\/alist\/commit\/6af17e2509a400979420f613fd7f2f9721fdcd6e",
      "commit_sha":"6af17e2509a400979420f613fd7f2f9721fdcd6e",
      "patch":"SINGLE",
      "chain_ord":"['6af17e2509a400979420f613fd7f2f9721fdcd6e']",
      "before_first_fix_commit":"{'5193b2aa7df73231ebf68e90b3295f2a5c0916a2'}",
      "last_fix_commit":"6af17e2509a400979420f613fd7f2f9721fdcd6e",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/01\/2022, 12:09:25",
      "message":":lock: fix #645 xss vulnerability",
      "author":"Xhofe",
      "comments":null,
      "stats":"{'additions': 9, 'deletions': 0, 'total': 9}",
      "files":"{'server\/controllers\/other.go': {'additions': 9, 'deletions': 0, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/alist-org\/alist\/raw\/6af17e2509a400979420f613fd7f2f9721fdcd6e\/server%2Fcontrollers%2Fother.go', 'patch': '@@ -7,6 +7,7 @@ import (\\n \\t\"github.com\/Xhofe\/alist\/server\/common\"\\n \\t\"github.com\/Xhofe\/alist\/utils\"\\n \\t\"github.com\/gin-gonic\/gin\"\\n+\\t\"net\/url\"\\n \\t\"strings\"\\n )\\n \\n@@ -24,11 +25,19 @@ func Plist(c *gin.Context) {\\n \\t\\treturn\\n \\t}\\n \\tu := string(bytes)\\n+\\tuUrl, err := url.Parse(u)\\n+\\tif err != nil {\\n+\\t\\tcommon.ErrorResp(c, err, 500)\\n+\\t\\treturn\\n+\\t}\\n \\tname := utils.Base(u)\\n+\\tu = uUrl.String()\\n \\tipaIndex := strings.Index(name, \".ipa\")\\n \\tif ipaIndex != -1 {\\n \\t\\tname = name[:ipaIndex]\\n \\t}\\n+\\tname = strings.ReplaceAll(name, \"<\", \"[\")\\n+\\tname = strings.ReplaceAll(name, \">\", \"]\")\\n \\tplist := fmt.Sprintf(`<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">\\n <plist version=\"1.0\">\\n     <dict>'}}",
      "message_norm":":lock: fix #645 xss vulnerability",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('#645', 'ISSUE', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/controllers\/other.go'])",
      "num_files":1.0,
      "patch_content":"From 6af17e2509a400979420f613fd7f2f9721fdcd6e Mon Sep 17 00:00:00 2001\nFrom: Xhofe <i@nn.ci>\nDate: Tue, 1 Mar 2022 20:09:25 +0800\nSubject: [PATCH] :lock: fix #645 xss vulnerability\n\n---\n server\/controllers\/other.go | 9 +++++++++\n 1 file changed, 9 insertions(+)\n\ndiff --git a\/server\/controllers\/other.go b\/server\/controllers\/other.go\nindex 6a4968f3997..79e36840f04 100644\n--- a\/server\/controllers\/other.go\n+++ b\/server\/controllers\/other.go\n@@ -7,6 +7,7 @@ import (\n \t\"github.com\/Xhofe\/alist\/server\/common\"\n \t\"github.com\/Xhofe\/alist\/utils\"\n \t\"github.com\/gin-gonic\/gin\"\n+\t\"net\/url\"\n \t\"strings\"\n )\n \n@@ -24,11 +25,19 @@ func Plist(c *gin.Context) {\n \t\treturn\n \t}\n \tu := string(bytes)\n+\tuUrl, err := url.Parse(u)\n+\tif err != nil {\n+\t\tcommon.ErrorResp(c, err, 500)\n+\t\treturn\n+\t}\n \tname := utils.Base(u)\n+\tu = uUrl.String()\n \tipaIndex := strings.Index(name, \".ipa\")\n \tif ipaIndex != -1 {\n \t\tname = name[:ipaIndex]\n \t}\n+\tname = strings.ReplaceAll(name, \"<\", \"[\")\n+\tname = strings.ReplaceAll(name, \">\", \"]\")\n \tplist := fmt.Sprintf(`<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">\n <plist version=\"1.0\">\n     <dict>",
      "code_diff":"@@ -7,6 +7,7 @@ import (\n \t\"github.com\/Xhofe\/alist\/server\/common\"\n \t\"github.com\/Xhofe\/alist\/utils\"\n \t\"github.com\/gin-gonic\/gin\"\n+\t\"net\/url\"\n \t\"strings\"\n )\n \n@@ -24,11 +25,19 @@ func Plist(c *gin.Context) {\n \t\treturn\n \t}\n \tu := string(bytes)\n+\tuUrl, err := url.Parse(u)\n+\tif err != nil {\n+\t\tcommon.ErrorResp(c, err, 500)\n+\t\treturn\n+\t}\n \tname := utils.Base(u)\n+\tu = uUrl.String()\n \tipaIndex := strings.Index(name, \".ipa\")\n \tif ipaIndex != -1 {\n \t\tname = name[:ipaIndex]\n \t}\n+\tname = strings.ReplaceAll(name, \"<\", \"[\")\n+\tname = strings.ReplaceAll(name, \">\", \"]\")\n \tplist := fmt.Sprintf(`<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE plist PUBLIC \"-\/\/Apple\/\/DTD PLIST 1.0\/\/EN\" \"http:\/\/www.apple.com\/DTDs\/PropertyList-1.0.dtd\">\n <plist version=\"1.0\">\n     <dict>"
    },
    {
      "index":79,
      "vuln_id":"GHSA-66gw-5xpf-gfp5",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/ipython\/ipython\/commit\/c2078a53543ed502efd968649fee1125e0eb549c', 'https:\/\/github.com\/ipython\/ipython\/commit\/7222bd53ad089a65fd610fab4626f9d0ab47dfce'}",
      "dataset":"osv",
      "summary":"Improper Neutralization of Input During Web Page Generation in IPython Cross-site scripting (XSS) vulnerability in IPython before 3.2 allows remote attackers to inject arbitrary web script or HTML via vectors involving JSON error messages and the \/api\/notebooks path.",
      "published_date":"2022-05-13",
      "chain_len":2,
      "project":"https:\/\/github.com\/ipython\/ipython",
      "commit_href":"https:\/\/github.com\/ipython\/ipython\/commit\/c2078a53543ed502efd968649fee1125e0eb549c",
      "commit_sha":"c2078a53543ed502efd968649fee1125e0eb549c",
      "patch":"MULTI",
      "chain_ord":"['7222bd53ad089a65fd610fab4626f9d0ab47dfce', 'c2078a53543ed502efd968649fee1125e0eb549c']",
      "before_first_fix_commit":"{'64966ea2ae0d44a9c059efcb299db66cbc66ef04'}",
      "last_fix_commit":"c2078a53543ed502efd968649fee1125e0eb549c",
      "chain_ord_pos":2.0,
      "commit_datetime":"06\/22\/2015, 04:12:34",
      "message":"Set content type in json_error to application\/json",
      "author":"Kyle Kelley",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 0, 'total': 2}",
      "files":"{'IPython\/html\/base\/handlers.py': {'additions': 2, 'deletions': 0, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ipython\/ipython\/raw\/c2078a53543ed502efd968649fee1125e0eb549c\/IPython%2Fhtml%2Fbase%2Fhandlers.py', 'patch': '@@ -339,6 +339,7 @@ def wrapper(self, *args, **kwargs):\\n             message = e.log_message\\n             self.log.warn(message)\\n             self.set_status(e.status_code)\\n+            self.set_header(\\'Content-Type\\', \\'application\/json\\')\\n             self.finish(json.dumps(dict(message=message)))\\n         except Exception:\\n             self.log.error(\"Unhandled error in API request\", exc_info=True)\\n@@ -348,6 +349,7 @@ def wrapper(self, *args, **kwargs):\\n             self.set_status(status)\\n             tb_text = \\'\\'.join(traceback.format_exception(t, value, tb))\\n             reply = dict(message=message, traceback=tb_text)\\n+            self.set_header(\\'Content-Type\\', \\'application\/json\\')\\n             self.finish(json.dumps(reply))\\n         else:\\n             return result'}}",
      "message_norm":"set content type in json_error to application\/json",
      "language":"en",
      "entities":"[('json_error', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['IPython\/html\/base\/handlers.py'])",
      "num_files":1.0,
      "patch_content":"From c2078a53543ed502efd968649fee1125e0eb549c Mon Sep 17 00:00:00 2001\nFrom: Kyle Kelley <rgbkrk@gmail.com>\nDate: Sun, 21 Jun 2015 23:12:34 -0500\nSubject: [PATCH] Set content type in json_error to application\/json\n\n---\n IPython\/html\/base\/handlers.py | 2 ++\n 1 file changed, 2 insertions(+)\n\ndiff --git a\/IPython\/html\/base\/handlers.py b\/IPython\/html\/base\/handlers.py\nindex 0eb7ac71992..40a9a630460 100644\n--- a\/IPython\/html\/base\/handlers.py\n+++ b\/IPython\/html\/base\/handlers.py\n@@ -339,6 +339,7 @@ def wrapper(self, *args, **kwargs):\n             message = e.log_message\n             self.log.warn(message)\n             self.set_status(e.status_code)\n+            self.set_header('Content-Type', 'application\/json')\n             self.finish(json.dumps(dict(message=message)))\n         except Exception:\n             self.log.error(\"Unhandled error in API request\", exc_info=True)\n@@ -348,6 +349,7 @@ def wrapper(self, *args, **kwargs):\n             self.set_status(status)\n             tb_text = ''.join(traceback.format_exception(t, value, tb))\n             reply = dict(message=message, traceback=tb_text)\n+            self.set_header('Content-Type', 'application\/json')\n             self.finish(json.dumps(reply))\n         else:\n             return result",
      "code_diff":"@@ -339,6 +339,7 @@ def wrapper(self, *args, **kwargs):\n             message = e.log_message\n             self.log.warn(message)\n             self.set_status(e.status_code)\n+            self.set_header('Content-Type', 'application\/json')\n             self.finish(json.dumps(dict(message=message)))\n         except Exception:\n             self.log.error(\"Unhandled error in API request\", exc_info=True)\n@@ -348,6 +349,7 @@ def wrapper(self, *args, **kwargs):\n             self.set_status(status)\n             tb_text = ''.join(traceback.format_exception(t, value, tb))\n             reply = dict(message=message, traceback=tb_text)\n+            self.set_header('Content-Type', 'application\/json')\n             self.finish(json.dumps(reply))\n         else:\n             return result"
    },
    {
      "index":80,
      "vuln_id":"GHSA-5fh3-25xr-g85h",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/ff81e6d5366c2cfb15618793ad919ae4cbb3ac57'}",
      "dataset":"osv",
      "summary":"snipe-it is vulnerable to Cross-site Scripting snipe-it is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').",
      "published_date":"2021-12-03",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/ff81e6d5366c2cfb15618793ad919ae4cbb3ac57",
      "commit_sha":"ff81e6d5366c2cfb15618793ad919ae4cbb3ac57",
      "patch":"SINGLE",
      "chain_ord":"['ff81e6d5366c2cfb15618793ad919ae4cbb3ac57']",
      "before_first_fix_commit":"{'3b68a6f1befeef504c0a3263e87a2afd55abc430', '00fad35c2a6ddc9813d3322da91086eb06cb7406'}",
      "last_fix_commit":"ff81e6d5366c2cfb15618793ad919ae4cbb3ac57",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/25\/2021, 03:56:36",
      "message":"Merge pull request #10361 from snipe\/fixes\/xss_in_accessories_checkout_notes\n\nEscape notes in transformCheckedOutAccessory",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/Http\/Transformers\/AccessoriesTransformer.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/ff81e6d5366c2cfb15618793ad919ae4cbb3ac57\/app%2FHttp%2FTransformers%2FAccessoriesTransformer.php', 'patch': \"@@ -82,7 +82,7 @@ public function transformCheckedoutAccessory ($accessory, $accessory_users, $tot\\n                 'first_name'=> e($user->first_name),\\n                 'last_name'=> e($user->last_name),\\n                 'employee_number' =>  e($user->employee_num),\\n-                'checkout_notes' => $user->pivot->note,\\n+                'checkout_notes' => e($user->pivot->note),\\n                 'last_checkout' => Helper::getFormattedDateObject($user->pivot->created_at, 'datetime'),\\n                 'type' => 'user',\\n                 'available_actions' => ['checkin' => true]\"}}",
      "message_norm":"merge pull request #10361 from snipe\/fixes\/xss_in_accessories_checkout_notes\n\nescape notes in transformcheckedoutaccessory",
      "language":"en",
      "entities":"[('#10361', 'ISSUE', ''), ('xss_in_accessories_checkout_notes', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Transformers\/AccessoriesTransformer.php'])",
      "num_files":1.0,
      "patch_content":"From 00fad35c2a6ddc9813d3322da91086eb06cb7406 Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Wed, 24 Nov 2021 19:54:45 -0800\nSubject: [PATCH] Escape notes in transformCheckedOutAccessory\n\nSigned-off-by: snipe <snipe@snipe.net>\n---\n app\/Http\/Transformers\/AccessoriesTransformer.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/Http\/Transformers\/AccessoriesTransformer.php b\/app\/Http\/Transformers\/AccessoriesTransformer.php\nindex d40642d875c6..1bc70f23140f 100644\n--- a\/app\/Http\/Transformers\/AccessoriesTransformer.php\n+++ b\/app\/Http\/Transformers\/AccessoriesTransformer.php\n@@ -82,7 +82,7 @@ public function transformCheckedoutAccessory ($accessory, $accessory_users, $tot\n                 'first_name'=> e($user->first_name),\n                 'last_name'=> e($user->last_name),\n                 'employee_number' =>  e($user->employee_num),\n-                'checkout_notes' => $user->pivot->note,\n+                'checkout_notes' => e($user->pivot->note),\n                 'last_checkout' => Helper::getFormattedDateObject($user->pivot->created_at, 'datetime'),\n                 'type' => 'user',\n                 'available_actions' => ['checkin' => true]",
      "code_diff":"@@ -82,7 +82,7 @@ public function transformCheckedoutAccessory ($accessory, $accessory_users, $tot\n                 'first_name'=> e($user->first_name),\n                 'last_name'=> e($user->last_name),\n                 'employee_number' =>  e($user->employee_num),\n-                'checkout_notes' => $user->pivot->note,\n+                'checkout_notes' => e($user->pivot->note),\n                 'last_checkout' => Helper::getFormattedDateObject($user->pivot->created_at, 'datetime'),\n                 'type' => 'user',\n                 'available_actions' => ['checkin' => true]"
    },
    {
      "index":81,
      "vuln_id":"GHSA-xg6r-5gx4-qxjm",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/invoiceninja\/invoiceninja\/commit\/1186eaa82375692d01d5ef3369c5b7bc7315b55f'}",
      "dataset":"osv",
      "summary":"invoiceninja is vulnerable to Cross-site Scripting invoiceninja is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2022-01-06",
      "chain_len":1,
      "project":"https:\/\/github.com\/invoiceninja\/invoiceninja",
      "commit_href":"https:\/\/github.com\/invoiceninja\/invoiceninja\/commit\/1186eaa82375692d01d5ef3369c5b7bc7315b55f",
      "commit_sha":"1186eaa82375692d01d5ef3369c5b7bc7315b55f",
      "patch":"SINGLE",
      "chain_ord":"['1186eaa82375692d01d5ef3369c5b7bc7315b55f']",
      "before_first_fix_commit":"{'ac194665de6728e4091f273ef2e01b4c48369fcd'}",
      "last_fix_commit":"1186eaa82375692d01d5ef3369c5b7bc7315b55f",
      "chain_ord_pos":1.0,
      "commit_datetime":"12\/10\/2021, 03:00:22",
      "message":"Fixes for client password reset",
      "author":"David Bomba",
      "comments":null,
      "stats":"{'additions': 7, 'deletions': 6, 'total': 13}",
      "files":"{'app\/Http\/Controllers\/Auth\/ContactForgotPasswordController.php': {'additions': 7, 'deletions': 6, 'changes': 13, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/invoiceninja\/invoiceninja\/raw\/1186eaa82375692d01d5ef3369c5b7bc7315b55f\/app%2FHttp%2FControllers%2FAuth%2FContactForgotPasswordController.php', 'patch': \"@@ -93,14 +93,15 @@ public function broker()\\n \\n     public function sendResetLinkEmail(ContactPasswordResetRequest $request)\\n     {\\n-\\n-        if(Ninja::isHosted() && $request->session()->has('company_key'))\\n-            MultiDB::findAndSetDbByCompanyKey($request->session()->get('company_key'));\\n+        if(Ninja::isHosted() && $request->has('company_key'))\\n+            MultiDB::findAndSetDbByCompanyKey($request->input('company_key'));\\n         \\n         $this->validateEmail($request);\\n \\n-        $company = Company::where('company_key', $request->session()->get('company_key'))->first();\\n-        $contact = ClientContact::where(['company_id' => $company->id, 'email' => $request->input('email')])->first();\\n+        \/\/ $company = Company::where('company_key', $request->input('company_key'))->first();\\n+        \/\/ $contact = ClientContact::where(['company_id' => $company->id, 'email' => $request->input('email')])->first();\\n+\\n+        $contact = ClientContact::where(['email' => $request->input('email')])->first();\\n \\n         $response = false;\\n \\n@@ -117,7 +118,7 @@ public function sendResetLinkEmail(ContactPasswordResetRequest $request)\\n             return $this->sendResetLinkFailedResponse($request, Password::INVALID_USER);\\n \\n         \/\/ We will send the password reset link to this user. Once we have attempted\\n-        \/\/ to send the link, we will examine the response then see the message we\\n+        \/\/ to send the link, we will examine thuser@example.ce response then see the message we\\n         \/\/ need to show to the user. Finally, we'll send out a proper response.\\n         \/\/ $response = $this->broker()->sendResetLink(\\n         \/\/     $this->credentials($request)\"}}",
      "message_norm":"fixes for client password reset",
      "language":"en",
      "entities":"[('password', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Controllers\/Auth\/ContactForgotPasswordController.php'])",
      "num_files":1.0,
      "patch_content":"From 1186eaa82375692d01d5ef3369c5b7bc7315b55f Mon Sep 17 00:00:00 2001\nFrom: David Bomba <turbo124@gmail.com>\nDate: Fri, 10 Dec 2021 14:00:22 +1100\nSubject: [PATCH] Fixes for client password reset\n\n---\n ...\/Auth\/ContactForgotPasswordController.php        | 13 +++++++------\n 1 file changed, 7 insertions(+), 6 deletions(-)\n\ndiff --git a\/app\/Http\/Controllers\/Auth\/ContactForgotPasswordController.php b\/app\/Http\/Controllers\/Auth\/ContactForgotPasswordController.php\nindex bdfe94431c..f88e99a43e 100644\n--- a\/app\/Http\/Controllers\/Auth\/ContactForgotPasswordController.php\n+++ b\/app\/Http\/Controllers\/Auth\/ContactForgotPasswordController.php\n@@ -93,14 +93,15 @@ public function broker()\n \n     public function sendResetLinkEmail(ContactPasswordResetRequest $request)\n     {\n-\n-        if(Ninja::isHosted() && $request->session()->has('company_key'))\n-            MultiDB::findAndSetDbByCompanyKey($request->session()->get('company_key'));\n+        if(Ninja::isHosted() && $request->has('company_key'))\n+            MultiDB::findAndSetDbByCompanyKey($request->input('company_key'));\n         \n         $this->validateEmail($request);\n \n-        $company = Company::where('company_key', $request->session()->get('company_key'))->first();\n-        $contact = ClientContact::where(['company_id' => $company->id, 'email' => $request->input('email')])->first();\n+        \/\/ $company = Company::where('company_key', $request->input('company_key'))->first();\n+        \/\/ $contact = ClientContact::where(['company_id' => $company->id, 'email' => $request->input('email')])->first();\n+\n+        $contact = ClientContact::where(['email' => $request->input('email')])->first();\n \n         $response = false;\n \n@@ -117,7 +118,7 @@ public function sendResetLinkEmail(ContactPasswordResetRequest $request)\n             return $this->sendResetLinkFailedResponse($request, Password::INVALID_USER);\n \n         \/\/ We will send the password reset link to this user. Once we have attempted\n-        \/\/ to send the link, we will examine the response then see the message we\n+        \/\/ to send the link, we will examine thuser@example.ce response then see the message we\n         \/\/ need to show to the user. Finally, we'll send out a proper response.\n         \/\/ $response = $this->broker()->sendResetLink(\n         \/\/     $this->credentials($request)",
      "code_diff":"@@ -93,14 +93,15 @@ public function broker()\n \n     public function sendResetLinkEmail(ContactPasswordResetRequest $request)\n     {\n-\n-        if(Ninja::isHosted() && $request->session()->has('company_key'))\n-            MultiDB::findAndSetDbByCompanyKey($request->session()->get('company_key'));\n+        if(Ninja::isHosted() && $request->has('company_key'))\n+            MultiDB::findAndSetDbByCompanyKey($request->input('company_key'));\n         \n         $this->validateEmail($request);\n \n-        $company = Company::where('company_key', $request->session()->get('company_key'))->first();\n-        $contact = ClientContact::where(['company_id' => $company->id, 'email' => $request->input('email')])->first();\n+        \/\/ $company = Company::where('company_key', $request->input('company_key'))->first();\n+        \/\/ $contact = ClientContact::where(['company_id' => $company->id, 'email' => $request->input('email')])->first();\n+\n+        $contact = ClientContact::where(['email' => $request->input('email')])->first();\n \n         $response = false;\n \n@@ -117,7 +118,7 @@ public function sendResetLinkEmail(ContactPasswordResetRequest $request)\n             return $this->sendResetLinkFailedResponse($request, Password::INVALID_USER);\n \n         \/\/ We will send the password reset link to this user. Once we have attempted\n-        \/\/ to send the link, we will examine the response then see the message we\n+        \/\/ to send the link, we will examine thuser@example.ce response then see the message we\n         \/\/ need to show to the user. Finally, we'll send out a proper response.\n         \/\/ $response = $this->broker()->sendResetLink(\n         \/\/     $this->credentials($request)"
    },
    {
      "index":82,
      "vuln_id":"GHSA-hm45-mgqm-gjm4",
      "cwe_id":"{'CWE-79'}",
      "score":7.7,
      "chain":"{'https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/commit\/a6b9785338003ec87fb75305e7d1cc2d40c7ab91', 'https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/commit\/99d88b840674674166ce005b784ae8e31e955ab1'}",
      "dataset":"osv",
      "summary":"Remote Code Execution (RCE) Exploit on Cross Site Scripting (XSS) Vulnerability ### Impact\nA RCE exploit has been discovered in the Red Discord Bot - Dashboard Webserver: this exploit allows Discord users with specially crafted Server names and Usernames\/Nicknames to inject code into the webserver front-end code.  By abusing this exploit, it's possible to perform destructive actions and\/or access sensitive information.\n\n### Patches\nThis high severity exploit has been fixed on version `0.1.7a`.\n\n### Workarounds\nThere are no workarounds, bot owners must upgrade their relevant packages (Dashboard module and Dashboard webserver) in order to patch this issue\n\n### References\n- 99d88b8\n- a6b9785\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Cog-Creators\/Red-Dashboard](https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/issues\/new\/choose)\n* Over on the official [Red Server](https:\/\/discord.gg\/red) or at the Third Party Server [Toxic Layer](https:\/\/discord.gg\/vQZTdB9)",
      "published_date":"2020-12-08",
      "chain_len":2,
      "project":"https:\/\/github.com\/Cog-Creators\/Red-Dashboard",
      "commit_href":"https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/commit\/a6b9785338003ec87fb75305e7d1cc2d40c7ab91",
      "commit_sha":"a6b9785338003ec87fb75305e7d1cc2d40c7ab91",
      "patch":"MULTI",
      "chain_ord":"['99d88b840674674166ce005b784ae8e31e955ab1', 'a6b9785338003ec87fb75305e7d1cc2d40c7ab91']",
      "before_first_fix_commit":"{'261f00f52bbfee4db67f624fd7409bf08124a6c4'}",
      "last_fix_commit":"a6b9785338003ec87fb75305e7d1cc2d40c7ab91",
      "chain_ord_pos":2.0,
      "commit_datetime":"12\/01\/2020, 14:15:49",
      "message":"[UI] Fix SelectPicker not rendering properly",
      "author":"NeuroAssassin",
      "comments":null,
      "stats":"{'additions': 41, 'deletions': 16, 'total': 57}",
      "files":"{'reddash\/app\/home\/templates\/guild.html': {'additions': 41, 'deletions': 16, 'changes': 57, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/raw\/a6b9785338003ec87fb75305e7d1cc2d40c7ab91\/reddash%2Fapp%2Fhome%2Ftemplates%2Fguild.html', 'patch': '@@ -930,20 +930,20 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n             img.attr(\"src\", `${img.attr(\"data-src-url\")}png`)\\r\\n         }\\r\\n     }\\r\\n+\\r\\n+    function safe(str) {\\r\\n+        return String(str).replace(\/&\/g, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\').replace(\/\"\/g, \\'&quot;\\');\\r\\n+    }\\r\\n <\/script>\\r\\n \\r\\n {% if data[\\'status\\'] == 1 and data[\\'data\\'][\\'status\\'] == 1 %}\\r\\n \\r\\n-{% if \\'aliascc\\' in data[\\'data\\'][\\'permslist\\'] %}\\r\\n+{% if \\'aliascc\\' in data[\\'data\\'][\\'permslist\\'] and false%}\\r\\n <script>\\r\\n     \/* ---------------------------------------------------------------------------------------------------------------------\\r\\n                                                         Aliases group\\r\\n        --------------------------------------------------------------------------------------------------------------------- *\/\\r\\n \\r\\n-    function safe(str) {\\r\\n-        return String(str).replace(\/&\/g, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\').replace(\/\"\/g, \\'&quot;\\');\\r\\n-    }\\r\\n-\\r\\n     \/\/ Alias modal\\r\\n     $(document).on(\\'click\\', \\'.editaliasbutton\\', function () {\\r\\n         var command = $(this).parent().parent().data(\"command\")\\r\\n@@ -1186,28 +1186,35 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n             } else if (json.status === 1 && json.data.status === 0) {\\r\\n                 $(\"#targetstatus\").html(`{{ _(\\'Failed to fetch targets\\') }}: ${json.data.message}`)\\r\\n             } else {\\r\\n+                let big_ol_dict = {}\\r\\n                 select.html(\"\")\\r\\n \\r\\n                 var chopt = [`<optgroup label=\"{{ _(\\'Channels\\') }}\">`]\\r\\n                 for (let [id, name] of json.data.CHANNELS) {\\r\\n-                    chopt.push(`<option value=${id}>${name}<\/option>`)\\r\\n+                    chopt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\\r\\n+                    big_ol_dict[id] = name\\r\\n                 }\\r\\n                 chopt.push(\"<\/optgroup>\")\\r\\n                 select.append(chopt.join(\"\"))\\r\\n \\r\\n                 var ropt = [`<optgroup label=\"{{ _(\\'Roles\\') }}\">`]\\r\\n                 for (let [id, name] of json.data.ROLES) {\\r\\n-                    ropt.push(`<option value=${id}>${name}<\/option>`)\\r\\n+                    ropt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\\r\\n+                    big_ol_dict[id] = name\\r\\n                 }\\r\\n                 ropt.push(\"<\/optgroup>\")\\r\\n                 select.append(ropt.join(\"\"))\\r\\n \\r\\n                 var uopt = [`<optgroup label=\"{{ _(\\'Users\\') }}\">`]\\r\\n                 for (let [id, name] of json.data.USERS) {\\r\\n-                    uopt.push(`<option value=${id}>${name}<\/option>`)\\r\\n+                    uopt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\\r\\n+                    big_ol_dict[id] = name\\r\\n                 }\\r\\n                 uopt.push(\"<\/optgroup>\")\\r\\n                 select.append(uopt.join(\"\"))\\r\\n+                for (let [id, name] of Object.entries(big_ol_dict)) {\\r\\n+                    $(`.selectpicker-element-${id}`).text(name)\\r\\n+                }\\r\\n             }\\r\\n             select.selectpicker({ title: \"{{ _(\\'Choose target\\') }}\" })\\r\\n             select.removeAttr(\"disabled\")\\r\\n@@ -1299,18 +1306,24 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n                 $(\"#rulesdiv\").html(\"\")\\r\\n                 var overall = [\\'<h3 style=\"margin-bottom: 10px\">{{ _(\"Cog rules\") }}<\/h3>\\']\\r\\n                 var allcoglines = [\"<ul>\"]\\r\\n+\\r\\n+                let big_ol_dict_two = {}\\r\\n+                let cog_counter = 0\\r\\n+\\r\\n                 for (let [cog, rules] of Object.entries(json.data.COG)) {\\r\\n                     var coglines = []\\r\\n                     for (let rule of rules) {\\r\\n                         if (rule.type === \"Default\") {\\r\\n                             coglines.unshift(`<li>{{ _(\\'By default, users are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n                         } else if (rule.type === \"Role\") {\\r\\n-                            coglines.push(`<li>{{ _(\\'Users with the\\') }} <code>${rule.name}<\/code> {{ _(\\'role\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n+                            coglines.push(`<li>{{ _(\\'Users with the\\') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> {{ _(\\'role\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n                         } else if (rule.type === \"Channel\") {\\r\\n-                            coglines.push(`<li>{{ _(\\'Users in the\\') }} <code>${rule.name}<\/code> {{ _(\\'channel\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n+                            coglines.push(`<li>{{ _(\\'Users in the\\') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> {{ _(\\'channel\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n                         } else {\\r\\n-                            coglines.push(`<li>{{ _(\\'User\\') }} <code>${rule.name}<\/code> (${rule.id}) {{ _(\\'is\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n+                            coglines.push(`<li>{{ _(\\'User\\') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> (${rule.id}) {{ _(\\'is\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cog}<\/code> {{ _(\\'cog\\') }}.<\/li>`)\\r\\n                         }\\r\\n+                        big_ol_dict_two[`cog-rules-${cog_counter}`] = rule.name\\r\\n+                        cog_counter += 1\\r\\n                     }\\r\\n                     if (coglines) {\\r\\n                         allcoglines = allcoglines.concat(coglines)\\r\\n@@ -1324,18 +1337,23 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n \\r\\n                 overall.push(\\'<h3 style=\"margin-bottom: 10px\">{{ _(\"Command rules\") }}<\/h3>\\')\\r\\n                 var allcmdlines = [\"<ul>\"]\\r\\n+\\r\\n+                let cmd_counter = 0\\r\\n+\\r\\n                 for (let [cmd, rules] of Object.entries(json.data.COMMAND)) {\\r\\n                     var cmdlines = []\\r\\n                     for (let rule of rules) {\\r\\n                         if (rule.type === \"Default\") {\\r\\n                             cmdlines.unshift(`<li>{{ _(\\'By default, users are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n                         } else if (rule.type === \"Role\") {\\r\\n-                            cmdlines.push(`<li>{{ _(\\'Users with the\\') }} <code>${rule.name}<\/code> {{ _(\\'role\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n+                            cmdlines.push(`<li>{{ _(\\'Users with the\\') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> {{ _(\\'role\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n                         } else if (rule.type === \"Channel\") {\\r\\n-                            cmdlines.push(`<li>{{ _(\\'Users in the\\') }} <code>${rule.name}<\/code> {{ _(\\'channel\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n+                            cmdlines.push(`<li>{{ _(\\'Users in the\\') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> {{ _(\\'channel\\') }} (${rule.id}) {{ _(\\'are\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n                         } else {\\r\\n-                            cmdlines.push(`<li>{{ _(\\'User\\') }} <code>${rule.name}<\/code> (${rule.id}) {{ _(\\'is\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n+                            cmdlines.push(`<li>{{ _(\\'User\\') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> (${rule.id}) {{ _(\\'is\\') }} ${rule.permission} {{ _(\\'permission to use the\\') }} <code>${cmd}<\/code> {{ _(\\'command\\') }}.<\/li>`)\\r\\n                         }\\r\\n+                        big_ol_dict_two[`cmd-rules-${cmd_counter}`] = rule.name\\r\\n+                        cmd_counter += 1\\r\\n                     }\\r\\n                     if (cmdlines) {\\r\\n                         allcmdlines = allcmdlines.concat(cmdlines)\\r\\n@@ -1347,6 +1365,9 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n                 }\\r\\n                 overall = overall.concat(allcmdlines)\\r\\n                 $(\"#rulesdiv\").html(overall.join(\"\"))\\r\\n+                for (let [id, name] of Object.entries(big_ol_dict_two)) {\\r\\n+                    $(`#${id}`).text(name)\\r\\n+                }\\r\\n                 $(\"#fetchrulesstatus\").html(\"{{ _(\\'Refreshed rules\\') }}.\")\\r\\n             }\\r\\n         }\\r\\n@@ -1378,18 +1399,20 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n \\r\\n     $(document).on(\\'click\\', \\'.adminroleoption\\', function () {\\r\\n         var elm = $(this)\\r\\n+        let random_number = Math.floor(Math.random() * Math.floor(100000))\\r\\n         $(\"#adminrolelist\").append(`\\r\\n                 <li>\\r\\n                     <div class=\"row\">\\r\\n                         <div class=\"col-md-10 col-8\">\\r\\n-                            <input class=\"form-control adminroleinput\" value=\"${elm.text()}\" disabled=True data-id=\"${elm.attr(\"data-id\")}\">\\r\\n+                            <input class=\"form-control adminroleinput\" value=\"Loading...\" disabled=True data-id=\"${elm.attr(\"data-id\")}\" id=\"admin-role-${random_number}\">\\r\\n                         <\/div>\\r\\n                         <div class=\"col-md-1 col-1\">\\r\\n                             <span class=\"admin-role-x clickable\"><i class=\"tim-icons icon-simple-remove\" style=\"float: right; margin-top: 10px;\"><\/i><\/span>\\r\\n                         <\/div>\\r\\n                     <\/div>\\r\\n                 <\/li>\\r\\n             `)\\r\\n+        $(`#admin-role-${random_number}`).val(elm.text())\\r\\n         elm.remove()\\r\\n     })\\r\\n \\r\\n@@ -1442,18 +1465,20 @@ <h5>{{ data[\\'message\\'] }}<\/h5>\\n \\r\\n     $(document).on(\\'click\\', \\'.modroleoption\\', function () {\\r\\n         var elm = $(this)\\r\\n+        let random_number = Math.floor(Math.random() * Math.floor(100000))\\r\\n         $(\"#modrolelist\").append(`\\r\\n                 <li>\\r\\n                     <div class=\"row\">\\r\\n                         <div class=\"col-md-10 col-8\">\\r\\n-                            <input class=\"form-control modroleinput\" value=\"${elm.text()}\" disabled=True data-id=\"${elm.attr(\"data-id\")}\">\\r\\n+                            <input class=\"form-control modroleinput\" value=\"Loading...\" disabled=True data-id=\"${elm.attr(\"data-id\")}\" id=\"mod-role-${random_number}\">\\r\\n                         <\/div>\\r\\n                         <div class=\"col-md-1 col-1\">\\r\\n                             <span class=\"mod-role-x clickable\"><i class=\"tim-icons icon-simple-remove\" style=\"float: right; margin-top: 10px;\"><\/i><\/span>\\r\\n                         <\/div>\\r\\n                     <\/div>\\r\\n                 <\/li>\\r\\n             `)\\r\\n+        $(`#mod-role-${random_number}`).val(elm.text())\\r\\n         elm.remove()\\r\\n     })'}}",
      "message_norm":"[ui] fix selectpicker not rendering properly",
      "language":"en",
      "entities":null,
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['reddash\/app\/home\/templates\/guild.html'])",
      "num_files":1.0,
      "patch_content":"From a6b9785338003ec87fb75305e7d1cc2d40c7ab91 Mon Sep 17 00:00:00 2001\nFrom: NeuroAssassin <42872277+NeuroAssassin@users.noreply.github.com>\nDate: Tue, 1 Dec 2020 14:15:49 +0000\nSubject: [PATCH] [UI] Fix SelectPicker not rendering properly\n\n---\n reddash\/app\/home\/templates\/guild.html | 57 +++++++++++++++++++--------\n 1 file changed, 41 insertions(+), 16 deletions(-)\n\ndiff --git a\/reddash\/app\/home\/templates\/guild.html b\/reddash\/app\/home\/templates\/guild.html\nindex ac6d206..ef1aed5 100755\n--- a\/reddash\/app\/home\/templates\/guild.html\n+++ b\/reddash\/app\/home\/templates\/guild.html\n@@ -930,20 +930,20 @@ <h5>{{ data['message'] }}<\/h5>\n             img.attr(\"src\", `${img.attr(\"data-src-url\")}png`)\r\n         }\r\n     }\r\n+\r\n+    function safe(str) {\r\n+        return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\r\n+    }\r\n <\/script>\r\n \r\n {% if data['status'] == 1 and data['data']['status'] == 1 %}\r\n \r\n-{% if 'aliascc' in data['data']['permslist'] %}\r\n+{% if 'aliascc' in data['data']['permslist'] and false%}\r\n <script>\r\n     \/* ---------------------------------------------------------------------------------------------------------------------\r\n                                                         Aliases group\r\n        --------------------------------------------------------------------------------------------------------------------- *\/\r\n \r\n-    function safe(str) {\r\n-        return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\r\n-    }\r\n-\r\n     \/\/ Alias modal\r\n     $(document).on('click', '.editaliasbutton', function () {\r\n         var command = $(this).parent().parent().data(\"command\")\r\n@@ -1186,28 +1186,35 @@ <h5>{{ data['message'] }}<\/h5>\n             } else if (json.status === 1 && json.data.status === 0) {\r\n                 $(\"#targetstatus\").html(`{{ _('Failed to fetch targets') }}: ${json.data.message}`)\r\n             } else {\r\n+                let big_ol_dict = {}\r\n                 select.html(\"\")\r\n \r\n                 var chopt = [`<optgroup label=\"{{ _('Channels') }}\">`]\r\n                 for (let [id, name] of json.data.CHANNELS) {\r\n-                    chopt.push(`<option value=${id}>${name}<\/option>`)\r\n+                    chopt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\r\n+                    big_ol_dict[id] = name\r\n                 }\r\n                 chopt.push(\"<\/optgroup>\")\r\n                 select.append(chopt.join(\"\"))\r\n \r\n                 var ropt = [`<optgroup label=\"{{ _('Roles') }}\">`]\r\n                 for (let [id, name] of json.data.ROLES) {\r\n-                    ropt.push(`<option value=${id}>${name}<\/option>`)\r\n+                    ropt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\r\n+                    big_ol_dict[id] = name\r\n                 }\r\n                 ropt.push(\"<\/optgroup>\")\r\n                 select.append(ropt.join(\"\"))\r\n \r\n                 var uopt = [`<optgroup label=\"{{ _('Users') }}\">`]\r\n                 for (let [id, name] of json.data.USERS) {\r\n-                    uopt.push(`<option value=${id}>${name}<\/option>`)\r\n+                    uopt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\r\n+                    big_ol_dict[id] = name\r\n                 }\r\n                 uopt.push(\"<\/optgroup>\")\r\n                 select.append(uopt.join(\"\"))\r\n+                for (let [id, name] of Object.entries(big_ol_dict)) {\r\n+                    $(`.selectpicker-element-${id}`).text(name)\r\n+                }\r\n             }\r\n             select.selectpicker({ title: \"{{ _('Choose target') }}\" })\r\n             select.removeAttr(\"disabled\")\r\n@@ -1299,18 +1306,24 @@ <h5>{{ data['message'] }}<\/h5>\n                 $(\"#rulesdiv\").html(\"\")\r\n                 var overall = ['<h3 style=\"margin-bottom: 10px\">{{ _(\"Cog rules\") }}<\/h3>']\r\n                 var allcoglines = [\"<ul>\"]\r\n+\r\n+                let big_ol_dict_two = {}\r\n+                let cog_counter = 0\r\n+\r\n                 for (let [cog, rules] of Object.entries(json.data.COG)) {\r\n                     var coglines = []\r\n                     for (let rule of rules) {\r\n                         if (rule.type === \"Default\") {\r\n                             coglines.unshift(`<li>{{ _('By default, users are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n                         } else if (rule.type === \"Role\") {\r\n-                            coglines.push(`<li>{{ _('Users with the') }} <code>${rule.name}<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n+                            coglines.push(`<li>{{ _('Users with the') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n                         } else if (rule.type === \"Channel\") {\r\n-                            coglines.push(`<li>{{ _('Users in the') }} <code>${rule.name}<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n+                            coglines.push(`<li>{{ _('Users in the') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n                         } else {\r\n-                            coglines.push(`<li>{{ _('User') }} <code>${rule.name}<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n+                            coglines.push(`<li>{{ _('User') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\r\n                         }\r\n+                        big_ol_dict_two[`cog-rules-${cog_counter}`] = rule.name\r\n+                        cog_counter += 1\r\n                     }\r\n                     if (coglines) {\r\n                         allcoglines = allcoglines.concat(coglines)\r\n@@ -1324,18 +1337,23 @@ <h5>{{ data['message'] }}<\/h5>\n \r\n                 overall.push('<h3 style=\"margin-bottom: 10px\">{{ _(\"Command rules\") }}<\/h3>')\r\n                 var allcmdlines = [\"<ul>\"]\r\n+\r\n+                let cmd_counter = 0\r\n+\r\n                 for (let [cmd, rules] of Object.entries(json.data.COMMAND)) {\r\n                     var cmdlines = []\r\n                     for (let rule of rules) {\r\n                         if (rule.type === \"Default\") {\r\n                             cmdlines.unshift(`<li>{{ _('By default, users are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n                         } else if (rule.type === \"Role\") {\r\n-                            cmdlines.push(`<li>{{ _('Users with the') }} <code>${rule.name}<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n+                            cmdlines.push(`<li>{{ _('Users with the') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n                         } else if (rule.type === \"Channel\") {\r\n-                            cmdlines.push(`<li>{{ _('Users in the') }} <code>${rule.name}<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n+                            cmdlines.push(`<li>{{ _('Users in the') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n                         } else {\r\n-                            cmdlines.push(`<li>{{ _('User') }} <code>${rule.name}<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n+                            cmdlines.push(`<li>{{ _('User') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\r\n                         }\r\n+                        big_ol_dict_two[`cmd-rules-${cmd_counter}`] = rule.name\r\n+                        cmd_counter += 1\r\n                     }\r\n                     if (cmdlines) {\r\n                         allcmdlines = allcmdlines.concat(cmdlines)\r\n@@ -1347,6 +1365,9 @@ <h5>{{ data['message'] }}<\/h5>\n                 }\r\n                 overall = overall.concat(allcmdlines)\r\n                 $(\"#rulesdiv\").html(overall.join(\"\"))\r\n+                for (let [id, name] of Object.entries(big_ol_dict_two)) {\r\n+                    $(`#${id}`).text(name)\r\n+                }\r\n                 $(\"#fetchrulesstatus\").html(\"{{ _('Refreshed rules') }}.\")\r\n             }\r\n         }\r\n@@ -1378,11 +1399,12 @@ <h5>{{ data['message'] }}<\/h5>\n \r\n     $(document).on('click', '.adminroleoption', function () {\r\n         var elm = $(this)\r\n+        let random_number = Math.floor(Math.random() * Math.floor(100000))\r\n         $(\"#adminrolelist\").append(`\r\n                 <li>\r\n                     <div class=\"row\">\r\n                         <div class=\"col-md-10 col-8\">\r\n-                            <input class=\"form-control adminroleinput\" value=\"${elm.text()}\" disabled=True data-id=\"${elm.attr(\"data-id\")}\">\r\n+                            <input class=\"form-control adminroleinput\" value=\"Loading...\" disabled=True data-id=\"${elm.attr(\"data-id\")}\" id=\"admin-role-${random_number}\">\r\n                         <\/div>\r\n                         <div class=\"col-md-1 col-1\">\r\n                             <span class=\"admin-role-x clickable\"><i class=\"tim-icons icon-simple-remove\" style=\"float: right; margin-top: 10px;\"><\/i><\/span>\r\n@@ -1390,6 +1412,7 @@ <h5>{{ data['message'] }}<\/h5>\n                     <\/div>\r\n                 <\/li>\r\n             `)\r\n+        $(`#admin-role-${random_number}`).val(elm.text())\r\n         elm.remove()\r\n     })\r\n \r\n@@ -1442,11 +1465,12 @@ <h5>{{ data['message'] }}<\/h5>\n \r\n     $(document).on('click', '.modroleoption', function () {\r\n         var elm = $(this)\r\n+        let random_number = Math.floor(Math.random() * Math.floor(100000))\r\n         $(\"#modrolelist\").append(`\r\n                 <li>\r\n                     <div class=\"row\">\r\n                         <div class=\"col-md-10 col-8\">\r\n-                            <input class=\"form-control modroleinput\" value=\"${elm.text()}\" disabled=True data-id=\"${elm.attr(\"data-id\")}\">\r\n+                            <input class=\"form-control modroleinput\" value=\"Loading...\" disabled=True data-id=\"${elm.attr(\"data-id\")}\" id=\"mod-role-${random_number}\">\r\n                         <\/div>\r\n                         <div class=\"col-md-1 col-1\">\r\n                             <span class=\"mod-role-x clickable\"><i class=\"tim-icons icon-simple-remove\" style=\"float: right; margin-top: 10px;\"><\/i><\/span>\r\n@@ -1454,6 +1478,7 @@ <h5>{{ data['message'] }}<\/h5>\n                     <\/div>\r\n                 <\/li>\r\n             `)\r\n+        $(`#mod-role-${random_number}`).val(elm.text())\r\n         elm.remove()\r\n     })",
      "code_diff":"@@ -930,20 +930,20 @@ <h5>{{ data['message'] }}<\/h5>\n             img.attr(\"src\", `${img.attr(\"data-src-url\")}png`)\n         }\n     }\n+\n+    function safe(str) {\n+        return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n+    }\n <\/script>\n \n {% if data['status'] == 1 and data['data']['status'] == 1 %}\n \n-{% if 'aliascc' in data['data']['permslist'] %}\n+{% if 'aliascc' in data['data']['permslist'] and false%}\n <script>\n     \/* ---------------------------------------------------------------------------------------------------------------------\n                                                         Aliases group\n        --------------------------------------------------------------------------------------------------------------------- *\/\n \n-    function safe(str) {\n-        return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n-    }\n-\n     \/\/ Alias modal\n     $(document).on('click', '.editaliasbutton', function () {\n         var command = $(this).parent().parent().data(\"command\")\n@@ -1186,28 +1186,35 @@ <h5>{{ data['message'] }}<\/h5>\n             } else if (json.status === 1 && json.data.status === 0) {\n                 $(\"#targetstatus\").html(`{{ _('Failed to fetch targets') }}: ${json.data.message}`)\n             } else {\n+                let big_ol_dict = {}\n                 select.html(\"\")\n \n                 var chopt = [`<optgroup label=\"{{ _('Channels') }}\">`]\n                 for (let [id, name] of json.data.CHANNELS) {\n-                    chopt.push(`<option value=${id}>${name}<\/option>`)\n+                    chopt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\n+                    big_ol_dict[id] = name\n                 }\n                 chopt.push(\"<\/optgroup>\")\n                 select.append(chopt.join(\"\"))\n \n                 var ropt = [`<optgroup label=\"{{ _('Roles') }}\">`]\n                 for (let [id, name] of json.data.ROLES) {\n-                    ropt.push(`<option value=${id}>${name}<\/option>`)\n+                    ropt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\n+                    big_ol_dict[id] = name\n                 }\n                 ropt.push(\"<\/optgroup>\")\n                 select.append(ropt.join(\"\"))\n \n                 var uopt = [`<optgroup label=\"{{ _('Users') }}\">`]\n                 for (let [id, name] of json.data.USERS) {\n-                    uopt.push(`<option value=${id}>${name}<\/option>`)\n+                    uopt.push(`<option value=${id} class=\"selectpicker-element-${id}\">Loading...<\/option>`)\n+                    big_ol_dict[id] = name\n                 }\n                 uopt.push(\"<\/optgroup>\")\n                 select.append(uopt.join(\"\"))\n+                for (let [id, name] of Object.entries(big_ol_dict)) {\n+                    $(`.selectpicker-element-${id}`).text(name)\n+                }\n             }\n             select.selectpicker({ title: \"{{ _('Choose target') }}\" })\n             select.removeAttr(\"disabled\")\n@@ -1299,18 +1306,24 @@ <h5>{{ data['message'] }}<\/h5>\n                 $(\"#rulesdiv\").html(\"\")\n                 var overall = ['<h3 style=\"margin-bottom: 10px\">{{ _(\"Cog rules\") }}<\/h3>']\n                 var allcoglines = [\"<ul>\"]\n+\n+                let big_ol_dict_two = {}\n+                let cog_counter = 0\n+\n                 for (let [cog, rules] of Object.entries(json.data.COG)) {\n                     var coglines = []\n                     for (let rule of rules) {\n                         if (rule.type === \"Default\") {\n                             coglines.unshift(`<li>{{ _('By default, users are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n                         } else if (rule.type === \"Role\") {\n-                            coglines.push(`<li>{{ _('Users with the') }} <code>${rule.name}<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n+                            coglines.push(`<li>{{ _('Users with the') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n                         } else if (rule.type === \"Channel\") {\n-                            coglines.push(`<li>{{ _('Users in the') }} <code>${rule.name}<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n+                            coglines.push(`<li>{{ _('Users in the') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n                         } else {\n-                            coglines.push(`<li>{{ _('User') }} <code>${rule.name}<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n+                            coglines.push(`<li>{{ _('User') }} <code id=\"cog-rules-${cog_counter}\">Loading...<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cog}<\/code> {{ _('cog') }}.<\/li>`)\n                         }\n+                        big_ol_dict_two[`cog-rules-${cog_counter}`] = rule.name\n+                        cog_counter += 1\n                     }\n                     if (coglines) {\n                         allcoglines = allcoglines.concat(coglines)\n@@ -1324,18 +1337,23 @@ <h5>{{ data['message'] }}<\/h5>\n \n                 overall.push('<h3 style=\"margin-bottom: 10px\">{{ _(\"Command rules\") }}<\/h3>')\n                 var allcmdlines = [\"<ul>\"]\n+\n+                let cmd_counter = 0\n+\n                 for (let [cmd, rules] of Object.entries(json.data.COMMAND)) {\n                     var cmdlines = []\n                     for (let rule of rules) {\n                         if (rule.type === \"Default\") {\n                             cmdlines.unshift(`<li>{{ _('By default, users are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n                         } else if (rule.type === \"Role\") {\n-                            cmdlines.push(`<li>{{ _('Users with the') }} <code>${rule.name}<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n+                            cmdlines.push(`<li>{{ _('Users with the') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> {{ _('role') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n                         } else if (rule.type === \"Channel\") {\n-                            cmdlines.push(`<li>{{ _('Users in the') }} <code>${rule.name}<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n+                            cmdlines.push(`<li>{{ _('Users in the') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> {{ _('channel') }} (${rule.id}) {{ _('are') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n                         } else {\n-                            cmdlines.push(`<li>{{ _('User') }} <code>${rule.name}<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n+                            cmdlines.push(`<li>{{ _('User') }} <code id=\"cmd-rules-${cmd_counter}\">Loading...<\/code> (${rule.id}) {{ _('is') }} ${rule.permission} {{ _('permission to use the') }} <code>${cmd}<\/code> {{ _('command') }}.<\/li>`)\n                         }\n+                        big_ol_dict_two[`cmd-rules-${cmd_counter}`] = rule.name\n+                        cmd_counter += 1\n                     }\n                     if (cmdlines) {\n                         allcmdlines = allcmdlines.concat(cmdlines)\n@@ -1347,6 +1365,9 @@ <h5>{{ data['message'] }}<\/h5>\n                 }\n                 overall = overall.concat(allcmdlines)\n                 $(\"#rulesdiv\").html(overall.join(\"\"))\n+                for (let [id, name] of Object.entries(big_ol_dict_two)) {\n+                    $(`#${id}`).text(name)\n+                }\n                 $(\"#fetchrulesstatus\").html(\"{{ _('Refreshed rules') }}.\")\n             }\n         }\n@@ -1378,11 +1399,12 @@ <h5>{{ data['message'] }}<\/h5>\n \n     $(document).on('click', '.adminroleoption', function () {\n         var elm = $(this)\n+        let random_number = Math.floor(Math.random() * Math.floor(100000))\n         $(\"#adminrolelist\").append(`\n                 <li>\n                     <div class=\"row\">\n                         <div class=\"col-md-10 col-8\">\n-                            <input class=\"form-control adminroleinput\" value=\"${elm.text()}\" disabled=True data-id=\"${elm.attr(\"data-id\")}\">\n+                            <input class=\"form-control adminroleinput\" value=\"Loading...\" disabled=True data-id=\"${elm.attr(\"data-id\")}\" id=\"admin-role-${random_number}\">\n                         <\/div>\n                         <div class=\"col-md-1 col-1\">\n                             <span class=\"admin-role-x clickable\"><i class=\"tim-icons icon-simple-remove\" style=\"float: right; margin-top: 10px;\"><\/i><\/span>\n@@ -1390,6 +1412,7 @@ <h5>{{ data['message'] }}<\/h5>\n                     <\/div>\n                 <\/li>\n             `)\n+        $(`#admin-role-${random_number}`).val(elm.text())\n         elm.remove()\n     })\n \n@@ -1442,11 +1465,12 @@ <h5>{{ data['message'] }}<\/h5>\n \n     $(document).on('click', '.modroleoption', function () {\n         var elm = $(this)\n+        let random_number = Math.floor(Math.random() * Math.floor(100000))\n         $(\"#modrolelist\").append(`\n                 <li>\n                     <div class=\"row\">\n                         <div class=\"col-md-10 col-8\">\n-                            <input class=\"form-control modroleinput\" value=\"${elm.text()}\" disabled=True data-id=\"${elm.attr(\"data-id\")}\">\n+                            <input class=\"form-control modroleinput\" value=\"Loading...\" disabled=True data-id=\"${elm.attr(\"data-id\")}\" id=\"mod-role-${random_number}\">\n                         <\/div>\n                         <div class=\"col-md-1 col-1\">\n                             <span class=\"mod-role-x clickable\"><i class=\"tim-icons icon-simple-remove\" style=\"float: right; margin-top: 10px;\"><\/i><\/span>\n@@ -1454,6 +1478,7 @@ <h5>{{ data['message'] }}<\/h5>\n                     <\/div>\n                 <\/li>\n             `)\n+        $(`#mod-role-${random_number}`).val(elm.text())\n         elm.remove()\n     })"
    },
    {
      "index":83,
      "vuln_id":"GHSA-6hjc-m38h-7jhh",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/nystudio107\/craft-seomatic\/commit\/4e46b792ce973ac0c652fb330055f41aca1981c8', 'https:\/\/github.com\/nystudio107\/craft-seomatic\/commit\/5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in SEOmatic plugin A cross-site scripting (XSS) vulnerability in the SEOmatic plugin 3.4.10 for Craft CMS 3 allows remote attackers to inject arbitrary web script via a GET to \/index.php?action=seomatic\/file\/seo-file-link with url parameter containing the base64 encoded URL of a malicious web page \/ file and fileName parameter containing an arbitrary filename with the intended content-type to be rendered in the user's browser as the extension.",
      "published_date":"2022-06-13",
      "chain_len":2,
      "project":"https:\/\/github.com\/nystudio107\/craft-seomatic",
      "commit_href":"https:\/\/github.com\/nystudio107\/craft-seomatic\/commit\/5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873",
      "commit_sha":"5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873",
      "patch":"MULTI",
      "chain_ord":"['5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873', '4e46b792ce973ac0c652fb330055f41aca1981c8']",
      "before_first_fix_commit":"{'8c0dc48d026fd076cd0a8fae917bdadc8d67cfa6'}",
      "last_fix_commit":"4e46b792ce973ac0c652fb330055f41aca1981c8",
      "chain_ord_pos":1.0,
      "commit_datetime":"09\/24\/2021, 01:25:40",
      "message":"Ensure that only files with the extensions listed in `allowedFileExtensions` General Config setting can be used with the SEO File Link controller\n\nSigned-off-by: Andrew Welch <andrew@nystudio107.com>",
      "author":"Andrew Welch",
      "comments":null,
      "stats":"{'additions': 12, 'deletions': 0, 'total': 12}",
      "files":"{'src\/controllers\/FileController.php': {'additions': 12, 'deletions': 0, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/nystudio107\/craft-seomatic\/raw\/5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873\/src%2Fcontrollers%2FFileController.php', 'patch': '@@ -15,12 +15,15 @@\\n use nystudio107\\\\seomatic\\\\Seomatic;\\n \\n use Craft;\\n+use craft\\\\elements\\\\Asset;\\n use craft\\\\helpers\\\\FileHelper;\\n+use craft\\\\helpers\\\\Assets as AssetsHelper;\\n use craft\\\\web\\\\Controller;\\n \\n use yii\\\\web\\\\NotFoundHttpException;\\n use yii\\\\web\\\\HttpException;\\n use yii\\\\web\\\\Response;\\n+use yii\\\\web\\\\ServerErrorHttpException;\\n \\n \/**\\n  * @author    nystudio107\\n@@ -87,6 +90,15 @@ public function actionSeoFileLink($url, $robots = \\'\\', $canonical = \\'\\', $inline =\\n                 $headerValue = \\'<\\'.$canonical.\\'>; rel=\"canonical\"\\';\\n                 $response->headers->add(\\'Link\\', $headerValue);\\n             }\\n+            \/\/ Ensure the file type is allowed\\n+            \/\/ ref: https:\/\/craftcms.com\/docs\/3.x\/config\/config-settings.html#allowedfileextensions\\n+            $allowedExtensions = Craft::$app->getConfig()->getGeneral()->allowedFileExtensions;\\n+            if (($ext = pathinfo($fileName, PATHINFO_EXTENSION)) !== \\'\\') {\\n+                $ext = strtolower($ext);\\n+            }\\n+            if ($ext === \\'\\' || !in_array($ext, $allowedExtensions, true)) {\\n+                throw new ServerErrorHttpException(Craft::t(\\'seomatic\\', \\'File format not allowed.\\'));\\n+            }\\n             \/\/ Send the file as a stream, so it can exist anywhere\\n             $response->sendContentAsFile(\\n                 $contents,'}}",
      "message_norm":"ensure that only files with the extensions listed in `allowedfileextensions` general config setting can be used with the seo file link controller\n\nsigned-off-by: andrew welch <andrew@nystudio107.com>",
      "language":"en",
      "entities":"[('ensure', 'ACTION', ''), ('andrew@nystudio107.com', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/controllers\/FileController.php'])",
      "num_files":1.0,
      "patch_content":"From 5f2cdc7c39e0a4bfb60d2f84131508f0a87b2873 Mon Sep 17 00:00:00 2001\nFrom: Andrew Welch <andrew@nystudio107.com>\nDate: Thu, 23 Sep 2021 21:25:40 -0400\nSubject: [PATCH] Ensure that only files with the extensions listed in\n `allowedFileExtensions` General Config setting can be used with the SEO File\n Link controller\n\nSigned-off-by: Andrew Welch <andrew@nystudio107.com>\n---\n src\/controllers\/FileController.php | 12 ++++++++++++\n 1 file changed, 12 insertions(+)\n\ndiff --git a\/src\/controllers\/FileController.php b\/src\/controllers\/FileController.php\nindex 1e1f1b1d2..33d7f0582 100644\n--- a\/src\/controllers\/FileController.php\n+++ b\/src\/controllers\/FileController.php\n@@ -15,12 +15,15 @@\n use nystudio107\\seomatic\\Seomatic;\n \n use Craft;\n+use craft\\elements\\Asset;\n use craft\\helpers\\FileHelper;\n+use craft\\helpers\\Assets as AssetsHelper;\n use craft\\web\\Controller;\n \n use yii\\web\\NotFoundHttpException;\n use yii\\web\\HttpException;\n use yii\\web\\Response;\n+use yii\\web\\ServerErrorHttpException;\n \n \/**\n  * @author    nystudio107\n@@ -87,6 +90,15 @@ public function actionSeoFileLink($url, $robots = '', $canonical = '', $inline =\n                 $headerValue = '<'.$canonical.'>; rel=\"canonical\"';\n                 $response->headers->add('Link', $headerValue);\n             }\n+            \/\/ Ensure the file type is allowed\n+            \/\/ ref: https:\/\/craftcms.com\/docs\/3.x\/config\/config-settings.html#allowedfileextensions\n+            $allowedExtensions = Craft::$app->getConfig()->getGeneral()->allowedFileExtensions;\n+            if (($ext = pathinfo($fileName, PATHINFO_EXTENSION)) !== '') {\n+                $ext = strtolower($ext);\n+            }\n+            if ($ext === '' || !in_array($ext, $allowedExtensions, true)) {\n+                throw new ServerErrorHttpException(Craft::t('seomatic', 'File format not allowed.'));\n+            }\n             \/\/ Send the file as a stream, so it can exist anywhere\n             $response->sendContentAsFile(\n                 $contents,",
      "code_diff":"@@ -15,12 +15,15 @@\n use nystudio107\\seomatic\\Seomatic;\n \n use Craft;\n+use craft\\elements\\Asset;\n use craft\\helpers\\FileHelper;\n+use craft\\helpers\\Assets as AssetsHelper;\n use craft\\web\\Controller;\n \n use yii\\web\\NotFoundHttpException;\n use yii\\web\\HttpException;\n use yii\\web\\Response;\n+use yii\\web\\ServerErrorHttpException;\n \n \/**\n  * @author    nystudio107\n@@ -87,6 +90,15 @@ public function actionSeoFileLink($url, $robots = '', $canonical = '', $inline =\n                 $headerValue = '<'.$canonical.'>; rel=\"canonical\"';\n                 $response->headers->add('Link', $headerValue);\n             }\n+            \/\/ Ensure the file type is allowed\n+            \/\/ ref: https:\/\/craftcms.com\/docs\/3.x\/config\/config-settings.html#allowedfileextensions\n+            $allowedExtensions = Craft::$app->getConfig()->getGeneral()->allowedFileExtensions;\n+            if (($ext = pathinfo($fileName, PATHINFO_EXTENSION)) !== '') {\n+                $ext = strtolower($ext);\n+            }\n+            if ($ext === '' || !in_array($ext, $allowedExtensions, true)) {\n+                throw new ServerErrorHttpException(Craft::t('seomatic', 'File format not allowed.'));\n+            }\n             \/\/ Send the file as a stream, so it can exist anywhere\n             $response->sendContentAsFile(\n                 $contents,"
    },
    {
      "index":84,
      "vuln_id":"GHSA-hpx4-xjp7-m4vr",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/f623d05d0c3487ae24c4f13907e4709484e5bf41'}",
      "dataset":"osv",
      "summary":"Stored cross-site scripting in Snipe-IT Snipe-IT prior to version 5.4.3 is vulnerable to stored cross-site scripting because the input to the `checked_out_to` parameter is not escaped. The vulnerability is capable of stealing a user's cookie.",
      "published_date":"2022-04-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/f623d05d0c3487ae24c4f13907e4709484e5bf41",
      "commit_sha":"f623d05d0c3487ae24c4f13907e4709484e5bf41",
      "patch":"SINGLE",
      "chain_ord":"['f623d05d0c3487ae24c4f13907e4709484e5bf41']",
      "before_first_fix_commit":"{'ef7f21e3ba01f13da2e656358343ba1236a122de'}",
      "last_fix_commit":"f623d05d0c3487ae24c4f13907e4709484e5bf41",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/24\/2022, 14:27:11",
      "message":"Escape checkout target name\n\nSigned-off-by: snipe <snipe@snipe.net>",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/Http\/Transformers\/DepreciationReportTransformer.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/f623d05d0c3487ae24c4f13907e4709484e5bf41\/app%2FHttp%2FTransformers%2FDepreciationReportTransformer.php', 'patch': \"@@ -98,7 +98,7 @@ public function transformAsset(Asset $asset)\\n             'purchase_cost' => Helper::formatCurrencyOutput($asset->purchase_cost),\\n             'book_value' => Helper::formatCurrencyOutput($depreciated_value),\\n             'monthly_depreciation' => $monthly_depreciation,\\n-            'checked_out_to' => $checkout_target,\\n+            'checked_out_to' => ($checkout_target) ? e($checkout_target) : null,\\n             'diff' =>  Helper::formatCurrencyOutput($diff),\\n             'number_of_months' =>  ($asset->model && $asset->model->depreciation) ? e($asset->model->depreciation->months) : null,\\n             'depreciation' => (($asset->model) && ($asset->model->depreciation)) ?  e($asset->model->depreciation->name) : null,\"}}",
      "message_norm":"escape checkout target name\n\nsigned-off-by: snipe <snipe@snipe.net>",
      "language":"en",
      "entities":"[('escape', 'SECWORD', ''), ('snipe@snipe.net', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Transformers\/DepreciationReportTransformer.php'])",
      "num_files":1.0,
      "patch_content":"From f623d05d0c3487ae24c4f13907e4709484e5bf41 Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Sun, 24 Apr 2022 15:27:11 +0100\nSubject: [PATCH] Escape checkout target name\n\nSigned-off-by: snipe <snipe@snipe.net>\n---\n app\/Http\/Transformers\/DepreciationReportTransformer.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/Http\/Transformers\/DepreciationReportTransformer.php b\/app\/Http\/Transformers\/DepreciationReportTransformer.php\nindex 73c970504b06..a5fb118c4035 100644\n--- a\/app\/Http\/Transformers\/DepreciationReportTransformer.php\n+++ b\/app\/Http\/Transformers\/DepreciationReportTransformer.php\n@@ -98,7 +98,7 @@ public function transformAsset(Asset $asset)\n             'purchase_cost' => Helper::formatCurrencyOutput($asset->purchase_cost),\n             'book_value' => Helper::formatCurrencyOutput($depreciated_value),\n             'monthly_depreciation' => $monthly_depreciation,\n-            'checked_out_to' => $checkout_target,\n+            'checked_out_to' => ($checkout_target) ? e($checkout_target) : null,\n             'diff' =>  Helper::formatCurrencyOutput($diff),\n             'number_of_months' =>  ($asset->model && $asset->model->depreciation) ? e($asset->model->depreciation->months) : null,\n             'depreciation' => (($asset->model) && ($asset->model->depreciation)) ?  e($asset->model->depreciation->name) : null,",
      "code_diff":"@@ -98,7 +98,7 @@ public function transformAsset(Asset $asset)\n             'purchase_cost' => Helper::formatCurrencyOutput($asset->purchase_cost),\n             'book_value' => Helper::formatCurrencyOutput($depreciated_value),\n             'monthly_depreciation' => $monthly_depreciation,\n-            'checked_out_to' => $checkout_target,\n+            'checked_out_to' => ($checkout_target) ? e($checkout_target) : null,\n             'diff' =>  Helper::formatCurrencyOutput($diff),\n             'number_of_months' =>  ($asset->model && $asset->model->depreciation) ? e($asset->model->depreciation->months) : null,\n             'depreciation' => (($asset->model) && ($asset->model->depreciation)) ?  e($asset->model->depreciation->name) : null,"
    },
    {
      "index":85,
      "vuln_id":"GHSA-wg8p-w946-c482",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/56e450c3adf75c707500d7231a78c9fc894c7f13'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc prior to 2.10.4 is vulnerable to stored cross-site scripting via file upload.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/56e450c3adf75c707500d7231a78c9fc894c7f13",
      "commit_sha":"56e450c3adf75c707500d7231a78c9fc894c7f13",
      "patch":"SINGLE",
      "chain_ord":"['56e450c3adf75c707500d7231a78c9fc894c7f13']",
      "before_first_fix_commit":"{'237ac6d43bf3728bf3587c486a23b4a48ea7acb3'}",
      "last_fix_commit":"56e450c3adf75c707500d7231a78c9fc894c7f13",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 12:15:13",
      "message":"file upload bug",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/56e450c3adf75c707500d7231a78c9fc894c7f13\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': \"@@ -329,7 +329,7 @@ public function isAllowedFilename($filename){\\n \\t\\t\\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\\n \\t\\t\\t'.pdf','.ofd','.swf','.epub','.xps',\\n \\t\\t\\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps','.wpt',\\n-\\t\\t\\t'.ppt','.pptx','.xls','.xlsx','.txt','.md','.psd','.csv',\\n+\\t\\t\\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\\n \\t\\t\\t'.cer','.ppt','.pub','.properties','.json','.css',\\n \\t\\t\\t) ;\"}}",
      "message_norm":"file upload bug",
      "language":"ro",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 56e450c3adf75c707500d7231a78c9fc894c7f13 Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Mon, 14 Mar 2022 20:15:13 +0800\nSubject: [PATCH] file upload bug\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 7f69b3cba..3ce94ceaf 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -329,7 +329,7 @@ public function isAllowedFilename($filename){\n \t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\n \t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n \t\t\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps','.wpt',\n-\t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.md','.psd','.csv',\n+\t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\n \t\t\t'.cer','.ppt','.pub','.properties','.json','.css',\n \t\t\t) ;",
      "code_diff":"@@ -329,7 +329,7 @@ public function isAllowedFilename($filename){\n \t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\n \t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n \t\t\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps','.wpt',\n-\t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.md','.psd','.csv',\n+\t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\n \t\t\t'.cer','.ppt','.pub','.properties','.json','.css',\n \t\t\t) ;"
    },
    {
      "index":86,
      "vuln_id":"GHSA-vc5r-xfc4-4x22",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/pimcore\/data-hub\/commit\/15d5b57af2466eebd3bbc531ead5dafa35d0a36e'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Pimcore Datahub Pimcore Datahub prior to 1.2.4 is vulnerable to stored cross-site scripting. An admin user accessing Datahub triggers the attack, which may result in the user's cookie being stolen.",
      "published_date":"2022-03-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/data-hub",
      "commit_href":"https:\/\/github.com\/pimcore\/data-hub\/commit\/15d5b57af2466eebd3bbc531ead5dafa35d0a36e",
      "commit_sha":"15d5b57af2466eebd3bbc531ead5dafa35d0a36e",
      "patch":"SINGLE",
      "chain_ord":"['15d5b57af2466eebd3bbc531ead5dafa35d0a36e']",
      "before_first_fix_commit":"{'1561fa5cda0d1a79139efbd2113e42a63d5602e4'}",
      "last_fix_commit":"15d5b57af2466eebd3bbc531ead5dafa35d0a36e",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/16\/2022, 13:24:41",
      "message":"follow up to https:\/\/github.com\/pimcore\/data-hub\/pull\/462",
      "author":"dpahuja",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'src\/Controller\/ConfigController.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/data-hub\/raw\/15d5b57af2466eebd3bbc531ead5dafa35d0a36e\/src%2FController%2FConfigController.php', 'patch': \"@@ -50,7 +50,7 @@ private function buildItem($configuration): array\\n \\n         return [\\n             'id' => $name,\\n-            'text' => $name,\\n+            'text' => htmlspecialchars($name),\\n             'type' => 'config',\\n             'iconCls' => 'plugin_pimcore_datahub_icon_' . $type,\\n             'expandable' => false,\"}}",
      "message_norm":"follow up to https:\/\/github.com\/pimcore\/data-hub\/pull\/462",
      "language":"en",
      "entities":"[('https:\/\/github.com\/pimcore\/data-hub\/pull\/462', 'URL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/Controller\/ConfigController.php'])",
      "num_files":1.0,
      "patch_content":"From 15d5b57af2466eebd3bbc531ead5dafa35d0a36e Mon Sep 17 00:00:00 2001\nFrom: dpahuja <divesh.pahuja@gmail.com>\nDate: Wed, 16 Mar 2022 14:24:41 +0100\nSubject: [PATCH] follow up to https:\/\/github.com\/pimcore\/data-hub\/pull\/462\n\n---\n src\/Controller\/ConfigController.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/Controller\/ConfigController.php b\/src\/Controller\/ConfigController.php\nindex 286ba4e6d..1d248114a 100644\n--- a\/src\/Controller\/ConfigController.php\n+++ b\/src\/Controller\/ConfigController.php\n@@ -50,7 +50,7 @@ private function buildItem($configuration): array\n \n         return [\n             'id' => $name,\n-            'text' => $name,\n+            'text' => htmlspecialchars($name),\n             'type' => 'config',\n             'iconCls' => 'plugin_pimcore_datahub_icon_' . $type,\n             'expandable' => false,",
      "code_diff":"@@ -50,7 +50,7 @@ private function buildItem($configuration): array\n \n         return [\n             'id' => $name,\n-            'text' => $name,\n+            'text' => htmlspecialchars($name),\n             'type' => 'config',\n             'iconCls' => 'plugin_pimcore_datahub_icon_' . $type,\n             'expandable' => false,"
    },
    {
      "index":87,
      "vuln_id":"GHSA-5fxf-x22x-5q38",
      "cwe_id":"{'CWE-79'}",
      "score":6.8,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/de6d17b52d261902653fbdd2ecefcaac82e54256'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber XSS on dynamic_text module in GitHub repository microweber\/microweber prior to 1.2.12.",
      "published_date":"2022-03-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/de6d17b52d261902653fbdd2ecefcaac82e54256",
      "commit_sha":"de6d17b52d261902653fbdd2ecefcaac82e54256",
      "patch":"SINGLE",
      "chain_ord":"['de6d17b52d261902653fbdd2ecefcaac82e54256']",
      "before_first_fix_commit":"{'095b1bcea7a4384f0d0513906100212df136a1e4'}",
      "last_fix_commit":"de6d17b52d261902653fbdd2ecefcaac82e54256",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/11\/2022, 13:38:50",
      "message":"Update build-and-upload.yml",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 0, 'deletions': 1, 'total': 1}",
      "files":"{'.github\/workflows\/build-and-upload.yml': {'additions': 0, 'deletions': 1, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/de6d17b52d261902653fbdd2ecefcaac82e54256\/.github%2Fworkflows%2Fbuild-and-upload.yml', 'patch': '@@ -6,7 +6,6 @@ on:\\n jobs:\\n   microweber-test-before-build:\\n     runs-on: ubuntu-latest\\n-    needs: stop-previous-runs\\n     steps:\\n       - uses: actions\/checkout@v2'}}",
      "message_norm":"update build-and-upload.yml",
      "language":"en",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['.github\/workflows\/build-and-upload.yml'])",
      "num_files":1.0,
      "patch_content":"From de6d17b52d261902653fbdd2ecefcaac82e54256 Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Fri, 11 Mar 2022 15:38:50 +0200\nSubject: [PATCH] Update build-and-upload.yml\n\n---\n .github\/workflows\/build-and-upload.yml | 1 -\n 1 file changed, 1 deletion(-)\n\ndiff --git a\/.github\/workflows\/build-and-upload.yml b\/.github\/workflows\/build-and-upload.yml\nindex 259ee2be29d..74b2a62a441 100644\n--- a\/.github\/workflows\/build-and-upload.yml\n+++ b\/.github\/workflows\/build-and-upload.yml\n@@ -6,7 +6,6 @@ on:\n jobs:\n   microweber-test-before-build:\n     runs-on: ubuntu-latest\n-    needs: stop-previous-runs\n     steps:\n       - uses: actions\/checkout@v2",
      "code_diff":"@@ -6,7 +6,6 @@ on:\n jobs:\n   microweber-test-before-build:\n     runs-on: ubuntu-latest\n-    needs: stop-previous-runs\n     steps:\n       - uses: actions\/checkout@v2"
    },
    {
      "index":88,
      "vuln_id":"GHSA-3pg8-c473-w6rr",
      "cwe_id":"{'CWE-79'}",
      "score":6.9,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/3caa32334db0c277b84e993eaca2036f5d1dbef8'}",
      "dataset":"osv",
      "summary":"Stored Cross-site Scripting in showdoc ShowDoc is a tool for an IT team to share documents online. showdoc contains a stored cross-site scripting vulnerability in the File Library page when uploading a file in .ofd format in versions prior to 2.10.4. At this time, there is no known workaround. Users should update to version 2.10.4.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/3caa32334db0c277b84e993eaca2036f5d1dbef8",
      "commit_sha":"3caa32334db0c277b84e993eaca2036f5d1dbef8",
      "patch":"SINGLE",
      "chain_ord":"['3caa32334db0c277b84e993eaca2036f5d1dbef8']",
      "before_first_fix_commit":"{'92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f'}",
      "last_fix_commit":"3caa32334db0c277b84e993eaca2036f5d1dbef8",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 15:26:49",
      "message":"Upload file vulnerability",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 7, 'total': 12}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 5, 'deletions': 7, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/3caa32334db0c277b84e993eaca2036f5d1dbef8\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': \"@@ -54,10 +54,10 @@ public function deleteFile($file_id){\\n \\t}\\n \\n \\t\/\/\u4e0a\u4f20\u6587\u4ef6\uff0c\u8fd4\u56deurl\\n-\\tpublic function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0  ){\\n+\\tpublic function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0 , $check_filename = true  ){\\n \\t\\t$uploadFile = $_files[$file_key] ;\\n \\n-\\t\\tif( !$this->isAllowedFilename($_files[$file_key]['name']) ){\\n+\\t\\tif( $check_filename && !$this->isAllowedFilename($_files[$file_key]['name']) ){\\n \\t\\t\\treturn false;\\n \\t\\t}\\n \\n@@ -324,14 +324,12 @@ public function isDangerFilename($filename){\\n \\tpublic function isAllowedFilename($filename){\\n \\t\\t$allow_array = array(\\n \\t\\t\\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\\n-\\t\\t\\t'.mp3','.wav','.mp4',\\n-\\t\\t\\t'.mov','.webmv','.flac','.mkv',\\n+\\t\\t\\t'.mp3','.wav','.mp4','.mov','.flac','.mkv',\\n \\t\\t\\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',\\n-\\t\\t\\t'.pdf','.ofd','.swf','.epub','.xps',\\n-\\t\\t\\t'.doc','.docx','.wps',\\n+\\t\\t\\t'.pdf','.epub','.xps','.doc','.docx','.wps',\\n \\t\\t\\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\\n \\t\\t\\t'.cer','.ppt','.pub','.json','.css',\\n-\\t\\t\\t) ;\\n+\\t\\t) ;\\n \\n \\t\\t$ext = strtolower(substr($filename,strripos($filename,'.')) ); \/\/\u83b7\u53d6\u6587\u4ef6\u6269\u5c55\u540d\uff08\u8f6c\u4e3a\u5c0f\u5199\u540e\uff09\\n \\t\\tif(in_array( $ext , $allow_array ) ){\"}}",
      "message_norm":"upload file vulnerability",
      "language":"ro",
      "entities":"[('vulnerability', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 3caa32334db0c277b84e993eaca2036f5d1dbef8 Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Mon, 14 Mar 2022 23:26:49 +0800\nSubject: [PATCH] Upload file vulnerability\n\n---\n ...\/Application\/Api\/Model\/AttachmentModel.class.php  | 12 +++++-------\n 1 file changed, 5 insertions(+), 7 deletions(-)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 965db2e60..b79090dc4 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -54,10 +54,10 @@ public function deleteFile($file_id){\n \t}\n \n \t\/\/\u4e0a\u4f20\u6587\u4ef6\uff0c\u8fd4\u56deurl\n-\tpublic function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0  ){\n+\tpublic function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0 , $check_filename = true  ){\n \t\t$uploadFile = $_files[$file_key] ;\n \n-\t\tif( !$this->isAllowedFilename($_files[$file_key]['name']) ){\n+\t\tif( $check_filename && !$this->isAllowedFilename($_files[$file_key]['name']) ){\n \t\t\treturn false;\n \t\t}\n \n@@ -324,14 +324,12 @@ public function isDangerFilename($filename){\n \tpublic function isAllowedFilename($filename){\n \t\t$allow_array = array(\n \t\t\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\n-\t\t\t'.mp3','.wav','.mp4',\n-\t\t\t'.mov','.webmv','.flac','.mkv',\n+\t\t\t'.mp3','.wav','.mp4','.mov','.flac','.mkv',\n \t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',\n-\t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n-\t\t\t'.doc','.docx','.wps',\n+\t\t\t'.pdf','.epub','.xps','.doc','.docx','.wps',\n \t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\n \t\t\t'.cer','.ppt','.pub','.json','.css',\n-\t\t\t) ;\n+\t\t) ;\n \n \t\t$ext = strtolower(substr($filename,strripos($filename,'.')) ); \/\/\u83b7\u53d6\u6587\u4ef6\u6269\u5c55\u540d\uff08\u8f6c\u4e3a\u5c0f\u5199\u540e\uff09\n \t\tif(in_array( $ext , $allow_array ) ){",
      "code_diff":"@@ -54,10 +54,10 @@ public function deleteFile($file_id){\n \t}\n \n \t\/\/\u4e0a\u4f20\u6587\u4ef6\uff0c\u8fd4\u56deurl\n-\tpublic function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0  ){\n+\tpublic function upload($_files , $file_key , $uid , $item_id = 0  , $page_id = 0 , $check_filename = true  ){\n \t\t$uploadFile = $_files[$file_key] ;\n \n-\t\tif( !$this->isAllowedFilename($_files[$file_key]['name']) ){\n+\t\tif( $check_filename && !$this->isAllowedFilename($_files[$file_key]['name']) ){\n \t\t\treturn false;\n \t\t}\n \n@@ -324,14 +324,12 @@ public function isDangerFilename($filename){\n \tpublic function isAllowedFilename($filename){\n \t\t$allow_array = array(\n \t\t\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\n-\t\t\t'.mp3','.wav','.mp4',\n-\t\t\t'.mov','.webmv','.flac','.mkv',\n+\t\t\t'.mp3','.wav','.mp4','.mov','.flac','.mkv',\n \t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',\n-\t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n-\t\t\t'.doc','.docx','.wps',\n+\t\t\t'.pdf','.epub','.xps','.doc','.docx','.wps',\n \t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\n \t\t\t'.cer','.ppt','.pub','.json','.css',\n-\t\t\t) ;\n+\t\t) ;\n \n \t\t$ext = strtolower(substr($filename,strripos($filename,'.')) ); \/\/\u83b7\u53d6\u6587\u4ef6\u6269\u5c55\u540d\uff08\u8f6c\u4e3a\u5c0f\u5199\u540e\uff09\n \t\tif(in_array( $ext , $allow_array ) ){"
    },
    {
      "index":89,
      "vuln_id":"GHSA-rphc-h572-2x9f",
      "cwe_id":"{'CWE-434', 'CWE-79'}",
      "score":9.0,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in showdoc\/showdoc ShowDoc is a tool greatly applicable for an IT team to share documents online. showdoc\/showdoc allows .properties files to upload which lead to stored XSS in versions prior to 2.10.4. This allows attackers to execute malicious scripts in the user's browser. This issue was patched in version 2.10.4. There is currently no known workaround.",
      "published_date":"2022-03-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f",
      "commit_sha":"92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f",
      "patch":"SINGLE",
      "chain_ord":"['92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f']",
      "before_first_fix_commit":"{'cd258a0de6fad53a5f41beaf2645f3f6f092f216'}",
      "last_fix_commit":"92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 14:36:28",
      "message":"file upload bug",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 4, 'total': 8}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 4, 'deletions': 4, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': \"@@ -324,13 +324,13 @@ public function isDangerFilename($filename){\\n \\tpublic function isAllowedFilename($filename){\\n \\t\\t$allow_array = array(\\n \\t\\t\\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\\n-\\t\\t\\t'.mp3','.wav','.m4a','.ogg','.webma','.mp4','.flv',\\n+\\t\\t\\t'.mp3','.wav','.mp4',\\n \\t\\t\\t'.mov','.webmv','.flac','.mkv',\\n-\\t\\t\\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\\n+\\t\\t\\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',\\n \\t\\t\\t'.pdf','.ofd','.swf','.epub','.xps',\\n-\\t\\t\\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps',\\n+\\t\\t\\t'.doc','.docx','.wps',\\n \\t\\t\\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\\n-\\t\\t\\t'.cer','.ppt','.pub','.properties','.json','.css',\\n+\\t\\t\\t'.cer','.ppt','.pub','.json','.css',\\n \\t\\t\\t) ;\\n \\n \\t\\t$ext = strtolower(substr($filename,strripos($filename,'.')) ); \/\/\u83b7\u53d6\u6587\u4ef6\u6269\u5c55\u540d\uff08\u8f6c\u4e3a\u5c0f\u5199\u540e\uff09\"}}",
      "message_norm":"file upload bug",
      "language":"ro",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Mon, 14 Mar 2022 22:36:28 +0800\nSubject: [PATCH] file upload bug\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 8 ++++----\n 1 file changed, 4 insertions(+), 4 deletions(-)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex c1b62cf28..965db2e60 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -324,13 +324,13 @@ public function isDangerFilename($filename){\n \tpublic function isAllowedFilename($filename){\n \t\t$allow_array = array(\n \t\t\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\n-\t\t\t'.mp3','.wav','.m4a','.ogg','.webma','.mp4','.flv',\n+\t\t\t'.mp3','.wav','.mp4',\n \t\t\t'.mov','.webmv','.flac','.mkv',\n-\t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\n+\t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',\n \t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n-\t\t\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps',\n+\t\t\t'.doc','.docx','.wps',\n \t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\n-\t\t\t'.cer','.ppt','.pub','.properties','.json','.css',\n+\t\t\t'.cer','.ppt','.pub','.json','.css',\n \t\t\t) ;\n \n \t\t$ext = strtolower(substr($filename,strripos($filename,'.')) ); \/\/\u83b7\u53d6\u6587\u4ef6\u6269\u5c55\u540d\uff08\u8f6c\u4e3a\u5c0f\u5199\u540e\uff09",
      "code_diff":"@@ -324,13 +324,13 @@ public function isDangerFilename($filename){\n \tpublic function isAllowedFilename($filename){\n \t\t$allow_array = array(\n \t\t\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\n-\t\t\t'.mp3','.wav','.m4a','.ogg','.webma','.mp4','.flv',\n+\t\t\t'.mp3','.wav','.mp4',\n \t\t\t'.mov','.webmv','.flac','.mkv',\n-\t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\n+\t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso',\n \t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n-\t\t\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps',\n+\t\t\t'.doc','.docx','.wps',\n \t\t\t'.ppt','.pptx','.xls','.xlsx','.txt','.psd','.csv',\n-\t\t\t'.cer','.ppt','.pub','.properties','.json','.css',\n+\t\t\t'.cer','.ppt','.pub','.json','.css',\n \t\t\t) ;\n \n \t\t$ext = strtolower(substr($filename,strripos($filename,'.')) ); \/\/\u83b7\u53d6\u6587\u4ef6\u6269\u5c55\u540d\uff08\u8f6c\u4e3a\u5c0f\u5199\u540e\uff09"
    },
    {
      "index":90,
      "vuln_id":"GHSA-ph5x-h23x-7q5q",
      "cwe_id":"{'CWE-79', 'CWE-116'}",
      "score":7.4,
      "chain":"{'https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/27f839133d41877e538d35fa88274b50a1c00b9b'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in wiki manager join wiki page ### Impact\nWe found a possible XSS vector in the `WikiManager.JoinWiki ` wiki page related to the \"requestJoin\" field.\n\n### Patches\nThe issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, 13.10.3.\n\n### Workarounds\nThe easiest workaround is to edit the wiki page `WikiManager.JoinWiki` (with wiki editor) and change the line\n\n```\n<input type='hidden' name='requestJoin' value=\"$!request.requestJoin\"\/>\n```\n\ninto\n\n```\n<input type='hidden' name='requestJoin' value=\"$escapetool.xml($!request.requestJoin)\">\n```\n\n### References\n  * https:\/\/jira.xwiki.org\/browse\/XWIKI-19292\n  * https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/27f839133d41877e538d35fa88274b50a1c00b9b\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira XWiki](https:\/\/jira.xwiki.org)\n* Email us at [security mailing list](mailto:security@xwiki.org)",
      "published_date":"2022-05-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/xwiki\/xwiki-platform",
      "commit_href":"https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/27f839133d41877e538d35fa88274b50a1c00b9b",
      "commit_sha":"27f839133d41877e538d35fa88274b50a1c00b9b",
      "patch":"SINGLE",
      "chain_ord":"['27f839133d41877e538d35fa88274b50a1c00b9b']",
      "before_first_fix_commit":"{'bd935320bee3c27cf7548351b1d0f935f116d437'}",
      "last_fix_commit":"27f839133d41877e538d35fa88274b50a1c00b9b",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/04\/2022, 10:35:46",
      "message":"XWIKI-19292: Fix bad escaping",
      "author":"Thomas Mortagne",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'xwiki-platform-core\/xwiki-platform-wiki\/xwiki-platform-wiki-ui\/xwiki-platform-wiki-ui-mainwiki\/src\/main\/resources\/WikiManager\/JoinWiki.xml': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/xwiki\/xwiki-platform\/raw\/27f839133d41877e538d35fa88274b50a1c00b9b\/xwiki-platform-core%2Fxwiki-platform-wiki%2Fxwiki-platform-wiki-ui%2Fxwiki-platform-wiki-ui-mainwiki%2Fsrc%2Fmain%2Fresources%2FWikiManager%2FJoinWiki.xml', 'patch': '@@ -245,7 +245,7 @@\\n                   &lt;a href=\"$backUrl\" class=\\'button secondary\\'&gt;{{translation key=\"platform.wiki.users.join.request.cancel.label\"\/}}&lt;\/a&gt;\\n                 &lt;\/span&gt;\\n                 &lt;input type=\\'hidden\\' name=\\'wikiId\\' value=\"$!wikiId\"\/&gt;\\n-                &lt;input type=\\'hidden\\' name=\\'requestJoin\\' value=\"$!request.requestJoin\"\/&gt;\\n+                &lt;input type=\\'hidden\\' name=\\'requestJoin\\' value=\"$escapetool.xml($!request.requestJoin)\"\/&gt;\\n                 &lt;input type=\"hidden\" name=\"form_token\" value=\"$!escapetool.xml($services.csrf.getToken())\" \/&gt;\\n               &lt;\/dl&gt;\\n             &lt;\/form&gt;'}}",
      "message_norm":"xwiki-19292: fix bad escaping",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('escaping', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['xwiki-platform-core\/xwiki-platform-wiki\/xwiki-platform-wiki-ui\/xwiki-platform-wiki-ui-mainwiki\/src\/main\/resources\/WikiManager\/JoinWiki.xml'])",
      "num_files":1.0,
      "patch_content":"From 27f839133d41877e538d35fa88274b50a1c00b9b Mon Sep 17 00:00:00 2001\nFrom: Thomas Mortagne <thomas.mortagne@gmail.com>\nDate: Tue, 4 Jan 2022 11:35:46 +0100\nSubject: [PATCH] XWIKI-19292: Fix bad escaping\n\n---\n ...\/src\/main\/resources\/WikiManager\/JoinWiki.xml                 | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/xwiki-platform-core\/xwiki-platform-wiki\/xwiki-platform-wiki-ui\/xwiki-platform-wiki-ui-mainwiki\/src\/main\/resources\/WikiManager\/JoinWiki.xml b\/xwiki-platform-core\/xwiki-platform-wiki\/xwiki-platform-wiki-ui\/xwiki-platform-wiki-ui-mainwiki\/src\/main\/resources\/WikiManager\/JoinWiki.xml\nindex ca408851faa3..3a717b2100c4 100644\n--- a\/xwiki-platform-core\/xwiki-platform-wiki\/xwiki-platform-wiki-ui\/xwiki-platform-wiki-ui-mainwiki\/src\/main\/resources\/WikiManager\/JoinWiki.xml\n+++ b\/xwiki-platform-core\/xwiki-platform-wiki\/xwiki-platform-wiki-ui\/xwiki-platform-wiki-ui-mainwiki\/src\/main\/resources\/WikiManager\/JoinWiki.xml\n@@ -245,7 +245,7 @@\n                   &lt;a href=\"$backUrl\" class='button secondary'&gt;{{translation key=\"platform.wiki.users.join.request.cancel.label\"\/}}&lt;\/a&gt;\n                 &lt;\/span&gt;\n                 &lt;input type='hidden' name='wikiId' value=\"$!wikiId\"\/&gt;\n-                &lt;input type='hidden' name='requestJoin' value=\"$!request.requestJoin\"\/&gt;\n+                &lt;input type='hidden' name='requestJoin' value=\"$escapetool.xml($!request.requestJoin)\"\/&gt;\n                 &lt;input type=\"hidden\" name=\"form_token\" value=\"$!escapetool.xml($services.csrf.getToken())\" \/&gt;\n               &lt;\/dl&gt;\n             &lt;\/form&gt;",
      "code_diff":"@@ -245,7 +245,7 @@\n                   &lt;a href=\"$backUrl\" class='button secondary'&gt;{{translation key=\"platform.wiki.users.join.request.cancel.label\"\/}}&lt;\/a&gt;\n                 &lt;\/span&gt;\n                 &lt;input type='hidden' name='wikiId' value=\"$!wikiId\"\/&gt;\n-                &lt;input type='hidden' name='requestJoin' value=\"$!request.requestJoin\"\/&gt;\n+                &lt;input type='hidden' name='requestJoin' value=\"$escapetool.xml($!request.requestJoin)\"\/&gt;\n                 &lt;input type=\"hidden\" name=\"form_token\" value=\"$!escapetool.xml($services.csrf.getToken())\" \/&gt;\n               &lt;\/dl&gt;\n             &lt;\/form&gt;"
    },
    {
      "index":91,
      "vuln_id":"GHSA-4wm8-c2vv-xrpq",
      "cwe_id":"{'CWE-79'}",
      "score":7.1,
      "chain":"{'https:\/\/github.com\/DSpace\/DSpace\/commit\/28eb8158210d41168a62ed5f9e044f754513bc37', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/f7758457b7ec3489d525e39aa753cc70809d9ad9'}",
      "dataset":"osv",
      "summary":"JSPUI Possible Cross Site Scripting in \"Request a Copy\" Feature ### Impact\nThe JSPUI \"Request a Copy\" feature does not properly escape values submitted and stored from the \"Request a Copy\" form.  This means that item requests could be vulnerable to XSS attacks.  This vulnerability only impacts the JSPUI.\n\n_This vulnerability does NOT impact the XMLUI or 7.x._\n\n### Patches\n\n_DSpace 6.x:_ \n* Fixed in 6.4 via commit: https:\/\/github.com\/DSpace\/DSpace\/commit\/503a6af57fd720c37b0d86c34de63baa5dd85819\n* 6.x patch file: https:\/\/github.com\/DSpace\/DSpace\/commit\/503a6af57fd720c37b0d86c34de63baa5dd85819.patch (may be applied manually if an immediate upgrade to 6.4 is not possible)\n\n_DSpace 5.x:_\n* Fixed in 5.11 via commit: https:\/\/github.com\/DSpace\/DSpace\/commit\/28eb8158210d41168a62ed5f9e044f754513bc37\n* 5.x patch file: https:\/\/github.com\/DSpace\/DSpace\/commit\/28eb8158210d41168a62ed5f9e044f754513bc37.patch (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)\n\n#### Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:\n1. Download the appropriate patch file to the machine where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This will copy all updated WARs \/ configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n    3. Restart Tomcat\n\n### Workarounds\nAs a workaround, you can temporarily disable the \"Request a Copy\" feature by either commenting out the below configuration (or setting its value to empty):\n```\n# Comment out this default value\n# request.item.type = all\n```\nOnce your JSPUI site is patched, you can re-enable this setting. See https:\/\/wiki.lyrasis.org\/display\/DSDOC6x\/Request+a+Copy for more information on this setting.\n\n### References\nDiscovered & reported by Andrea Bollini of 4Science\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@dspace.org",
      "published_date":"2022-08-06",
      "chain_len":2,
      "project":"https:\/\/github.com\/DSpace\/DSpace",
      "commit_href":"https:\/\/github.com\/DSpace\/DSpace\/commit\/f7758457b7ec3489d525e39aa753cc70809d9ad9",
      "commit_sha":"f7758457b7ec3489d525e39aa753cc70809d9ad9",
      "patch":"MULTI",
      "chain_ord":"['f7758457b7ec3489d525e39aa753cc70809d9ad9', '28eb8158210d41168a62ed5f9e044f754513bc37']",
      "before_first_fix_commit":"{'56e76049185bbd87c994128a9d77735ad7af0199'}",
      "last_fix_commit":"28eb8158210d41168a62ed5f9e044f754513bc37",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/08\/2020, 00:48:56",
      "message":"[DS-4133] Improve URL handling in Controlled Vocab JSPUI servlet",
      "author":"Kim Shepherd",
      "comments":null,
      "stats":"{'additions': 10, 'deletions': 2, 'total': 12}",
      "files":"{'dspace-jspui\/src\/main\/java\/org\/dspace\/app\/webui\/servlet\/ControlledVocabularyServlet.java': {'additions': 10, 'deletions': 2, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DSpace\/DSpace\/raw\/f7758457b7ec3489d525e39aa753cc70809d9ad9\/dspace-jspui%2Fsrc%2Fmain%2Fjava%2Forg%2Fdspace%2Fapp%2Fwebui%2Fservlet%2FControlledVocabularyServlet.java', 'patch': '@@ -14,6 +14,7 @@\\n import javax.servlet.http.HttpServletRequest;\\n import javax.servlet.http.HttpServletResponse;\\n \\n+import org.apache.log4j.Logger;\\n import org.dspace.authorize.AuthorizeException;\\n import org.dspace.core.Context;\\n \\n@@ -25,8 +26,8 @@\\n  *\/\\n public class ControlledVocabularyServlet extends DSpaceServlet\\n {\\n-    \/\/ private static Logger log =\\n-    \/\/ Logger.getLogger(ControlledVocabularyServlet.class);\\n+    private static Logger log =\\n+    Logger.getLogger(ControlledVocabularyServlet.class);\\n \\n     protected void doDSGet(Context context, HttpServletRequest request,\\n             HttpServletResponse response) throws ServletException, IOException,\\n@@ -37,6 +38,13 @@ protected void doDSGet(Context context, HttpServletRequest request,\\n         String filter = \"\";\\n         String callerUrl = request.getParameter(\"callerUrl\");\\n \\n+        \/\/ callerUrl must starts with URL outside DSpace request context path\\n+        if(!callerUrl.startsWith(request.getContextPath())) {\\n+            log.error(\"Controlled vocabulary caller URL would result in redirect outside DSpace web app: \" + callerUrl + \". Rejecting request with 400 Bad Request.\");\\n+            response.sendError(400, \"The caller URL must be within the DSpace base URL of \" + request.getContextPath());\\n+            return;\\n+        }\\n+\\n         if (request.getParameter(\"ID\") != null)\\n         {\\n             ID = request.getParameter(\"ID\");'}}",
      "message_norm":"[ds-4133] improve url handling in controlled vocab jspui servlet",
      "language":"en",
      "entities":"[('improve', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['dspace-jspui\/src\/main\/java\/org\/dspace\/app\/webui\/servlet\/ControlledVocabularyServlet.java'])",
      "num_files":1.0,
      "patch_content":"From f7758457b7ec3489d525e39aa753cc70809d9ad9 Mon Sep 17 00:00:00 2001\nFrom: Kim Shepherd <kim@shepherd.nz>\nDate: Wed, 8 Apr 2020 12:48:56 +1200\nSubject: [PATCH] [DS-4133] Improve URL handling in Controlled Vocab JSPUI\n servlet\n\n---\n ...\/webui\/servlet\/ControlledVocabularyServlet.java   | 12 ++++++++++--\n 1 file changed, 10 insertions(+), 2 deletions(-)\n\ndiff --git a\/dspace-jspui\/src\/main\/java\/org\/dspace\/app\/webui\/servlet\/ControlledVocabularyServlet.java b\/dspace-jspui\/src\/main\/java\/org\/dspace\/app\/webui\/servlet\/ControlledVocabularyServlet.java\nindex 0736418e8c51..70a1d62f4313 100644\n--- a\/dspace-jspui\/src\/main\/java\/org\/dspace\/app\/webui\/servlet\/ControlledVocabularyServlet.java\n+++ b\/dspace-jspui\/src\/main\/java\/org\/dspace\/app\/webui\/servlet\/ControlledVocabularyServlet.java\n@@ -14,6 +14,7 @@\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n \n+import org.apache.log4j.Logger;\n import org.dspace.authorize.AuthorizeException;\n import org.dspace.core.Context;\n \n@@ -25,8 +26,8 @@\n  *\/\n public class ControlledVocabularyServlet extends DSpaceServlet\n {\n-    \/\/ private static Logger log =\n-    \/\/ Logger.getLogger(ControlledVocabularyServlet.class);\n+    private static Logger log =\n+    Logger.getLogger(ControlledVocabularyServlet.class);\n \n     protected void doDSGet(Context context, HttpServletRequest request,\n             HttpServletResponse response) throws ServletException, IOException,\n@@ -37,6 +38,13 @@ protected void doDSGet(Context context, HttpServletRequest request,\n         String filter = \"\";\n         String callerUrl = request.getParameter(\"callerUrl\");\n \n+        \/\/ callerUrl must starts with URL outside DSpace request context path\n+        if(!callerUrl.startsWith(request.getContextPath())) {\n+            log.error(\"Controlled vocabulary caller URL would result in redirect outside DSpace web app: \" + callerUrl + \". Rejecting request with 400 Bad Request.\");\n+            response.sendError(400, \"The caller URL must be within the DSpace base URL of \" + request.getContextPath());\n+            return;\n+        }\n+\n         if (request.getParameter(\"ID\") != null)\n         {\n             ID = request.getParameter(\"ID\");",
      "code_diff":"@@ -14,6 +14,7 @@\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n \n+import org.apache.log4j.Logger;\n import org.dspace.authorize.AuthorizeException;\n import org.dspace.core.Context;\n \n@@ -25,8 +26,8 @@\n  *\/\n public class ControlledVocabularyServlet extends DSpaceServlet\n {\n-    \/\/ private static Logger log =\n-    \/\/ Logger.getLogger(ControlledVocabularyServlet.class);\n+    private static Logger log =\n+    Logger.getLogger(ControlledVocabularyServlet.class);\n \n     protected void doDSGet(Context context, HttpServletRequest request,\n             HttpServletResponse response) throws ServletException, IOException,\n@@ -37,6 +38,13 @@ protected void doDSGet(Context context, HttpServletRequest request,\n         String filter = \"\";\n         String callerUrl = request.getParameter(\"callerUrl\");\n \n+        \/\/ callerUrl must starts with URL outside DSpace request context path\n+        if(!callerUrl.startsWith(request.getContextPath())) {\n+            log.error(\"Controlled vocabulary caller URL would result in redirect outside DSpace web app: \" + callerUrl + \". Rejecting request with 400 Bad Request.\");\n+            response.sendError(400, \"The caller URL must be within the DSpace base URL of \" + request.getContextPath());\n+            return;\n+        }\n+\n         if (request.getParameter(\"ID\") != null)\n         {\n             ID = request.getParameter(\"ID\");"
    },
    {
      "index":92,
      "vuln_id":"GHSA-c558-5gfm-p2r8",
      "cwe_id":"{'CWE-79'}",
      "score":7.1,
      "chain":"{'https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a'}",
      "dataset":"osv",
      "summary":"JSPUI spellcheck and autocomplete tools vulnerable to Cross Site Scripting ### Impact\nThe JSPUI spellcheck \"Did you mean\" HTML escapes the data-spell attribute in the link, but not the actual displayed text.  Similarly, the JSPUI autocomplete HTML does not properly escape text passed to it. Both are vulnerable to XSS.  This vulnerability only impacts the JSPUI.\n\n_This vulnerability does NOT impact the XMLUI or 7.x._\n\n### Patches\n_DSpace 6.x:_\n* Fixed in 6.4 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7\n* 6.x patch files available (may be applied manually if an immediate upgrade to 6.4 or above is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7.patch\n\n_DSpace 5.x:_\n* Fixed in 5.11 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5\n* 5.x patch files available (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5.patch\n\n#### Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:\n1. Download the appropriate patch file to the machine where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This will copy all updated WARs \/ configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n    3. Restart Tomcat\n\n### References\nDiscovered & reported by Hassan Bhuiyan (Brunel University London)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@dspace.org",
      "published_date":"2022-08-06",
      "chain_len":4,
      "project":"https:\/\/github.com\/DSpace\/DSpace",
      "commit_href":"https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d",
      "commit_sha":"ebb83a75234d3de9be129464013e998dc929b68d",
      "patch":"MULTI",
      "chain_ord":"['ebb83a75234d3de9be129464013e998dc929b68d', '35030a23e48b5946f5853332c797e1c4adea7bb7', 'c89e493e517b424dea6175caba54e91d3847fc3a', '6f75bb084ab1937d094208c55cd84340040bcbb5']",
      "before_first_fix_commit":"{'d1dd7d23329ef055069759df15cfa200c8e32e54'}",
      "last_fix_commit":"6f75bb084ab1937d094208c55cd84340040bcbb5",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/08\/2020, 00:55:36",
      "message":"[DS-4453] Fix XSS handling in JSPUI discovery spellcheck",
      "author":"Kim Shepherd",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DSpace\/DSpace\/raw\/ebb83a75234d3de9be129464013e998dc929b68d\/dspace-jspui%2Fsrc%2Fmain%2Fwebapp%2Fsearch%2Fdiscovery.jsp', 'patch': '@@ -209,7 +209,7 @@\\n         <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\\n         <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\\n-\\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\\n+\\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\\n <% } %>                  \\n         <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\\n         <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>'}}",
      "message_norm":"[ds-4453] fix xss handling in jspui discovery spellcheck",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp'])",
      "num_files":1.0,
      "patch_content":"From ebb83a75234d3de9be129464013e998dc929b68d Mon Sep 17 00:00:00 2001\nFrom: Kim Shepherd <kim@shepherd.nz>\nDate: Wed, 8 Apr 2020 12:55:36 +1200\nSubject: [PATCH] [DS-4453] Fix XSS handling in JSPUI discovery spellcheck\n\n---\n dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\nindex 6cfafd4f3c7d..ac51dbcb1405 100644\n--- a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n+++ b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n@@ -209,7 +209,7 @@\n         <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\n         <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\n-\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\n+\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\n <% } %>                  \n         <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\n         <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>",
      "code_diff":"@@ -209,7 +209,7 @@\n         <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\n         <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\n-\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\n+\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\n <% } %>                  \n         <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\n         <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>"
    },
    {
      "index":93,
      "vuln_id":"GHSA-r5jw-62xg-j433",
      "cwe_id":"{'CWE-79'}",
      "score":6.4,
      "chain":"{'https:\/\/github.com\/kaminari\/kaminari\/commit\/8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in Kaminari ### Impact\nIn Kaminari before 1.2.1, there is a vulnerability that would allow an attacker to inject arbitrary code into pages with pagination links. This has been fixed in 1.2.1.\n\n### Releases\nThe 1.2.1 gem including the patch has already been released.\nAll past released versions are affected by this vulnerability.\n\n### Workarounds\nApplication developers who can't update the gem can workaround by overriding the `PARAM_KEY_EXCEPT_LIST` constant.\n\n```ruby\nmodule Kaminari::Helpers\n  PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\nend\n```\n\n### Credits\nThanks to Daniel Mircea for finding the issue and sending a patch via GitHub. Also thanks to Aditya Prakash for reporting the vulnerability.",
      "published_date":"2020-05-28",
      "chain_len":1,
      "project":"https:\/\/github.com\/kaminari\/kaminari",
      "commit_href":"https:\/\/github.com\/kaminari\/kaminari\/commit\/8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8",
      "commit_sha":"8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8",
      "patch":"SINGLE",
      "chain_ord":"['8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8']",
      "before_first_fix_commit":"{'04d86ed3f2537aff620941413e5fca254e87aebe'}",
      "last_fix_commit":"8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/21\/2020, 21:02:59",
      "message":"Blacklist \"original_script_name\" get param",
      "author":"Daniel Mircea",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'kaminari-core\/lib\/kaminari\/helpers\/tags.rb': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/kaminari\/kaminari\/raw\/8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8\/kaminari-core%2Flib%2Fkaminari%2Fhelpers%2Ftags.rb', 'patch': '@@ -2,7 +2,7 @@\\n \\n module Kaminari\\n   module Helpers\\n-    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name].freeze\\n+    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\\n \\n     # A tag stands for an HTML tag inside the paginator.\\n     # Basically, a tag has its own partial template file, so every tag can be'}}",
      "message_norm":"blacklist \"original_script_name\" get param",
      "language":"ca",
      "entities":"[('blacklist', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['kaminari-core\/lib\/kaminari\/helpers\/tags.rb'])",
      "num_files":1.0,
      "patch_content":"From 8dd52a1aed3d2fa2835d836de23fc0d8c4ff5db8 Mon Sep 17 00:00:00 2001\nFrom: Daniel Mircea <daniel@viseztrance.com>\nDate: Tue, 21 Apr 2020 22:02:59 +0100\nSubject: [PATCH] Blacklist \"original_script_name\" get param\n\n---\n kaminari-core\/lib\/kaminari\/helpers\/tags.rb | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb b\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb\nindex 076bd4310..702e66e5b 100644\n--- a\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb\n+++ b\/kaminari-core\/lib\/kaminari\/helpers\/tags.rb\n@@ -2,7 +2,7 @@\n \n module Kaminari\n   module Helpers\n-    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name].freeze\n+    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\n \n     # A tag stands for an HTML tag inside the paginator.\n     # Basically, a tag has its own partial template file, so every tag can be",
      "code_diff":"@@ -2,7 +2,7 @@\n \n module Kaminari\n   module Helpers\n-    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name].freeze\n+    PARAM_KEY_EXCEPT_LIST = [:authenticity_token, :commit, :utf8, :_method, :script_name, :original_script_name].freeze\n \n     # A tag stands for an HTML tag inside the paginator.\n     # Basically, a tag has its own partial template file, so every tag can be"
    },
    {
      "index":94,
      "vuln_id":"GHSA-8w3x-r6x7-c5r5",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/3c2a14e676a57e5d77a16255965988eef48f9065'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in pimcore pimcore is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2021-12-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/3c2a14e676a57e5d77a16255965988eef48f9065",
      "commit_sha":"3c2a14e676a57e5d77a16255965988eef48f9065",
      "patch":"SINGLE",
      "chain_ord":"['3c2a14e676a57e5d77a16255965988eef48f9065']",
      "before_first_fix_commit":"{'a5e13bea6315b7bee8fb44f83a38029d065f97a3'}",
      "last_fix_commit":"3c2a14e676a57e5d77a16255965988eef48f9065",
      "chain_ord_pos":1.0,
      "commit_datetime":"12\/09\/2021, 11:53:00",
      "message":"[Admin UI] DataObject Class - escape general settings input values (#10991)\n\n* [Admin UI] DataObject Class - escape general settings input values\r\n\r\n* Update bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\r\n\r\n* [Admin UI] DataObject Class - escape general settings input values\r\n\r\n* [Admin UI] DataObject Class - escape general settings input values",
      "author":"Divesh Pahuja",
      "comments":null,
      "stats":"{'additions': 20, 'deletions': 1, 'total': 21}",
      "files":"{'bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js': {'additions': 20, 'deletions': 1, 'changes': 21, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/3c2a14e676a57e5d77a16255965988eef48f9065\/bundles%2FAdminBundle%2FResources%2Fpublic%2Fjs%2Fpimcore%2Fobject%2Fclasses%2Fclass.js', 'patch': '@@ -607,7 +607,12 @@ pimcore.object.classes.klass = Class.create({\\n                 for (var i = 0; i < items.length; i++) {\\n                     var item = items[i];\\n                     if (typeof item.getValue == \"function\") {\\n-                        this.data[item.name] = item.getValue();\\n+                        let value = item.getValue();\\n+                        if (typeof item.config.xtype !== \\'undefined\\' && item.config.xtype === \\'textfield\\') {\\n+                            value = Ext.util.Format.htmlEncode(value);\\n+                        }\\n+\\n+                        this.data[item.name] = value;\\n                     }\\n                 }\\n \\n@@ -705,6 +710,7 @@ pimcore.object.classes.klass = Class.create({\\n             id: \"iconfield-\" + this.getId(),\\n             name: \"icon\",\\n             width: 396,\\n+            renderer: Ext.util.Format.htmlEncode,\\n             value: this.data.icon,\\n             listeners: {\\n                 \"afterrender\": function (el) {\\n@@ -752,6 +758,7 @@ pimcore.object.classes.klass = Class.create({\\n                     width: 500,\\n                     enableKeyEvents: true,\\n                     value: this.data.name,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     listeners: {\\n                         keyup: function (el) {\\n                             this.rootPanel.getComponent(\"phpClassName\").setValue(getPhpClassName(el.getValue()))\\n@@ -763,12 +770,14 @@ pimcore.object.classes.klass = Class.create({\\n                     fieldLabel: t(\"description\"),\\n                     name: \"description\",\\n                     width: 500,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.description\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"unique_identifier\"),\\n                     disabled: true,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.id,\\n                     width: 500\\n                 },\\n@@ -779,62 +788,71 @@ pimcore.object.classes.klass = Class.create({\\n                     itemId: \"phpClassName\",\\n                     width: 500,\\n                     disabled: true,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: getPhpClassName(this.data.name)\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"parent_php_class\"),\\n                     name: \"parentClass\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.parentClass\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     width: 600,\\n                     name: \"implementsInterfaces\",\\n                     fieldLabel: t(\"implements_interfaces\"),\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.implementsInterfaces\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"use_traits\"),\\n                     name: \"useTraits\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.useTraits\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"listing_parent_php_class\"),\\n                     name: \"listingParentClass\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.listingParentClass\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"listing_use_traits\"),\\n                     name: \"listingUseTraits\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.listingUseTraits\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"link_generator_reference\"),\\n                     name: \"linkGeneratorReference\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.linkGeneratorReference\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"preview_generator_reference\"),\\n                     name: \"previewGeneratorReference\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.previewGeneratorReference\\n                 },\\n                 {\\n                     xtype: \"textfield\",\\n                     fieldLabel: t(\"preview_url\"),\\n                     name: \"previewUrl\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.previewUrl\\n                 },\\n                 {\\n@@ -885,6 +903,7 @@ pimcore.object.classes.klass = Class.create({\\n                     fieldLabel: t(\"group\"),\\n                     name: \"group\",\\n                     width: 600,\\n+                    renderer: Ext.util.Format.htmlEncode,\\n                     value: this.data.group\\n                 },\\n                 this.allowInheritance,'}}",
      "message_norm":"[admin ui] dataobject class - escape general settings input values (#10991)\n\n* [admin ui] dataobject class - escape general settings input values\r\n\r\n* update bundles\/adminbundle\/resources\/public\/js\/pimcore\/object\/classes\/class.js\r\n\r\n* [admin ui] dataobject class - escape general settings input values\r\n\r\n* [admin ui] dataobject class - escape general settings input values",
      "language":"ca",
      "entities":"[('admin', 'SECWORD', ''), ('escape', 'SECWORD', ''), ('#10991', 'ISSUE', ''), ('admin', 'SECWORD', ''), ('escape', 'SECWORD', ''), ('update', 'ACTION', ''), ('adminbundle', 'SECWORD', ''), ('admin', 'SECWORD', ''), ('escape', 'SECWORD', ''), ('admin', 'SECWORD', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js'])",
      "num_files":1.0,
      "patch_content":"From 3c2a14e676a57e5d77a16255965988eef48f9065 Mon Sep 17 00:00:00 2001\nFrom: Divesh Pahuja <divesh.pahuja@pimcore.com>\nDate: Thu, 9 Dec 2021 12:53:00 +0100\nSubject: [PATCH] [Admin UI] DataObject Class - escape general settings input\n values (#10991)\n\n* [Admin UI] DataObject Class - escape general settings input values\n\n* Update bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\n\n* [Admin UI] DataObject Class - escape general settings input values\n\n* [Admin UI] DataObject Class - escape general settings input values\n---\n ...\/public\/js\/pimcore\/object\/classes\/class.js | 21 ++++++++++++++++++-\n 1 file changed, 20 insertions(+), 1 deletion(-)\n\ndiff --git a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\nindex a712aa67ce3..ad66b07cb57 100644\n--- a\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\n+++ b\/bundles\/AdminBundle\/Resources\/public\/js\/pimcore\/object\/classes\/class.js\n@@ -607,7 +607,12 @@ pimcore.object.classes.klass = Class.create({\n                 for (var i = 0; i < items.length; i++) {\n                     var item = items[i];\n                     if (typeof item.getValue == \"function\") {\n-                        this.data[item.name] = item.getValue();\n+                        let value = item.getValue();\n+                        if (typeof item.config.xtype !== 'undefined' && item.config.xtype === 'textfield') {\n+                            value = Ext.util.Format.htmlEncode(value);\n+                        }\n+\n+                        this.data[item.name] = value;\n                     }\n                 }\n \n@@ -705,6 +710,7 @@ pimcore.object.classes.klass = Class.create({\n             id: \"iconfield-\" + this.getId(),\n             name: \"icon\",\n             width: 396,\n+            renderer: Ext.util.Format.htmlEncode,\n             value: this.data.icon,\n             listeners: {\n                 \"afterrender\": function (el) {\n@@ -752,6 +758,7 @@ pimcore.object.classes.klass = Class.create({\n                     width: 500,\n                     enableKeyEvents: true,\n                     value: this.data.name,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     listeners: {\n                         keyup: function (el) {\n                             this.rootPanel.getComponent(\"phpClassName\").setValue(getPhpClassName(el.getValue()))\n@@ -763,12 +770,14 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"description\"),\n                     name: \"description\",\n                     width: 500,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.description\n                 },\n                 {\n                     xtype: \"textfield\",\n                     fieldLabel: t(\"unique_identifier\"),\n                     disabled: true,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.id,\n                     width: 500\n                 },\n@@ -779,6 +788,7 @@ pimcore.object.classes.klass = Class.create({\n                     itemId: \"phpClassName\",\n                     width: 500,\n                     disabled: true,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: getPhpClassName(this.data.name)\n                 },\n                 {\n@@ -786,6 +796,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"parent_php_class\"),\n                     name: \"parentClass\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.parentClass\n                 },\n                 {\n@@ -793,6 +804,7 @@ pimcore.object.classes.klass = Class.create({\n                     width: 600,\n                     name: \"implementsInterfaces\",\n                     fieldLabel: t(\"implements_interfaces\"),\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.implementsInterfaces\n                 },\n                 {\n@@ -800,6 +812,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"use_traits\"),\n                     name: \"useTraits\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.useTraits\n                 },\n                 {\n@@ -807,6 +820,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"listing_parent_php_class\"),\n                     name: \"listingParentClass\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.listingParentClass\n                 },\n                 {\n@@ -814,6 +828,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"listing_use_traits\"),\n                     name: \"listingUseTraits\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.listingUseTraits\n                 },\n                 {\n@@ -821,6 +836,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"link_generator_reference\"),\n                     name: \"linkGeneratorReference\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.linkGeneratorReference\n                 },\n                 {\n@@ -828,6 +844,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"preview_generator_reference\"),\n                     name: \"previewGeneratorReference\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.previewGeneratorReference\n                 },\n                 {\n@@ -835,6 +852,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"preview_url\"),\n                     name: \"previewUrl\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.previewUrl\n                 },\n                 {\n@@ -885,6 +903,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"group\"),\n                     name: \"group\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.group\n                 },\n                 this.allowInheritance,",
      "code_diff":"@@ -607,7 +607,12 @@ pimcore.object.classes.klass = Class.create({\n                 for (var i = 0; i < items.length; i++) {\n                     var item = items[i];\n                     if (typeof item.getValue == \"function\") {\n-                        this.data[item.name] = item.getValue();\n+                        let value = item.getValue();\n+                        if (typeof item.config.xtype !== 'undefined' && item.config.xtype === 'textfield') {\n+                            value = Ext.util.Format.htmlEncode(value);\n+                        }\n+\n+                        this.data[item.name] = value;\n                     }\n                 }\n \n@@ -705,6 +710,7 @@ pimcore.object.classes.klass = Class.create({\n             id: \"iconfield-\" + this.getId(),\n             name: \"icon\",\n             width: 396,\n+            renderer: Ext.util.Format.htmlEncode,\n             value: this.data.icon,\n             listeners: {\n                 \"afterrender\": function (el) {\n@@ -752,6 +758,7 @@ pimcore.object.classes.klass = Class.create({\n                     width: 500,\n                     enableKeyEvents: true,\n                     value: this.data.name,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     listeners: {\n                         keyup: function (el) {\n                             this.rootPanel.getComponent(\"phpClassName\").setValue(getPhpClassName(el.getValue()))\n@@ -763,12 +770,14 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"description\"),\n                     name: \"description\",\n                     width: 500,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.description\n                 },\n                 {\n                     xtype: \"textfield\",\n                     fieldLabel: t(\"unique_identifier\"),\n                     disabled: true,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.id,\n                     width: 500\n                 },\n@@ -779,6 +788,7 @@ pimcore.object.classes.klass = Class.create({\n                     itemId: \"phpClassName\",\n                     width: 500,\n                     disabled: true,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: getPhpClassName(this.data.name)\n                 },\n                 {\n@@ -786,6 +796,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"parent_php_class\"),\n                     name: \"parentClass\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.parentClass\n                 },\n                 {\n@@ -793,6 +804,7 @@ pimcore.object.classes.klass = Class.create({\n                     width: 600,\n                     name: \"implementsInterfaces\",\n                     fieldLabel: t(\"implements_interfaces\"),\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.implementsInterfaces\n                 },\n                 {\n@@ -800,6 +812,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"use_traits\"),\n                     name: \"useTraits\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.useTraits\n                 },\n                 {\n@@ -807,6 +820,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"listing_parent_php_class\"),\n                     name: \"listingParentClass\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.listingParentClass\n                 },\n                 {\n@@ -814,6 +828,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"listing_use_traits\"),\n                     name: \"listingUseTraits\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.listingUseTraits\n                 },\n                 {\n@@ -821,6 +836,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"link_generator_reference\"),\n                     name: \"linkGeneratorReference\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.linkGeneratorReference\n                 },\n                 {\n@@ -828,6 +844,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"preview_generator_reference\"),\n                     name: \"previewGeneratorReference\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.previewGeneratorReference\n                 },\n                 {\n@@ -835,6 +852,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"preview_url\"),\n                     name: \"previewUrl\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.previewUrl\n                 },\n                 {\n@@ -885,6 +903,7 @@ pimcore.object.classes.klass = Class.create({\n                     fieldLabel: t(\"group\"),\n                     name: \"group\",\n                     width: 600,\n+                    renderer: Ext.util.Format.htmlEncode,\n                     value: this.data.group\n                 },\n                 this.allowInheritance,"
    },
    {
      "index":95,
      "vuln_id":"GHSA-7jh9-6cpf-h4m7",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/MrSwitch\/hello.js\/commit\/d6f5137f30de6e0ef7048191ee6ae575fdc2f669'}",
      "dataset":"osv",
      "summary":"XSS in hello.js This affects the package hello.js before 1.18.6. The code get the param oauth_redirect from url and pass it to location.assign without any check and sanitisation. So we can simply pass some XSS payloads into the url param oauth_redirect, such as javascript:alert(1).",
      "published_date":"2021-01-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/MrSwitch\/hello.js",
      "commit_href":"https:\/\/github.com\/MrSwitch\/hello.js\/commit\/d6f5137f30de6e0ef7048191ee6ae575fdc2f669",
      "commit_sha":"d6f5137f30de6e0ef7048191ee6ae575fdc2f669",
      "patch":"SINGLE",
      "chain_ord":"['d6f5137f30de6e0ef7048191ee6ae575fdc2f669']",
      "before_first_fix_commit":"{'3b79ec93781b3d7b9c0b56f598e060301d1f3e73'}",
      "last_fix_commit":"d6f5137f30de6e0ef7048191ee6ae575fdc2f669",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/06\/2020, 11:20:56",
      "message":"fix(xss): oauth_redirect should be a valid url",
      "author":"Andrew Dodson",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 1, 'total': 6}",
      "files":"{'src\/hello.js': {'additions': 5, 'deletions': 1, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/MrSwitch\/hello.js\/raw\/d6f5137f30de6e0ef7048191ee6ae575fdc2f669\/src%2Fhello.js', 'patch': \"@@ -1388,8 +1388,12 @@ hello.utils.extend(hello.utils, {\\n \\t\\t\/\/ (URI Fragments within 302 Location URI are lost over HTTPS)\\n \\t\\t\/\/ Loading the redirect.html before triggering the OAuth Flow seems to fix it.\\n \\t\\telse if ('oauth_redirect' in p) {\\n+\\t\\t\\tvar url = decodeURIComponent(p.oauth_redirect);\\n+\\n+\\t\\t\\tif (isValidUrl(url)) {\\n+\\t\\t\\t\\tlocation.assign(url);\\n+\\t\\t\\t}\\n \\n-\\t\\t\\tlocation.assign(decodeURIComponent(p.oauth_redirect));\\n \\t\\t\\treturn;\\n \\t\\t}\"}}",
      "message_norm":"fix(xss): oauth_redirect should be a valid url",
      "language":"en",
      "entities":"[('fix(xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/hello.js'])",
      "num_files":1.0,
      "patch_content":"From d6f5137f30de6e0ef7048191ee6ae575fdc2f669 Mon Sep 17 00:00:00 2001\nFrom: Andrew Dodson <andrew@5app.com>\nDate: Tue, 6 Oct 2020 12:20:56 +0100\nSubject: [PATCH] fix(xss): oauth_redirect should be a valid url\n\n---\n src\/hello.js | 6 +++++-\n 1 file changed, 5 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/hello.js b\/src\/hello.js\nindex e2c57a73..e8618d17 100644\n--- a\/src\/hello.js\n+++ b\/src\/hello.js\n@@ -1388,8 +1388,12 @@ hello.utils.extend(hello.utils, {\n \t\t\/\/ (URI Fragments within 302 Location URI are lost over HTTPS)\n \t\t\/\/ Loading the redirect.html before triggering the OAuth Flow seems to fix it.\n \t\telse if ('oauth_redirect' in p) {\n+\t\t\tvar url = decodeURIComponent(p.oauth_redirect);\n+\n+\t\t\tif (isValidUrl(url)) {\n+\t\t\t\tlocation.assign(url);\n+\t\t\t}\n \n-\t\t\tlocation.assign(decodeURIComponent(p.oauth_redirect));\n \t\t\treturn;\n \t\t}",
      "code_diff":"@@ -1388,8 +1388,12 @@ hello.utils.extend(hello.utils, {\n \t\t\/\/ (URI Fragments within 302 Location URI are lost over HTTPS)\n \t\t\/\/ Loading the redirect.html before triggering the OAuth Flow seems to fix it.\n \t\telse if ('oauth_redirect' in p) {\n+\t\t\tvar url = decodeURIComponent(p.oauth_redirect);\n+\n+\t\t\tif (isValidUrl(url)) {\n+\t\t\t\tlocation.assign(url);\n+\t\t\t}\n \n-\t\t\tlocation.assign(decodeURIComponent(p.oauth_redirect));\n \t\t\treturn;\n \t\t}"
    },
    {
      "index":96,
      "vuln_id":"GHSA-vx6v-xg64-pmr8",
      "cwe_id":"{'CWE-79'}",
      "score":8.8,
      "chain":"{'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/2c7065e0c4296e0c692fb4a7ee19c7357583af30'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in django-helpdesk django-helpdesk is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').",
      "published_date":"2021-11-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/django-helpdesk\/django-helpdesk",
      "commit_href":"https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/2c7065e0c4296e0c692fb4a7ee19c7357583af30",
      "commit_sha":"2c7065e0c4296e0c692fb4a7ee19c7357583af30",
      "patch":"SINGLE",
      "chain_ord":"['2c7065e0c4296e0c692fb4a7ee19c7357583af30']",
      "before_first_fix_commit":"{'3f245871ac91356fd91a4e2cea5048bcac1d833e'}",
      "last_fix_commit":"2c7065e0c4296e0c692fb4a7ee19c7357583af30",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/11\/2021, 10:32:09",
      "message":"Add function `htmlEntities`\n\n`htmlentities()` is a function which converts special characters. This allows you to show to display the string without the browser reading it as HTML.",
      "author":"lethanhphuc",
      "comments":null,
      "stats":"{'additions': 6, 'deletions': 2, 'total': 8}",
      "files":"{'helpdesk\/templates\/helpdesk\/ticket_list.html': {'additions': 6, 'deletions': 2, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/raw\/2c7065e0c4296e0c692fb4a7ee19c7357583af30\/helpdesk%2Ftemplates%2Fhelpdesk%2Fticket_list.html', 'patch': '@@ -330,7 +330,11 @@ <h5 class=\"mb-0\">\\n         function get_url(row) {\\n             return \"{% url \\'helpdesk:view\\' 1234 %}\".replace(\/1234\/, row.id.toString());\\n         }\\n-\\n+        \\n+        function htmlEntities(str) {\\n+            return String(str).replace(\/&\/g, \\'&amp;\\').replace(\/<\/g, \\'&lt;\\').replace(\/>\/g, \\'&gt;\\').replace(\/\"\/g, \\'&quot;\\');\\n+        }\\n+        \\n         $(document).ready(function () {\\n             \/\/ Ticket DataTable Initialization\\n             $(\\'#ticketTable\\').DataTable({\\n@@ -366,7 +370,7 @@ <h5 class=\"mb-0\">\\n                             if (type === \\'display\\') {\\n                                 data = \\'<div class=\"tickettitle\"><a href=\"\\' + get_url(row) + \\'\" >\\' +\\n                                     row.id + \\'. \\' +\\n-                                    row.title + \\'<\/a><\/div>\\';\\n+                                    htmlEntities(row.title) + \\'<\/a><\/div>\\';\\n                             }\\n                             return data\\n                         }'}}",
      "message_norm":"add function `htmlentities`\n\n`htmlentities()` is a function which converts special characters. this allows you to show to display the string without the browser reading it as html.",
      "language":"en",
      "entities":"[('add', 'ACTION', ''), ('htmlentities', 'SECWORD', ''), ('htmlentities', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['helpdesk\/templates\/helpdesk\/ticket_list.html'])",
      "num_files":1.0,
      "patch_content":"From 2c7065e0c4296e0c692fb4a7ee19c7357583af30 Mon Sep 17 00:00:00 2001\nFrom: lethanhphuc <31820707+noobpk@users.noreply.github.com>\nDate: Thu, 11 Nov 2021 17:32:09 +0700\nSubject: [PATCH] Add function `htmlEntities`\n\n`htmlentities()` is a function which converts special characters. This allows you to show to display the string without the browser reading it as HTML.\n---\n helpdesk\/templates\/helpdesk\/ticket_list.html | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\ndiff --git a\/helpdesk\/templates\/helpdesk\/ticket_list.html b\/helpdesk\/templates\/helpdesk\/ticket_list.html\nindex c9a57d23d..2894349b8 100644\n--- a\/helpdesk\/templates\/helpdesk\/ticket_list.html\n+++ b\/helpdesk\/templates\/helpdesk\/ticket_list.html\n@@ -330,7 +330,11 @@ <h5 class=\"mb-0\">\n         function get_url(row) {\n             return \"{% url 'helpdesk:view' 1234 %}\".replace(\/1234\/, row.id.toString());\n         }\n-\n+        \n+        function htmlEntities(str) {\n+            return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n+        }\n+        \n         $(document).ready(function () {\n             \/\/ Ticket DataTable Initialization\n             $('#ticketTable').DataTable({\n@@ -366,7 +370,7 @@ <h5 class=\"mb-0\">\n                             if (type === 'display') {\n                                 data = '<div class=\"tickettitle\"><a href=\"' + get_url(row) + '\" >' +\n                                     row.id + '. ' +\n-                                    row.title + '<\/a><\/div>';\n+                                    htmlEntities(row.title) + '<\/a><\/div>';\n                             }\n                             return data\n                         }",
      "code_diff":"@@ -330,7 +330,11 @@ <h5 class=\"mb-0\">\n         function get_url(row) {\n             return \"{% url 'helpdesk:view' 1234 %}\".replace(\/1234\/, row.id.toString());\n         }\n-\n+        \n+        function htmlEntities(str) {\n+            return String(str).replace(\/&\/g, '&amp;').replace(\/<\/g, '&lt;').replace(\/>\/g, '&gt;').replace(\/\"\/g, '&quot;');\n+        }\n+        \n         $(document).ready(function () {\n             \/\/ Ticket DataTable Initialization\n             $('#ticketTable').DataTable({\n@@ -366,7 +370,7 @@ <h5 class=\"mb-0\">\n                             if (type === 'display') {\n                                 data = '<div class=\"tickettitle\"><a href=\"' + get_url(row) + '\" >' +\n                                     row.id + '. ' +\n-                                    row.title + '<\/a><\/div>';\n+                                    htmlEntities(row.title) + '<\/a><\/div>';\n                             }\n                             return data\n                         }"
    },
    {
      "index":97,
      "vuln_id":"GHSA-rcvx-rmvf-mxch",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/eclipse\/hawkbit\/commit\/94b7c12cde1b38eda5414bd88d6d068008cfb9f9'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Eclipse Hawkbit In all version of Eclipse Hawkbit prior to 0.3.0M7, the HTTP 404 (Not Found) JSON response body returned by the REST API may contain unsafe characters within the path attribute. Sending a POST request to a non existing resource will return the full path from the given URL unescaped to the client.",
      "published_date":"2022-02-09",
      "chain_len":1,
      "project":"https:\/\/github.com\/eclipse\/hawkbit",
      "commit_href":"https:\/\/github.com\/eclipse\/hawkbit\/commit\/94b7c12cde1b38eda5414bd88d6d068008cfb9f9",
      "commit_sha":"94b7c12cde1b38eda5414bd88d6d068008cfb9f9",
      "patch":"SINGLE",
      "chain_ord":"['94b7c12cde1b38eda5414bd88d6d068008cfb9f9']",
      "before_first_fix_commit":"{'8816396d18880d2020743ce2e83a08446449d0db'}",
      "last_fix_commit":"94b7c12cde1b38eda5414bd88d6d068008cfb9f9",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/12\/2021, 10:56:44",
      "message":"Fixes #1067\n\nJSON body response for HTTP 404 error may contain unsafe URL path characters. Thus removing path from the response\n\nSigned-off-by: Dominic Schabel <dominic.schabel@bosch.io>",
      "author":"Dominic Schabel",
      "comments":null,
      "stats":"{'additions': 22, 'deletions': 4, 'total': 26}",
      "files":"{'hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java': {'additions': 22, 'deletions': 4, 'changes': 26, 'status': 'renamed', 'raw_url': 'https:\/\/github.com\/eclipse\/hawkbit\/raw\/94b7c12cde1b38eda5414bd88d6d068008cfb9f9\/hawkbit-runtime%2Fhawkbit-update-server%2Fsrc%2Fmain%2Fjava%2Forg%2Feclipse%2Fhawkbit%2Fapp%2FErrorController.java', 'patch': '@@ -8,6 +8,8 @@\\n  *\/\\n package org.eclipse.hawkbit.app;\\n \\n+import java.util.Map;\\n+\\n import javax.servlet.http.HttpServletRequest;\\n import javax.servlet.http.HttpServletResponse;\\n \\n@@ -23,22 +25,23 @@\\n \/**\\n  * Error page controller that ensures that ocet stream does not return text in\\n  * case of an error.\\n- *\\n  *\/\\n @Controller\\n \/\/ Exception squid:S3752 - errors need handling for all methods\\n @SuppressWarnings(\"squid:S3752\")\\n-public class StreamAwareErrorController extends BasicErrorController {\\n+public class ErrorController extends BasicErrorController {\\n+\\n+    private static final String PATH = \"path\";\\n \\n     \/**\\n-     * A new {@link StreamAwareErrorController}.\\n+     * A new {@link ErrorController}.\\n      * \\n      * @param errorAttributes\\n      *            the error attributes\\n      * @param serverProperties\\n      *            configuration properties\\n      *\/\\n-    public StreamAwareErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\\n+    public ErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\\n         super(errorAttributes, serverProperties.getError());\\n     }\\n \\n@@ -48,4 +51,19 @@ public ResponseEntity<Void> errorStream(final HttpServletRequest request, final\\n         return new ResponseEntity<>(status);\\n     }\\n \\n+    @Override\\n+    @RequestMapping\\n+    public ResponseEntity<Map<String, Object>> error(final HttpServletRequest request) {\\n+        final HttpStatus status = getStatus(request);\\n+        final Map<String, Object> body = getErrorAttributesWithoutPath(request);\\n+        return new ResponseEntity<>(body, status);\\n+    }\\n+\\n+    private Map<String, Object> getErrorAttributesWithoutPath(final HttpServletRequest request) {\\n+        final Map<String, Object> body = getErrorAttributes(request, isIncludeStackTrace(request, MediaType.ALL));\\n+        if (body != null && body.containsKey(PATH)) {\\n+            body.remove(PATH);\\n+        }\\n+        return body;\\n+    }\\n }'}}",
      "message_norm":"fixes #1067\n\njson body response for http 404 error may contain unsafe url path characters. thus removing path from the response\n\nsigned-off-by: dominic schabel <dominic.schabel@bosch.io>",
      "language":"en",
      "entities":"[('fixes', 'ACTION', ''), ('#1067', 'ISSUE', ''), ('error', 'FLAW', ''), ('unsafe', 'SECWORD', ''), ('removing', 'ACTION', ''), ('dominic.schabel@bosch.io', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java'])",
      "num_files":1.0,
      "patch_content":"From 94b7c12cde1b38eda5414bd88d6d068008cfb9f9 Mon Sep 17 00:00:00 2001\nFrom: Dominic Schabel <dominic.schabel@bosch.io>\nDate: Tue, 12 Jan 2021 11:56:44 +0100\nSubject: [PATCH] Fixes #1067\n\nJSON body response for HTTP 404 error may contain unsafe URL path characters. Thus removing path from the response\n\nSigned-off-by: Dominic Schabel <dominic.schabel@bosch.io>\n---\n ...orController.java => ErrorController.java} | 26 ++++++++++++++++---\n 1 file changed, 22 insertions(+), 4 deletions(-)\n rename hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/{StreamAwareErrorController.java => ErrorController.java} (64%)\n\ndiff --git a\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java b\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\nsimilarity index 64%\nrename from hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java\nrename to hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\nindex 39793afe74..da4c46be24 100644\n--- a\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java\n+++ b\/hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\n@@ -8,6 +8,8 @@\n  *\/\n package org.eclipse.hawkbit.app;\n \n+import java.util.Map;\n+\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n \n@@ -23,22 +25,23 @@\n \/**\n  * Error page controller that ensures that ocet stream does not return text in\n  * case of an error.\n- *\n  *\/\n @Controller\n \/\/ Exception squid:S3752 - errors need handling for all methods\n @SuppressWarnings(\"squid:S3752\")\n-public class StreamAwareErrorController extends BasicErrorController {\n+public class ErrorController extends BasicErrorController {\n+\n+    private static final String PATH = \"path\";\n \n     \/**\n-     * A new {@link StreamAwareErrorController}.\n+     * A new {@link ErrorController}.\n      * \n      * @param errorAttributes\n      *            the error attributes\n      * @param serverProperties\n      *            configuration properties\n      *\/\n-    public StreamAwareErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\n+    public ErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\n         super(errorAttributes, serverProperties.getError());\n     }\n \n@@ -48,4 +51,19 @@ public ResponseEntity<Void> errorStream(final HttpServletRequest request, final\n         return new ResponseEntity<>(status);\n     }\n \n+    @Override\n+    @RequestMapping\n+    public ResponseEntity<Map<String, Object>> error(final HttpServletRequest request) {\n+        final HttpStatus status = getStatus(request);\n+        final Map<String, Object> body = getErrorAttributesWithoutPath(request);\n+        return new ResponseEntity<>(body, status);\n+    }\n+\n+    private Map<String, Object> getErrorAttributesWithoutPath(final HttpServletRequest request) {\n+        final Map<String, Object> body = getErrorAttributes(request, isIncludeStackTrace(request, MediaType.ALL));\n+        if (body != null && body.containsKey(PATH)) {\n+            body.remove(PATH);\n+        }\n+        return body;\n+    }\n }",
      "code_diff":"similarity index 64%\nrename from hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/StreamAwareErrorController.java\nrename to hawkbit-runtime\/hawkbit-update-server\/src\/main\/java\/org\/eclipse\/hawkbit\/app\/ErrorController.java\n@@ -8,6 +8,8 @@\n  *\/\n package org.eclipse.hawkbit.app;\n \n+import java.util.Map;\n+\n import javax.servlet.http.HttpServletRequest;\n import javax.servlet.http.HttpServletResponse;\n \n@@ -23,22 +25,23 @@\n \/**\n  * Error page controller that ensures that ocet stream does not return text in\n  * case of an error.\n- *\n  *\/\n @Controller\n \/\/ Exception squid:S3752 - errors need handling for all methods\n @SuppressWarnings(\"squid:S3752\")\n-public class StreamAwareErrorController extends BasicErrorController {\n+public class ErrorController extends BasicErrorController {\n+\n+    private static final String PATH = \"path\";\n \n     \/**\n-     * A new {@link StreamAwareErrorController}.\n+     * A new {@link ErrorController}.\n      * \n      * @param errorAttributes\n      *            the error attributes\n      * @param serverProperties\n      *            configuration properties\n      *\/\n-    public StreamAwareErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\n+    public ErrorController(final ErrorAttributes errorAttributes, final ServerProperties serverProperties) {\n         super(errorAttributes, serverProperties.getError());\n     }\n \n@@ -48,4 +51,19 @@ public ResponseEntity<Void> errorStream(final HttpServletRequest request, final\n         return new ResponseEntity<>(status);\n     }\n \n+    @Override\n+    @RequestMapping\n+    public ResponseEntity<Map<String, Object>> error(final HttpServletRequest request) {\n+        final HttpStatus status = getStatus(request);\n+        final Map<String, Object> body = getErrorAttributesWithoutPath(request);\n+        return new ResponseEntity<>(body, status);\n+    }\n+\n+    private Map<String, Object> getErrorAttributesWithoutPath(final HttpServletRequest request) {\n+        final Map<String, Object> body = getErrorAttributes(request, isIncludeStackTrace(request, MediaType.ALL));\n+        if (body != null && body.containsKey(PATH)) {\n+            body.remove(PATH);\n+        }\n+        return body;\n+    }\n }"
    },
    {
      "index":98,
      "vuln_id":"GHSA-wjh9-344g-vc49",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/francoisjacquet\/rosariosis\/commit\/6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in RosarioSIS Cross-site Scripting (XSS) - Stored in GitHub repository francoisjacquet\/rosariosis prior to 9.0.",
      "published_date":"2022-06-09",
      "chain_len":1,
      "project":"https:\/\/github.com\/francoisjacquet\/rosariosis",
      "commit_href":"https:\/\/github.com\/francoisjacquet\/rosariosis\/commit\/6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8",
      "commit_sha":"6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8",
      "patch":"SINGLE",
      "chain_ord":"['6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8']",
      "before_first_fix_commit":"{'25eb3196e26df31917dfef87aa9f66f78c1646ea'}",
      "last_fix_commit":"6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/04\/2022, 11:44:21",
      "message":"Fix stored XSS security issue: remove inline JS from URL in PreparePHP_SELF.fnc.php",
      "author":"Fran\u00e7ois Jacquet",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'functions\/PreparePHP_SELF.fnc.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/francoisjacquet\/rosariosis\/raw\/6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8\/functions%2FPreparePHP_SELF.fnc.php', 'patch': \"@@ -200,7 +200,7 @@ function( $match ) {\\n \\n \\tforeach ( $remove as $remove_string )\\n \\t{\\n-\\t\\twhile ( strpos( $string, $remove_string ) !== false )\\n+\\t\\twhile ( stripos( $string, $remove_string ) !== false )\\n \\t\\t{\\n \\t\\t\\t$string = str_ireplace( $remove, '', $string );\\n \\t\\t}\"}}",
      "message_norm":"fix stored xss security issue: remove inline js from url in preparephp_self.fnc.php",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('security', 'SECWORD', ''), ('issue', 'FLAW', ''), ('remove', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['functions\/PreparePHP_SELF.fnc.php'])",
      "num_files":1.0,
      "patch_content":"From 6b22c0b5b40fad891c8cf9e7eeff3e42a35c0bf8 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Fran=C3=A7ois=20Jacquet?=\n <francoisjacquet@users.noreply.github.com>\nDate: Sat, 4 Jun 2022 13:44:21 +0200\nSubject: [PATCH] Fix stored XSS security issue: remove inline JS from URL in\n PreparePHP_SELF.fnc.php\n\n---\n functions\/PreparePHP_SELF.fnc.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/functions\/PreparePHP_SELF.fnc.php b\/functions\/PreparePHP_SELF.fnc.php\nindex 80da4699a..f7dfe677b 100644\n--- a\/functions\/PreparePHP_SELF.fnc.php\n+++ b\/functions\/PreparePHP_SELF.fnc.php\n@@ -200,7 +200,7 @@ function( $match ) {\n \n \tforeach ( $remove as $remove_string )\n \t{\n-\t\twhile ( strpos( $string, $remove_string ) !== false )\n+\t\twhile ( stripos( $string, $remove_string ) !== false )\n \t\t{\n \t\t\t$string = str_ireplace( $remove, '', $string );\n \t\t}",
      "code_diff":"@@ -200,7 +200,7 @@ function( $match ) {\n \n \tforeach ( $remove as $remove_string )\n \t{\n-\t\twhile ( strpos( $string, $remove_string ) !== false )\n+\t\twhile ( stripos( $string, $remove_string ) !== false )\n \t\t{\n \t\t\t$string = str_ireplace( $remove, '', $string );\n \t\t}"
    },
    {
      "index":99,
      "vuln_id":"GHSA-gx5w-rrhp-f436",
      "cwe_id":"{'CWE-79'}",
      "score":8.2,
      "chain":"{'https:\/\/github.com\/rust-lang\/mdBook\/commit\/32abeef088e98327ca0dfccdad92e84afa9d2e9b'}",
      "dataset":"osv",
      "summary":"XSS in mdBook > This is a cross-post of [the official security advisory][ml]. The official post contains a signed version with our PGP key, as well.\n\n[ml]: https:\/\/groups.google.com\/g\/rustlang-security-announcements\/c\/3-sO6of29O0\n\nThe Rust Security Response Working Group was recently notified of a security issue affecting the search feature of mdBook, which could allow an attacker to execute arbitrary JavaScript code on the page.\n\nThe CVE for this vulnerability is [CVE-2020-26297](https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2020-26297).\n\n## Overview\n\nThe search feature of mdBook (introduced in version 0.1.4) was affected by a cross site scripting vulnerability that allowed an attacker to execute arbitrary JavaScript code on an user's browser by tricking the user into typing a malicious search query, or tricking the user into clicking a link to the search page with the malicious search query prefilled.\n\nmdBook 0.4.5 fixes the vulnerability by properly escaping the search query.\n\n## Mitigations\n\nOwners of websites built with mdBook have to upgrade to mdBook 0.4.5 or greater and rebuild their website contents with it. It's possible to install mdBook 0.4.5 on the local system with:\n\n```\ncargo install mdbook --version 0.4.5 --force\n```\n\n## Acknowledgements\n\nThanks to Kamil Vavra for responsibly disclosing the vulnerability to us according to [our security policy](https:\/\/www.rust-lang.org\/policies\/security).\n\n## Timeline of events\n\nAll times are listed in UTC.\n\n- 2020-12-30 20:14 - The issue is reported to the Rust Security Response WG\n- 2020-12-30 20:32 - The issue is acknowledged and the investigation began\n- 2020-12-30 21:21 - Found the cause of the vulnerability and prepared the patch\n- 2021-01-04 15:00 - Patched version released and vulnerability disclosed",
      "published_date":"2021-08-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/rust-lang\/mdBook",
      "commit_href":"https:\/\/github.com\/rust-lang\/mdBook\/commit\/32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "commit_sha":"32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "patch":"SINGLE",
      "chain_ord":"['32abeef088e98327ca0dfccdad92e84afa9d2e9b']",
      "before_first_fix_commit":"{'5de9b6841ed03c8149eeec3c8a5fcd40b5d4dbe0'}",
      "last_fix_commit":"32abeef088e98327ca0dfccdad92e84afa9d2e9b",
      "chain_ord_pos":1.0,
      "commit_datetime":"12\/30\/2020, 21:13:15",
      "message":"fix xss in the search page\n\nThanks to Kamil Vavra for responsibly disclosing the vulnerability\naccording to Rust's Security Policy.",
      "author":"Pietro Albini",
      "comments":null,
      "stats":"{'additions': 5, 'deletions': 0, 'total': 5}",
      "files":"{'src\/theme\/searcher\/searcher.js': {'additions': 5, 'deletions': 0, 'changes': 5, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/rust-lang\/mdBook\/raw\/32abeef088e98327ca0dfccdad92e84afa9d2e9b\/src%2Ftheme%2Fsearcher%2Fsearcher.js', 'patch': '@@ -145,6 +145,11 @@ window.search = window.search || {};\\n             url.push(\"\");\\n         }\\n \\n+        \/\/ encodeURIComponent escapes all chars that could allow an XSS except\\n+        \/\/ for \\'. Due to that we also manually replace \\' with its url-encoded\\n+        \/\/ representation (%27).\\n+        var searchterms = encodeURIComponent(searchterms.join(\" \")).replace(\/\\\\\\'\/g, \"%27\");\\n+\\n         return \\'<a href=\"\\' + path_to_root + url[0] + \\'?\\' + URL_MARK_PARAM + \\'=\\' + searchterms + \\'#\\' + url[1]\\n             + \\'\" aria-details=\"teaser_\\' + teaser_count + \\'\">\\' + result.doc.breadcrumbs + \\'<\/a>\\'\\n             + \\'<span class=\"teaser\" id=\"teaser_\\' + teaser_count + \\'\" aria-label=\"Search Result Teaser\">\\''}}",
      "message_norm":"fix xss in the search page\n\nthanks to kamil vavra for responsibly disclosing the vulnerability\naccording to rust's security policy.",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('vulnerability', 'SECWORD', ''), ('security', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/theme\/searcher\/searcher.js'])",
      "num_files":1.0,
      "patch_content":"From 32abeef088e98327ca0dfccdad92e84afa9d2e9b Mon Sep 17 00:00:00 2001\nFrom: Pietro Albini <pietro@pietroalbini.org>\nDate: Wed, 30 Dec 2020 22:13:15 +0100\nSubject: [PATCH] fix xss in the search page\n\nThanks to Kamil Vavra for responsibly disclosing the vulnerability\naccording to Rust's Security Policy.\n---\n src\/theme\/searcher\/searcher.js | 5 +++++\n 1 file changed, 5 insertions(+)\n\ndiff --git a\/src\/theme\/searcher\/searcher.js b\/src\/theme\/searcher\/searcher.js\nindex e1cc806b8e..acf3d50cbc 100644\n--- a\/src\/theme\/searcher\/searcher.js\n+++ b\/src\/theme\/searcher\/searcher.js\n@@ -145,6 +145,11 @@ window.search = window.search || {};\n             url.push(\"\");\n         }\n \n+        \/\/ encodeURIComponent escapes all chars that could allow an XSS except\n+        \/\/ for '. Due to that we also manually replace ' with its url-encoded\n+        \/\/ representation (%27).\n+        var searchterms = encodeURIComponent(searchterms.join(\" \")).replace(\/\\'\/g, \"%27\");\n+\n         return '<a href=\"' + path_to_root + url[0] + '?' + URL_MARK_PARAM + '=' + searchterms + '#' + url[1]\n             + '\" aria-details=\"teaser_' + teaser_count + '\">' + result.doc.breadcrumbs + '<\/a>'\n             + '<span class=\"teaser\" id=\"teaser_' + teaser_count + '\" aria-label=\"Search Result Teaser\">'",
      "code_diff":"@@ -145,6 +145,11 @@ window.search = window.search || {};\n             url.push(\"\");\n         }\n \n+        \/\/ encodeURIComponent escapes all chars that could allow an XSS except\n+        \/\/ for '. Due to that we also manually replace ' with its url-encoded\n+        \/\/ representation (%27).\n+        var searchterms = encodeURIComponent(searchterms.join(\" \")).replace(\/\\'\/g, \"%27\");\n+\n         return '<a href=\"' + path_to_root + url[0] + '?' + URL_MARK_PARAM + '=' + searchterms + '#' + url[1]\n             + '\" aria-details=\"teaser_' + teaser_count + '\">' + result.doc.breadcrumbs + '<\/a>'\n             + '<span class=\"teaser\" id=\"teaser_' + teaser_count + '\" aria-label=\"Search Result Teaser\">'"
    },
    {
      "index":100,
      "vuln_id":"GHSA-6m26-25q2-cq46",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/c897d0dc159849763a813184d9b75b966c6360bf'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber Microweber Cross-site Scripting (XSS) - Stored XSS vulnerability on admin page up to version 1.3.",
      "published_date":"2022-02-27",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/c897d0dc159849763a813184d9b75b966c6360bf",
      "commit_sha":"c897d0dc159849763a813184d9b75b966c6360bf",
      "patch":"SINGLE",
      "chain_ord":"['c897d0dc159849763a813184d9b75b966c6360bf']",
      "before_first_fix_commit":"{'7d3e768be798979e82778c47fbabfbd944ec8ea7'}",
      "last_fix_commit":"c897d0dc159849763a813184d9b75b966c6360bf",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/25\/2022, 09:57:42",
      "message":"add xss clean to create media dir method",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 6, 'deletions': 1, 'total': 7}",
      "files":"{'src\/MicroweberPackages\/Media\/MediaManager.php': {'additions': 6, 'deletions': 1, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/c897d0dc159849763a813184d9b75b966c6360bf\/src%2FMicroweberPackages%2FMedia%2FMediaManager.php', 'patch': \"@@ -4,6 +4,7 @@\\n \\n use Conner\\\\Tagging\\\\Model\\\\Tagged;\\n use \\\\Intervention\\\\Image\\\\ImageManagerStatic as Image;\\n+use MicroweberPackages\\\\Helper\\\\HTMLClean;\\n use MicroweberPackages\\\\Media\\\\Models\\\\Media;\\n use MicroweberPackages\\\\Media\\\\Models\\\\MediaThumbnail;\\n use MicroweberPackages\\\\Utils\\\\Media\\\\Thumbnailer;\\n@@ -1184,6 +1185,10 @@ public function thumbnail_img($params)\\n \\n     public function create_media_dir($params)\\n     {\\n+\\n+        $clean = new HTMLClean();\\n+        $_REQUEST = $clean->cleanArray($_REQUEST);\\n+\\n         must_have_access();\\n         $resp = array();\\n         \/\/ $target_path = media_base_path() . 'uploaded' . DS;\\n@@ -1198,7 +1203,7 @@ public function create_media_dir($params)\\n \\n             $target_path = $fn_path;\\n         }\\n-        if (!isset($_REQUEST['name'])) {\\n+        if (!isset($_REQUEST['name']) || empty($_REQUEST['name'])) {\\n             $resp = array('error' => 'You must send new_folder parameter');\\n         } else {\\n             $fn_new_folder_path = $_REQUEST['name'];\"}}",
      "message_norm":"add xss clean to create media dir method",
      "language":"en",
      "entities":"[('add', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/Media\/MediaManager.php'])",
      "num_files":1.0,
      "patch_content":"From c897d0dc159849763a813184d9b75b966c6360bf Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Fri, 25 Feb 2022 11:57:42 +0200\nSubject: [PATCH] add xss clean to create media dir method\n\n---\n src\/MicroweberPackages\/Media\/MediaManager.php | 7 ++++++-\n 1 file changed, 6 insertions(+), 1 deletion(-)\n\ndiff --git a\/src\/MicroweberPackages\/Media\/MediaManager.php b\/src\/MicroweberPackages\/Media\/MediaManager.php\nindex 1ed03ac0085..eca46fa89bb 100644\n--- a\/src\/MicroweberPackages\/Media\/MediaManager.php\n+++ b\/src\/MicroweberPackages\/Media\/MediaManager.php\n@@ -4,6 +4,7 @@\n \n use Conner\\Tagging\\Model\\Tagged;\n use \\Intervention\\Image\\ImageManagerStatic as Image;\n+use MicroweberPackages\\Helper\\HTMLClean;\n use MicroweberPackages\\Media\\Models\\Media;\n use MicroweberPackages\\Media\\Models\\MediaThumbnail;\n use MicroweberPackages\\Utils\\Media\\Thumbnailer;\n@@ -1184,6 +1185,10 @@ public function thumbnail_img($params)\n \n     public function create_media_dir($params)\n     {\n+\n+        $clean = new HTMLClean();\n+        $_REQUEST = $clean->cleanArray($_REQUEST);\n+\n         must_have_access();\n         $resp = array();\n         \/\/ $target_path = media_base_path() . 'uploaded' . DS;\n@@ -1198,7 +1203,7 @@ public function create_media_dir($params)\n \n             $target_path = $fn_path;\n         }\n-        if (!isset($_REQUEST['name'])) {\n+        if (!isset($_REQUEST['name']) || empty($_REQUEST['name'])) {\n             $resp = array('error' => 'You must send new_folder parameter');\n         } else {\n             $fn_new_folder_path = $_REQUEST['name'];",
      "code_diff":"@@ -4,6 +4,7 @@\n \n use Conner\\Tagging\\Model\\Tagged;\n use \\Intervention\\Image\\ImageManagerStatic as Image;\n+use MicroweberPackages\\Helper\\HTMLClean;\n use MicroweberPackages\\Media\\Models\\Media;\n use MicroweberPackages\\Media\\Models\\MediaThumbnail;\n use MicroweberPackages\\Utils\\Media\\Thumbnailer;\n@@ -1184,6 +1185,10 @@ public function thumbnail_img($params)\n \n     public function create_media_dir($params)\n     {\n+\n+        $clean = new HTMLClean();\n+        $_REQUEST = $clean->cleanArray($_REQUEST);\n+\n         must_have_access();\n         $resp = array();\n         \/\/ $target_path = media_base_path() . 'uploaded' . DS;\n@@ -1198,7 +1203,7 @@ public function create_media_dir($params)\n \n             $target_path = $fn_path;\n         }\n-        if (!isset($_REQUEST['name'])) {\n+        if (!isset($_REQUEST['name']) || empty($_REQUEST['name'])) {\n             $resp = array('error' => 'You must send new_folder parameter');\n         } else {\n             $fn_new_folder_path = $_REQUEST['name'];"
    },
    {
      "index":101,
      "vuln_id":"GHSA-6jp6-9rf9-gc66",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/9e19a8414337692cc90da2a91c9af5420f2952f1', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/f6753a1a1c63fade6ad418fbda827c6750ab0bda', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/22d577b1f1e88665a88b4569380148030e0f8389'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Weblate ### Impact\nDue to improper neutralization, it was possible to perform cross-site scripting via crafted user and language names.\n\n### Patches\n\nThe issues were fixed in the 4.11 release. The following commits are addressing it:\n\n* f6753a1a1c63fade6ad418fbda827c6750ab0bda\n* 9e19a8414337692cc90da2a91c9af5420f2952f1\n* 22d577b1f1e88665a88b4569380148030e0f8389\n\n### Workarounds\n\nYou can look for crafted user and language names to see if you were affected.\n\n### References\n* https:\/\/hackerone.com\/reports\/1486674\n* https:\/\/hackerone.com\/reports\/1486718\n* https:\/\/hackerone.com\/reports\/1485226\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open a topic in [discussions](https:\/\/github.com\/WeblateOrg\/weblate\/discussions)\n* Email us at [care@weblate.org](mailto:care@weblate.org)",
      "published_date":"2022-02-25",
      "chain_len":3,
      "project":"https:\/\/github.com\/WeblateOrg\/weblate",
      "commit_href":"https:\/\/github.com\/WeblateOrg\/weblate\/commit\/9e19a8414337692cc90da2a91c9af5420f2952f1",
      "commit_sha":"9e19a8414337692cc90da2a91c9af5420f2952f1",
      "patch":"MULTI",
      "chain_ord":"['22d577b1f1e88665a88b4569380148030e0f8389', '9e19a8414337692cc90da2a91c9af5420f2952f1', 'f6753a1a1c63fade6ad418fbda827c6750ab0bda']",
      "before_first_fix_commit":"{'572628cef60e9d839b79b2087960b606a5cca4d8'}",
      "last_fix_commit":"f6753a1a1c63fade6ad418fbda827c6750ab0bda",
      "chain_ord_pos":2.0,
      "commit_datetime":"02\/22\/2022, 20:00:41",
      "message":"js: Add missing escaping to username completion\n\nFixes https:\/\/hackerone.com\/reports\/1486674",
      "author":"Michal \u010ciha\u0159",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 1, 'total': 4}",
      "files":"{'weblate\/static\/loader-bootstrap.js': {'additions': 3, 'deletions': 1, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/WeblateOrg\/weblate\/raw\/9e19a8414337692cc90da2a91c9af5420f2952f1\/weblate%2Fstatic%2Floader-bootstrap.js', 'patch': '@@ -1131,7 +1131,9 @@ $(function () {\\n       return \"\";\\n     },\\n     menuItemTemplate: function (item) {\\n-      return `<a>${item.string}<\/a>`;\\n+      let link = document.createElement(\"a\");\\n+      link.innerText = item.string;\\n+      return link.outerHTML;\\n     },\\n     values: (text, callback) => {\\n       $.ajax({'}}",
      "message_norm":"js: add missing escaping to username completion\n\nfixes https:\/\/hackerone.com\/reports\/1486674",
      "language":"en",
      "entities":"[('add', 'ACTION', ''), ('escaping', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('https:\/\/hackerone.com\/reports\/1486674', 'URL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['weblate\/static\/loader-bootstrap.js'])",
      "num_files":1.0,
      "patch_content":"From 9e19a8414337692cc90da2a91c9af5420f2952f1 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>\nDate: Tue, 22 Feb 2022 21:00:41 +0100\nSubject: [PATCH] js: Add missing escaping to username completion\n\nFixes https:\/\/hackerone.com\/reports\/1486674\n---\n weblate\/static\/loader-bootstrap.js | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a\/weblate\/static\/loader-bootstrap.js b\/weblate\/static\/loader-bootstrap.js\nindex c0a44c787ead..c7fbdf09a5f8 100644\n--- a\/weblate\/static\/loader-bootstrap.js\n+++ b\/weblate\/static\/loader-bootstrap.js\n@@ -1131,7 +1131,9 @@ $(function () {\n       return \"\";\n     },\n     menuItemTemplate: function (item) {\n-      return `<a>${item.string}<\/a>`;\n+      let link = document.createElement(\"a\");\n+      link.innerText = item.string;\n+      return link.outerHTML;\n     },\n     values: (text, callback) => {\n       $.ajax({",
      "code_diff":"@@ -1131,7 +1131,9 @@ $(function () {\n       return \"\";\n     },\n     menuItemTemplate: function (item) {\n-      return `<a>${item.string}<\/a>`;\n+      let link = document.createElement(\"a\");\n+      link.innerText = item.string;\n+      return link.outerHTML;\n     },\n     values: (text, callback) => {\n       $.ajax({"
    },
    {
      "index":102,
      "vuln_id":"GHSA-c558-5gfm-p2r8",
      "cwe_id":"{'CWE-79'}",
      "score":7.1,
      "chain":"{'https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a'}",
      "dataset":"osv",
      "summary":"JSPUI spellcheck and autocomplete tools vulnerable to Cross Site Scripting ### Impact\nThe JSPUI spellcheck \"Did you mean\" HTML escapes the data-spell attribute in the link, but not the actual displayed text.  Similarly, the JSPUI autocomplete HTML does not properly escape text passed to it. Both are vulnerable to XSS.  This vulnerability only impacts the JSPUI.\n\n_This vulnerability does NOT impact the XMLUI or 7.x._\n\n### Patches\n_DSpace 6.x:_\n* Fixed in 6.4 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7\n* 6.x patch files available (may be applied manually if an immediate upgrade to 6.4 or above is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7.patch\n\n_DSpace 5.x:_\n* Fixed in 5.11 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5\n* 5.x patch files available (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5.patch\n\n#### Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:\n1. Download the appropriate patch file to the machine where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This will copy all updated WARs \/ configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n    3. Restart Tomcat\n\n### References\nDiscovered & reported by Hassan Bhuiyan (Brunel University London)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@dspace.org",
      "published_date":"2022-08-06",
      "chain_len":4,
      "project":"https:\/\/github.com\/DSpace\/DSpace",
      "commit_href":"https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7",
      "commit_sha":"35030a23e48b5946f5853332c797e1c4adea7bb7",
      "patch":"MULTI",
      "chain_ord":"['ebb83a75234d3de9be129464013e998dc929b68d', '35030a23e48b5946f5853332c797e1c4adea7bb7', 'c89e493e517b424dea6175caba54e91d3847fc3a', '6f75bb084ab1937d094208c55cd84340040bcbb5']",
      "before_first_fix_commit":"{'d1dd7d23329ef055069759df15cfa200c8e32e54'}",
      "last_fix_commit":"6f75bb084ab1937d094208c55cd84340040bcbb5",
      "chain_ord_pos":2.0,
      "commit_datetime":"04\/08\/2020, 01:19:14",
      "message":"[DS-4453] Fix XSS handling in JSPUI discovery autocomplete",
      "author":"Kim Shepherd",
      "comments":null,
      "stats":"{'additions': 6, 'deletions': 1, 'total': 7}",
      "files":"{'dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp': {'additions': 6, 'deletions': 1, 'changes': 7, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DSpace\/DSpace\/raw\/35030a23e48b5946f5853332c797e1c4adea7bb7\/dspace-jspui%2Fsrc%2Fmain%2Fwebapp%2Fsearch%2Fdiscovery.jsp', 'patch': '@@ -147,7 +147,7 @@\\n \\t\\t\\t\\t\\t\\t\\t\\t\\ttmp_val = item.displayedValue;\\n \\t\\t\\t\\t\\t\\t\\t\\t}\\n \\t\\t\\t\\t\\t\\t\\t\\treturn {\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\tlabel: item.displayedValue + \" (\" + item.count + \")\",\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\\n \\t\\t\\t\\t\\t\\t\\t\\t\\tvalue: tmp_val\\n \\t\\t\\t\\t\\t\\t\\t\\t};\\n \\t\\t\\t\\t\\t\\t\\t}))\\t\\t\\t\\n@@ -159,6 +159,11 @@\\n \\tfunction validateFilters() {\\n \\t\\treturn document.getElementById(\"filterquery\").value.length > 0;\\n \\t}\\n+\\t\/\/ Generic HTML escape utility\\n+\\tvar escapeHtml = s => (s + \\'\\').replace(\/[&<>\"\\']\/g, m => ({\\n+\\t\\t\\'&\\': \\'&amp;\\', \\'<\\': \\'&lt;\\', \\'>\\': \\'&gt;\\',\\n+\\t\\t\\'\"\\': \\'&quot;\\', \"\\'\": \\'&#39;\\'\\n+\\t})[m]);\\n <\/script>\\t\\t\\n <\/c:set>'}}",
      "message_norm":"[ds-4453] fix xss handling in jspui discovery autocomplete",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp'])",
      "num_files":1.0,
      "patch_content":"From 35030a23e48b5946f5853332c797e1c4adea7bb7 Mon Sep 17 00:00:00 2001\nFrom: Kim Shepherd <kim@shepherd.nz>\nDate: Wed, 8 Apr 2020 13:19:14 +1200\nSubject: [PATCH] [DS-4453] Fix XSS handling in JSPUI discovery autocomplete\n\n---\n dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp | 7 ++++++-\n 1 file changed, 6 insertions(+), 1 deletion(-)\n\ndiff --git a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\nindex 6d71bb6a0e30..6cfafd4f3c7d 100644\n--- a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n+++ b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n@@ -147,7 +147,7 @@\n \t\t\t\t\t\t\t\t\ttmp_val = item.displayedValue;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\treturn {\n-\t\t\t\t\t\t\t\t\tlabel: item.displayedValue + \" (\" + item.count + \")\",\n+\t\t\t\t\t\t\t\t\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\n \t\t\t\t\t\t\t\t\tvalue: tmp_val\n \t\t\t\t\t\t\t\t};\n \t\t\t\t\t\t\t}))\t\t\t\n@@ -159,6 +159,11 @@\n \tfunction validateFilters() {\n \t\treturn document.getElementById(\"filterquery\").value.length > 0;\n \t}\n+\t\/\/ Generic HTML escape utility\n+\tvar escapeHtml = s => (s + '').replace(\/[&<>\"']\/g, m => ({\n+\t\t'&': '&amp;', '<': '&lt;', '>': '&gt;',\n+\t\t'\"': '&quot;', \"'\": '&#39;'\n+\t})[m]);\n <\/script>\t\t\n <\/c:set>",
      "code_diff":"@@ -147,7 +147,7 @@\n \t\t\t\t\t\t\t\t\ttmp_val = item.displayedValue;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\treturn {\n-\t\t\t\t\t\t\t\t\tlabel: item.displayedValue + \" (\" + item.count + \")\",\n+\t\t\t\t\t\t\t\t\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\n \t\t\t\t\t\t\t\t\tvalue: tmp_val\n \t\t\t\t\t\t\t\t};\n \t\t\t\t\t\t\t}))\t\t\t\n@@ -159,6 +159,11 @@\n \tfunction validateFilters() {\n \t\treturn document.getElementById(\"filterquery\").value.length > 0;\n \t}\n+\t\/\/ Generic HTML escape utility\n+\tvar escapeHtml = s => (s + '').replace(\/[&<>\"']\/g, m => ({\n+\t\t'&': '&amp;', '<': '&lt;', '>': '&gt;',\n+\t\t'\"': '&quot;', \"'\": '&#39;'\n+\t})[m]);\n <\/script>\t\t\n <\/c:set>"
    },
    {
      "index":103,
      "vuln_id":"GHSA-qf2g-q4mc-w7rr",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/forkcms\/forkcms\/commit\/981730f1a3d59b423ca903b1f4bf79b848a1766e'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Fork CMS Fork CMS prior to 5.11.1 is vulnerable to stored cross-site scripting. When uploading a new module, the description of the module can contain JavaScript code. The JavaScript code may be executed after uploading the new module and looking at the `Details` page.",
      "published_date":"2022-03-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/forkcms\/forkcms",
      "commit_href":"https:\/\/github.com\/forkcms\/forkcms\/commit\/981730f1a3d59b423ca903b1f4bf79b848a1766e",
      "commit_sha":"981730f1a3d59b423ca903b1f4bf79b848a1766e",
      "patch":"SINGLE",
      "chain_ord":"['981730f1a3d59b423ca903b1f4bf79b848a1766e']",
      "before_first_fix_commit":"{'1b38e33a98992793e998a937b717355212346993'}",
      "last_fix_commit":"981730f1a3d59b423ca903b1f4bf79b848a1766e",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/23\/2022, 13:20:39",
      "message":"Fix xss though the description in the info.xml file of a theme or module",
      "author":"Jelmer Prins",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'src\/Backend\/Modules\/Extensions\/Engine\/Model.php': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/forkcms\/forkcms\/raw\/981730f1a3d59b423ca903b1f4bf79b848a1766e\/src%2FBackend%2FModules%2FExtensions%2FEngine%2FModel.php', 'patch': \"@@ -839,7 +839,7 @@ public static function processModuleXml(\\\\SimpleXMLElement $xml): array\\n         $information['name'] = (string) $module->name;\\n         $information['version'] = (string) $module->version;\\n         $information['requirements'] = (array) $module->requirements;\\n-        $information['description'] = (string) $module->description;\\n+        $information['description'] = strip_tags((string) $module->description, '<h1><h2><h3><h4><h5><h6><p><li><a>');\\n         $information['cronjobs'] = [];\\n \\n         \/\/ authors\\n@@ -900,7 +900,7 @@ public static function processThemeXml(\\\\SimpleXMLElement $xml): array\\n         $information['version'] = (string) $theme->version;\\n         $information['requirements'] = (array) $theme->requirements;\\n         $information['thumbnail'] = (string) $theme->thumbnail;\\n-        $information['description'] = (string) $theme->description;\\n+        $information['description'] = strip_tags((string) $theme->description, '<h1><h2><h3><h4><h5><h6><p><li><a>');\\n \\n         \/\/ authors\\n         foreach ($xml->xpath('\/theme\/authors\/author') as $author) {\"}}",
      "message_norm":"fix xss though the description in the info.xml file of a theme or module",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/Backend\/Modules\/Extensions\/Engine\/Model.php'])",
      "num_files":1.0,
      "patch_content":"From 981730f1a3d59b423ca903b1f4bf79b848a1766e Mon Sep 17 00:00:00 2001\nFrom: Jelmer Prins <jelmer@pageon.be>\nDate: Wed, 23 Mar 2022 14:20:39 +0100\nSubject: [PATCH] Fix xss though the description in the info.xml file of a\n theme or module\n\n---\n src\/Backend\/Modules\/Extensions\/Engine\/Model.php | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/Backend\/Modules\/Extensions\/Engine\/Model.php b\/src\/Backend\/Modules\/Extensions\/Engine\/Model.php\nindex 4e09814e26..3d81361271 100644\n--- a\/src\/Backend\/Modules\/Extensions\/Engine\/Model.php\n+++ b\/src\/Backend\/Modules\/Extensions\/Engine\/Model.php\n@@ -839,7 +839,7 @@ public static function processModuleXml(\\SimpleXMLElement $xml): array\n         $information['name'] = (string) $module->name;\n         $information['version'] = (string) $module->version;\n         $information['requirements'] = (array) $module->requirements;\n-        $information['description'] = (string) $module->description;\n+        $information['description'] = strip_tags((string) $module->description, '<h1><h2><h3><h4><h5><h6><p><li><a>');\n         $information['cronjobs'] = [];\n \n         \/\/ authors\n@@ -900,7 +900,7 @@ public static function processThemeXml(\\SimpleXMLElement $xml): array\n         $information['version'] = (string) $theme->version;\n         $information['requirements'] = (array) $theme->requirements;\n         $information['thumbnail'] = (string) $theme->thumbnail;\n-        $information['description'] = (string) $theme->description;\n+        $information['description'] = strip_tags((string) $theme->description, '<h1><h2><h3><h4><h5><h6><p><li><a>');\n \n         \/\/ authors\n         foreach ($xml->xpath('\/theme\/authors\/author') as $author) {",
      "code_diff":"@@ -839,7 +839,7 @@ public static function processModuleXml(\\SimpleXMLElement $xml): array\n         $information['name'] = (string) $module->name;\n         $information['version'] = (string) $module->version;\n         $information['requirements'] = (array) $module->requirements;\n-        $information['description'] = (string) $module->description;\n+        $information['description'] = strip_tags((string) $module->description, '<h1><h2><h3><h4><h5><h6><p><li><a>');\n         $information['cronjobs'] = [];\n \n         \/\/ authors\n@@ -900,7 +900,7 @@ public static function processThemeXml(\\SimpleXMLElement $xml): array\n         $information['version'] = (string) $theme->version;\n         $information['requirements'] = (array) $theme->requirements;\n         $information['thumbnail'] = (string) $theme->thumbnail;\n-        $information['description'] = (string) $theme->description;\n+        $information['description'] = strip_tags((string) $theme->description, '<h1><h2><h3><h4><h5><h6><p><li><a>');\n \n         \/\/ authors\n         foreach ($xml->xpath('\/theme\/authors\/author') as $author) {"
    },
    {
      "index":104,
      "vuln_id":"GHSA-wrp6-9w7f-3wxg",
      "cwe_id":"{'CWE-79'}",
      "score":7.3,
      "chain":"{'https:\/\/github.com\/janeczku\/calibre-web\/commit\/7ad419dc8c12180e842a82118f4866ac3d074bc5'}",
      "dataset":"osv",
      "summary":"calibre-web is vulnerable to Cross-site Scripting calibre-web is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2022-01-21",
      "chain_len":1,
      "project":"https:\/\/github.com\/janeczku\/calibre-web",
      "commit_href":"https:\/\/github.com\/janeczku\/calibre-web\/commit\/7ad419dc8c12180e842a82118f4866ac3d074bc5",
      "commit_sha":"7ad419dc8c12180e842a82118f4866ac3d074bc5",
      "patch":"SINGLE",
      "chain_ord":"['7ad419dc8c12180e842a82118f4866ac3d074bc5']",
      "before_first_fix_commit":"{'bcdc97641447965af486964537f3821f47b28874'}",
      "last_fix_commit":"7ad419dc8c12180e842a82118f4866ac3d074bc5",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/20\/2021, 12:40:23",
      "message":"Fix upload of cover and book formats containing html characters",
      "author":"Ozzie Isaacs",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'cps\/static\/js\/edit_books.js': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/janeczku\/calibre-web\/raw\/7ad419dc8c12180e842a82118f4866ac3d074bc5\/cps%2Fstatic%2Fjs%2Fedit_books.js', 'patch': '@@ -248,15 +248,15 @@ $(\"#btn-upload-format\").on(\"change\", function () {\\n     if (filename.substring(3, 11) === \"fakepath\") {\\n         filename = filename.substring(12);\\n     } \/\/ Remove c:\\\\fake at beginning from localhost chrome\\n-    $(\"#upload-format\").html(filename);\\n+    $(\"#upload-format\").text(filename);\\n });\\n \\n $(\"#btn-upload-cover\").on(\"change\", function () {\\n     var filename = $(this).val();\\n     if (filename.substring(3, 11) === \"fakepath\") {\\n         filename = filename.substring(12);\\n     } \/\/ Remove c:\\\\fake at beginning from localhost chrome\\n-    $(\"#upload-cover\").html(filename);\\n+    $(\"#upload-cover\").text(filename);\\n });\\n \\n $(\"#xchange\").click(function () {'}}",
      "message_norm":"fix upload of cover and book formats containing html characters",
      "language":"en",
      "entities":"[('fix', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['cps\/static\/js\/edit_books.js'])",
      "num_files":1.0,
      "patch_content":"From 7ad419dc8c12180e842a82118f4866ac3d074bc5 Mon Sep 17 00:00:00 2001\nFrom: Ozzie Isaacs <ozzie.fernandez.isaacs@googlemail.com>\nDate: Sat, 20 Nov 2021 13:40:23 +0100\nSubject: [PATCH] Fix upload of cover and book formats containing html\n characters\n\n---\n cps\/static\/js\/edit_books.js | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/cps\/static\/js\/edit_books.js b\/cps\/static\/js\/edit_books.js\nindex ddc7a3e7ee..0bfe078cfe 100644\n--- a\/cps\/static\/js\/edit_books.js\n+++ b\/cps\/static\/js\/edit_books.js\n@@ -248,7 +248,7 @@ $(\"#btn-upload-format\").on(\"change\", function () {\n     if (filename.substring(3, 11) === \"fakepath\") {\n         filename = filename.substring(12);\n     } \/\/ Remove c:\\fake at beginning from localhost chrome\n-    $(\"#upload-format\").html(filename);\n+    $(\"#upload-format\").text(filename);\n });\n \n $(\"#btn-upload-cover\").on(\"change\", function () {\n@@ -256,7 +256,7 @@ $(\"#btn-upload-cover\").on(\"change\", function () {\n     if (filename.substring(3, 11) === \"fakepath\") {\n         filename = filename.substring(12);\n     } \/\/ Remove c:\\fake at beginning from localhost chrome\n-    $(\"#upload-cover\").html(filename);\n+    $(\"#upload-cover\").text(filename);\n });\n \n $(\"#xchange\").click(function () {",
      "code_diff":"@@ -248,7 +248,7 @@ $(\"#btn-upload-format\").on(\"change\", function () {\n     if (filename.substring(3, 11) === \"fakepath\") {\n         filename = filename.substring(12);\n     } \/\/ Remove c:\\fake at beginning from localhost chrome\n-    $(\"#upload-format\").html(filename);\n+    $(\"#upload-format\").text(filename);\n });\n \n $(\"#btn-upload-cover\").on(\"change\", function () {\n@@ -256,7 +256,7 @@ $(\"#btn-upload-cover\").on(\"change\", function () {\n     if (filename.substring(3, 11) === \"fakepath\") {\n         filename = filename.substring(12);\n     } \/\/ Remove c:\\fake at beginning from localhost chrome\n-    $(\"#upload-cover\").html(filename);\n+    $(\"#upload-cover\").text(filename);\n });\n \n $(\"#xchange\").click(function () {"
    },
    {
      "index":105,
      "vuln_id":"GHSA-49qr-xh3w-h436",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/jupyter\/notebook\/commit\/107a89fce5f413fb5728c1c5d2c7788e1fb17491'}",
      "dataset":"osv",
      "summary":"Moderate severity vulnerability that affects notebook Jupyter Notebook before 5.7.1 allows XSS via an untrusted notebook because nbconvert responses are considered to have the same origin as the notebook server. In other words, nbconvert endpoints can execute JavaScript with access to the server API. In notebook\/nbconvert\/handlers.py, NbconvertFileHandler and NbconvertPostHandler do not set a Content Security Policy to prevent this.",
      "published_date":"2018-11-21",
      "chain_len":1,
      "project":"https:\/\/github.com\/jupyter\/notebook",
      "commit_href":"https:\/\/github.com\/jupyter\/notebook\/commit\/107a89fce5f413fb5728c1c5d2c7788e1fb17491",
      "commit_sha":"107a89fce5f413fb5728c1c5d2c7788e1fb17491",
      "patch":"SINGLE",
      "chain_ord":"['107a89fce5f413fb5728c1c5d2c7788e1fb17491']",
      "before_first_fix_commit":"{'04a686dbaf9dfe553324a03cb9e6f778cf1e3da1'}",
      "last_fix_commit":"107a89fce5f413fb5728c1c5d2c7788e1fb17491",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/22\/2018, 13:52:36",
      "message":"Apply CSP sandboxing for nbconvert responses\n\nThese may contain untrusted content, so they should be treated as being\nfrom a different domain to the notebook server.",
      "author":"Thomas Kluyver",
      "comments":null,
      "stats":"{'additions': 14, 'deletions': 0, 'total': 14}",
      "files":"{'notebook\/nbconvert\/handlers.py': {'additions': 14, 'deletions': 0, 'changes': 14, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/jupyter\/notebook\/raw\/107a89fce5f413fb5728c1c5d2c7788e1fb17491\/notebook%2Fnbconvert%2Fhandlers.py', 'patch': '@@ -78,6 +78,13 @@ class NbconvertFileHandler(IPythonHandler):\\n \\n     SUPPORTED_METHODS = (\\'GET\\',)\\n \\n+    @property\\n+    def content_security_policy(self):\\n+        # In case we\\'re serving HTML\/SVG, confine any Javascript to a unique\\n+        # origin so it can\\'t interact with the notebook server.\\n+        return super(NbconvertFileHandler, self).content_security_policy + \\\\\\n+               \"; sandbox allow-scripts\"\\n+\\n     @web.authenticated\\n     def get(self, format, path):\\n \\n@@ -145,6 +152,13 @@ def get(self, format, path):\\n class NbconvertPostHandler(IPythonHandler):\\n     SUPPORTED_METHODS = (\\'POST\\',)\\n \\n+    @property\\n+    def content_security_policy(self):\\n+        # In case we\\'re serving HTML\/SVG, confine any Javascript to a unique\\n+        # origin so it can\\'t interact with the notebook server.\\n+        return super(NbconvertPostHandler, self).content_security_policy + \\\\\\n+               \"; sandbox allow-scripts\"\\n+\\n     @web.authenticated\\n     def post(self, format):\\n         exporter = get_exporter(format, config=self.config)'}}",
      "message_norm":"apply csp sandboxing for nbconvert responses\n\nthese may contain untrusted content, so they should be treated as being\nfrom a different domain to the notebook server.",
      "language":"en",
      "entities":"[('untrusted', 'SECWORD', ''), ('server', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['notebook\/nbconvert\/handlers.py'])",
      "num_files":1.0,
      "patch_content":"From 107a89fce5f413fb5728c1c5d2c7788e1fb17491 Mon Sep 17 00:00:00 2001\nFrom: Thomas Kluyver <thomas@kluyver.me.uk>\nDate: Mon, 22 Oct 2018 14:52:36 +0100\nSubject: [PATCH] Apply CSP sandboxing for nbconvert responses\n\nThese may contain untrusted content, so they should be treated as being\nfrom a different domain to the notebook server.\n---\n notebook\/nbconvert\/handlers.py | 14 ++++++++++++++\n 1 file changed, 14 insertions(+)\n\ndiff --git a\/notebook\/nbconvert\/handlers.py b\/notebook\/nbconvert\/handlers.py\nindex bb26664aa7..bf0a4bfba8 100644\n--- a\/notebook\/nbconvert\/handlers.py\n+++ b\/notebook\/nbconvert\/handlers.py\n@@ -78,6 +78,13 @@ class NbconvertFileHandler(IPythonHandler):\n \n     SUPPORTED_METHODS = ('GET',)\n \n+    @property\n+    def content_security_policy(self):\n+        # In case we're serving HTML\/SVG, confine any Javascript to a unique\n+        # origin so it can't interact with the notebook server.\n+        return super(NbconvertFileHandler, self).content_security_policy + \\\n+               \"; sandbox allow-scripts\"\n+\n     @web.authenticated\n     def get(self, format, path):\n \n@@ -145,6 +152,13 @@ def get(self, format, path):\n class NbconvertPostHandler(IPythonHandler):\n     SUPPORTED_METHODS = ('POST',)\n \n+    @property\n+    def content_security_policy(self):\n+        # In case we're serving HTML\/SVG, confine any Javascript to a unique\n+        # origin so it can't interact with the notebook server.\n+        return super(NbconvertPostHandler, self).content_security_policy + \\\n+               \"; sandbox allow-scripts\"\n+\n     @web.authenticated\n     def post(self, format):\n         exporter = get_exporter(format, config=self.config)",
      "code_diff":"@@ -78,6 +78,13 @@ class NbconvertFileHandler(IPythonHandler):\n \n     SUPPORTED_METHODS = ('GET',)\n \n+    @property\n+    def content_security_policy(self):\n+        # In case we're serving HTML\/SVG, confine any Javascript to a unique\n+        # origin so it can't interact with the notebook server.\n+        return super(NbconvertFileHandler, self).content_security_policy + \\\n+               \"; sandbox allow-scripts\"\n+\n     @web.authenticated\n     def get(self, format, path):\n \n@@ -145,6 +152,13 @@ def get(self, format, path):\n class NbconvertPostHandler(IPythonHandler):\n     SUPPORTED_METHODS = ('POST',)\n \n+    @property\n+    def content_security_policy(self):\n+        # In case we're serving HTML\/SVG, confine any Javascript to a unique\n+        # origin so it can't interact with the notebook server.\n+        return super(NbconvertPostHandler, self).content_security_policy + \\\n+               \"; sandbox allow-scripts\"\n+\n     @web.authenticated\n     def post(self, format):\n         exporter = get_exporter(format, config=self.config)"
    },
    {
      "index":106,
      "vuln_id":"GHSA-38m9-3vg4-rwvp",
      "cwe_id":"{'CWE-79'}",
      "score":6.5,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber microweber prior to version 1.2.11 is vulnerable to cross-site scripting.",
      "published_date":"2022-02-20",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8",
      "commit_sha":"2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8",
      "patch":"SINGLE",
      "chain_ord":"['2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8']",
      "before_first_fix_commit":"{'93e1e59185d1fdf921d89a887887bca988b12085'}",
      "last_fix_commit":"2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/18\/2022, 10:09:45",
      "message":"Update UrlManager.php",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 0, 'total': 3}",
      "files":"{'src\/MicroweberPackages\/Helper\/UrlManager.php': {'additions': 3, 'deletions': 0, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8\/src%2FMicroweberPackages%2FHelper%2FUrlManager.php', 'patch': '@@ -114,6 +114,9 @@ public function redirect($url)\\n         $redirectUrl = str_replace(\"\\\\r\", \"\", $redirectUrl);\\n         $redirectUrl = str_replace(\"\\\\n\", \"\", $redirectUrl);\\n \\n+        $clearInput = new HTMLClean();\\n+        $redirectUrl = $clearInput->clean($redirectUrl);\\n+\\n         if (headers_sent()) {\\n             echo \\'<meta http-equiv=\"refresh\" content=\"0;url=\\' . $redirectUrl . \\'\">\\';\\n         } else {'}}",
      "message_norm":"update urlmanager.php",
      "language":"sv",
      "entities":null,
      "classification_level_1":"POORLY_DOCUMENTED",
      "classification_level_2":"SUBMIT_CENTERED",
      "list_files":"dict_keys(['src\/MicroweberPackages\/Helper\/UrlManager.php'])",
      "num_files":1.0,
      "patch_content":"From 2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8 Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Fri, 18 Feb 2022 12:09:45 +0200\nSubject: [PATCH] Update UrlManager.php\n\n---\n src\/MicroweberPackages\/Helper\/UrlManager.php | 3 +++\n 1 file changed, 3 insertions(+)\n\ndiff --git a\/src\/MicroweberPackages\/Helper\/UrlManager.php b\/src\/MicroweberPackages\/Helper\/UrlManager.php\nindex ed94787e1a5..cff71b4dc1b 100644\n--- a\/src\/MicroweberPackages\/Helper\/UrlManager.php\n+++ b\/src\/MicroweberPackages\/Helper\/UrlManager.php\n@@ -114,6 +114,9 @@ public function redirect($url)\n         $redirectUrl = str_replace(\"\\r\", \"\", $redirectUrl);\n         $redirectUrl = str_replace(\"\\n\", \"\", $redirectUrl);\n \n+        $clearInput = new HTMLClean();\n+        $redirectUrl = $clearInput->clean($redirectUrl);\n+\n         if (headers_sent()) {\n             echo '<meta http-equiv=\"refresh\" content=\"0;url=' . $redirectUrl . '\">';\n         } else {",
      "code_diff":"@@ -114,6 +114,9 @@ public function redirect($url)\n         $redirectUrl = str_replace(\"\\r\", \"\", $redirectUrl);\n         $redirectUrl = str_replace(\"\\n\", \"\", $redirectUrl);\n \n+        $clearInput = new HTMLClean();\n+        $redirectUrl = $clearInput->clean($redirectUrl);\n+\n         if (headers_sent()) {\n             echo '<meta http-equiv=\"refresh\" content=\"0;url=' . $redirectUrl . '\">';\n         } else {"
    },
    {
      "index":107,
      "vuln_id":"GHSA-vfrc-ggmc-5jwv",
      "cwe_id":"{'CWE-79'}",
      "score":8.8,
      "chain":"{'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/04483bdac3b5196737516398b5ce0383875a5c60'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in django-helpdesk django-helpdesk is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
      "published_date":"2021-11-23",
      "chain_len":1,
      "project":"https:\/\/github.com\/django-helpdesk\/django-helpdesk",
      "commit_href":"https:\/\/github.com\/django-helpdesk\/django-helpdesk\/commit\/04483bdac3b5196737516398b5ce0383875a5c60",
      "commit_sha":"04483bdac3b5196737516398b5ce0383875a5c60",
      "patch":"SINGLE",
      "chain_ord":"['04483bdac3b5196737516398b5ce0383875a5c60']",
      "before_first_fix_commit":"{'2c7065e0c4296e0c692fb4a7ee19c7357583af30'}",
      "last_fix_commit":"04483bdac3b5196737516398b5ce0383875a5c60",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/18\/2021, 03:42:02",
      "message":"Add `att.full_clean()` before saving\n\nFix issue https:\/\/github.com\/django-helpdesk\/django-helpdesk\/issues\/983\r\nAlso, fix bug stored XSS disclosure: https:\/\/huntr.dev\/bounties\/4d7a5fdd-b2de-467a-ade0-3f2fb386638e\/",
      "author":"lethanhphuc",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'helpdesk\/lib.py': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/django-helpdesk\/django-helpdesk\/raw\/04483bdac3b5196737516398b5ce0383875a5c60\/helpdesk%2Flib.py', 'patch': \"@@ -145,6 +145,7 @@ def process_attachments(followup, attached_files):\\n                 'application\/octet-stream',\\n                 size=attached.size,\\n             )\\n+            att.full_clean()\\n             att.save()\\n \\n             if attached.size < max_email_attachment_size:\"}}",
      "message_norm":"add `att.full_clean()` before saving\n\nfix issue https:\/\/github.com\/django-helpdesk\/django-helpdesk\/issues\/983\r\nalso, fix bug stored xss disclosure: https:\/\/huntr.dev\/bounties\/4d7a5fdd-b2de-467a-ade0-3f2fb386638e\/",
      "language":"en",
      "entities":"[('add', 'ACTION', ''), ('issue', 'FLAW', ''), ('https:\/\/github.com\/django-helpdesk\/django-helpdesk\/issues\/983', 'URL', ''), ('fix', 'ACTION', ''), ('bug', 'FLAW', ''), ('xss', 'SECWORD', ''), ('disclosure', 'SECWORD', ''), ('https:\/\/huntr.dev\/bounties\/4d7a5fdd-b2de-467a-ade0-3f2fb386638e\/', 'URL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['helpdesk\/lib.py'])",
      "num_files":1.0,
      "patch_content":"From 04483bdac3b5196737516398b5ce0383875a5c60 Mon Sep 17 00:00:00 2001\nFrom: lethanhphuc <31820707+noobpk@users.noreply.github.com>\nDate: Thu, 18 Nov 2021 10:42:02 +0700\nSubject: [PATCH] Add `att.full_clean()` before saving\n\nFix issue https:\/\/github.com\/django-helpdesk\/django-helpdesk\/issues\/983\nAlso, fix bug stored XSS disclosure: https:\/\/huntr.dev\/bounties\/4d7a5fdd-b2de-467a-ade0-3f2fb386638e\/\n---\n helpdesk\/lib.py | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/helpdesk\/lib.py b\/helpdesk\/lib.py\nindex 07d655c39..da853990b 100644\n--- a\/helpdesk\/lib.py\n+++ b\/helpdesk\/lib.py\n@@ -145,6 +145,7 @@ def process_attachments(followup, attached_files):\n                 'application\/octet-stream',\n                 size=attached.size,\n             )\n+            att.full_clean()\n             att.save()\n \n             if attached.size < max_email_attachment_size:",
      "code_diff":"@@ -145,6 +145,7 @@ def process_attachments(followup, attached_files):\n                 'application\/octet-stream',\n                 size=attached.size,\n             )\n+            att.full_clean()\n             att.save()\n \n             if attached.size < max_email_attachment_size:"
    },
    {
      "index":108,
      "vuln_id":"GHSA-3fw8-66wf-pr7m",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/senchalabs\/connect\/commit\/126187c4e12162e231b87350740045e5bb06e93a', 'https:\/\/github.com\/senchalabs\/connect\/commit\/277e5aad6a95d00f55571a9a0e11f2fa190d8135'}",
      "dataset":"osv",
      "summary":"methodOverride Middleware Reflected Cross-Site Scripting in connect Connect is a stack of middleware that is executed in order in each request.\n\nThe \"methodOverride\" middleware allows the http post to override the method of the request with the value of the \"_method\" post key or with the header \"x-http-method-override\".\n\nBecause the user post input was not checked, req.method could contain any kind of value. Because the req.method did not match any common method VERB, connect answered with a 404 page containing the \"Cannot `[method]` `[url]`\" content. The method was not properly encoded for output in the browser.\n\n\n###Example:\n```\n~ curl \"localhost:3000\" -d \"_method=<script src=http:\/\/nodesecurity.io\/xss.js><\/script>\"\nCannot <SCRIPT SRC=HTTP:\/\/NODESECURITY.IO\/XSS.JS><\/SCRIPT> \/\n```\n\n## Recommendation\n\nUpdate to the newest version of Connect or disable methodOverride. It is not possible to avoid the vulnerability if you have enabled this middleware in the top of your stack.",
      "published_date":"2020-08-31",
      "chain_len":2,
      "project":"https:\/\/github.com\/senchalabs\/connect",
      "commit_href":"https:\/\/github.com\/senchalabs\/connect\/commit\/277e5aad6a95d00f55571a9a0e11f2fa190d8135",
      "commit_sha":"277e5aad6a95d00f55571a9a0e11f2fa190d8135",
      "patch":"MULTI",
      "chain_ord":"['277e5aad6a95d00f55571a9a0e11f2fa190d8135', '126187c4e12162e231b87350740045e5bb06e93a']",
      "before_first_fix_commit":"{'b0df35bcf2e1b4e487a17889a8440ecf254ac3b4'}",
      "last_fix_commit":"126187c4e12162e231b87350740045e5bb06e93a",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/27\/2013, 15:31:23",
      "message":"fix: escape req.method in 404 response",
      "author":"TJ Holowaychuk",
      "comments":null,
      "stats":"{'additions': 4, 'deletions': 4, 'total': 8}",
      "files":"{'lib\/proto.js': {'additions': 4, 'deletions': 4, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/senchalabs\/connect\/raw\/277e5aad6a95d00f55571a9a0e11f2fa190d8135\/lib%2Fproto.js', 'patch': \"@@ -152,7 +152,7 @@ app.handle = function(req, res, out) {\\n         res.statusCode = 404;\\n         res.setHeader('Content-Type', 'text\/plain');\\n         if ('HEAD' == req.method) return res.end();\\n-        res.end('Cannot ' + req.method + ' ' + utils.escape(req.originalUrl));\\n+        res.end('Cannot ' + utils.escape(req.method) + ' ' + utils.escape(req.originalUrl));\\n       }\\n       return;\\n     }\\n@@ -202,7 +202,7 @@ app.handle = function(req, res, out) {\\n  * Listen for connections.\\n  *\\n  * This method takes the same arguments\\n- * as node's `http.Server#listen()`.  \\n+ * as node's `http.Server#listen()`.\\n  *\\n  * HTTP and HTTPS:\\n  *\\n@@ -214,9 +214,9 @@ app.handle = function(req, res, out) {\\n  *      var connect = require('connect')\\n  *        , http = require('http')\\n  *        , https = require('https');\\n- *      \\n+ *\\n  *      var app = connect();\\n- *      \\n+ *\\n  *      http.createServer(app).listen(80);\\n  *      https.createServer(options, app).listen(443);\\n  *\"}}",
      "message_norm":"fix: escape req.method in 404 response",
      "language":"en",
      "entities":"[('fix', 'ACTION', ''), ('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['lib\/proto.js'])",
      "num_files":1.0,
      "patch_content":"From 277e5aad6a95d00f55571a9a0e11f2fa190d8135 Mon Sep 17 00:00:00 2001\nFrom: TJ Holowaychuk <tj@vision-media.ca>\nDate: Thu, 27 Jun 2013 08:31:23 -0700\nSubject: [PATCH] fix: escape req.method in 404 response\n\n---\n lib\/proto.js | 8 ++++----\n 1 file changed, 4 insertions(+), 4 deletions(-)\n\ndiff --git a\/lib\/proto.js b\/lib\/proto.js\nindex b304cf72f..7a8f3098f 100644\n--- a\/lib\/proto.js\n+++ b\/lib\/proto.js\n@@ -152,7 +152,7 @@ app.handle = function(req, res, out) {\n         res.statusCode = 404;\n         res.setHeader('Content-Type', 'text\/plain');\n         if ('HEAD' == req.method) return res.end();\n-        res.end('Cannot ' + req.method + ' ' + utils.escape(req.originalUrl));\n+        res.end('Cannot ' + utils.escape(req.method) + ' ' + utils.escape(req.originalUrl));\n       }\n       return;\n     }\n@@ -202,7 +202,7 @@ app.handle = function(req, res, out) {\n  * Listen for connections.\n  *\n  * This method takes the same arguments\n- * as node's `http.Server#listen()`.  \n+ * as node's `http.Server#listen()`.\n  *\n  * HTTP and HTTPS:\n  *\n@@ -214,9 +214,9 @@ app.handle = function(req, res, out) {\n  *      var connect = require('connect')\n  *        , http = require('http')\n  *        , https = require('https');\n- *      \n+ *\n  *      var app = connect();\n- *      \n+ *\n  *      http.createServer(app).listen(80);\n  *      https.createServer(options, app).listen(443);\n  *",
      "code_diff":"@@ -152,7 +152,7 @@ app.handle = function(req, res, out) {\n         res.statusCode = 404;\n         res.setHeader('Content-Type', 'text\/plain');\n         if ('HEAD' == req.method) return res.end();\n-        res.end('Cannot ' + req.method + ' ' + utils.escape(req.originalUrl));\n+        res.end('Cannot ' + utils.escape(req.method) + ' ' + utils.escape(req.originalUrl));\n       }\n       return;\n     }\n@@ -202,7 +202,7 @@ app.handle = function(req, res, out) {\n  * Listen for connections.\n  *\n  * This method takes the same arguments\n- * as node's `http.Server#listen()`.  \n+ * as node's `http.Server#listen()`.\n  *\n  * HTTP and HTTPS:\n  *\n@@ -214,9 +214,9 @@ app.handle = function(req, res, out) {\n  *      var connect = require('connect')\n  *        , http = require('http')\n  *        , https = require('https');\n- *      \n+ *\n  *      var app = connect();\n- *      \n+ *\n  *      http.createServer(app).listen(80);\n  *      https.createServer(options, app).listen(443);\n  *"
    },
    {
      "index":109,
      "vuln_id":"GHSA-455w-gv5p-wgg3",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/pimcore\/pimcore\/commit\/665976327ad3c2c87efa2a5a64d696032c0a8109'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in pimcore pimcore is vulnerable to Stored XSS at Name field in the setting tab of the Global Targeting Rules.",
      "published_date":"2022-01-26",
      "chain_len":1,
      "project":"https:\/\/github.com\/pimcore\/pimcore",
      "commit_href":"https:\/\/github.com\/pimcore\/pimcore\/commit\/665976327ad3c2c87efa2a5a64d696032c0a8109",
      "commit_sha":"665976327ad3c2c87efa2a5a64d696032c0a8109",
      "patch":"SINGLE",
      "chain_ord":"['665976327ad3c2c87efa2a5a64d696032c0a8109']",
      "before_first_fix_commit":"{'7f8855719f56c42ee3eda27a84b38ab57890e144'}",
      "last_fix_commit":"665976327ad3c2c87efa2a5a64d696032c0a8109",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/19\/2022, 10:36:40",
      "message":"[Targeting] Escape\/validate names of rules properly (#11205)\n\n* [Targeting] Escape\/validate names of rules properly\r\n\r\n* Update bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php\r\n\r\nCo-authored-by: Jacob Dreesen <j.dreesen@neusta.de>\r\n\r\nCo-authored-by: Jacob Dreesen <j.dreesen@neusta.de>",
      "author":"Bernhard Rusch",
      "comments":null,
      "stats":"{'additions': 11, 'deletions': 4, 'total': 15}",
      "files":"{'bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php': {'additions': 11, 'deletions': 4, 'changes': 15, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/pimcore\/pimcore\/raw\/665976327ad3c2c87efa2a5a64d696032c0a8109\/bundles%2FAdminBundle%2FController%2FAdmin%2FTargetingController.php', 'patch': '@@ -37,6 +37,11 @@ class TargetingController extends AdminController implements KernelControllerEve\\n {\\n     \/\/ RULES\\n \\n+    private function correctName(string $name): string\\n+    {\\n+        return preg_replace(\\'\/[#?*:\\\\\\\\\\\\\\\\<>|\"%&@=;+]\/\\', \\'-\\', $name);\\n+    }\\n+\\n     \/**\\n      * @Route(\"\/rule\/list\", name=\"pimcore_admin_targeting_rulelist\", methods={\"GET\"})\\n      *\\n@@ -55,7 +60,7 @@ public function ruleListAction(Request $request)\\n         foreach ($list->load() as $target) {\\n             $targets[] = [\\n                 \\'id\\' => $target->getId(),\\n-                \\'text\\' => $target->getName(),\\n+                \\'text\\' => htmlspecialchars($target->getName()),\\n                 \\'active\\' => $target->getActive(),\\n                 \\'qtip\\' => \\'ID: \\' . $target->getId(),\\n             ];\\n@@ -74,7 +79,7 @@ public function ruleListAction(Request $request)\\n     public function ruleAddAction(Request $request)\\n     {\\n         $target = new Targeting\\\\Rule();\\n-        $target->setName($request->get(\\'name\\'));\\n+        $target->setName($this->correctName($request->get(\\'name\\')));\\n         $target->save();\\n \\n         return $this->adminJson([\\'success\\' => true, \\'id\\' => $target->getId()]);\\n@@ -129,6 +134,7 @@ public function ruleSaveAction(Request $request)\\n         \/** @var Targeting\\\\Rule|Targeting\\\\Rule\\\\Dao $target *\/\\n         $target = Targeting\\\\Rule::getById($request->get(\\'id\\'));\\n         $target->setValues($data[\\'settings\\']);\\n+        $target->setName($this->correctName($target->getName()));\\n         $target->setConditions($data[\\'conditions\\']);\\n         $target->setActions($data[\\'actions\\']);\\n         $target->save();\\n@@ -208,7 +214,7 @@ public function targetGroupListAction(Request $request)\\n         foreach ($list->load() as $targetGroup) {\\n             $targetGroups[] = [\\n                 \\'id\\' => $targetGroup->getId(),\\n-                \\'text\\' => $targetGroup->getName(),\\n+                \\'text\\' => htmlspecialchars($targetGroup->getName()),\\n                 \\'active\\' => $targetGroup->getActive(),\\n                 \\'qtip\\' => $targetGroup->getId(),\\n             ];\\n@@ -230,7 +236,7 @@ public function targetGroupAddAction(Request $request, CoreCacheHandler $cache,\\n     {\\n         \/** @var TargetGroup|TargetGroup\\\\Dao $targetGroup *\/\\n         $targetGroup = new TargetGroup();\\n-        $targetGroup->setName($request->get(\\'name\\'));\\n+        $targetGroup->setName($this->correctName($request->get(\\'name\\')));\\n         $targetGroup->save();\\n \\n         $event = new TargetGroupEvent($targetGroup);\\n@@ -300,6 +306,7 @@ public function targetGroupSaveAction(Request $request, CoreCacheHandler $cache,\\n         \/** @var TargetGroup|TargetGroup\\\\Dao $targetGroup *\/\\n         $targetGroup = TargetGroup::getById($request->get(\\'id\\'));\\n         $targetGroup->setValues($data[\\'settings\\']);\\n+        $targetGroup->setName($this->correctName($targetGroup->getName()));\\n         $targetGroup->save();\\n \\n         $event = new TargetGroupEvent($targetGroup);'}}",
      "message_norm":"[targeting] escape\/validate names of rules properly (#11205)\n\n* [targeting] escape\/validate names of rules properly\r\n\r\n* update bundles\/adminbundle\/controller\/admin\/targetingcontroller.php\r\n\r\nco-authored-by: jacob dreesen <j.dreesen@neusta.de>\r\n\r\nco-authored-by: jacob dreesen <j.dreesen@neusta.de>",
      "language":"en",
      "entities":"[('escape', 'SECWORD', ''), ('validate', 'ACTION', ''), ('#11205', 'ISSUE', ''), ('escape', 'SECWORD', ''), ('validate', 'ACTION', ''), ('update', 'ACTION', ''), ('adminbundle', 'SECWORD', ''), ('admin', 'SECWORD', ''), ('j.dreesen@neusta.de', 'EMAIL', ''), ('j.dreesen@neusta.de', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php'])",
      "num_files":1.0,
      "patch_content":"From 665976327ad3c2c87efa2a5a64d696032c0a8109 Mon Sep 17 00:00:00 2001\nFrom: Bernhard Rusch <brusch@users.noreply.github.com>\nDate: Wed, 19 Jan 2022 11:36:40 +0100\nSubject: [PATCH] [Targeting] Escape\/validate names of rules properly (#11205)\n\n* [Targeting] Escape\/validate names of rules properly\n\n* Update bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php\n\nCo-authored-by: Jacob Dreesen <j.dreesen@neusta.de>\n\nCo-authored-by: Jacob Dreesen <j.dreesen@neusta.de>\n---\n ...\/Controller\/Admin\/TargetingController.php      | 15 +++++++++++----\n 1 file changed, 11 insertions(+), 4 deletions(-)\n\ndiff --git a\/bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php b\/bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php\nindex 6da669019aa..c615c7e3811 100644\n--- a\/bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php\n+++ b\/bundles\/AdminBundle\/Controller\/Admin\/TargetingController.php\n@@ -37,6 +37,11 @@ class TargetingController extends AdminController implements KernelControllerEve\n {\n     \/\/ RULES\n \n+    private function correctName(string $name): string\n+    {\n+        return preg_replace('\/[#?*:\\\\\\\\<>|\"%&@=;+]\/', '-', $name);\n+    }\n+\n     \/**\n      * @Route(\"\/rule\/list\", name=\"pimcore_admin_targeting_rulelist\", methods={\"GET\"})\n      *\n@@ -55,7 +60,7 @@ public function ruleListAction(Request $request)\n         foreach ($list->load() as $target) {\n             $targets[] = [\n                 'id' => $target->getId(),\n-                'text' => $target->getName(),\n+                'text' => htmlspecialchars($target->getName()),\n                 'active' => $target->getActive(),\n                 'qtip' => 'ID: ' . $target->getId(),\n             ];\n@@ -74,7 +79,7 @@ public function ruleListAction(Request $request)\n     public function ruleAddAction(Request $request)\n     {\n         $target = new Targeting\\Rule();\n-        $target->setName($request->get('name'));\n+        $target->setName($this->correctName($request->get('name')));\n         $target->save();\n \n         return $this->adminJson(['success' => true, 'id' => $target->getId()]);\n@@ -129,6 +134,7 @@ public function ruleSaveAction(Request $request)\n         \/** @var Targeting\\Rule|Targeting\\Rule\\Dao $target *\/\n         $target = Targeting\\Rule::getById($request->get('id'));\n         $target->setValues($data['settings']);\n+        $target->setName($this->correctName($target->getName()));\n         $target->setConditions($data['conditions']);\n         $target->setActions($data['actions']);\n         $target->save();\n@@ -208,7 +214,7 @@ public function targetGroupListAction(Request $request)\n         foreach ($list->load() as $targetGroup) {\n             $targetGroups[] = [\n                 'id' => $targetGroup->getId(),\n-                'text' => $targetGroup->getName(),\n+                'text' => htmlspecialchars($targetGroup->getName()),\n                 'active' => $targetGroup->getActive(),\n                 'qtip' => $targetGroup->getId(),\n             ];\n@@ -230,7 +236,7 @@ public function targetGroupAddAction(Request $request, CoreCacheHandler $cache,\n     {\n         \/** @var TargetGroup|TargetGroup\\Dao $targetGroup *\/\n         $targetGroup = new TargetGroup();\n-        $targetGroup->setName($request->get('name'));\n+        $targetGroup->setName($this->correctName($request->get('name')));\n         $targetGroup->save();\n \n         $event = new TargetGroupEvent($targetGroup);\n@@ -300,6 +306,7 @@ public function targetGroupSaveAction(Request $request, CoreCacheHandler $cache,\n         \/** @var TargetGroup|TargetGroup\\Dao $targetGroup *\/\n         $targetGroup = TargetGroup::getById($request->get('id'));\n         $targetGroup->setValues($data['settings']);\n+        $targetGroup->setName($this->correctName($targetGroup->getName()));\n         $targetGroup->save();\n \n         $event = new TargetGroupEvent($targetGroup);",
      "code_diff":"@@ -37,6 +37,11 @@ class TargetingController extends AdminController implements KernelControllerEve\n {\n     \/\/ RULES\n \n+    private function correctName(string $name): string\n+    {\n+        return preg_replace('\/[#?*:\\\\\\\\<>|\"%&@=;+]\/', '-', $name);\n+    }\n+\n     \/**\n      * @Route(\"\/rule\/list\", name=\"pimcore_admin_targeting_rulelist\", methods={\"GET\"})\n      *\n@@ -55,7 +60,7 @@ public function ruleListAction(Request $request)\n         foreach ($list->load() as $target) {\n             $targets[] = [\n                 'id' => $target->getId(),\n-                'text' => $target->getName(),\n+                'text' => htmlspecialchars($target->getName()),\n                 'active' => $target->getActive(),\n                 'qtip' => 'ID: ' . $target->getId(),\n             ];\n@@ -74,7 +79,7 @@ public function ruleListAction(Request $request)\n     public function ruleAddAction(Request $request)\n     {\n         $target = new Targeting\\Rule();\n-        $target->setName($request->get('name'));\n+        $target->setName($this->correctName($request->get('name')));\n         $target->save();\n \n         return $this->adminJson(['success' => true, 'id' => $target->getId()]);\n@@ -129,6 +134,7 @@ public function ruleSaveAction(Request $request)\n         \/** @var Targeting\\Rule|Targeting\\Rule\\Dao $target *\/\n         $target = Targeting\\Rule::getById($request->get('id'));\n         $target->setValues($data['settings']);\n+        $target->setName($this->correctName($target->getName()));\n         $target->setConditions($data['conditions']);\n         $target->setActions($data['actions']);\n         $target->save();\n@@ -208,7 +214,7 @@ public function targetGroupListAction(Request $request)\n         foreach ($list->load() as $targetGroup) {\n             $targetGroups[] = [\n                 'id' => $targetGroup->getId(),\n-                'text' => $targetGroup->getName(),\n+                'text' => htmlspecialchars($targetGroup->getName()),\n                 'active' => $targetGroup->getActive(),\n                 'qtip' => $targetGroup->getId(),\n             ];\n@@ -230,7 +236,7 @@ public function targetGroupAddAction(Request $request, CoreCacheHandler $cache,\n     {\n         \/** @var TargetGroup|TargetGroup\\Dao $targetGroup *\/\n         $targetGroup = new TargetGroup();\n-        $targetGroup->setName($request->get('name'));\n+        $targetGroup->setName($this->correctName($request->get('name')));\n         $targetGroup->save();\n \n         $event = new TargetGroupEvent($targetGroup);\n@@ -300,6 +306,7 @@ public function targetGroupSaveAction(Request $request, CoreCacheHandler $cache,\n         \/** @var TargetGroup|TargetGroup\\Dao $targetGroup *\/\n         $targetGroup = TargetGroup::getById($request->get('id'));\n         $targetGroup->setValues($data['settings']);\n+        $targetGroup->setName($this->correctName($targetGroup->getName()));\n         $targetGroup->save();\n \n         $event = new TargetGroupEvent($targetGroup);"
    },
    {
      "index":110,
      "vuln_id":"GHSA-3q55-66g3-p8xq",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/89200cfcc2cfefe5554721e7fa3cf52f6a2a9120'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber File upload filter bypass leading to stored XSS in GitHub repository microweber\/microweber prior to 1.2.12.",
      "published_date":"2022-03-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/89200cfcc2cfefe5554721e7fa3cf52f6a2a9120",
      "commit_sha":"89200cfcc2cfefe5554721e7fa3cf52f6a2a9120",
      "patch":"SINGLE",
      "chain_ord":"['89200cfcc2cfefe5554721e7fa3cf52f6a2a9120']",
      "before_first_fix_commit":"{'077b1e2d5dda0c6611b65bce849a18a5620c5c98'}",
      "last_fix_commit":"89200cfcc2cfefe5554721e7fa3cf52f6a2a9120",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/11\/2022, 10:04:52",
      "message":"Update Files.php",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 254, 'deletions': 2, 'total': 256}",
      "files":"{'src\/MicroweberPackages\/Utils\/System\/Files.php': {'additions': 254, 'deletions': 2, 'changes': 256, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/89200cfcc2cfefe5554721e7fa3cf52f6a2a9120\/src%2FMicroweberPackages%2FUtils%2FSystem%2FFiles.php', 'patch': \"@@ -834,10 +834,262 @@ function get_dangerous_files_extentions()\\n             'xqt',        \/\/    SuperCalc Macro File',\\n             'xys',        \/\/    XYplorer Script File',\\n             'zl9',        \/\/    ZoneAlarm Quarantined EXE File\\n-\\n-\\n             'swf',        \/\/    Flash File\\n \\n+            'key',\\n+            'asax',\\n+            'btapp',\\n+            'xd',\\n+            'fwtemplate',\\n+            'crdownload',\\n+            'whtt',\\n+            'ssp',\\n+            'fmp',\\n+            'jspa',\\n+            'obml16',\\n+            'a5w',\\n+            'crt',\\n+            'vrt',\\n+            'website',\\n+            'p7c',\\n+            'dll',\\n+            'php',\\n+            'mjs',\\n+            'dhtml',\\n+            'xul',\\n+            'bml',\\n+            'download',\\n+            'cshtml',\\n+            'vsdisco',\\n+            'codasite',\\n+            'webbookmark',\\n+            'rjs',\\n+            'wsdl',\\n+            'dml',\\n+            'aro',\\n+            'dcr',\\n+            'shtml',\\n+            'dochtml',\\n+            'dwt',\\n+            'spc',\\n+            'a4p',\\n+            'htaccess',\\n+            'ascx',\\n+            'pac',\\n+            'p7b',\\n+            'xhtm',\\n+            'oam',\\n+            'site',\\n+            'kit',\\n+            'aspx',\\n+            'zul',\\n+            'tpl',\\n+            'htm',\\n+            'seam',\\n+            'svr',\\n+            'pem',\\n+            'url',\\n+            'dap',\\n+            'appcache',\\n+            'chm',\\n+            'wbs',\\n+            'htc',\\n+            'ewp',\\n+            'gsp',\\n+            'asr',\\n+            'der',\\n+            'master',\\n+            'stc',\\n+            'ap',\\n+            'html',\\n+            'p12',\\n+            'xpd',\\n+            'fwp',\\n+            'epibrw',\\n+            'strm',\\n+            'xss',\\n+            'node',\\n+            'disco',\\n+            'gsp',\\n+            'pro',\\n+            'rss',\\n+            'gne',\\n+            'sdb',\\n+            'compressed',\\n+            'asp',\\n+            'browser',\\n+            'php2',\\n+            'sites2',\\n+            'dothtml',\\n+            'bok',\\n+            'axd',\\n+            'nzb',\\n+            'vdw',\\n+            'obml',\\n+            'mhtml',\\n+            'ashx',\\n+            'con',\\n+            'rhtml',\\n+            'alx',\\n+            'opml',\\n+            'web',\\n+            'chat',\\n+            'csr',\\n+            'do',\\n+            'sht',\\n+            'asa',\\n+            'cha',\\n+            'h5p',\\n+            'qf',\\n+            'olp',\\n+            'hyperesources',\\n+            'sparkle',\\n+            'razor',\\n+            'php4',\\n+            'cms',\\n+            'mml',\\n+            'jnlp',\\n+            'har',\\n+            'br',\\n+            'webloc',\\n+            'srf',\\n+            'cer',\\n+            'uhtml',\\n+            'pptmhtml',\\n+            'phtml',\\n+            'xbel',\\n+            'cfm',\\n+            'fwtemplateb',\\n+            'jspx',\\n+            'jsp',\\n+            'xfdl',\\n+            'zhtml',\\n+            'stml',\\n+            'jsonl',\\n+            'maff',\\n+            'dbm',\\n+            'aex',\\n+            'crl',\\n+            'mht',\\n+            'wml',\\n+            'sass',\\n+            'xht',\\n+            'awm',\\n+            'page',\\n+            'hdml',\\n+            'webmanifest',\\n+            'itms',\\n+            'sitemap',\\n+            'shtm',\\n+            'wpp',\\n+            'jss',\\n+            'oth',\\n+            'ucf',\\n+            'prf',\\n+            'freeway',\\n+            'edge',\\n+            'iqy',\\n+            'vrml',\\n+            'mvc',\\n+            'wdgt',\\n+            'discomap',\\n+            'psp',\\n+            'hxs',\\n+            'adr',\\n+            'hype',\\n+            'csp',\\n+            'xhtml',\\n+            'webarchive',\\n+            'qbo',\\n+            'jhtml',\\n+            'svc',\\n+            'phtm',\\n+            'rw3',\\n+            'tpl',\\n+            'stl',\\n+            'wbxml',\\n+            'p7',\\n+            'ndjson',\\n+            'ognc',\\n+            'fwtb',\\n+            'muse',\\n+            'vbd',\\n+            'sites',\\n+            'rt',\\n+            'esproj',\\n+            'private',\\n+            'srl',\\n+            'zhtml',\\n+            'vbhtml', \\n+            'hypetemplate',\\n+            'obml15',\\n+            'hypesymbol',\\n+            'pub',\\n+            'ece',\\n+            'mspx',\\n+            'docmhtml',\\n+            'xws',\\n+            'wgp',\\n+            'tvpi',\\n+            'woa',\\n+            'asmx',\\n+            'xbl',\\n+            'webhistory',\\n+            'idc',\\n+            'jws',\\n+            'lbc',\\n+            'att',\\n+            'tvvi',\\n+            'zvz',\\n+            'php3',\\n+            'webarchivexml',\\n+            'widget',\\n+            'swz',\\n+            'qrm',\\n+            'bwp',\\n+            'atom',\\n+            'cdf',\\n+            'map',\\n+            'hdm',\\n+            'php5',\\n+            'rwsw',\\n+            'wgt',\\n+            'nod',\\n+            'rflw',\\n+            'htx',\\n+            'mvr',\\n+            'an',\\n+            'rwp',\\n+            'lasso',\\n+            'vlp',\\n+            'stp',\\n+            'nxg',\\n+            'faces',\\n+            'kcmsf',\\n+            'ptw',\\n+            'less',\\n+            'saveddeck',\\n+            'ccbjs',\\n+            'wn',\\n+            'ppthtml',\\n+            'jcz',\\n+            'jvs',\\n+            'rwtheme',\\n+            'jst',\\n+            'mapx',\\n+            'cpg',\\n+            'wpx',\\n+            'qbx',\\n+            'suck',\\n+            'iwdgt',\\n+            'public',\\n+            'cphd',\\n+            'moz',\\n+            'zfo',\\n+            'stm',\\n+            'fcgi',\\n+            'itpc',\\n+            'cfml'\\n         );\"}}",
      "message_norm":"update files.php",
      "language":"fr",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/Utils\/System\/Files.php'])",
      "num_files":1.0,
      "patch_content":"From 89200cfcc2cfefe5554721e7fa3cf52f6a2a9120 Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Fri, 11 Mar 2022 12:04:52 +0200\nSubject: [PATCH] Update Files.php\n\n---\n src\/MicroweberPackages\/Utils\/System\/Files.php | 256 +++++++++++++++++-\n 1 file changed, 254 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/Utils\/System\/Files.php b\/src\/MicroweberPackages\/Utils\/System\/Files.php\nindex 037f5950017..12b120ab4a8 100644\n--- a\/src\/MicroweberPackages\/Utils\/System\/Files.php\n+++ b\/src\/MicroweberPackages\/Utils\/System\/Files.php\n@@ -834,10 +834,262 @@ function get_dangerous_files_extentions()\n             'xqt',        \/\/    SuperCalc Macro File',\n             'xys',        \/\/    XYplorer Script File',\n             'zl9',        \/\/    ZoneAlarm Quarantined EXE File\n-\n-\n             'swf',        \/\/    Flash File\n \n+            'key',\n+            'asax',\n+            'btapp',\n+            'xd',\n+            'fwtemplate',\n+            'crdownload',\n+            'whtt',\n+            'ssp',\n+            'fmp',\n+            'jspa',\n+            'obml16',\n+            'a5w',\n+            'crt',\n+            'vrt',\n+            'website',\n+            'p7c',\n+            'dll',\n+            'php',\n+            'mjs',\n+            'dhtml',\n+            'xul',\n+            'bml',\n+            'download',\n+            'cshtml',\n+            'vsdisco',\n+            'codasite',\n+            'webbookmark',\n+            'rjs',\n+            'wsdl',\n+            'dml',\n+            'aro',\n+            'dcr',\n+            'shtml',\n+            'dochtml',\n+            'dwt',\n+            'spc',\n+            'a4p',\n+            'htaccess',\n+            'ascx',\n+            'pac',\n+            'p7b',\n+            'xhtm',\n+            'oam',\n+            'site',\n+            'kit',\n+            'aspx',\n+            'zul',\n+            'tpl',\n+            'htm',\n+            'seam',\n+            'svr',\n+            'pem',\n+            'url',\n+            'dap',\n+            'appcache',\n+            'chm',\n+            'wbs',\n+            'htc',\n+            'ewp',\n+            'gsp',\n+            'asr',\n+            'der',\n+            'master',\n+            'stc',\n+            'ap',\n+            'html',\n+            'p12',\n+            'xpd',\n+            'fwp',\n+            'epibrw',\n+            'strm',\n+            'xss',\n+            'node',\n+            'disco',\n+            'gsp',\n+            'pro',\n+            'rss',\n+            'gne',\n+            'sdb',\n+            'compressed',\n+            'asp',\n+            'browser',\n+            'php2',\n+            'sites2',\n+            'dothtml',\n+            'bok',\n+            'axd',\n+            'nzb',\n+            'vdw',\n+            'obml',\n+            'mhtml',\n+            'ashx',\n+            'con',\n+            'rhtml',\n+            'alx',\n+            'opml',\n+            'web',\n+            'chat',\n+            'csr',\n+            'do',\n+            'sht',\n+            'asa',\n+            'cha',\n+            'h5p',\n+            'qf',\n+            'olp',\n+            'hyperesources',\n+            'sparkle',\n+            'razor',\n+            'php4',\n+            'cms',\n+            'mml',\n+            'jnlp',\n+            'har',\n+            'br',\n+            'webloc',\n+            'srf',\n+            'cer',\n+            'uhtml',\n+            'pptmhtml',\n+            'phtml',\n+            'xbel',\n+            'cfm',\n+            'fwtemplateb',\n+            'jspx',\n+            'jsp',\n+            'xfdl',\n+            'zhtml',\n+            'stml',\n+            'jsonl',\n+            'maff',\n+            'dbm',\n+            'aex',\n+            'crl',\n+            'mht',\n+            'wml',\n+            'sass',\n+            'xht',\n+            'awm',\n+            'page',\n+            'hdml',\n+            'webmanifest',\n+            'itms',\n+            'sitemap',\n+            'shtm',\n+            'wpp',\n+            'jss',\n+            'oth',\n+            'ucf',\n+            'prf',\n+            'freeway',\n+            'edge',\n+            'iqy',\n+            'vrml',\n+            'mvc',\n+            'wdgt',\n+            'discomap',\n+            'psp',\n+            'hxs',\n+            'adr',\n+            'hype',\n+            'csp',\n+            'xhtml',\n+            'webarchive',\n+            'qbo',\n+            'jhtml',\n+            'svc',\n+            'phtm',\n+            'rw3',\n+            'tpl',\n+            'stl',\n+            'wbxml',\n+            'p7',\n+            'ndjson',\n+            'ognc',\n+            'fwtb',\n+            'muse',\n+            'vbd',\n+            'sites',\n+            'rt',\n+            'esproj',\n+            'private',\n+            'srl',\n+            'zhtml',\n+            'vbhtml', \n+            'hypetemplate',\n+            'obml15',\n+            'hypesymbol',\n+            'pub',\n+            'ece',\n+            'mspx',\n+            'docmhtml',\n+            'xws',\n+            'wgp',\n+            'tvpi',\n+            'woa',\n+            'asmx',\n+            'xbl',\n+            'webhistory',\n+            'idc',\n+            'jws',\n+            'lbc',\n+            'att',\n+            'tvvi',\n+            'zvz',\n+            'php3',\n+            'webarchivexml',\n+            'widget',\n+            'swz',\n+            'qrm',\n+            'bwp',\n+            'atom',\n+            'cdf',\n+            'map',\n+            'hdm',\n+            'php5',\n+            'rwsw',\n+            'wgt',\n+            'nod',\n+            'rflw',\n+            'htx',\n+            'mvr',\n+            'an',\n+            'rwp',\n+            'lasso',\n+            'vlp',\n+            'stp',\n+            'nxg',\n+            'faces',\n+            'kcmsf',\n+            'ptw',\n+            'less',\n+            'saveddeck',\n+            'ccbjs',\n+            'wn',\n+            'ppthtml',\n+            'jcz',\n+            'jvs',\n+            'rwtheme',\n+            'jst',\n+            'mapx',\n+            'cpg',\n+            'wpx',\n+            'qbx',\n+            'suck',\n+            'iwdgt',\n+            'public',\n+            'cphd',\n+            'moz',\n+            'zfo',\n+            'stm',\n+            'fcgi',\n+            'itpc',\n+            'cfml'\n         );",
      "code_diff":"@@ -834,10 +834,262 @@ function get_dangerous_files_extentions()\n             'xqt',        \/\/    SuperCalc Macro File',\n             'xys',        \/\/    XYplorer Script File',\n             'zl9',        \/\/    ZoneAlarm Quarantined EXE File\n-\n-\n             'swf',        \/\/    Flash File\n \n+            'key',\n+            'asax',\n+            'btapp',\n+            'xd',\n+            'fwtemplate',\n+            'crdownload',\n+            'whtt',\n+            'ssp',\n+            'fmp',\n+            'jspa',\n+            'obml16',\n+            'a5w',\n+            'crt',\n+            'vrt',\n+            'website',\n+            'p7c',\n+            'dll',\n+            'php',\n+            'mjs',\n+            'dhtml',\n+            'xul',\n+            'bml',\n+            'download',\n+            'cshtml',\n+            'vsdisco',\n+            'codasite',\n+            'webbookmark',\n+            'rjs',\n+            'wsdl',\n+            'dml',\n+            'aro',\n+            'dcr',\n+            'shtml',\n+            'dochtml',\n+            'dwt',\n+            'spc',\n+            'a4p',\n+            'htaccess',\n+            'ascx',\n+            'pac',\n+            'p7b',\n+            'xhtm',\n+            'oam',\n+            'site',\n+            'kit',\n+            'aspx',\n+            'zul',\n+            'tpl',\n+            'htm',\n+            'seam',\n+            'svr',\n+            'pem',\n+            'url',\n+            'dap',\n+            'appcache',\n+            'chm',\n+            'wbs',\n+            'htc',\n+            'ewp',\n+            'gsp',\n+            'asr',\n+            'der',\n+            'master',\n+            'stc',\n+            'ap',\n+            'html',\n+            'p12',\n+            'xpd',\n+            'fwp',\n+            'epibrw',\n+            'strm',\n+            'xss',\n+            'node',\n+            'disco',\n+            'gsp',\n+            'pro',\n+            'rss',\n+            'gne',\n+            'sdb',\n+            'compressed',\n+            'asp',\n+            'browser',\n+            'php2',\n+            'sites2',\n+            'dothtml',\n+            'bok',\n+            'axd',\n+            'nzb',\n+            'vdw',\n+            'obml',\n+            'mhtml',\n+            'ashx',\n+            'con',\n+            'rhtml',\n+            'alx',\n+            'opml',\n+            'web',\n+            'chat',\n+            'csr',\n+            'do',\n+            'sht',\n+            'asa',\n+            'cha',\n+            'h5p',\n+            'qf',\n+            'olp',\n+            'hyperesources',\n+            'sparkle',\n+            'razor',\n+            'php4',\n+            'cms',\n+            'mml',\n+            'jnlp',\n+            'har',\n+            'br',\n+            'webloc',\n+            'srf',\n+            'cer',\n+            'uhtml',\n+            'pptmhtml',\n+            'phtml',\n+            'xbel',\n+            'cfm',\n+            'fwtemplateb',\n+            'jspx',\n+            'jsp',\n+            'xfdl',\n+            'zhtml',\n+            'stml',\n+            'jsonl',\n+            'maff',\n+            'dbm',\n+            'aex',\n+            'crl',\n+            'mht',\n+            'wml',\n+            'sass',\n+            'xht',\n+            'awm',\n+            'page',\n+            'hdml',\n+            'webmanifest',\n+            'itms',\n+            'sitemap',\n+            'shtm',\n+            'wpp',\n+            'jss',\n+            'oth',\n+            'ucf',\n+            'prf',\n+            'freeway',\n+            'edge',\n+            'iqy',\n+            'vrml',\n+            'mvc',\n+            'wdgt',\n+            'discomap',\n+            'psp',\n+            'hxs',\n+            'adr',\n+            'hype',\n+            'csp',\n+            'xhtml',\n+            'webarchive',\n+            'qbo',\n+            'jhtml',\n+            'svc',\n+            'phtm',\n+            'rw3',\n+            'tpl',\n+            'stl',\n+            'wbxml',\n+            'p7',\n+            'ndjson',\n+            'ognc',\n+            'fwtb',\n+            'muse',\n+            'vbd',\n+            'sites',\n+            'rt',\n+            'esproj',\n+            'private',\n+            'srl',\n+            'zhtml',\n+            'vbhtml', \n+            'hypetemplate',\n+            'obml15',\n+            'hypesymbol',\n+            'pub',\n+            'ece',\n+            'mspx',\n+            'docmhtml',\n+            'xws',\n+            'wgp',\n+            'tvpi',\n+            'woa',\n+            'asmx',\n+            'xbl',\n+            'webhistory',\n+            'idc',\n+            'jws',\n+            'lbc',\n+            'att',\n+            'tvvi',\n+            'zvz',\n+            'php3',\n+            'webarchivexml',\n+            'widget',\n+            'swz',\n+            'qrm',\n+            'bwp',\n+            'atom',\n+            'cdf',\n+            'map',\n+            'hdm',\n+            'php5',\n+            'rwsw',\n+            'wgt',\n+            'nod',\n+            'rflw',\n+            'htx',\n+            'mvr',\n+            'an',\n+            'rwp',\n+            'lasso',\n+            'vlp',\n+            'stp',\n+            'nxg',\n+            'faces',\n+            'kcmsf',\n+            'ptw',\n+            'less',\n+            'saveddeck',\n+            'ccbjs',\n+            'wn',\n+            'ppthtml',\n+            'jcz',\n+            'jvs',\n+            'rwtheme',\n+            'jst',\n+            'mapx',\n+            'cpg',\n+            'wpx',\n+            'qbx',\n+            'suck',\n+            'iwdgt',\n+            'public',\n+            'cphd',\n+            'moz',\n+            'zfo',\n+            'stm',\n+            'fcgi',\n+            'itpc',\n+            'cfml'\n         );"
    },
    {
      "index":111,
      "vuln_id":"GHSA-q73m-3q7r-fpf7",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/d1c9ed0d77ea5d56f09be0c492361dca8af745bb'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc prior to 2.10.4 is vulnerable to stored cross-site scripting via file upload.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/d1c9ed0d77ea5d56f09be0c492361dca8af745bb",
      "commit_sha":"d1c9ed0d77ea5d56f09be0c492361dca8af745bb",
      "patch":"SINGLE",
      "chain_ord":"['d1c9ed0d77ea5d56f09be0c492361dca8af745bb']",
      "before_first_fix_commit":"{'56e450c3adf75c707500d7231a78c9fc894c7f13', 'aa41c83e0cc5079fb39e04d9f630571ffb8bbf22'}",
      "last_fix_commit":"d1c9ed0d77ea5d56f09be0c492361dca8af745bb",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 12:29:34",
      "message":"Merge pull request #1632 from ajaysenr\/master\n\nUpdate AttachmentModel.class.php",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/d1c9ed0d77ea5d56f09be0c492361dca8af745bb\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': \"@@ -325,7 +325,7 @@ public function isAllowedFilename($filename){\\n \\t\\t$allow_array = array(\\n \\t\\t\\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\\n \\t\\t\\t'.mp3','.wav','.m4a','.ogg','.webma','.mp4','.flv',\\n-\\t\\t\\t'.mov','.webmv','.m3u8a','.flac','.mkv',\\n+\\t\\t\\t'.mov','.webmv','.flac','.mkv',\\n \\t\\t\\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\\n \\t\\t\\t'.pdf','.ofd','.swf','.epub','.xps',\\n \\t\\t\\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps','.wpt',\"}}",
      "message_norm":"merge pull request #1632 from ajaysenr\/master\n\nupdate attachmentmodel.class.php",
      "language":"en",
      "entities":"[('#1632', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From aa41c83e0cc5079fb39e04d9f630571ffb8bbf22 Mon Sep 17 00:00:00 2001\nFrom: Ajaysen R <40132420+ajaysenr@users.noreply.github.com>\nDate: Mon, 14 Mar 2022 12:24:33 +0000\nSubject: [PATCH] Update AttachmentModel.class.php\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 3ce94ceaf..ac9666c1f 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -325,7 +325,7 @@ public function isAllowedFilename($filename){\n \t\t$allow_array = array(\n \t\t\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\n \t\t\t'.mp3','.wav','.m4a','.ogg','.webma','.mp4','.flv',\n-\t\t\t'.mov','.webmv','.m3u8a','.flac','.mkv',\n+\t\t\t'.mov','.webmv','.flac','.mkv',\n \t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\n \t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n \t\t\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps','.wpt',",
      "code_diff":"@@ -325,7 +325,7 @@ public function isAllowedFilename($filename){\n \t\t$allow_array = array(\n \t\t\t'.jpg','.jpeg','.png','.bmp','.gif','.ico','.webp',\n \t\t\t'.mp3','.wav','.m4a','.ogg','.webma','.mp4','.flv',\n-\t\t\t'.mov','.webmv','.m3u8a','.flac','.mkv',\n+\t\t\t'.mov','.webmv','.flac','.mkv',\n \t\t\t'.zip','.tar','.gz','.tgz','.ipa','.apk','.rar','.iso','.bz2','.epub',\n \t\t\t'.pdf','.ofd','.swf','.epub','.xps',\n \t\t\t'.doc','.docx','.odt','.rtf','.docm','.dotm','.dot','.dotx','.wps','.wpt',"
    },
    {
      "index":112,
      "vuln_id":"GHSA-vmhh-xh3g-j992",
      "cwe_id":"{'CWE-80', 'CWE-79', 'CWE-116'}",
      "score":7.4,
      "chain":"{'https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/bd935320bee3c27cf7548351b1d0f935f116d437'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in the Flamingo theme manager ### Impact\nWe found a possible XSS vector in the `FlamingoThemesCode.WebHomeSheet` wiki page related to the \"newThemeName\" form field.\n\n### Patches\n\nThe issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, 13.10.3.\n\n### Workarounds\nThe easiest workaround is to edit the wiki page `FlamingoThemesCode.WebHomeSheet` (with wiki editor) and change the line\n\n```\n<input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$request.newThemeName\" \/>\n```\n\ninto\n\n```\n<input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$escapetool.xml($request.newThemeName)\" \/>\n```\n\n### References\n  * https:\/\/jira.xwiki.org\/browse\/XWIKI-19294\n  * https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/bd935320bee3c27cf7548351b1d0f935f116d437\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira XWiki](https:\/\/jira.xwiki.org)\n* Email us at [security mailing list](mailto:security@xwiki.org)",
      "published_date":"2022-05-25",
      "chain_len":1,
      "project":"https:\/\/github.com\/xwiki\/xwiki-platform",
      "commit_href":"https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/bd935320bee3c27cf7548351b1d0f935f116d437",
      "commit_sha":"bd935320bee3c27cf7548351b1d0f935f116d437",
      "patch":"SINGLE",
      "chain_ord":"['bd935320bee3c27cf7548351b1d0f935f116d437']",
      "before_first_fix_commit":"{'21906acb5ee2304552f56f9bbdbf8e7d368f7f3a'}",
      "last_fix_commit":"bd935320bee3c27cf7548351b1d0f935f116d437",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/04\/2022, 10:34:49",
      "message":"XWIKI-19294: Fix bad escaping",
      "author":"Thomas Mortagne",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'xwiki-platform-core\/xwiki-platform-flamingo\/xwiki-platform-flamingo-theme\/xwiki-platform-flamingo-theme-ui\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/xwiki\/xwiki-platform\/raw\/bd935320bee3c27cf7548351b1d0f935f116d437\/xwiki-platform-core%2Fxwiki-platform-flamingo%2Fxwiki-platform-flamingo-theme%2Fxwiki-platform-flamingo-theme-ui%2Fsrc%2Fmain%2Fresources%2FFlamingoThemesCode%2FWebHomeSheet.xml', 'patch': '@@ -287,7 +287,7 @@\\n       &lt;form action=\"$doc.getURL()\" method=\"post\"&gt;\\n         &lt;input type=\"hidden\" name=\"form_token\" value=\"$services.csrf.token\" \/&gt;\\n         &lt;input type=\"hidden\" name=\"action\" value=\"create\"\/&gt;\\n-        &lt;input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$request.newThemeName\" \/&gt;\\n+        &lt;input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$escapetool.xml($request.newThemeName)\" \/&gt;\\n         &lt;input type=\"submit\" value=\"$services.localization.render(\\'platform.flamingo.themes.home.create.confirm\\')\" class=\"button\"\/&gt;\\n       &lt;\/form&gt;\\n     {{\/html}}'}}",
      "message_norm":"xwiki-19294: fix bad escaping",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('escaping', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['xwiki-platform-core\/xwiki-platform-flamingo\/xwiki-platform-flamingo-theme\/xwiki-platform-flamingo-theme-ui\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml'])",
      "num_files":1.0,
      "patch_content":"From bd935320bee3c27cf7548351b1d0f935f116d437 Mon Sep 17 00:00:00 2001\nFrom: Thomas Mortagne <thomas.mortagne@gmail.com>\nDate: Tue, 4 Jan 2022 11:34:49 +0100\nSubject: [PATCH] XWIKI-19294: Fix bad escaping\n\n---\n ...\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml      | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/xwiki-platform-core\/xwiki-platform-flamingo\/xwiki-platform-flamingo-theme\/xwiki-platform-flamingo-theme-ui\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml b\/xwiki-platform-core\/xwiki-platform-flamingo\/xwiki-platform-flamingo-theme\/xwiki-platform-flamingo-theme-ui\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml\nindex a71814ef07ef..4fba502601ab 100644\n--- a\/xwiki-platform-core\/xwiki-platform-flamingo\/xwiki-platform-flamingo-theme\/xwiki-platform-flamingo-theme-ui\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml\n+++ b\/xwiki-platform-core\/xwiki-platform-flamingo\/xwiki-platform-flamingo-theme\/xwiki-platform-flamingo-theme-ui\/src\/main\/resources\/FlamingoThemesCode\/WebHomeSheet.xml\n@@ -287,7 +287,7 @@\n       &lt;form action=\"$doc.getURL()\" method=\"post\"&gt;\n         &lt;input type=\"hidden\" name=\"form_token\" value=\"$services.csrf.token\" \/&gt;\n         &lt;input type=\"hidden\" name=\"action\" value=\"create\"\/&gt;\n-        &lt;input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$request.newThemeName\" \/&gt;\n+        &lt;input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$escapetool.xml($request.newThemeName)\" \/&gt;\n         &lt;input type=\"submit\" value=\"$services.localization.render('platform.flamingo.themes.home.create.confirm')\" class=\"button\"\/&gt;\n       &lt;\/form&gt;\n     {{\/html}}",
      "code_diff":"@@ -287,7 +287,7 @@\n       &lt;form action=\"$doc.getURL()\" method=\"post\"&gt;\n         &lt;input type=\"hidden\" name=\"form_token\" value=\"$services.csrf.token\" \/&gt;\n         &lt;input type=\"hidden\" name=\"action\" value=\"create\"\/&gt;\n-        &lt;input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$request.newThemeName\" \/&gt;\n+        &lt;input type=\"hidden\" name=\"newThemeName\" id=\"newThemeName\" value=\"$escapetool.xml($request.newThemeName)\" \/&gt;\n         &lt;input type=\"submit\" value=\"$services.localization.render('platform.flamingo.themes.home.create.confirm')\" class=\"button\"\/&gt;\n       &lt;\/form&gt;\n     {{\/html}}"
    },
    {
      "index":113,
      "vuln_id":"GHSA-c558-5gfm-p2r8",
      "cwe_id":"{'CWE-79'}",
      "score":7.1,
      "chain":"{'https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a'}",
      "dataset":"osv",
      "summary":"JSPUI spellcheck and autocomplete tools vulnerable to Cross Site Scripting ### Impact\nThe JSPUI spellcheck \"Did you mean\" HTML escapes the data-spell attribute in the link, but not the actual displayed text.  Similarly, the JSPUI autocomplete HTML does not properly escape text passed to it. Both are vulnerable to XSS.  This vulnerability only impacts the JSPUI.\n\n_This vulnerability does NOT impact the XMLUI or 7.x._\n\n### Patches\n_DSpace 6.x:_\n* Fixed in 6.4 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7\n* 6.x patch files available (may be applied manually if an immediate upgrade to 6.4 or above is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7.patch\n\n_DSpace 5.x:_\n* Fixed in 5.11 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5\n* 5.x patch files available (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5.patch\n\n#### Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:\n1. Download the appropriate patch file to the machine where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This will copy all updated WARs \/ configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n    3. Restart Tomcat\n\n### References\nDiscovered & reported by Hassan Bhuiyan (Brunel University London)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@dspace.org",
      "published_date":"2022-08-06",
      "chain_len":4,
      "project":"https:\/\/github.com\/DSpace\/DSpace",
      "commit_href":"https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a",
      "commit_sha":"c89e493e517b424dea6175caba54e91d3847fc3a",
      "patch":"MULTI",
      "chain_ord":"['ebb83a75234d3de9be129464013e998dc929b68d', '35030a23e48b5946f5853332c797e1c4adea7bb7', 'c89e493e517b424dea6175caba54e91d3847fc3a', '6f75bb084ab1937d094208c55cd84340040bcbb5']",
      "before_first_fix_commit":"{'d1dd7d23329ef055069759df15cfa200c8e32e54'}",
      "last_fix_commit":"6f75bb084ab1937d094208c55cd84340040bcbb5",
      "chain_ord_pos":3.0,
      "commit_datetime":"07\/26\/2022, 04:25:18",
      "message":"[DS-4453] Escape spellcheck, autocomplete HTML (JSPUI)",
      "author":"Kim Shepherd",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DSpace\/DSpace\/raw\/c89e493e517b424dea6175caba54e91d3847fc3a\/dspace-jspui%2Fsrc%2Fmain%2Fwebapp%2Fsearch%2Fdiscovery.jsp', 'patch': '@@ -196,7 +196,7 @@\\n                                 <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\\n                                 <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\\n-\\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\\n+\\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%=Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\\n <% } %>                  \\n                                 <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\\n                                 <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>'}}",
      "message_norm":"[ds-4453] escape spellcheck, autocomplete html (jspui)",
      "language":"fr",
      "entities":"[('escape', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp'])",
      "num_files":1.0,
      "patch_content":"From c89e493e517b424dea6175caba54e91d3847fc3a Mon Sep 17 00:00:00 2001\nFrom: Kim Shepherd <kim@shepherd.nz>\nDate: Tue, 26 Jul 2022 16:25:18 +1200\nSubject: [PATCH] [DS-4453] Escape spellcheck, autocomplete HTML (JSPUI)\n\n---\n dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\nindex fe0a64908dd1..ec97afb90fc7 100644\n--- a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n+++ b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n@@ -196,7 +196,7 @@\n                                 <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\n                                 <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\n-\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\n+\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%=Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\n <% } %>                  \n                                 <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\n                                 <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>",
      "code_diff":"@@ -196,7 +196,7 @@\n                                 <input type=\"text\" size=\"50\" id=\"query\" name=\"query\" value=\"<%= (query==null ? \"\" : Utils.addEntities(query)) %>\"\/>\n                                 <input type=\"submit\" id=\"main-query-submit\" class=\"btn btn-primary\" value=\"<fmt:message key=\"jsp.general.go\"\/>\" \/>\n <% if (StringUtils.isNotBlank(spellCheckQuery)) {%>\n-\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%= spellCheckQuery %><\/a><\/fmt:param><\/fmt:message><\/p>\n+\t<p class=\"lead\"><fmt:message key=\"jsp.search.didyoumean\"><fmt:param><a id=\"spellCheckQuery\" data-spell=\"<%= Utils.addEntities(spellCheckQuery) %>\" href=\"#\"><%=Utils.addEntities(spellCheckQuery) %><\/a><\/fmt:param><\/fmt:message><\/p>\n <% } %>                  \n                                 <input type=\"hidden\" value=\"<%= rpp %>\" name=\"rpp\" \/>\n                                 <input type=\"hidden\" value=\"<%= Utils.addEntities(sortedBy) %>\" name=\"sort_by\" \/>"
    },
    {
      "index":114,
      "vuln_id":"GHSA-gq77-3r6x-383w",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/818d7fe731f452acccacf731ce47ec27ad68049c'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc version 2.10.3 and prior is vulnerable to stored cross-site scripting. A patch is available and anticipated to be part of version 2.10.4.",
      "published_date":"2022-03-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/818d7fe731f452acccacf731ce47ec27ad68049c",
      "commit_sha":"818d7fe731f452acccacf731ce47ec27ad68049c",
      "patch":"SINGLE",
      "chain_ord":"['818d7fe731f452acccacf731ce47ec27ad68049c']",
      "before_first_fix_commit":"{'85af5ab5a375ce16f991e2acb15466be4b3ba44b'}",
      "last_fix_commit":"818d7fe731f452acccacf731ce47ec27ad68049c",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/08\/2022, 03:48:44",
      "message":"file upload bug",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/818d7fe731f452acccacf731ce47ec27ad68049c\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -301,6 +301,7 @@ public function isDangerFilename($filename){\\n \\t\\t\\t|| $isDangerStr($filename , \".svg\")\\n \\t\\t\\t|| $isDangerStr($filename , \".htm\")\\n \\t\\t\\t|| $isDangerStr($filename , \"%\")\\n+\\t\\t\\t|| $isDangerStr($filename , \".xml\")\\n \\t\\t) {\\n \\t\\t\\treturn true;\\n \\t\\t}'}}",
      "message_norm":"file upload bug",
      "language":"ro",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From 818d7fe731f452acccacf731ce47ec27ad68049c Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Tue, 8 Mar 2022 11:48:44 +0800\nSubject: [PATCH] file upload bug\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 3d76105b8..d84898984 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -301,6 +301,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".svg\")\n \t\t\t|| $isDangerStr($filename , \".htm\")\n \t\t\t|| $isDangerStr($filename , \"%\")\n+\t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t) {\n \t\t\treturn true;\n \t\t}",
      "code_diff":"@@ -301,6 +301,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".svg\")\n \t\t\t|| $isDangerStr($filename , \".htm\")\n \t\t\t|| $isDangerStr($filename , \"%\")\n+\t\t\t|| $isDangerStr($filename , \".xml\")\n \t\t) {\n \t\t\treturn true;\n \t\t}"
    },
    {
      "index":115,
      "vuln_id":"GHSA-6346-5r4h-ff5x",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/724e2d186a33c0c27273107dc4f160a09384877f'}",
      "dataset":"osv",
      "summary":"Microweber vulnerable to cross-site scripting (XSS) Microweber is a drag and drop website builder and a powerful next generation CMS. Microweber versions 1.2.15 and prior are vulnerable to cross-site scripting. This could lead to injection of arbitrary JaveScript code, defacement of a page, or stealing cookies. A patch is available on the `master` branch of Microweber's GitHub repository.",
      "published_date":"2022-05-05",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/724e2d186a33c0c27273107dc4f160a09384877f",
      "commit_sha":"724e2d186a33c0c27273107dc4f160a09384877f",
      "patch":"SINGLE",
      "chain_ord":"['724e2d186a33c0c27273107dc4f160a09384877f']",
      "before_first_fix_commit":"{'5eb846301d61b22eda84a997026d050a14a518f4'}",
      "last_fix_commit":"724e2d186a33c0c27273107dc4f160a09384877f",
      "chain_ord_pos":1.0,
      "commit_datetime":"05\/03\/2022, 08:41:32",
      "message":"Update order_filtering.blade.php",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'src\/MicroweberPackages\/Order\/resources\/views\/admin\/orders\/partials\/order_filtering.blade.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/724e2d186a33c0c27273107dc4f160a09384877f\/src%2FMicroweberPackages%2FOrder%2Fresources%2Fviews%2Fadmin%2Forders%2Fpartials%2Forder_filtering.blade.php', 'patch': '@@ -158,7 +158,7 @@ class=\"btn btn-link btn-sm <?php if (isset($abandoned)): ?>font-weight-bold text\\n             $(document).ready(function () {\\n                 var searchOrdersByProduct = new mw.autoComplete({\\n                     element: \"#js-orders-search-by-products\",\\n-                    placeholder: \"<?php if ($productKeyword) { echo $productKeyword; } else { _e(\"Search by products...\"); }?>\",\\n+                    placeholder: \"<?php if ($productKeyword) { echo xss_clean($productKeyword); } else { _e(\"Search by products...\"); }?>\",\\n                     autoComplete:true,\\n                     ajaxConfig: {\\n                         method: \\'get\\','}}",
      "message_norm":"update order_filtering.blade.php",
      "language":"da",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/Order\/resources\/views\/admin\/orders\/partials\/order_filtering.blade.php'])",
      "num_files":1.0,
      "patch_content":"From 724e2d186a33c0c27273107dc4f160a09384877f Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Tue, 3 May 2022 11:41:32 +0300\nSubject: [PATCH] Update order_filtering.blade.php\n\n---\n ...\/views\/admin\/orders\/partials\/order_filtering.blade.php       | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/MicroweberPackages\/Order\/resources\/views\/admin\/orders\/partials\/order_filtering.blade.php b\/src\/MicroweberPackages\/Order\/resources\/views\/admin\/orders\/partials\/order_filtering.blade.php\nindex 418a4429a5b..ce243b216bd 100644\n--- a\/src\/MicroweberPackages\/Order\/resources\/views\/admin\/orders\/partials\/order_filtering.blade.php\n+++ b\/src\/MicroweberPackages\/Order\/resources\/views\/admin\/orders\/partials\/order_filtering.blade.php\n@@ -158,7 +158,7 @@ class=\"btn btn-link btn-sm <?php if (isset($abandoned)): ?>font-weight-bold text\n             $(document).ready(function () {\n                 var searchOrdersByProduct = new mw.autoComplete({\n                     element: \"#js-orders-search-by-products\",\n-                    placeholder: \"<?php if ($productKeyword) { echo $productKeyword; } else { _e(\"Search by products...\"); }?>\",\n+                    placeholder: \"<?php if ($productKeyword) { echo xss_clean($productKeyword); } else { _e(\"Search by products...\"); }?>\",\n                     autoComplete:true,\n                     ajaxConfig: {\n                         method: 'get',",
      "code_diff":"@@ -158,7 +158,7 @@ class=\"btn btn-link btn-sm <?php if (isset($abandoned)): ?>font-weight-bold text\n             $(document).ready(function () {\n                 var searchOrdersByProduct = new mw.autoComplete({\n                     element: \"#js-orders-search-by-products\",\n-                    placeholder: \"<?php if ($productKeyword) { echo $productKeyword; } else { _e(\"Search by products...\"); }?>\",\n+                    placeholder: \"<?php if ($productKeyword) { echo xss_clean($productKeyword); } else { _e(\"Search by products...\"); }?>\",\n                     autoComplete:true,\n                     ajaxConfig: {\n                         method: 'get',"
    },
    {
      "index":116,
      "vuln_id":"GHSA-6jp6-9rf9-gc66",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/9e19a8414337692cc90da2a91c9af5420f2952f1', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/f6753a1a1c63fade6ad418fbda827c6750ab0bda', 'https:\/\/github.com\/WeblateOrg\/weblate\/commit\/22d577b1f1e88665a88b4569380148030e0f8389'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Weblate ### Impact\nDue to improper neutralization, it was possible to perform cross-site scripting via crafted user and language names.\n\n### Patches\n\nThe issues were fixed in the 4.11 release. The following commits are addressing it:\n\n* f6753a1a1c63fade6ad418fbda827c6750ab0bda\n* 9e19a8414337692cc90da2a91c9af5420f2952f1\n* 22d577b1f1e88665a88b4569380148030e0f8389\n\n### Workarounds\n\nYou can look for crafted user and language names to see if you were affected.\n\n### References\n* https:\/\/hackerone.com\/reports\/1486674\n* https:\/\/hackerone.com\/reports\/1486718\n* https:\/\/hackerone.com\/reports\/1485226\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open a topic in [discussions](https:\/\/github.com\/WeblateOrg\/weblate\/discussions)\n* Email us at [care@weblate.org](mailto:care@weblate.org)",
      "published_date":"2022-02-25",
      "chain_len":3,
      "project":"https:\/\/github.com\/WeblateOrg\/weblate",
      "commit_href":"https:\/\/github.com\/WeblateOrg\/weblate\/commit\/f6753a1a1c63fade6ad418fbda827c6750ab0bda",
      "commit_sha":"f6753a1a1c63fade6ad418fbda827c6750ab0bda",
      "patch":"MULTI",
      "chain_ord":"['22d577b1f1e88665a88b4569380148030e0f8389', '9e19a8414337692cc90da2a91c9af5420f2952f1', 'f6753a1a1c63fade6ad418fbda827c6750ab0bda']",
      "before_first_fix_commit":"{'572628cef60e9d839b79b2087960b606a5cca4d8'}",
      "last_fix_commit":"f6753a1a1c63fade6ad418fbda827c6750ab0bda",
      "chain_ord_pos":3.0,
      "commit_datetime":"02\/22\/2022, 20:10:41",
      "message":"translate: Add missing escaping to language name\n\nFixes https:\/\/hackerone.com\/reports\/1486674",
      "author":"Michal \u010ciha\u0159",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
      "files":"{'weblate\/trans\/forms.py': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/WeblateOrg\/weblate\/raw\/f6753a1a1c63fade6ad418fbda827c6750ab0bda\/weblate%2Ftrans%2Fforms.py', 'patch': '@@ -37,6 +37,7 @@\\n from django.template.loader import render_to_string\\n from django.urls import reverse\\n from django.utils import timezone\\n+from django.utils.html import escape\\n from django.utils.http import urlencode\\n from django.utils.safestring import mark_safe\\n from django.utils.translation import gettext\\n@@ -318,7 +319,7 @@ def render(self, name, value, attrs=None, renderer=None, **kwargs):\\n             # Render textare\\n             textarea = super().render(fieldname, val, attrs, renderer, **kwargs)\\n             # Label for plural\\n-            label = str(unit.translation.language)\\n+            label = escape(unit.translation.language)\\n             if len(values) != 1:\\n                 label = f\"{label}, {plural.get_plural_label(idx)}\"\\n             ret.append('}}",
      "message_norm":"translate: add missing escaping to language name\n\nfixes https:\/\/hackerone.com\/reports\/1486674",
      "language":"en",
      "entities":"[('add', 'ACTION', ''), ('escaping', 'SECWORD', ''), ('fixes', 'ACTION', ''), ('https:\/\/hackerone.com\/reports\/1486674', 'URL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['weblate\/trans\/forms.py'])",
      "num_files":1.0,
      "patch_content":"From f6753a1a1c63fade6ad418fbda827c6750ab0bda Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Michal=20=C4=8Ciha=C5=99?= <michal@cihar.com>\nDate: Tue, 22 Feb 2022 21:10:41 +0100\nSubject: [PATCH] translate: Add missing escaping to language name\n\nFixes https:\/\/hackerone.com\/reports\/1486674\n---\n weblate\/trans\/forms.py | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/weblate\/trans\/forms.py b\/weblate\/trans\/forms.py\nindex 242ca7f62b60..c9f02a8f6dd6 100644\n--- a\/weblate\/trans\/forms.py\n+++ b\/weblate\/trans\/forms.py\n@@ -37,6 +37,7 @@\n from django.template.loader import render_to_string\n from django.urls import reverse\n from django.utils import timezone\n+from django.utils.html import escape\n from django.utils.http import urlencode\n from django.utils.safestring import mark_safe\n from django.utils.translation import gettext\n@@ -318,7 +319,7 @@ def render(self, name, value, attrs=None, renderer=None, **kwargs):\n             # Render textare\n             textarea = super().render(fieldname, val, attrs, renderer, **kwargs)\n             # Label for plural\n-            label = str(unit.translation.language)\n+            label = escape(unit.translation.language)\n             if len(values) != 1:\n                 label = f\"{label}, {plural.get_plural_label(idx)}\"\n             ret.append(",
      "code_diff":"@@ -37,6 +37,7 @@\n from django.template.loader import render_to_string\n from django.urls import reverse\n from django.utils import timezone\n+from django.utils.html import escape\n from django.utils.http import urlencode\n from django.utils.safestring import mark_safe\n from django.utils.translation import gettext\n@@ -318,7 +319,7 @@ def render(self, name, value, attrs=None, renderer=None, **kwargs):\n             # Render textare\n             textarea = super().render(fieldname, val, attrs, renderer, **kwargs)\n             # Label for plural\n-            label = str(unit.translation.language)\n+            label = escape(unit.translation.language)\n             if len(values) != 1:\n                 label = f\"{label}, {plural.get_plural_label(idx)}\"\n             ret.append("
    },
    {
      "index":117,
      "vuln_id":"GHSA-3x96-m42v-hvh5",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/c51285f791e48e536111cd57a9544ccbf7f33961'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Microweber Cross-site Scripting (XSS) - Reflected in GitHub repository microweber\/microweber prior to 1.2.18.",
      "published_date":"2022-06-23",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/c51285f791e48e536111cd57a9544ccbf7f33961",
      "commit_sha":"c51285f791e48e536111cd57a9544ccbf7f33961",
      "patch":"SINGLE",
      "chain_ord":"['c51285f791e48e536111cd57a9544ccbf7f33961']",
      "before_first_fix_commit":"{'10550ec85018bb0f581edd0ac2aed0d7bc9fe6b1'}",
      "last_fix_commit":"c51285f791e48e536111cd57a9544ccbf7f33961",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/22\/2022, 11:56:16",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 9, 'deletions': 3, 'total': 12}",
      "files":"{'userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php': {'additions': 9, 'deletions': 3, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/c51285f791e48e536111cd57a9544ccbf7f33961\/userfiles%2Fmodules%2Fmicroweber%2Ftoolbar%2Feditor_tools%2Fmodule_settings%2Findex.php', 'patch': '@@ -87,11 +87,13 @@\\n     if (isset($_GET[\\'autosize\\'])) {\\n         $autoSize = $_GET[\\'autosize\\'];\\n     }\\n+    $autoSize = xss_clean($autoSize);\\n \\n     $type = \\'\\';\\n     if (isset($_GET[\\'type\\'])) {\\n         $type = $_GET[\\'type\\'];\\n     }\\n+    $type = xss_clean($type);\\n \\n     $mod_id = $mod_orig_id = false;\\n     $is_linked_mod = false;\\n@@ -403,7 +405,9 @@\\n                 if (mw.notification) {\\n                     mw.notification.success(\\'<?php _ejs(\\'Settings are saved\\') ?>\\');\\n                 }\\n+                <?php if (isset($params[\\'id\\'])) : ?>\\n                 mw.reload_module_parent(\\'#<?php print $params[\\'id\\']  ?>\\')\\n+                <?php endif; ?>\\n \\n             });\\n \\n@@ -440,9 +444,11 @@\\n <body class=\"mw-external-loading loading\">\\n <div id=\"settings-main\">\\n     <div id=\"settings-container\">\\n-        <div class=\"mw-module-live-edit-settings <?php print $params[\\'id\\'] ?>\"\\n-             id=\"module-id-<?php print $params[\\'id\\'] ?>\">{content}\\n-        <\/div>\\n+        <?php if (isset($params[\\'id\\'])) : ?>\\n+            <div class=\"mw-module-live-edit-settings <?php print $params[\\'id\\'] ?>\"\\n+                 id=\"module-id-<?php print $params[\\'id\\'] ?>\">{content}\\n+            <\/div>\\n+        <?php endif; ?>\\n     <\/div>\\n <\/div>'}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php'])",
      "num_files":1.0,
      "patch_content":"From c51285f791e48e536111cd57a9544ccbf7f33961 Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Wed, 22 Jun 2022 14:56:16 +0300\nSubject: [PATCH] update\n\n---\n ...\/toolbar\/editor_tools\/module_settings\/index.php   | 12 +++++++++---\n 1 file changed, 9 insertions(+), 3 deletions(-)\n\ndiff --git a\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php b\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php\nindex 1380f7a3120..a6bc6821ccd 100644\n--- a\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php\n+++ b\/userfiles\/modules\/microweber\/toolbar\/editor_tools\/module_settings\/index.php\n@@ -87,11 +87,13 @@\n     if (isset($_GET['autosize'])) {\n         $autoSize = $_GET['autosize'];\n     }\n+    $autoSize = xss_clean($autoSize);\n \n     $type = '';\n     if (isset($_GET['type'])) {\n         $type = $_GET['type'];\n     }\n+    $type = xss_clean($type);\n \n     $mod_id = $mod_orig_id = false;\n     $is_linked_mod = false;\n@@ -403,7 +405,9 @@\n                 if (mw.notification) {\n                     mw.notification.success('<?php _ejs('Settings are saved') ?>');\n                 }\n+                <?php if (isset($params['id'])) : ?>\n                 mw.reload_module_parent('#<?php print $params['id']  ?>')\n+                <?php endif; ?>\n \n             });\n \n@@ -440,9 +444,11 @@\n <body class=\"mw-external-loading loading\">\n <div id=\"settings-main\">\n     <div id=\"settings-container\">\n-        <div class=\"mw-module-live-edit-settings <?php print $params['id'] ?>\"\n-             id=\"module-id-<?php print $params['id'] ?>\">{content}\n-        <\/div>\n+        <?php if (isset($params['id'])) : ?>\n+            <div class=\"mw-module-live-edit-settings <?php print $params['id'] ?>\"\n+                 id=\"module-id-<?php print $params['id'] ?>\">{content}\n+            <\/div>\n+        <?php endif; ?>\n     <\/div>\n <\/div>",
      "code_diff":"@@ -87,11 +87,13 @@\n     if (isset($_GET['autosize'])) {\n         $autoSize = $_GET['autosize'];\n     }\n+    $autoSize = xss_clean($autoSize);\n \n     $type = '';\n     if (isset($_GET['type'])) {\n         $type = $_GET['type'];\n     }\n+    $type = xss_clean($type);\n \n     $mod_id = $mod_orig_id = false;\n     $is_linked_mod = false;\n@@ -403,7 +405,9 @@\n                 if (mw.notification) {\n                     mw.notification.success('<?php _ejs('Settings are saved') ?>');\n                 }\n+                <?php if (isset($params['id'])) : ?>\n                 mw.reload_module_parent('#<?php print $params['id']  ?>')\n+                <?php endif; ?>\n \n             });\n \n@@ -440,9 +444,11 @@\n <body class=\"mw-external-loading loading\">\n <div id=\"settings-main\">\n     <div id=\"settings-container\">\n-        <div class=\"mw-module-live-edit-settings <?php print $params['id'] ?>\"\n-             id=\"module-id-<?php print $params['id'] ?>\">{content}\n-        <\/div>\n+        <?php if (isset($params['id'])) : ?>\n+            <div class=\"mw-module-live-edit-settings <?php print $params['id'] ?>\"\n+                 id=\"module-id-<?php print $params['id'] ?>\">{content}\n+            <\/div>\n+        <?php endif; ?>\n     <\/div>\n <\/div>"
    },
    {
      "index":118,
      "vuln_id":"GHSA-cqhr-jqvc-qw9p",
      "cwe_id":"{'CWE-79'}",
      "score":10.0,
      "chain":"{'https:\/\/github.com\/javamelody\/javamelody\/commit\/e0497c1980acebd257d3da78dfde29ae9bdffdf6'}",
      "dataset":"osv",
      "summary":"Java Melody vulnerable to cross-site scripting JavaMelody is a monitoring tool for JavaEE applications. Versions prior to 1.61.0 are vulnerable to a cross-site scripting (XSS) attack. This issue was patched in version 1.61.0, and users are recommended to upgrade to the latest version. There are no known workarounds.",
      "published_date":"2022-07-20",
      "chain_len":1,
      "project":"https:\/\/github.com\/javamelody\/javamelody",
      "commit_href":"https:\/\/github.com\/javamelody\/javamelody\/commit\/e0497c1980acebd257d3da78dfde29ae9bdffdf6",
      "commit_sha":"e0497c1980acebd257d3da78dfde29ae9bdffdf6",
      "patch":"SINGLE",
      "chain_ord":"['e0497c1980acebd257d3da78dfde29ae9bdffdf6']",
      "before_first_fix_commit":"{'7f9460e61bc2d942af3fee19041deda6c8f85816'}",
      "last_fix_commit":"e0497c1980acebd257d3da78dfde29ae9bdffdf6",
      "chain_ord_pos":1.0,
      "commit_datetime":"08\/24\/2016, 15:15:22",
      "message":"fix XSS",
      "author":"evernat",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'javamelody-core\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/javamelody\/javamelody\/raw\/e0497c1980acebd257d3da78dfde29ae9bdffdf6\/javamelody-core%2Fsrc%2Fmain%2Fjava%2Fnet%2Fbull%2Fjavamelody%2FHtmlCoreReport.java', 'patch': '@@ -365,7 +365,7 @@ void writeMessageIfNotNull(String message, String partToRedirectTo,\\n \\t\\tif (message != null) {\\r\\n \\t\\t\\twriteln(SCRIPT_BEGIN);\\r\\n \\t\\t\\t\/\/ writeDirectly pour ne pas g\u00e9rer de traductions si le message contient \\'#\\'\\r\\n-\\t\\t\\twriteDirectly(\"alert(\\\\\"\" + javascriptEncode(message) + \"\\\\\");\");\\r\\n+\\t\\t\\twriteDirectly(\"alert(\\\\\"\" + htmlEncodeButNotSpace(javascriptEncode(message)) + \"\\\\\");\");\\r\\n \\t\\t\\twriteln(\"\");\\r\\n \\t\\t\\t\/\/ redirect vers une url \u00e9vitant que F5 du navigateur ne refasse l\\'action au lieu de faire un refresh\\r\\n \\t\\t\\tif (partToRedirectTo == null) {'}}",
      "message_norm":"fix xss",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['javamelody-core\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java'])",
      "num_files":1.0,
      "patch_content":"From e0497c1980acebd257d3da78dfde29ae9bdffdf6 Mon Sep 17 00:00:00 2001\nFrom: evernat <evernat@free.fr>\nDate: Wed, 24 Aug 2016 17:15:22 +0200\nSubject: [PATCH] fix XSS\n\n---\n ...\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java       | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/javamelody-core\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java b\/javamelody-core\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java\nindex 7571b0dec..d02aa6af9 100644\n--- a\/javamelody-core\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java\n+++ b\/javamelody-core\/src\/main\/java\/net\/bull\/javamelody\/HtmlCoreReport.java\n@@ -365,7 +365,7 @@ void writeMessageIfNotNull(String message, String partToRedirectTo,\n \t\tif (message != null) {\r\n \t\t\twriteln(SCRIPT_BEGIN);\r\n \t\t\t\/\/ writeDirectly pour ne pas g\u00e9rer de traductions si le message contient '#'\r\n-\t\t\twriteDirectly(\"alert(\\\"\" + javascriptEncode(message) + \"\\\");\");\r\n+\t\t\twriteDirectly(\"alert(\\\"\" + htmlEncodeButNotSpace(javascriptEncode(message)) + \"\\\");\");\r\n \t\t\twriteln(\"\");\r\n \t\t\t\/\/ redirect vers une url \u00e9vitant que F5 du navigateur ne refasse l'action au lieu de faire un refresh\r\n \t\t\tif (partToRedirectTo == null) {",
      "code_diff":"@@ -365,7 +365,7 @@ void writeMessageIfNotNull(String message, String partToRedirectTo,\n \t\tif (message != null) {\n \t\t\twriteln(SCRIPT_BEGIN);\n \t\t\t\/\/ writeDirectly pour ne pas g\u00e9rer de traductions si le message contient '#'\n-\t\t\twriteDirectly(\"alert(\\\"\" + javascriptEncode(message) + \"\\\");\");\n+\t\t\twriteDirectly(\"alert(\\\"\" + htmlEncodeButNotSpace(javascriptEncode(message)) + \"\\\");\");\n \t\t\twriteln(\"\");\n \t\t\t\/\/ redirect vers une url \u00e9vitant que F5 du navigateur ne refasse l'action au lieu de faire un refresh\n \t\t\tif (partToRedirectTo == null) {"
    },
    {
      "index":119,
      "vuln_id":"GHSA-3r95-23jp-mhvg",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/TYPO3\/typo3\/commit\/6f2554dc4ea0b670fd5599c54fd788d4db96c4a0'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in TYPO3's Form Framework > ### Meta\n> * CVSS: `CVSS:3.1\/AV:N\/AC:L\/PR:L\/UI:R\/S:C\/C:L\/I:L\/A:N\/E:F\/RL:O\/RC:C` (4.9)\n\n### Problem\nIt has been discovered that the Form Designer backend module of the Form Framework is vulnerable to cross-site scripting. A valid backend user account with access to the form module is needed to exploit this vulnerability.\n\n### Solution\nUpdate to TYPO3 versions 8.7.47 ELTS, 9.5.35 ELTS, 10.4.29, 11.5.11 that fix the problem described above.\n\n### Credits\nThanks to Gabe Troyan who reported and fixed the issue.\n\n### References\n* [TYPO3-CORE-SA-2022-003](https:\/\/typo3.org\/security\/advisory\/typo3-core-sa-2022-003)",
      "published_date":"2022-06-17",
      "chain_len":1,
      "project":"https:\/\/github.com\/TYPO3\/typo3",
      "commit_href":"https:\/\/github.com\/TYPO3\/typo3\/commit\/6f2554dc4ea0b670fd5599c54fd788d4db96c4a0",
      "commit_sha":"6f2554dc4ea0b670fd5599c54fd788d4db96c4a0",
      "patch":"SINGLE",
      "chain_ord":"['6f2554dc4ea0b670fd5599c54fd788d4db96c4a0']",
      "before_first_fix_commit":"{'c93ea692e7dfef03b7c50fe5437487545bee4d6a'}",
      "last_fix_commit":"6f2554dc4ea0b670fd5599c54fd788d4db96c4a0",
      "chain_ord_pos":1.0,
      "commit_datetime":"06\/14\/2022, 07:17:30",
      "message":"[SECURITY] Ensure text preview of multivalue items in form editor\n\nMultivalue items in the form editor user interface were previewed\nas HTML, but should be treated as scalar text only.\n\nResolves: #96743\nReleases: main, 11.5, 10.4\nChange-Id: I5e8dab26119490ecf19ac5d48c2bc7a5a00daaad\nSecurity-Bulletin: TYPO3-CORE-SA-2022-003\nSecurity-References: CVE-2022-31048\nReviewed-on: https:\/\/review.typo3.org\/c\/Packages\/TYPO3.CMS\/+\/73297\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>",
      "author":"Gabe Troyan",
      "comments":null,
      "stats":"{'additions': 6, 'deletions': 6, 'total': 12}",
      "files":"{'typo3\/sysext\/form\/Resources\/Public\/JavaScript\/backend\/form-editor\/stage-component.js': {'additions': 6, 'deletions': 6, 'changes': 12, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/TYPO3\/typo3\/raw\/6f2554dc4ea0b670fd5599c54fd788d4db96c4a0\/typo3%2Fsysext%2Fform%2FResources%2FPublic%2FJavaScript%2Fbackend%2Fform-editor%2Fstage-component.js', 'patch': \"@@ -513,10 +513,10 @@ function factory($, Helper, Icons) {\\n      *\/\\n     function setStageHeadline(title) {\\n       if (getUtility().isUndefinedOrNull(title)) {\\n-        title = buildTitleByFormElement();\\n+        title = buildTitleByFormElement().text();\\n       }\\n \\n-      $(getHelper().getDomElementDataIdentifierSelector('stageHeadline')).html(title);\\n+      $(getHelper().getDomElementDataIdentifierSelector('stageHeadline')).text(title);\\n     };\\n \\n     \/**\\n@@ -981,10 +981,10 @@ function factory($, Helper, Icons) {\\n \\n       getHelper()\\n         .getTemplatePropertyDomElement('_type', template)\\n-        .append(getFormElementDefinition(formElement, 'label'));\\n+        .append(document.createTextNode(getFormElementDefinition(formElement, 'label')));\\n       getHelper()\\n         .getTemplatePropertyDomElement('_identifier', template)\\n-        .append(formElement.get('identifier'));\\n+        .append(document.createTextNode(formElement.get('identifier')));\\n     };\\n \\n     \/**\\n@@ -1029,7 +1029,7 @@ function factory($, Helper, Icons) {\\n \\n             getHelper()\\n               .getTemplatePropertyDomElement('_label', rowTemplate)\\n-              .append(collectionElementConfiguration['label']);\\n+              .append(document.createTextNode(collectionElementConfiguration['label']));\\n             $(getHelper().getDomElementDataIdentifierSelector('validatorsContainer'), $(template))\\n               .append(rowTemplate.html());\\n           }\\n@@ -1089,7 +1089,7 @@ function factory($, Helper, Icons) {\\n           }\\n         }\\n \\n-        getHelper().getTemplatePropertyDomElement('_label', rowTemplate).append(label);\\n+        getHelper().getTemplatePropertyDomElement('_label', rowTemplate).append(document.createTextNode(label));\\n \\n         if (isPreselected) {\\n           getHelper().getTemplatePropertyDomElement('_label', rowTemplate).addClass(\"}}",
      "message_norm":"[security] ensure text preview of multivalue items in form editor\n\nmultivalue items in the form editor user interface were previewed\nas html, but should be treated as scalar text only.\n\nresolves: #96743\nreleases: main, 11.5, 10.4\nchange-id: i5e8dab26119490ecf19ac5d48c2bc7a5a00daaad\nsecurity-bulletin: typo3-core-sa-2022-003\nsecurity-references: cve-2022-31048\nreviewed-on: https:\/\/review.typo3.org\/c\/packages\/typo3.cms\/+\/73297\ntested-by: oliver hader <oliver.hader@typo3.org>\nreviewed-by: oliver hader <oliver.hader@typo3.org>",
      "language":"en",
      "entities":"[('security', 'SECWORD', ''), ('ensure', 'ACTION', ''), ('#96743', 'ISSUE', ''), ('security', 'SECWORD', ''), ('security', 'SECWORD', ''), ('cve-2022-31048', 'VULNID', 'CVE'), ('https:\/\/review.typo3.org\/c\/packages\/typo3.cms\/+\/73297', 'URL', ''), ('oliver.hader@typo3.org', 'EMAIL', ''), ('oliver.hader@typo3.org', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['typo3\/sysext\/form\/Resources\/Public\/JavaScript\/backend\/form-editor\/stage-component.js'])",
      "num_files":1.0,
      "patch_content":"From 6f2554dc4ea0b670fd5599c54fd788d4db96c4a0 Mon Sep 17 00:00:00 2001\nFrom: Gabe Troyan <gabe+typo3org@ecopixel.com>\nDate: Tue, 14 Jun 2022 09:17:30 +0200\nSubject: [PATCH] [SECURITY] Ensure text preview of multivalue items in form\n editor\n\nMultivalue items in the form editor user interface were previewed\nas HTML, but should be treated as scalar text only.\n\nResolves: #96743\nReleases: main, 11.5, 10.4\nChange-Id: I5e8dab26119490ecf19ac5d48c2bc7a5a00daaad\nSecurity-Bulletin: TYPO3-CORE-SA-2022-003\nSecurity-References: CVE-2022-31048\nReviewed-on: https:\/\/review.typo3.org\/c\/Packages\/TYPO3.CMS\/+\/73297\nTested-by: Oliver Hader <oliver.hader@typo3.org>\nReviewed-by: Oliver Hader <oliver.hader@typo3.org>\n---\n ...\/backend\/form-editor\/stage-component.js           | 12 ++++++------\n 1 file changed, 6 insertions(+), 6 deletions(-)\n\ndiff --git a\/typo3\/sysext\/form\/Resources\/Public\/JavaScript\/backend\/form-editor\/stage-component.js b\/typo3\/sysext\/form\/Resources\/Public\/JavaScript\/backend\/form-editor\/stage-component.js\nindex 4cac39607c94..a78147841290 100644\n--- a\/typo3\/sysext\/form\/Resources\/Public\/JavaScript\/backend\/form-editor\/stage-component.js\n+++ b\/typo3\/sysext\/form\/Resources\/Public\/JavaScript\/backend\/form-editor\/stage-component.js\n@@ -513,10 +513,10 @@ function factory($, Helper, Icons) {\n      *\/\n     function setStageHeadline(title) {\n       if (getUtility().isUndefinedOrNull(title)) {\n-        title = buildTitleByFormElement();\n+        title = buildTitleByFormElement().text();\n       }\n \n-      $(getHelper().getDomElementDataIdentifierSelector('stageHeadline')).html(title);\n+      $(getHelper().getDomElementDataIdentifierSelector('stageHeadline')).text(title);\n     };\n \n     \/**\n@@ -981,10 +981,10 @@ function factory($, Helper, Icons) {\n \n       getHelper()\n         .getTemplatePropertyDomElement('_type', template)\n-        .append(getFormElementDefinition(formElement, 'label'));\n+        .append(document.createTextNode(getFormElementDefinition(formElement, 'label')));\n       getHelper()\n         .getTemplatePropertyDomElement('_identifier', template)\n-        .append(formElement.get('identifier'));\n+        .append(document.createTextNode(formElement.get('identifier')));\n     };\n \n     \/**\n@@ -1029,7 +1029,7 @@ function factory($, Helper, Icons) {\n \n             getHelper()\n               .getTemplatePropertyDomElement('_label', rowTemplate)\n-              .append(collectionElementConfiguration['label']);\n+              .append(document.createTextNode(collectionElementConfiguration['label']));\n             $(getHelper().getDomElementDataIdentifierSelector('validatorsContainer'), $(template))\n               .append(rowTemplate.html());\n           }\n@@ -1089,7 +1089,7 @@ function factory($, Helper, Icons) {\n           }\n         }\n \n-        getHelper().getTemplatePropertyDomElement('_label', rowTemplate).append(label);\n+        getHelper().getTemplatePropertyDomElement('_label', rowTemplate).append(document.createTextNode(label));\n \n         if (isPreselected) {\n           getHelper().getTemplatePropertyDomElement('_label', rowTemplate).addClass(",
      "code_diff":"@@ -513,10 +513,10 @@ function factory($, Helper, Icons) {\n      *\/\n     function setStageHeadline(title) {\n       if (getUtility().isUndefinedOrNull(title)) {\n-        title = buildTitleByFormElement();\n+        title = buildTitleByFormElement().text();\n       }\n \n-      $(getHelper().getDomElementDataIdentifierSelector('stageHeadline')).html(title);\n+      $(getHelper().getDomElementDataIdentifierSelector('stageHeadline')).text(title);\n     };\n \n     \/**\n@@ -981,10 +981,10 @@ function factory($, Helper, Icons) {\n \n       getHelper()\n         .getTemplatePropertyDomElement('_type', template)\n-        .append(getFormElementDefinition(formElement, 'label'));\n+        .append(document.createTextNode(getFormElementDefinition(formElement, 'label')));\n       getHelper()\n         .getTemplatePropertyDomElement('_identifier', template)\n-        .append(formElement.get('identifier'));\n+        .append(document.createTextNode(formElement.get('identifier')));\n     };\n \n     \/**\n@@ -1029,7 +1029,7 @@ function factory($, Helper, Icons) {\n \n             getHelper()\n               .getTemplatePropertyDomElement('_label', rowTemplate)\n-              .append(collectionElementConfiguration['label']);\n+              .append(document.createTextNode(collectionElementConfiguration['label']));\n             $(getHelper().getDomElementDataIdentifierSelector('validatorsContainer'), $(template))\n               .append(rowTemplate.html());\n           }\n@@ -1089,7 +1089,7 @@ function factory($, Helper, Icons) {\n           }\n         }\n \n-        getHelper().getTemplatePropertyDomElement('_label', rowTemplate).append(label);\n+        getHelper().getTemplatePropertyDomElement('_label', rowTemplate).append(document.createTextNode(label));\n \n         if (isPreselected) {\n           getHelper().getTemplatePropertyDomElement('_label', rowTemplate).addClass("
    },
    {
      "index":120,
      "vuln_id":"GHSA-jp6r-xcjj-5h7r",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/gchq\/CyberChef\/commit\/01f0625d6a177f9c5df9281f12a27c814c2d8bcf'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in cyberchef Versions of `cyberchef` prior to 8.31.3 are vulnerable to Cross-Site Scripting. In `Text Encoding Brute Force` the table rows are created by concatenating the `value` variable unsanitized in the HTML code. If this variable is controlled by user input it allows attackers to execute arbitrary JavaScript in a victim's browser.\n\n\n## Recommendation\n\nUpgrade to version 8.31.3 or later.",
      "published_date":"2019-08-27",
      "chain_len":1,
      "project":"https:\/\/github.com\/gchq\/CyberChef",
      "commit_href":"https:\/\/github.com\/gchq\/CyberChef\/commit\/01f0625d6a177f9c5df9281f12a27c814c2d8bcf",
      "commit_sha":"01f0625d6a177f9c5df9281f12a27c814c2d8bcf",
      "patch":"SINGLE",
      "chain_ord":"['01f0625d6a177f9c5df9281f12a27c814c2d8bcf']",
      "before_first_fix_commit":"{'38ff7ec89f595dbe5971c3577fa29a142b4b2416'}",
      "last_fix_commit":"01f0625d6a177f9c5df9281f12a27c814c2d8bcf",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/14\/2019, 21:00:17",
      "message":"Fixed XSS in 'Text Encoding Brute Force. Closes #539",
      "author":"n1474335",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'src\/core\/operations\/TextEncodingBruteForce.mjs': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/gchq\/CyberChef\/raw\/01f0625d6a177f9c5df9281f12a27c814c2d8bcf\/src%2Fcore%2Foperations%2FTextEncodingBruteForce.mjs', 'patch': '@@ -79,7 +79,7 @@ class TextEncodingBruteForce extends Operation {\\n         let table = \"<table class=\\'table table-hover table-sm table-bordered table-nonfluid\\'><tr><th>Encoding<\/th><th>Value<\/th><\/tr>\";\\n \\n         for (const enc in encodings) {\\n-            const value = Utils.printable(encodings[enc], true);\\n+            const value = Utils.escapeHtml(Utils.printable(encodings[enc], true));\\n             table += `<tr><td>${enc}<\/td><td>${value}<\/td><\/tr>`;\\n         }'}}",
      "message_norm":"fixed xss in 'text encoding brute force. closes #539",
      "language":"en",
      "entities":"[('fixed', 'ACTION', ''), ('xss', 'SECWORD', ''), ('encoding', 'SECWORD', ''), ('#539', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/core\/operations\/TextEncodingBruteForce.mjs'])",
      "num_files":1.0,
      "patch_content":"From 01f0625d6a177f9c5df9281f12a27c814c2d8bcf Mon Sep 17 00:00:00 2001\nFrom: n1474335 <n1474335@gmail.com>\nDate: Sun, 14 Apr 2019 22:00:17 +0100\nSubject: [PATCH] Fixed XSS in 'Text Encoding Brute Force. Closes #539\n\n---\n src\/core\/operations\/TextEncodingBruteForce.mjs | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/src\/core\/operations\/TextEncodingBruteForce.mjs b\/src\/core\/operations\/TextEncodingBruteForce.mjs\nindex ee5f70d311..169e6ad7b6 100644\n--- a\/src\/core\/operations\/TextEncodingBruteForce.mjs\n+++ b\/src\/core\/operations\/TextEncodingBruteForce.mjs\n@@ -79,7 +79,7 @@ class TextEncodingBruteForce extends Operation {\n         let table = \"<table class='table table-hover table-sm table-bordered table-nonfluid'><tr><th>Encoding<\/th><th>Value<\/th><\/tr>\";\n \n         for (const enc in encodings) {\n-            const value = Utils.printable(encodings[enc], true);\n+            const value = Utils.escapeHtml(Utils.printable(encodings[enc], true));\n             table += `<tr><td>${enc}<\/td><td>${value}<\/td><\/tr>`;\n         }",
      "code_diff":"@@ -79,7 +79,7 @@ class TextEncodingBruteForce extends Operation {\n         let table = \"<table class='table table-hover table-sm table-bordered table-nonfluid'><tr><th>Encoding<\/th><th>Value<\/th><\/tr>\";\n \n         for (const enc in encodings) {\n-            const value = Utils.printable(encodings[enc], true);\n+            const value = Utils.escapeHtml(Utils.printable(encodings[enc], true));\n             table += `<tr><td>${enc}<\/td><td>${value}<\/td><\/tr>`;\n         }"
    },
    {
      "index":121,
      "vuln_id":"GHSA-rxch-gp62-574w",
      "cwe_id":"{'CWE-79'}",
      "score":6.4,
      "chain":"{'https:\/\/github.com\/snipe\/snipe-it\/commit\/9d5d1a9f9aae2c8baee48551185da5de0cdb62c2'}",
      "dataset":"osv",
      "summary":"snipe-it is vulnerable to Cross-site Scripting snipe-it is vulnerable to Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting').",
      "published_date":"2021-12-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/snipe\/snipe-it",
      "commit_href":"https:\/\/github.com\/snipe\/snipe-it\/commit\/9d5d1a9f9aae2c8baee48551185da5de0cdb62c2",
      "commit_sha":"9d5d1a9f9aae2c8baee48551185da5de0cdb62c2",
      "patch":"SINGLE",
      "chain_ord":"['9d5d1a9f9aae2c8baee48551185da5de0cdb62c2']",
      "before_first_fix_commit":"{'3a7cef15bd7578f93104011137222512d4c95f4e'}",
      "last_fix_commit":"9d5d1a9f9aae2c8baee48551185da5de0cdb62c2",
      "chain_ord_pos":1.0,
      "commit_datetime":"12\/13\/2021, 20:03:03",
      "message":"Added escape to assigned_to API response\n\nSigned-off-by: snipe <snipe@snipe.net>",
      "author":"snipe",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'app\/Http\/Transformers\/AssetsTransformer.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/snipe\/snipe-it\/raw\/9d5d1a9f9aae2c8baee48551185da5de0cdb62c2\/app%2FHttp%2FTransformers%2FAssetsTransformer.php', 'patch': \"@@ -170,7 +170,7 @@ public function transformAssignedTo($asset)\\n         }\\n         return $asset->assigned ? [\\n             'id' => $asset->assigned->id,\\n-            'name' => $asset->assigned->display_name,\\n+            'name' => e($asset->assigned->display_name),\\n             'type' => $asset->assignedType()\\n         ] : null;\\n     }\"}}",
      "message_norm":"added escape to assigned_to api response\n\nsigned-off-by: snipe <snipe@snipe.net>",
      "language":"en",
      "entities":"[('added', 'ACTION', ''), ('escape', 'SECWORD', ''), ('snipe@snipe.net', 'EMAIL', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Transformers\/AssetsTransformer.php'])",
      "num_files":1.0,
      "patch_content":"From 9d5d1a9f9aae2c8baee48551185da5de0cdb62c2 Mon Sep 17 00:00:00 2001\nFrom: snipe <snipe@snipe.net>\nDate: Mon, 13 Dec 2021 12:03:03 -0800\nSubject: [PATCH] Added escape to assigned_to API response\n\nSigned-off-by: snipe <snipe@snipe.net>\n---\n app\/Http\/Transformers\/AssetsTransformer.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/app\/Http\/Transformers\/AssetsTransformer.php b\/app\/Http\/Transformers\/AssetsTransformer.php\nindex 0da314002f54..e9abca65e13d 100644\n--- a\/app\/Http\/Transformers\/AssetsTransformer.php\n+++ b\/app\/Http\/Transformers\/AssetsTransformer.php\n@@ -170,7 +170,7 @@ public function transformAssignedTo($asset)\n         }\n         return $asset->assigned ? [\n             'id' => $asset->assigned->id,\n-            'name' => $asset->assigned->display_name,\n+            'name' => e($asset->assigned->display_name),\n             'type' => $asset->assignedType()\n         ] : null;\n     }",
      "code_diff":"@@ -170,7 +170,7 @@ public function transformAssignedTo($asset)\n         }\n         return $asset->assigned ? [\n             'id' => $asset->assigned->id,\n-            'name' => $asset->assigned->display_name,\n+            'name' => e($asset->assigned->display_name),\n             'type' => $asset->assignedType()\n         ] : null;\n     }"
    },
    {
      "index":122,
      "vuln_id":"GHSA-6465-r752-2h8v",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/neorazorx\/facturascripts\/commit\/8e31d8434014a6d1e8791a489d84268fd74b0c9a'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in facturascripts Reflected cross-site scripting using url based payload in GitHub repository neorazorx\/facturascripts prior to 2022.08. This can lead to theft of a user's cookies, which in turn could lead to account takeover or do other malicious activities in a victim's browser.",
      "published_date":"2022-05-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/neorazorx\/facturascripts",
      "commit_href":"https:\/\/github.com\/neorazorx\/facturascripts\/commit\/8e31d8434014a6d1e8791a489d84268fd74b0c9a",
      "commit_sha":"8e31d8434014a6d1e8791a489d84268fd74b0c9a",
      "patch":"SINGLE",
      "chain_ord":"['8e31d8434014a6d1e8791a489d84268fd74b0c9a']",
      "before_first_fix_commit":"{'ec88bc72ff2f6eb79a27112c777a7d601e946ed5'}",
      "last_fix_commit":"8e31d8434014a6d1e8791a489d84268fd74b0c9a",
      "chain_ord_pos":1.0,
      "commit_datetime":"05\/09\/2022, 22:12:41",
      "message":"We check the url parameter of the link to ensure that it is a valid controller.\n------\nComprobamos el par\u00e1metro url del enlace para asegurar que sea un controlador v\u00e1lido.",
      "author":"Carlos Garcia Gomez",
      "comments":null,
      "stats":"{'additions': 18, 'deletions': 1, 'total': 19}",
      "files":"{'Core\/Controller\/EditPageOption.php': {'additions': 18, 'deletions': 1, 'changes': 19, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/NeoRazorX\/facturascripts\/raw\/8e31d8434014a6d1e8791a489d84268fd74b0c9a\/Core%2FController%2FEditPageOption.php', 'patch': \"@@ -24,6 +24,7 @@\\n use FacturaScripts\\\\Core\\\\Base\\\\DataBase\\\\DataBaseWhere;\\n use FacturaScripts\\\\Core\\\\Lib\\\\Widget\\\\VisualItemLoadEngine;\\n use FacturaScripts\\\\Dinamic\\\\Model\\\\CodeModel;\\n+use FacturaScripts\\\\Dinamic\\\\Model\\\\Page;\\n use FacturaScripts\\\\Dinamic\\\\Model\\\\PageOption;\\n use FacturaScripts\\\\Dinamic\\\\Model\\\\User;\\n use Symfony\\\\Component\\\\HttpFoundation\\\\Response;\\n@@ -121,7 +122,7 @@ public function privateCore(&$response, $user, $permissions)\\n         parent::privateCore($response, $user, $permissions);\\n         $this->model = new PageOption();\\n         $this->loadSelectedViewName();\\n-        $this->backPage = $this->request->get('url') ?: $this->selectedViewName;\\n+        $this->setBackPage();\\n         $this->selectedUser = $this->user->admin ? $this->request->get('nick') : $this->user->nick;\\n         $this->loadPageOptions();\\n \\n@@ -275,6 +276,22 @@ private function loadPageOptionsForUser(): bool\\n         return true;\\n     }\\n \\n+    private function setBackPage()\\n+    {\\n+        \/\/ check if the url is a real controller name\\n+        $url = $this->request->get('url', '');\\n+        $pageModel = new Page();\\n+        foreach ($pageModel->all([], [], 0, 0) as $page) {\\n+            if (substr($url, 0, strlen($page->name)) === $page->name) {\\n+                $this->backPage = $url;\\n+                return;\\n+            }\\n+        }\\n+\\n+        \/\/ set the default back page\\n+        $this->backPage = $this->selectedViewName;\\n+    }\\n+\\n     \/**\\n      * @param array $column\\n      * @param string $name\"}}",
      "message_norm":"we check the url parameter of the link to ensure that it is a valid controller.\n------\ncomprobamos el par\u00e1metro url del enlace para asegurar que sea un controlador v\u00e1lido.",
      "language":"es",
      "entities":"[('ensure', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['Core\/Controller\/EditPageOption.php'])",
      "num_files":1.0,
      "patch_content":"From 8e31d8434014a6d1e8791a489d84268fd74b0c9a Mon Sep 17 00:00:00 2001\nFrom: Carlos Garcia Gomez <neorazorx@gmail.com>\nDate: Tue, 10 May 2022 00:12:41 +0200\nSubject: [PATCH] =?UTF-8?q?We=20check=20the=20url=20parameter=20of=20the?=\n =?UTF-8?q?=20link=20to=20ensure=20that=20it=20is=20a=20valid=20controller?=\n =?UTF-8?q?.=20------=20Comprobamos=20el=20par=C3=A1metro=20url=20del=20en?=\n =?UTF-8?q?lace=20para=20asegurar=20que=20sea=20un=20controlador=20v=C3=A1?=\n =?UTF-8?q?lido.?=\nMIME-Version: 1.0\nContent-Type: text\/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n\n---\n Core\/Controller\/EditPageOption.php | 19 ++++++++++++++++++-\n 1 file changed, 18 insertions(+), 1 deletion(-)\n\ndiff --git a\/Core\/Controller\/EditPageOption.php b\/Core\/Controller\/EditPageOption.php\nindex a9b620f8d3..b8cb64a839 100644\n--- a\/Core\/Controller\/EditPageOption.php\n+++ b\/Core\/Controller\/EditPageOption.php\n@@ -24,6 +24,7 @@\n use FacturaScripts\\Core\\Base\\DataBase\\DataBaseWhere;\n use FacturaScripts\\Core\\Lib\\Widget\\VisualItemLoadEngine;\n use FacturaScripts\\Dinamic\\Model\\CodeModel;\n+use FacturaScripts\\Dinamic\\Model\\Page;\n use FacturaScripts\\Dinamic\\Model\\PageOption;\n use FacturaScripts\\Dinamic\\Model\\User;\n use Symfony\\Component\\HttpFoundation\\Response;\n@@ -121,7 +122,7 @@ public function privateCore(&$response, $user, $permissions)\n         parent::privateCore($response, $user, $permissions);\n         $this->model = new PageOption();\n         $this->loadSelectedViewName();\n-        $this->backPage = $this->request->get('url') ?: $this->selectedViewName;\n+        $this->setBackPage();\n         $this->selectedUser = $this->user->admin ? $this->request->get('nick') : $this->user->nick;\n         $this->loadPageOptions();\n \n@@ -275,6 +276,22 @@ private function loadPageOptionsForUser(): bool\n         return true;\n     }\n \n+    private function setBackPage()\n+    {\n+        \/\/ check if the url is a real controller name\n+        $url = $this->request->get('url', '');\n+        $pageModel = new Page();\n+        foreach ($pageModel->all([], [], 0, 0) as $page) {\n+            if (substr($url, 0, strlen($page->name)) === $page->name) {\n+                $this->backPage = $url;\n+                return;\n+            }\n+        }\n+\n+        \/\/ set the default back page\n+        $this->backPage = $this->selectedViewName;\n+    }\n+\n     \/**\n      * @param array $column\n      * @param string $name",
      "code_diff":"@@ -24,6 +24,7 @@\n use FacturaScripts\\Core\\Base\\DataBase\\DataBaseWhere;\n use FacturaScripts\\Core\\Lib\\Widget\\VisualItemLoadEngine;\n use FacturaScripts\\Dinamic\\Model\\CodeModel;\n+use FacturaScripts\\Dinamic\\Model\\Page;\n use FacturaScripts\\Dinamic\\Model\\PageOption;\n use FacturaScripts\\Dinamic\\Model\\User;\n use Symfony\\Component\\HttpFoundation\\Response;\n@@ -121,7 +122,7 @@ public function privateCore(&$response, $user, $permissions)\n         parent::privateCore($response, $user, $permissions);\n         $this->model = new PageOption();\n         $this->loadSelectedViewName();\n-        $this->backPage = $this->request->get('url') ?: $this->selectedViewName;\n+        $this->setBackPage();\n         $this->selectedUser = $this->user->admin ? $this->request->get('nick') : $this->user->nick;\n         $this->loadPageOptions();\n \n@@ -275,6 +276,22 @@ private function loadPageOptionsForUser(): bool\n         return true;\n     }\n \n+    private function setBackPage()\n+    {\n+        \/\/ check if the url is a real controller name\n+        $url = $this->request->get('url', '');\n+        $pageModel = new Page();\n+        foreach ($pageModel->all([], [], 0, 0) as $page) {\n+            if (substr($url, 0, strlen($page->name)) === $page->name) {\n+                $this->backPage = $url;\n+                return;\n+            }\n+        }\n+\n+        \/\/ set the default back page\n+        $this->backPage = $this->selectedViewName;\n+    }\n+\n     \/**\n      * @param array $column\n      * @param string $name"
    },
    {
      "index":123,
      "vuln_id":"GHSA-2gqg-2rg7-gh33",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/librenms\/librenms\/commit\/cc6112b8fb36039b862b42d86eb79ef7ee89d31b'}",
      "dataset":"osv",
      "summary":"Cross site scripting in librenms LibreNMS v22.3.0 was discovered to contain a cross-site scripting (XSS) vulnerability via the component \/Table\/GraylogController.php.",
      "published_date":"2022-06-03",
      "chain_len":1,
      "project":"https:\/\/github.com\/librenms\/librenms",
      "commit_href":"https:\/\/github.com\/librenms\/librenms\/commit\/cc6112b8fb36039b862b42d86eb79ef7ee89d31b",
      "commit_sha":"cc6112b8fb36039b862b42d86eb79ef7ee89d31b",
      "patch":"SINGLE",
      "chain_ord":"['cc6112b8fb36039b862b42d86eb79ef7ee89d31b']",
      "before_first_fix_commit":"{'9c126572a2aebd43838aab9bf6abc09719ce983e'}",
      "last_fix_commit":"cc6112b8fb36039b862b42d86eb79ef7ee89d31b",
      "chain_ord_pos":1.0,
      "commit_datetime":"04\/19\/2022, 23:10:02",
      "message":"fix graylog xss (#13931)",
      "author":"Tony Murray",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'app\/Http\/Controllers\/Table\/GraylogController.php': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/librenms\/librenms\/raw\/cc6112b8fb36039b862b42d86eb79ef7ee89d31b\/app%2FHttp%2FControllers%2FTable%2FGraylogController.php', 'patch': '@@ -118,8 +118,8 @@ private function formatMessage($message)\\n         return [\\n             \\'severity\\'  => $this->severityLabel($level),\\n             \\'timestamp\\' => $displayTime,\\n-            \\'source\\'    => $device ? Url::deviceLink($device) : $message[\\'message\\'][\\'source\\'],\\n-            \\'message\\'   => $message[\\'message\\'][\\'message\\'] ?? \\'\\',\\n+            \\'source\\'    => $device ? Url::deviceLink($device) : htmlspecialchars($message[\\'message\\'][\\'source\\']),\\n+            \\'message\\'   => htmlspecialchars($message[\\'message\\'][\\'message\\'] ?? \\'\\'),\\n             \\'facility\\'  => is_numeric($facility) ? \"($facility) \" . __(\"syslog.facility.$facility\") : $facility,\\n             \\'level\\'     => (is_numeric($level) && $level >= 0) ? \"($level) \" . __(\"syslog.severity.$level\") : $level,\\n         ];'}}",
      "message_norm":"fix graylog xss (#13931)",
      "language":"no",
      "entities":"[('fix', 'ACTION', ''), ('xss', 'SECWORD', ''), ('#13931', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['app\/Http\/Controllers\/Table\/GraylogController.php'])",
      "num_files":1.0,
      "patch_content":"From cc6112b8fb36039b862b42d86eb79ef7ee89d31b Mon Sep 17 00:00:00 2001\nFrom: Tony Murray <murraytony@gmail.com>\nDate: Tue, 19 Apr 2022 18:10:02 -0500\nSubject: [PATCH] fix graylog xss (#13931)\n\n---\n app\/Http\/Controllers\/Table\/GraylogController.php | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/app\/Http\/Controllers\/Table\/GraylogController.php b\/app\/Http\/Controllers\/Table\/GraylogController.php\nindex bc0d9f418c6e..ec911c790af1 100644\n--- a\/app\/Http\/Controllers\/Table\/GraylogController.php\n+++ b\/app\/Http\/Controllers\/Table\/GraylogController.php\n@@ -118,8 +118,8 @@ private function formatMessage($message)\n         return [\n             'severity'  => $this->severityLabel($level),\n             'timestamp' => $displayTime,\n-            'source'    => $device ? Url::deviceLink($device) : $message['message']['source'],\n-            'message'   => $message['message']['message'] ?? '',\n+            'source'    => $device ? Url::deviceLink($device) : htmlspecialchars($message['message']['source']),\n+            'message'   => htmlspecialchars($message['message']['message'] ?? ''),\n             'facility'  => is_numeric($facility) ? \"($facility) \" . __(\"syslog.facility.$facility\") : $facility,\n             'level'     => (is_numeric($level) && $level >= 0) ? \"($level) \" . __(\"syslog.severity.$level\") : $level,\n         ];",
      "code_diff":"@@ -118,8 +118,8 @@ private function formatMessage($message)\n         return [\n             'severity'  => $this->severityLabel($level),\n             'timestamp' => $displayTime,\n-            'source'    => $device ? Url::deviceLink($device) : $message['message']['source'],\n-            'message'   => $message['message']['message'] ?? '',\n+            'source'    => $device ? Url::deviceLink($device) : htmlspecialchars($message['message']['source']),\n+            'message'   => htmlspecialchars($message['message']['message'] ?? ''),\n             'facility'  => is_numeric($facility) ? \"($facility) \" . __(\"syslog.facility.$facility\") : $facility,\n             'level'     => (is_numeric($level) && $level >= 0) ? \"($level) \" . __(\"syslog.severity.$level\") : $level,\n         ];"
    },
    {
      "index":124,
      "vuln_id":"GHSA-8c76-mxv5-w4g8",
      "cwe_id":"{'CWE-79'}",
      "score":6.8,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/955471c27e671c49e4b012e3b120b004082ac3f7'}",
      "dataset":"osv",
      "summary":"Stored Cross-site Scripting in Microweber Microweber 1.2.11 and prior contains multiple stored cross-site scripting vulnerabilities in Shop's Other Settings, Shop's Autorespond E-mail Settings and Shops' Payments Methods.",
      "published_date":"2022-03-16",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/955471c27e671c49e4b012e3b120b004082ac3f7",
      "commit_sha":"955471c27e671c49e4b012e3b120b004082ac3f7",
      "patch":"SINGLE",
      "chain_ord":"['955471c27e671c49e4b012e3b120b004082ac3f7']",
      "before_first_fix_commit":"{'46e100a1b3e613f3e27b82942b00bdb0e69df4fa'}",
      "last_fix_commit":"955471c27e671c49e4b012e3b120b004082ac3f7",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 10:14:14",
      "message":"Update SaveOptionApiController.php",
      "author":"Bozhidar Slaveykov",
      "comments":null,
      "stats":"{'additions': 19, 'deletions': 7, 'total': 26}",
      "files":"{'src\/MicroweberPackages\/Option\/Http\/Controllers\/Api\/SaveOptionApiController.php': {'additions': 19, 'deletions': 7, 'changes': 26, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/955471c27e671c49e4b012e3b120b004082ac3f7\/src%2FMicroweberPackages%2FOption%2FHttp%2FControllers%2FApi%2FSaveOptionApiController.php', 'patch': \"@@ -6,18 +6,30 @@\\n \\n class SaveOptionApiController\\n {\\n-    public function saveOption(Request $request) {\\n+    public $whitelistedGroupKeys = [\\n+        'website' => [\\n+            'website_head',\\n+            'website_footer'\\n+        ]\\n+    ];\\n+\\n+    public function saveOption(Request $request)\\n+    {\\n \\n         $cleanFromXss = true;\\n         $option = $request->all();\\n \\n-        \/\/ Allow for this keys\\n+        \/\/ Allow for this keys and groups\\n         if (isset($option['option_key'])) {\\n-            if ($option['option_key'] == 'website_head') {\\n-                $cleanFromXss = false;\\n-            }\\n-            if ($option['option_key'] == 'website_footer') {\\n-                $cleanFromXss = false;\\n+            foreach ($this->whitelistedGroupKeys as $group => $keys) {\\n+                if ($option['option_group'] == $group) {\\n+                    foreach ($keys as $key) {\\n+                        if ($option['option_key'] == $key) {\\n+                            $cleanFromXss = false;\\n+                            break;\\n+                        }\\n+                    }\\n+                }\\n             }\\n         }\"}}",
      "message_norm":"update saveoptionapicontroller.php",
      "language":"it",
      "entities":null,
      "classification_level_1":"POORLY_DOCUMENTED",
      "classification_level_2":"SUBMIT_CENTERED",
      "list_files":"dict_keys(['src\/MicroweberPackages\/Option\/Http\/Controllers\/Api\/SaveOptionApiController.php'])",
      "num_files":1.0,
      "patch_content":"From 955471c27e671c49e4b012e3b120b004082ac3f7 Mon Sep 17 00:00:00 2001\nFrom: Bozhidar Slaveykov <bobi@microweber.com>\nDate: Mon, 14 Mar 2022 12:14:14 +0200\nSubject: [PATCH] Update SaveOptionApiController.php\n\n---\n ...\/Api\/SaveOptionApiController.php           | 26 ++++++++++++++-----\n 1 file changed, 19 insertions(+), 7 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/Option\/Http\/Controllers\/Api\/SaveOptionApiController.php b\/src\/MicroweberPackages\/Option\/Http\/Controllers\/Api\/SaveOptionApiController.php\nindex 33c8fa4c5b2..e40d5b03a83 100644\n--- a\/src\/MicroweberPackages\/Option\/Http\/Controllers\/Api\/SaveOptionApiController.php\n+++ b\/src\/MicroweberPackages\/Option\/Http\/Controllers\/Api\/SaveOptionApiController.php\n@@ -6,18 +6,30 @@\n \n class SaveOptionApiController\n {\n-    public function saveOption(Request $request) {\n+    public $whitelistedGroupKeys = [\n+        'website' => [\n+            'website_head',\n+            'website_footer'\n+        ]\n+    ];\n+\n+    public function saveOption(Request $request)\n+    {\n \n         $cleanFromXss = true;\n         $option = $request->all();\n \n-        \/\/ Allow for this keys\n+        \/\/ Allow for this keys and groups\n         if (isset($option['option_key'])) {\n-            if ($option['option_key'] == 'website_head') {\n-                $cleanFromXss = false;\n-            }\n-            if ($option['option_key'] == 'website_footer') {\n-                $cleanFromXss = false;\n+            foreach ($this->whitelistedGroupKeys as $group => $keys) {\n+                if ($option['option_group'] == $group) {\n+                    foreach ($keys as $key) {\n+                        if ($option['option_key'] == $key) {\n+                            $cleanFromXss = false;\n+                            break;\n+                        }\n+                    }\n+                }\n             }\n         }",
      "code_diff":"@@ -6,18 +6,30 @@\n \n class SaveOptionApiController\n {\n-    public function saveOption(Request $request) {\n+    public $whitelistedGroupKeys = [\n+        'website' => [\n+            'website_head',\n+            'website_footer'\n+        ]\n+    ];\n+\n+    public function saveOption(Request $request)\n+    {\n \n         $cleanFromXss = true;\n         $option = $request->all();\n \n-        \/\/ Allow for this keys\n+        \/\/ Allow for this keys and groups\n         if (isset($option['option_key'])) {\n-            if ($option['option_key'] == 'website_head') {\n-                $cleanFromXss = false;\n-            }\n-            if ($option['option_key'] == 'website_footer') {\n-                $cleanFromXss = false;\n+            foreach ($this->whitelistedGroupKeys as $group => $keys) {\n+                if ($option['option_group'] == $group) {\n+                    foreach ($keys as $key) {\n+                        if ($option['option_key'] == $key) {\n+                            $cleanFromXss = false;\n+                            break;\n+                        }\n+                    }\n+                }\n             }\n         }"
    },
    {
      "index":125,
      "vuln_id":"GHSA-rp34-85x3-3764",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/librenms\/librenms\/commit\/135717a9a05c5bf8921f1389cbb469dcbf300bfd'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in librenms Cross-site Scripting (XSS) - Generic in Packagist librenms\/librenms prior to 22.1.0.",
      "published_date":"2022-02-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/librenms\/librenms",
      "commit_href":"https:\/\/github.com\/librenms\/librenms\/commit\/135717a9a05c5bf8921f1389cbb469dcbf300bfd",
      "commit_sha":"135717a9a05c5bf8921f1389cbb469dcbf300bfd",
      "patch":"SINGLE",
      "chain_ord":"['135717a9a05c5bf8921f1389cbb469dcbf300bfd']",
      "before_first_fix_commit":"{'c7b63b574f31efdeaa376d1a1cc0e7da681cba9f'}",
      "last_fix_commit":"135717a9a05c5bf8921f1389cbb469dcbf300bfd",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/13\/2022, 10:00:56",
      "message":"security - XSS Fix 01\n\nfixing https:\/\/huntr.dev\/bounties\/114ba055-a2f0-4db9-aafb-95df944ba177\/ (#13775)",
      "author":"PipoCanaja",
      "comments":null,
      "stats":"{'additions': 3, 'deletions': 3, 'total': 6}",
      "files":"{'includes\/html\/forms\/alert-transports.inc.php': {'additions': 3, 'deletions': 3, 'changes': 6, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/librenms\/librenms\/raw\/135717a9a05c5bf8921f1389cbb469dcbf300bfd\/includes%2Fhtml%2Fforms%2Falert-transports.inc.php', 'patch': \"@@ -34,10 +34,10 @@\\n $status = 'ok';\\n $message = '';\\n \\n-$transport_id = $vars['transport_id'];\\n-$name = $vars['name'];\\n+$transport_id = strip_tags($vars['transport_id']);\\n+$name = strip_tags($vars['name']);\\n $is_default = (int) (isset($vars['is_default']) && $vars['is_default'] == 'on');\\n-$transport_type = $vars['transport-type'];\\n+$transport_type = strip_tags($vars['transport-type']);\\n \\n if (empty($name)) {\\n     $status = 'error';\"}}",
      "message_norm":"security - xss fix 01\n\nfixing https:\/\/huntr.dev\/bounties\/114ba055-a2f0-4db9-aafb-95df944ba177\/ (#13775)",
      "language":"en",
      "entities":"[('security', 'SECWORD', ''), ('xss', 'SECWORD', ''), ('fix', 'ACTION', ''), ('fixing', 'ACTION', ''), ('https:\/\/huntr.dev\/bounties\/114ba055-a2f0-4db9-aafb-95df944ba177\/', 'URL', ''), ('#13775', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['includes\/html\/forms\/alert-transports.inc.php'])",
      "num_files":1.0,
      "patch_content":"From 135717a9a05c5bf8921f1389cbb469dcbf300bfd Mon Sep 17 00:00:00 2001\nFrom: PipoCanaja <38363551+PipoCanaja@users.noreply.github.com>\nDate: Sun, 13 Feb 2022 11:00:56 +0100\nSubject: [PATCH] security - XSS Fix 01\n\nfixing https:\/\/huntr.dev\/bounties\/114ba055-a2f0-4db9-aafb-95df944ba177\/ (#13775)\n---\n includes\/html\/forms\/alert-transports.inc.php | 6 +++---\n 1 file changed, 3 insertions(+), 3 deletions(-)\n\ndiff --git a\/includes\/html\/forms\/alert-transports.inc.php b\/includes\/html\/forms\/alert-transports.inc.php\nindex 9675e9fc4cf2..21190036f3b0 100644\n--- a\/includes\/html\/forms\/alert-transports.inc.php\n+++ b\/includes\/html\/forms\/alert-transports.inc.php\n@@ -34,10 +34,10 @@\n $status = 'ok';\n $message = '';\n \n-$transport_id = $vars['transport_id'];\n-$name = $vars['name'];\n+$transport_id = strip_tags($vars['transport_id']);\n+$name = strip_tags($vars['name']);\n $is_default = (int) (isset($vars['is_default']) && $vars['is_default'] == 'on');\n-$transport_type = $vars['transport-type'];\n+$transport_type = strip_tags($vars['transport-type']);\n \n if (empty($name)) {\n     $status = 'error';",
      "code_diff":"@@ -34,10 +34,10 @@\n $status = 'ok';\n $message = '';\n \n-$transport_id = $vars['transport_id'];\n-$name = $vars['name'];\n+$transport_id = strip_tags($vars['transport_id']);\n+$name = strip_tags($vars['name']);\n $is_default = (int) (isset($vars['is_default']) && $vars['is_default'] == 'on');\n-$transport_type = $vars['transport-type'];\n+$transport_type = strip_tags($vars['transport-type']);\n \n if (empty($name)) {\n     $status = 'error';"
    },
    {
      "index":126,
      "vuln_id":"GHSA-xjfw-5vv5-vjq2",
      "cwe_id":"{'CWE-79', 'CWE-116'}",
      "score":7.4,
      "chain":"{'https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/21906acb5ee2304552f56f9bbdbf8e7d368f7f3a'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Filter Stream Converter Application in XWiki Platform ### Impact\nWe found a possible XSS vector in the `Filter.FilterStreamDescriptorForm` wiki page related to pretty much all the form fields printed in the home page of the application.\n\n### Patches\nThe issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, 13.10.3.\n\n### Workarounds\nThe easiest workaround is to edit the wiki page `Filter.FilterStreamDescriptorForm` (with wiki editor) and change the lines\n\n```\n          <input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$request.get($descriptorId)#else$descriptor.defaultValue#end\"\/>\n        #else\n          <input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$request.get($descriptorId)\"#end\/>\n```\n\ninto\n\n```\n          <input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$escapetool.xml($request.get($descriptorId))#else$descriptor.defaultValue#end\"\/>\n        #else\n          <input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$escapetool.xml($request.get($descriptorId))\"#end\/>\n```",
      "published_date":"2022-06-01",
      "chain_len":1,
      "project":"https:\/\/github.com\/xwiki\/xwiki-platform",
      "commit_href":"https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/21906acb5ee2304552f56f9bbdbf8e7d368f7f3a",
      "commit_sha":"21906acb5ee2304552f56f9bbdbf8e7d368f7f3a",
      "patch":"SINGLE",
      "chain_ord":"['21906acb5ee2304552f56f9bbdbf8e7d368f7f3a']",
      "before_first_fix_commit":"{'eed842a0ea9e263548805b908ebbd362213ce0ea'}",
      "last_fix_commit":"21906acb5ee2304552f56f9bbdbf8e7d368f7f3a",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/04\/2022, 10:33:53",
      "message":"XWIKI-19293: Fix bad escaping",
      "author":"Thomas Mortagne",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'xwiki-platform-core\/xwiki-platform-filter\/xwiki-platform-filter-ui\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/xwiki\/xwiki-platform\/raw\/21906acb5ee2304552f56f9bbdbf8e7d368f7f3a\/xwiki-platform-core%2Fxwiki-platform-filter%2Fxwiki-platform-filter-ui%2Fsrc%2Fmain%2Fresources%2FFilter%2FFilterStreamDescriptorForm.xml', 'patch': '@@ -58,9 +58,9 @@\\n       &lt;dd&gt;\\n         ## TODO: design a real framework to generate form by type\\n         #if (($descriptor.defaultValue || \"$!descriptor.defaultValue\" != \\'\\') &amp;&amp; ($descriptor.type.getName() == \\'boolean\\' || $descriptor.type.getName() == \\'int\\' || $descriptor.type.getName() == \\'java.lang.String\\'))\\n-          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$request.get($descriptorId)#else$descriptor.defaultValue#end\"\/&gt;\\n+          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$escapetool.xml($request.get($descriptorId))#else$descriptor.defaultValue#end\"\/&gt;\\n         #else\\n-          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$request.get($descriptorId)\"#end\/&gt;\\n+          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$escapetool.xml($request.get($descriptorId))\"#end\/&gt;\\n         #end\\n       &lt;\/dd&gt;\\n     #end'}}",
      "message_norm":"xwiki-19293: fix bad escaping",
      "language":"ca",
      "entities":"[('fix', 'ACTION', ''), ('escaping', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['xwiki-platform-core\/xwiki-platform-filter\/xwiki-platform-filter-ui\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml'])",
      "num_files":1.0,
      "patch_content":"From 21906acb5ee2304552f56f9bbdbf8e7d368f7f3a Mon Sep 17 00:00:00 2001\nFrom: Thomas Mortagne <thomas.mortagne@gmail.com>\nDate: Tue, 4 Jan 2022 11:33:53 +0100\nSubject: [PATCH] XWIKI-19293: Fix bad escaping\n\n---\n ...\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml  | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/xwiki-platform-core\/xwiki-platform-filter\/xwiki-platform-filter-ui\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml b\/xwiki-platform-core\/xwiki-platform-filter\/xwiki-platform-filter-ui\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml\nindex d1ab451ee5da..1a38e1e6cc01 100644\n--- a\/xwiki-platform-core\/xwiki-platform-filter\/xwiki-platform-filter-ui\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml\n+++ b\/xwiki-platform-core\/xwiki-platform-filter\/xwiki-platform-filter-ui\/src\/main\/resources\/Filter\/FilterStreamDescriptorForm.xml\n@@ -58,9 +58,9 @@\n       &lt;dd&gt;\n         ## TODO: design a real framework to generate form by type\n         #if (($descriptor.defaultValue || \"$!descriptor.defaultValue\" != '') &amp;&amp; ($descriptor.type.getName() == 'boolean' || $descriptor.type.getName() == 'int' || $descriptor.type.getName() == 'java.lang.String'))\n-          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$request.get($descriptorId)#else$descriptor.defaultValue#end\"\/&gt;\n+          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$escapetool.xml($request.get($descriptorId))#else$descriptor.defaultValue#end\"\/&gt;\n         #else\n-          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$request.get($descriptorId)\"#end\/&gt;\n+          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$escapetool.xml($request.get($descriptorId))\"#end\/&gt;\n         #end\n       &lt;\/dd&gt;\n     #end",
      "code_diff":"@@ -58,9 +58,9 @@\n       &lt;dd&gt;\n         ## TODO: design a real framework to generate form by type\n         #if (($descriptor.defaultValue || \"$!descriptor.defaultValue\" != '') &amp;&amp; ($descriptor.type.getName() == 'boolean' || $descriptor.type.getName() == 'int' || $descriptor.type.getName() == 'java.lang.String'))\n-          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$request.get($descriptorId)#else$descriptor.defaultValue#end\"\/&gt;\n+          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$escapetool.xml($request.get($descriptorId))#else$descriptor.defaultValue#end\"\/&gt;\n         #else\n-          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$request.get($descriptorId)\"#end\/&gt;\n+          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$escapetool.xml($request.get($descriptorId))\"#end\/&gt;\n         #end\n       &lt;\/dd&gt;\n     #end"
    },
    {
      "index":127,
      "vuln_id":"GHSA-qq74-vgcf-54c3",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/e5d575928b1371a7e07b09b6592822298335062a'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc is vulnerable to stored cross-site scripting via viva cshtm file upload in in versions 2.10.3 and prior. A patch is available and anticipated to be part of version 2.10.4.",
      "published_date":"2022-03-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/e5d575928b1371a7e07b09b6592822298335062a",
      "commit_sha":"e5d575928b1371a7e07b09b6592822298335062a",
      "patch":"SINGLE",
      "chain_ord":"['e5d575928b1371a7e07b09b6592822298335062a']",
      "before_first_fix_commit":"{'ba45d19e1d77a7eea866dab30eff5da552694891'}",
      "last_fix_commit":"e5d575928b1371a7e07b09b6592822298335062a",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/14\/2022, 05:07:40",
      "message":"bug",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/e5d575928b1371a7e07b09b6592822298335062a\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -311,6 +311,7 @@ public function isDangerFilename($filename){\\n \\t\\t\\t|| $isDangerStr($filename , \".asa\")\\n \\t\\t\\t|| $isDangerStr($filename , \".cshtml\")\\n \\t\\t\\t|| $isDangerStr($filename , \".axd\")\\n+\\t\\t\\t|| $isDangerStr($filename , \"htm\")\\n \\t\\t) {\\n \\t\\t\\treturn true;\\n \\t\\t}'}}",
      "message_norm":"bug",
      "language":"id",
      "entities":"[('bug', 'FLAW', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From e5d575928b1371a7e07b09b6592822298335062a Mon Sep 17 00:00:00 2001\nFrom: star7th <xing7th@gmail.com>\nDate: Mon, 14 Mar 2022 13:07:40 +0800\nSubject: [PATCH] bug\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex b518b9b57..f7781533d 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -311,6 +311,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".asa\")\n \t\t\t|| $isDangerStr($filename , \".cshtml\")\n \t\t\t|| $isDangerStr($filename , \".axd\")\n+\t\t\t|| $isDangerStr($filename , \"htm\")\n \t\t) {\n \t\t\treturn true;\n \t\t}",
      "code_diff":"@@ -311,6 +311,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".asa\")\n \t\t\t|| $isDangerStr($filename , \".cshtml\")\n \t\t\t|| $isDangerStr($filename , \".axd\")\n+\t\t\t|| $isDangerStr($filename , \"htm\")\n \t\t) {\n \t\t\treturn true;\n \t\t}"
    },
    {
      "index":128,
      "vuln_id":"GHSA-gx6h-936c-vrrr",
      "cwe_id":"{'CWE-79'}",
      "score":7.4,
      "chain":"{'https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/053d957d53f2a543d158f3ab651e390d2728e0b9'}",
      "dataset":"osv",
      "summary":"Cross site scripting in registration template in xwiki-platform ### Impact\n\nWe found a possible XSS vector in the `registerinline.vm` template related to the `xredirect` hidden field. \nThis template is only used in the following conditions:\n  - the wiki must be open to registration for anyone\n  - the wiki must be closed to view for Guest users (more specifically the XWiki.Registration page must be forbidden in View for guest user)\n\nA way to obtain the second condition is when administrators checked the \"Prevent unregistered users from viewing pages, regardless of the page rights\" box in the administration rights.\n\n### Patches\n\nThe issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, 13.10.3.\n\n### Workarounds\n\nThere are two main ways for protecting against this vulnerability, the easiest and the best one is by applying a patch in the `registerinline.vm` template, the patch consists in checking the value of the xredirect field to ensure it matches the following:\n```\n<input type=\"hidden\" name=\"xredirect\" value=\"$escapetool.xml($!request.xredirect)\" \/>\n```\n\nIf for some reason it's not possible to patch this file, another workaround is to ensure \"Prevent unregistered users from viewing pages, regardless of the page rights\" is not checked in the rights and apply a better right scheme using groups and rights on spaces. \n\n### References\n\nhttps:\/\/jira.xwiki.org\/browse\/XWIKI-19291\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Jira XWiki](https:\/\/jira.xwiki.org)\n* Email us at [security mailing list](mailto:security@xwiki.org)",
      "published_date":"2022-02-09",
      "chain_len":1,
      "project":"https:\/\/github.com\/xwiki\/xwiki-platform",
      "commit_href":"https:\/\/github.com\/xwiki\/xwiki-platform\/commit\/053d957d53f2a543d158f3ab651e390d2728e0b9",
      "commit_sha":"053d957d53f2a543d158f3ab651e390d2728e0b9",
      "patch":"SINGLE",
      "chain_ord":"['053d957d53f2a543d158f3ab651e390d2728e0b9']",
      "before_first_fix_commit":"{'9ae3703c535e34d328fd60758f85a8ee358224ca'}",
      "last_fix_commit":"053d957d53f2a543d158f3ab651e390d2728e0b9",
      "chain_ord_pos":1.0,
      "commit_datetime":"01\/04\/2022, 10:09:57",
      "message":"XWIKI-19291: redirect parameter is badly handled in register page\n\n  * Fix the typo",
      "author":"Simon Urli",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'xwiki-platform-core\/xwiki-platform-web\/xwiki-platform-web-templates\/src\/main\/resources\/templates\/registerinline.vm': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/xwiki\/xwiki-platform\/raw\/053d957d53f2a543d158f3ab651e390d2728e0b9\/xwiki-platform-core%2Fxwiki-platform-web%2Fxwiki-platform-web-templates%2Fsrc%2Fmain%2Fresources%2Ftemplates%2Fregisterinline.vm', 'patch': '@@ -45,7 +45,7 @@\\n       <div>\\n         <input type=\"hidden\" name=\"form_token\" value=\"$!services.csrf.token\" \/>\\n         <input type=\"hidden\" name=\"register\" value=\"1\" \/>\\n-        <input type=\"hidden\" name=\"xredirect\" value=\"$!request.xredirect\" \/>\\n+        <input type=\"hidden\" name=\"xredirect\" value=\"$escapetool.xml($!request.xredirect)\" \/>\\n         #set ($class = $xwiki.getClass(\\'XWiki.XWikiUsers\\'))\\n         #set ($obj = $class.newObject())\\n         #set ($serverobj = $class.newObject())'}}",
      "message_norm":"xwiki-19291: redirect parameter is badly handled in register page\n\n  * fix the typo",
      "language":"en",
      "entities":"[('fix', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['xwiki-platform-core\/xwiki-platform-web\/xwiki-platform-web-templates\/src\/main\/resources\/templates\/registerinline.vm'])",
      "num_files":1.0,
      "patch_content":"From 053d957d53f2a543d158f3ab651e390d2728e0b9 Mon Sep 17 00:00:00 2001\nFrom: Simon Urli <simon.urli@xwiki.com>\nDate: Tue, 4 Jan 2022 11:09:57 +0100\nSubject: [PATCH] XWIKI-19291: redirect parameter is badly handled in register\n page\n\n  * Fix the typo\n---\n ...\/src\/main\/resources\/templates\/registerinline.vm              | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/xwiki-platform-core\/xwiki-platform-web\/xwiki-platform-web-templates\/src\/main\/resources\/templates\/registerinline.vm b\/xwiki-platform-core\/xwiki-platform-web\/xwiki-platform-web-templates\/src\/main\/resources\/templates\/registerinline.vm\nindex 2657b2cddf5a..b25f72f1e166 100644\n--- a\/xwiki-platform-core\/xwiki-platform-web\/xwiki-platform-web-templates\/src\/main\/resources\/templates\/registerinline.vm\n+++ b\/xwiki-platform-core\/xwiki-platform-web\/xwiki-platform-web-templates\/src\/main\/resources\/templates\/registerinline.vm\n@@ -45,7 +45,7 @@\n       <div>\n         <input type=\"hidden\" name=\"form_token\" value=\"$!services.csrf.token\" \/>\n         <input type=\"hidden\" name=\"register\" value=\"1\" \/>\n-        <input type=\"hidden\" name=\"xredirect\" value=\"$!request.xredirect\" \/>\n+        <input type=\"hidden\" name=\"xredirect\" value=\"$escapetool.xml($!request.xredirect)\" \/>\n         #set ($class = $xwiki.getClass('XWiki.XWikiUsers'))\n         #set ($obj = $class.newObject())\n         #set ($serverobj = $class.newObject())",
      "code_diff":"@@ -45,7 +45,7 @@\n       <div>\n         <input type=\"hidden\" name=\"form_token\" value=\"$!services.csrf.token\" \/>\n         <input type=\"hidden\" name=\"register\" value=\"1\" \/>\n-        <input type=\"hidden\" name=\"xredirect\" value=\"$!request.xredirect\" \/>\n+        <input type=\"hidden\" name=\"xredirect\" value=\"$escapetool.xml($!request.xredirect)\" \/>\n         #set ($class = $xwiki.getClass('XWiki.XWikiUsers'))\n         #set ($obj = $class.newObject())\n         #set ($serverobj = $class.newObject())"
    },
    {
      "index":129,
      "vuln_id":"GHSA-ff28-f46g-r9g8",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/gogs\/gogs\/commit\/bc77440b301ac8780698be91dff1ac33b7cee850'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Gogs ### Impact\n\nThe malicious user is able to upload a crafted SVG file as the issue attachment to archive XSS. All installations [allow uploading SVG (`text\/xml`) files as issue attachments (non-default)](https:\/\/github.com\/gogs\/gogs\/blob\/e51e01683408e10b3dcd2ace65e259ca7f0fd61b\/conf\/app.ini#L283-L284) are affected.\n\n### Patches\n\nCorrectly setting the Content Security Policy for the serving endpoint. Users should upgrade to 0.12.7 or the latest 0.13.0+dev.\n\n### Workarounds\n\n[Disable uploading SVG files (`text\/xml`) as issue attachments](https:\/\/github.com\/gogs\/gogs\/blob\/e51e01683408e10b3dcd2ace65e259ca7f0fd61b\/conf\/app.ini#L283-L284).\n\n### References\n\nhttps:\/\/huntr.dev\/bounties\/34a12146-3a5d-4efc-a0f8-7a3ae04b198d\/\n\n### For more information\n\nIf you have any questions or comments about this advisory, please post on https:\/\/github.com\/gogs\/gogs\/issues\/6919.",
      "published_date":"2022-05-24",
      "chain_len":1,
      "project":"https:\/\/github.com\/gogs\/gogs",
      "commit_href":"https:\/\/github.com\/gogs\/gogs\/commit\/bc77440b301ac8780698be91dff1ac33b7cee850",
      "commit_sha":"bc77440b301ac8780698be91dff1ac33b7cee850",
      "patch":"SINGLE",
      "chain_ord":"['bc77440b301ac8780698be91dff1ac33b7cee850']",
      "before_first_fix_commit":"{'2a8f561c6413ed7683a3844a8ae6b68d30c0dd08'}",
      "last_fix_commit":"bc77440b301ac8780698be91dff1ac33b7cee850",
      "chain_ord_pos":1.0,
      "commit_datetime":"05\/03\/2022, 09:51:28",
      "message":"attachment: set CSP header in the serving endpoint (#6926)",
      "author":"Joe Chen",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 0, 'total': 1}",
      "files":"{'internal\/cmd\/web.go': {'additions': 1, 'deletions': 0, 'changes': 1, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/gogs\/gogs\/raw\/bc77440b301ac8780698be91dff1ac33b7cee850\/internal%2Fcmd%2Fweb.go', 'patch': '@@ -314,6 +314,7 @@ func runWeb(c *cli.Context) error {\\n \\t\\t\\t\\t}\\n \\t\\t\\t\\tdefer fr.Close()\\n \\n+\\t\\t\\t\\tc.Header().Set(\"Content-Security-Policy\", \"default-src \\'none\\'; style-src \\'unsafe-inline\\'; sandbox\")\\n \\t\\t\\t\\tc.Header().Set(\"Cache-Control\", \"public,max-age=86400\")\\n \\t\\t\\t\\tc.Header().Set(\"Content-Disposition\", fmt.Sprintf(`inline; filename=\"%s\"`, attach.Name))'}}",
      "message_norm":"attachment: set csp header in the serving endpoint (#6926)",
      "language":"en",
      "entities":"[('csp header', 'SECWORD', ''), ('#6926', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['internal\/cmd\/web.go'])",
      "num_files":1.0,
      "patch_content":"From bc77440b301ac8780698be91dff1ac33b7cee850 Mon Sep 17 00:00:00 2001\nFrom: Joe Chen <jc@unknwon.io>\nDate: Tue, 3 May 2022 17:51:28 +0800\nSubject: [PATCH] attachment: set CSP header in the serving endpoint (#6926)\n\n---\n internal\/cmd\/web.go | 1 +\n 1 file changed, 1 insertion(+)\n\ndiff --git a\/internal\/cmd\/web.go b\/internal\/cmd\/web.go\nindex 09c173f40cd..6a64f26ba21 100644\n--- a\/internal\/cmd\/web.go\n+++ b\/internal\/cmd\/web.go\n@@ -314,6 +314,7 @@ func runWeb(c *cli.Context) error {\n \t\t\t\t}\n \t\t\t\tdefer fr.Close()\n \n+\t\t\t\tc.Header().Set(\"Content-Security-Policy\", \"default-src 'none'; style-src 'unsafe-inline'; sandbox\")\n \t\t\t\tc.Header().Set(\"Cache-Control\", \"public,max-age=86400\")\n \t\t\t\tc.Header().Set(\"Content-Disposition\", fmt.Sprintf(`inline; filename=\"%s\"`, attach.Name))",
      "code_diff":"@@ -314,6 +314,7 @@ func runWeb(c *cli.Context) error {\n \t\t\t\t}\n \t\t\t\tdefer fr.Close()\n \n+\t\t\t\tc.Header().Set(\"Content-Security-Policy\", \"default-src 'none'; style-src 'unsafe-inline'; sandbox\")\n \t\t\t\tc.Header().Set(\"Cache-Control\", \"public,max-age=86400\")\n \t\t\t\tc.Header().Set(\"Content-Disposition\", fmt.Sprintf(`inline; filename=\"%s\"`, attach.Name))"
    },
    {
      "index":130,
      "vuln_id":"GHSA-74qp-233x-p5j8",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/apache\/incubator-livy\/commit\/4d8a912699683b973eee76d4e91447d769a0cb0d'}",
      "dataset":"osv",
      "summary":"Cross-site scripting (XSS) in Apache Livy Livy server version 0.7.0-incubating (only) is vulnerable to a cross site scripting issue in the session name. A malicious user could use this flaw to access logs and results of other users' sessions and run jobs with their privileges. This issue is fixed in Livy 0.7.1-incubating.",
      "published_date":"2021-05-13",
      "chain_len":1,
      "project":"https:\/\/github.com\/apache\/incubator-livy",
      "commit_href":"https:\/\/github.com\/apache\/incubator-livy\/commit\/4d8a912699683b973eee76d4e91447d769a0cb0d",
      "commit_sha":"4d8a912699683b973eee76d4e91447d769a0cb0d",
      "patch":"SINGLE",
      "chain_ord":"['4d8a912699683b973eee76d4e91447d769a0cb0d']",
      "before_first_fix_commit":"{'97cf2f75929ef6c152afc468adbead269bd0758f'}",
      "last_fix_commit":"4d8a912699683b973eee76d4e91447d769a0cb0d",
      "chain_ord_pos":1.0,
      "commit_datetime":"08\/15\/2020, 00:25:54",
      "message":"Add html escape to session name\n\n## What changes were proposed in this pull request?\n\nThe PR adds HTML escaping to session names.\n\n## How was this patch tested?\n\nManual test.\n\nAuthor: Marco Gaido <mgaido@apache.org>\n\nCloses #302 from mgaido91\/escape_html.",
      "author":"Marco Gaido",
      "comments":null,
      "stats":"{'additions': 7, 'deletions': 3, 'total': 10}",
      "files":"{'server\/src\/main\/resources\/org\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js': {'additions': 7, 'deletions': 3, 'changes': 10, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/apache\/incubator-livy\/raw\/4d8a912699683b973eee76d4e91447d769a0cb0d\/server%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Flivy%2Fserver%2Fui%2Fstatic%2Fjs%2Fall-sessions.js', 'patch': '@@ -15,13 +15,17 @@\\n  * limitations under the License.\\n  *\/\\n \\n+function escapeHtml(unescapedText) {\\n+  return $(\"<div>\").text(unescapedText).html()\\n+}\\n+\\n function loadSessionsTable(sessions) {\\n   $.each(sessions, function(index, session) {\\n     $(\"#interactive-sessions .sessions-table-body\").append(\\n       \"<tr>\" +\\n         tdWrap(uiLink(\"session\/\" + session.id, session.id)) +\\n         tdWrap(appIdLink(session)) +\\n-        tdWrap(session.name) +\\n+        tdWrap(escapeHtml(session.name)) +\\n         tdWrap(session.owner) +\\n         tdWrap(session.proxyUser) +\\n         tdWrap(session.kind) +\\n@@ -38,7 +42,7 @@ function loadBatchesTable(sessions) {\\n       \"<tr>\" +\\n         tdWrap(session.id) +\\n         tdWrap(appIdLink(session)) +\\n-        tdWrap(session.name) +\\n+        tdWrap(escapeHtml(session.name)) +\\n         tdWrap(session.owner) +\\n         tdWrap(session.proxyUser) +\\n         tdWrap(session.state) +\\n@@ -79,4 +83,4 @@ $(document).ready(function () {\\n       $(\"#all-sessions\").append(\\'<h4>No Sessions or Batches have been created yet.<\/h4>\\');\\n     }\\n   });\\n-});\\n\\\\ No newline at end of file\\n+});'}}",
      "message_norm":"add html escape to session name\n\n## what changes were proposed in this pull request?\n\nthe pr adds html escaping to session names.\n\n## how was this patch tested?\n\nmanual test.\n\nauthor: marco gaido <mgaido@apache.org>\n\ncloses #302 from mgaido91\/escape_html.",
      "language":"en",
      "entities":"[('add', 'ACTION', ''), ('escape', 'SECWORD', ''), ('adds', 'ACTION', ''), ('escaping', 'SECWORD', ''), ('mgaido@apache.org', 'EMAIL', ''), ('#302', 'ISSUE', ''), ('escape_html', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/src\/main\/resources\/org\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js'])",
      "num_files":1.0,
      "patch_content":"From 4d8a912699683b973eee76d4e91447d769a0cb0d Mon Sep 17 00:00:00 2001\nFrom: Marco Gaido <mgaido@apache.org>\nDate: Fri, 14 Aug 2020 17:25:54 -0700\nSubject: [PATCH] Add html escape to session name\n\n## What changes were proposed in this pull request?\n\nThe PR adds HTML escaping to session names.\n\n## How was this patch tested?\n\nManual test.\n\nAuthor: Marco Gaido <mgaido@apache.org>\n\nCloses #302 from mgaido91\/escape_html.\n---\n ...\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js    | 10 +++++++---\n 1 file changed, 7 insertions(+), 3 deletions(-)\n\ndiff --git a\/server\/src\/main\/resources\/org\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js b\/server\/src\/main\/resources\/org\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js\nindex 6e3570204..d8a84a761 100644\n--- a\/server\/src\/main\/resources\/org\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js\n+++ b\/server\/src\/main\/resources\/org\/apache\/livy\/server\/ui\/static\/js\/all-sessions.js\n@@ -15,13 +15,17 @@\n  * limitations under the License.\n  *\/\n \n+function escapeHtml(unescapedText) {\n+  return $(\"<div>\").text(unescapedText).html()\n+}\n+\n function loadSessionsTable(sessions) {\n   $.each(sessions, function(index, session) {\n     $(\"#interactive-sessions .sessions-table-body\").append(\n       \"<tr>\" +\n         tdWrap(uiLink(\"session\/\" + session.id, session.id)) +\n         tdWrap(appIdLink(session)) +\n-        tdWrap(session.name) +\n+        tdWrap(escapeHtml(session.name)) +\n         tdWrap(session.owner) +\n         tdWrap(session.proxyUser) +\n         tdWrap(session.kind) +\n@@ -38,7 +42,7 @@ function loadBatchesTable(sessions) {\n       \"<tr>\" +\n         tdWrap(session.id) +\n         tdWrap(appIdLink(session)) +\n-        tdWrap(session.name) +\n+        tdWrap(escapeHtml(session.name)) +\n         tdWrap(session.owner) +\n         tdWrap(session.proxyUser) +\n         tdWrap(session.state) +\n@@ -79,4 +83,4 @@ $(document).ready(function () {\n       $(\"#all-sessions\").append('<h4>No Sessions or Batches have been created yet.<\/h4>');\n     }\n   });\n-});\n\\ No newline at end of file\n+});",
      "code_diff":"@@ -15,13 +15,17 @@\n  * limitations under the License.\n  *\/\n \n+function escapeHtml(unescapedText) {\n+  return $(\"<div>\").text(unescapedText).html()\n+}\n+\n function loadSessionsTable(sessions) {\n   $.each(sessions, function(index, session) {\n     $(\"#interactive-sessions .sessions-table-body\").append(\n       \"<tr>\" +\n         tdWrap(uiLink(\"session\/\" + session.id, session.id)) +\n         tdWrap(appIdLink(session)) +\n-        tdWrap(session.name) +\n+        tdWrap(escapeHtml(session.name)) +\n         tdWrap(session.owner) +\n         tdWrap(session.proxyUser) +\n         tdWrap(session.kind) +\n@@ -38,7 +42,7 @@ function loadBatchesTable(sessions) {\n       \"<tr>\" +\n         tdWrap(session.id) +\n         tdWrap(appIdLink(session)) +\n-        tdWrap(session.name) +\n+        tdWrap(escapeHtml(session.name)) +\n         tdWrap(session.owner) +\n         tdWrap(session.proxyUser) +\n         tdWrap(session.state) +\n@@ -79,4 +83,4 @@ $(document).ready(function () {\n       $(\"#all-sessions\").append('<h4>No Sessions or Batches have been created yet.<\/h4>');\n     }\n   });\n-});\n\\ No newline at end of file\n+});"
    },
    {
      "index":131,
      "vuln_id":"GHSA-c7pp-g2v2-2766",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/KartikTalwar\/gmail.js\/commit\/a83436f499f9c01b04280af945a5a81137b6baf1'}",
      "dataset":"osv",
      "summary":"DOM-based XSS in gmail-js Affected versions of `gmail-js` are vulnerable to cross-site scripting in the `tools.parse_response`, `helper.get.visible_emails_post`, and `helper.get.email_data_post` functions, which pass user input directly into the Function constructor.\n\n\n\n## Recommendation\n\nUpdate to version 0.6.5 or later.",
      "published_date":"2020-09-01",
      "chain_len":1,
      "project":"https:\/\/github.com\/KartikTalwar\/gmail.js",
      "commit_href":"https:\/\/github.com\/KartikTalwar\/gmail.js\/commit\/a83436f499f9c01b04280af945a5a81137b6baf1",
      "commit_sha":"a83436f499f9c01b04280af945a5a81137b6baf1",
      "patch":"SINGLE",
      "chain_ord":"['a83436f499f9c01b04280af945a5a81137b6baf1']",
      "before_first_fix_commit":"{'0e4732cb6c6c447d7f0487580ad7ada33184be92'}",
      "last_fix_commit":"a83436f499f9c01b04280af945a5a81137b6baf1",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/29\/2016, 08:36:02",
      "message":"Replace new Function() with JSON.parse()",
      "author":"Jostein Kj\u00f8nigsen",
      "comments":null,
      "stats":"{'additions': 8, 'deletions': 15, 'total': 23}",
      "files":"{'src\/gmail.js': {'additions': 8, 'deletions': 15, 'changes': 23, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/KartikTalwar\/gmail.js\/raw\/a83436f499f9c01b04280af945a5a81137b6baf1\/src%2Fgmail.js', 'patch': '@@ -891,10 +891,8 @@ var Gmail_ = function(localJQuery) {\\n                 endIndex = (parseInt(dataLength, 10) - 2) + response.indexOf(\"[\");\\n                 data = response.substring(response.indexOf(\"[\"), endIndex);\\n \\n-                var get_data = new Function(\"\\\\\"use strict\\\\\"; return \" + data);\\n-                realData = get_data();\\n-\\n-                parsedResponse.push(realData);\\n+                var json = JSON.parse(data);\\n+                parsedResponse.push(json);\\n \\n                 \/\/ prepare response for next loop\\n                 response = response.substring(response.indexOf(\"[\"), response.length);\\n@@ -1684,11 +1682,9 @@ var Gmail_ = function(localJQuery) {\\n             return emails;\\n         }\\n \\n-        get_data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\\n-        get_data = \"\\\\\"use strict\\\\\"; return \" + get_data;\\n-        get_data = new Function(get_data);\\n-\\n-        api.tracker.view_data = get_data();\\n+        var data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\\n+        var json = JSON.parse(data);\\n+        api.tracker.view_data = json;\\n \\n         for(var i in api.tracker.view_data) {\\n             if (typeof(api.tracker.view_data[i]) === \"function\") {\\n@@ -1934,13 +1930,10 @@ var Gmail_ = function(localJQuery) {\\n         if (!get_data) {\\n             return {};\\n         }\\n-        get_data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\\n-        get_data = \"\\\\\"use strict\\\\\"; return \" + get_data;\\n-        get_data = new Function(get_data);\\n-\\n-        var cdata = get_data();\\n+        var data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\\n+        var json = JSON.parse(data);\\n \\n-        api.tracker.email_data = cdata[0];\\n+        api.tracker.email_data = json[0];\\n         return api.tools.parse_email_data(api.tracker.email_data);\\n     };'}}",
      "message_norm":"replace new function() with json.parse()",
      "language":"en",
      "entities":null,
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/gmail.js'])",
      "num_files":1.0,
      "patch_content":"From a83436f499f9c01b04280af945a5a81137b6baf1 Mon Sep 17 00:00:00 2001\nFrom: =?UTF-8?q?Jostein=20Kj=C3=B8nigsen?= <jostein@kjonigsen.net>\nDate: Tue, 29 Nov 2016 09:36:02 +0100\nSubject: [PATCH] Replace new Function() with JSON.parse()\n\n---\n src\/gmail.js | 23 ++++++++---------------\n 1 file changed, 8 insertions(+), 15 deletions(-)\n\ndiff --git a\/src\/gmail.js b\/src\/gmail.js\nindex 125ef4e2..3a09364f 100755\n--- a\/src\/gmail.js\n+++ b\/src\/gmail.js\n@@ -891,10 +891,8 @@ var Gmail_ = function(localJQuery) {\n                 endIndex = (parseInt(dataLength, 10) - 2) + response.indexOf(\"[\");\n                 data = response.substring(response.indexOf(\"[\"), endIndex);\n \n-                var get_data = new Function(\"\\\"use strict\\\"; return \" + data);\n-                realData = get_data();\n-\n-                parsedResponse.push(realData);\n+                var json = JSON.parse(data);\n+                parsedResponse.push(json);\n \n                 \/\/ prepare response for next loop\n                 response = response.substring(response.indexOf(\"[\"), response.length);\n@@ -1684,11 +1682,9 @@ var Gmail_ = function(localJQuery) {\n             return emails;\n         }\n \n-        get_data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n-        get_data = \"\\\"use strict\\\"; return \" + get_data;\n-        get_data = new Function(get_data);\n-\n-        api.tracker.view_data = get_data();\n+        var data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n+        var json = JSON.parse(data);\n+        api.tracker.view_data = json;\n \n         for(var i in api.tracker.view_data) {\n             if (typeof(api.tracker.view_data[i]) === \"function\") {\n@@ -1934,13 +1930,10 @@ var Gmail_ = function(localJQuery) {\n         if (!get_data) {\n             return {};\n         }\n-        get_data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n-        get_data = \"\\\"use strict\\\"; return \" + get_data;\n-        get_data = new Function(get_data);\n-\n-        var cdata = get_data();\n+        var data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n+        var json = JSON.parse(data);\n \n-        api.tracker.email_data = cdata[0];\n+        api.tracker.email_data = json[0];\n         return api.tools.parse_email_data(api.tracker.email_data);\n     };",
      "code_diff":"@@ -891,10 +891,8 @@ var Gmail_ = function(localJQuery) {\n                 endIndex = (parseInt(dataLength, 10) - 2) + response.indexOf(\"[\");\n                 data = response.substring(response.indexOf(\"[\"), endIndex);\n \n-                var get_data = new Function(\"\\\"use strict\\\"; return \" + data);\n-                realData = get_data();\n-\n-                parsedResponse.push(realData);\n+                var json = JSON.parse(data);\n+                parsedResponse.push(json);\n \n                 \/\/ prepare response for next loop\n                 response = response.substring(response.indexOf(\"[\"), response.length);\n@@ -1684,11 +1682,9 @@ var Gmail_ = function(localJQuery) {\n             return emails;\n         }\n \n-        get_data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n-        get_data = \"\\\"use strict\\\"; return \" + get_data;\n-        get_data = new Function(get_data);\n-\n-        api.tracker.view_data = get_data();\n+        var data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n+        var json = JSON.parse(data);\n+        api.tracker.view_data = json;\n \n         for(var i in api.tracker.view_data) {\n             if (typeof(api.tracker.view_data[i]) === \"function\") {\n@@ -1934,13 +1930,10 @@ var Gmail_ = function(localJQuery) {\n         if (!get_data) {\n             return {};\n         }\n-        get_data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n-        get_data = \"\\\"use strict\\\"; return \" + get_data;\n-        get_data = new Function(get_data);\n-\n-        var cdata = get_data();\n+        var data = get_data.substring(get_data.indexOf(\"[\"), get_data.length);\n+        var json = JSON.parse(data);\n \n-        api.tracker.email_data = cdata[0];\n+        api.tracker.email_data = json[0];\n         return api.tools.parse_email_data(api.tracker.email_data);\n     };"
    },
    {
      "index":132,
      "vuln_id":"GHSA-c558-5gfm-p2r8",
      "cwe_id":"{'CWE-79'}",
      "score":7.1,
      "chain":"{'https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7', 'https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a'}",
      "dataset":"osv",
      "summary":"JSPUI spellcheck and autocomplete tools vulnerable to Cross Site Scripting ### Impact\nThe JSPUI spellcheck \"Did you mean\" HTML escapes the data-spell attribute in the link, but not the actual displayed text.  Similarly, the JSPUI autocomplete HTML does not properly escape text passed to it. Both are vulnerable to XSS.  This vulnerability only impacts the JSPUI.\n\n_This vulnerability does NOT impact the XMLUI or 7.x._\n\n### Patches\n_DSpace 6.x:_\n* Fixed in 6.4 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7\n* 6.x patch files available (may be applied manually if an immediate upgrade to 6.4 or above is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/ebb83a75234d3de9be129464013e998dc929b68d.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/35030a23e48b5946f5853332c797e1c4adea7bb7.patch\n\n_DSpace 5.x:_\n* Fixed in 5.11 via two commits: \n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5\n* 5.x patch files available (may be applied manually if an immediate upgrade to 5.11 or 6.4 is not possible)\n    * Fix for spellcheck: https:\/\/github.com\/DSpace\/DSpace\/commit\/c89e493e517b424dea6175caba54e91d3847fc3a.patch\n    * Fix for autocomplete: https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5.patch\n\n#### Apply the patch to your DSpace\nIf at all possible, we recommend upgrading your DSpace site based on the upgrade instructions. However, if you are unable to do so, you can manually apply the above patches as follows:\n1. Download the appropriate patch file to the machine where DSpace is running\n2. From the `[dspace-src]` folder, apply the patch, e.g. `git apply [name-of-file].patch`\n3. Now, update your DSpace site (based loosely on the Upgrade instructions). This generally involves three steps:\n    1. Rebuild DSpace, e.g. `mvn -U clean package`  (This will recompile all DSpace code)\n    2. Redeploy DSpace, e.g. `ant update`  (This will copy all updated WARs \/ configs to your installation directory). Depending on your setup you also may need to copy the updated WARs over to your Tomcat webapps folder.\n    3. Restart Tomcat\n\n### References\nDiscovered & reported by Hassan Bhuiyan (Brunel University London)\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Email us at security@dspace.org",
      "published_date":"2022-08-06",
      "chain_len":4,
      "project":"https:\/\/github.com\/DSpace\/DSpace",
      "commit_href":"https:\/\/github.com\/DSpace\/DSpace\/commit\/6f75bb084ab1937d094208c55cd84340040bcbb5",
      "commit_sha":"6f75bb084ab1937d094208c55cd84340040bcbb5",
      "patch":"MULTI",
      "chain_ord":"['ebb83a75234d3de9be129464013e998dc929b68d', '35030a23e48b5946f5853332c797e1c4adea7bb7', 'c89e493e517b424dea6175caba54e91d3847fc3a', '6f75bb084ab1937d094208c55cd84340040bcbb5']",
      "before_first_fix_commit":"{'d1dd7d23329ef055069759df15cfa200c8e32e54'}",
      "last_fix_commit":"6f75bb084ab1937d094208c55cd84340040bcbb5",
      "chain_ord_pos":4.0,
      "commit_datetime":"07\/26\/2022, 21:12:22",
      "message":"[DS-4453] Discovery autocomplete HTML escaping (JSPUI)",
      "author":"Kim Shepherd",
      "comments":null,
      "stats":"{'additions': 7, 'deletions': 2, 'total': 9}",
      "files":"{'dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp': {'additions': 7, 'deletions': 2, 'changes': 9, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/DSpace\/DSpace\/raw\/6f75bb084ab1937d094208c55cd84340040bcbb5\/dspace-jspui%2Fsrc%2Fmain%2Fwebapp%2Fsearch%2Fdiscovery.jsp', 'patch': '@@ -141,7 +141,7 @@\\n \\t\\t\\t\\t\\t\\t\\t\\t\\ttmp_val = item.displayedValue;\\n \\t\\t\\t\\t\\t\\t\\t\\t}\\n \\t\\t\\t\\t\\t\\t\\t\\treturn {\\n-\\t\\t\\t\\t\\t\\t\\t\\t\\tlabel: item.displayedValue + \" (\" + item.count + \")\",\\n+\\t\\t\\t\\t\\t\\t\\t\\t\\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\\n \\t\\t\\t\\t\\t\\t\\t\\t\\tvalue: tmp_val\\n \\t\\t\\t\\t\\t\\t\\t\\t};\\n \\t\\t\\t\\t\\t\\t\\t}))\\t\\t\\t\\n@@ -153,7 +153,12 @@\\n \\tfunction validateFilters() {\\n \\t\\treturn document.getElementById(\"filterquery\").value.length > 0;\\n \\t}\\n-<\/script>\\t\\t\\n+\\t\/\/ Generic HTML escape utility\\n+\\tvar escapeHtml = s => (s + \\'\\').replace(\/[&<>\"\\']\/g, m => ({\\n+\\t\\t\\'&\\': \\'&amp;\\', \\'<\\': \\'&lt;\\', \\'>\\': \\'&gt;\\',\\n+\\t\\t\\'\"\\': \\'&quot;\\', \"\\'\": \\'&#39;\\'\\n+\\t})[m]);\\n+<\/script>\\n <\/c:set>\\n \\n <dspace:layout titlekey=\"jsp.search.title\">'}}",
      "message_norm":"[ds-4453] discovery autocomplete html escaping (jspui)",
      "language":"it",
      "entities":"[('escaping', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp'])",
      "num_files":1.0,
      "patch_content":"From 6f75bb084ab1937d094208c55cd84340040bcbb5 Mon Sep 17 00:00:00 2001\nFrom: Kim Shepherd <kim@shepherd.nz>\nDate: Wed, 27 Jul 2022 09:12:22 +1200\nSubject: [PATCH] [DS-4453] Discovery autocomplete HTML escaping (JSPUI)\n\n---\n dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp | 9 +++++++--\n 1 file changed, 7 insertions(+), 2 deletions(-)\n\ndiff --git a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\nindex ec97afb90fc7..154e014add85 100644\n--- a\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n+++ b\/dspace-jspui\/src\/main\/webapp\/search\/discovery.jsp\n@@ -141,7 +141,7 @@\n \t\t\t\t\t\t\t\t\ttmp_val = item.displayedValue;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\treturn {\n-\t\t\t\t\t\t\t\t\tlabel: item.displayedValue + \" (\" + item.count + \")\",\n+\t\t\t\t\t\t\t\t\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\n \t\t\t\t\t\t\t\t\tvalue: tmp_val\n \t\t\t\t\t\t\t\t};\n \t\t\t\t\t\t\t}))\t\t\t\n@@ -153,7 +153,12 @@\n \tfunction validateFilters() {\n \t\treturn document.getElementById(\"filterquery\").value.length > 0;\n \t}\n-<\/script>\t\t\n+\t\/\/ Generic HTML escape utility\n+\tvar escapeHtml = s => (s + '').replace(\/[&<>\"']\/g, m => ({\n+\t\t'&': '&amp;', '<': '&lt;', '>': '&gt;',\n+\t\t'\"': '&quot;', \"'\": '&#39;'\n+\t})[m]);\n+<\/script>\n <\/c:set>\n \n <dspace:layout titlekey=\"jsp.search.title\">",
      "code_diff":"@@ -141,7 +141,7 @@\n \t\t\t\t\t\t\t\t\ttmp_val = item.displayedValue;\n \t\t\t\t\t\t\t\t}\n \t\t\t\t\t\t\t\treturn {\n-\t\t\t\t\t\t\t\t\tlabel: item.displayedValue + \" (\" + item.count + \")\",\n+\t\t\t\t\t\t\t\t\tlabel: escapeHtml(item.displayedValue) + \" (\" + item.count + \")\",\n \t\t\t\t\t\t\t\t\tvalue: tmp_val\n \t\t\t\t\t\t\t\t};\n \t\t\t\t\t\t\t}))\t\t\t\n@@ -153,7 +153,12 @@\n \tfunction validateFilters() {\n \t\treturn document.getElementById(\"filterquery\").value.length > 0;\n \t}\n-<\/script>\t\t\n+\t\/\/ Generic HTML escape utility\n+\tvar escapeHtml = s => (s + '').replace(\/[&<>\"']\/g, m => ({\n+\t\t'&': '&amp;', '<': '&lt;', '>': '&gt;',\n+\t\t'\"': '&quot;', \"'\": '&#39;'\n+\t})[m]);\n+<\/script>\n <\/c:set>\n \n <dspace:layout titlekey=\"jsp.search.title\">"
    },
    {
      "index":133,
      "vuln_id":"GHSA-gj85-pvp5-mvf9",
      "cwe_id":"{'CWE-79'}",
      "score":6.1,
      "chain":"{'https:\/\/github.com\/ptrofimov\/beanstalk_console\/commit\/e351c8260ec1d3718d9e475ee57c7e12c47f19da'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Beanstalk console Beanstalk console prior to version 1.7.12 is vulnerable to cross-site scripting.",
      "published_date":"2022-02-06",
      "chain_len":1,
      "project":"https:\/\/github.com\/ptrofimov\/beanstalk_console",
      "commit_href":"https:\/\/github.com\/ptrofimov\/beanstalk_console\/commit\/e351c8260ec1d3718d9e475ee57c7e12c47f19da",
      "commit_sha":"e351c8260ec1d3718d9e475ee57c7e12c47f19da",
      "patch":"SINGLE",
      "chain_ord":"['e351c8260ec1d3718d9e475ee57c7e12c47f19da']",
      "before_first_fix_commit":"{'95d5808836034835fc33500c6a82276277fabdf9'}",
      "last_fix_commit":"e351c8260ec1d3718d9e475ee57c7e12c47f19da",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/01\/2022, 15:43:02",
      "message":"Sanitize input",
      "author":"Nav-Prak",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'lib\/include.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/ptrofimov\/beanstalk_console\/raw\/e351c8260ec1d3718d9e475ee57c7e12c47f19da\/lib%2Finclude.php', 'patch': \"@@ -19,7 +19,7 @@ function autoload_class($class) {\\n require_once dirname(__FILE__) . '\/..\/config.php';\\r\\n require_once dirname(__FILE__) . '\/..\/src\/Storage.php';\\r\\n \\r\\n-$GLOBALS['server'] = !empty($_GET['server']) ? $_GET['server'] : '';\\r\\n+$GLOBALS['server'] = !empty($_GET['server']) ? htmlspecialchars($_GET['server']) : '';\\r\\n $GLOBALS['action'] = !empty($_GET['action']) ? $_GET['action'] : '';\\r\\n $GLOBALS['state'] = !empty($_GET['state']) ? $_GET['state'] : '';\\r\\n $GLOBALS['count'] = !empty($_GET['count']) ? $_GET['count'] : '';\"}}",
      "message_norm":"sanitize input",
      "language":"ro",
      "entities":"[('sanitize', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['lib\/include.php'])",
      "num_files":1.0,
      "patch_content":"From e351c8260ec1d3718d9e475ee57c7e12c47f19da Mon Sep 17 00:00:00 2001\nFrom: Nav-Prak <54226343+Nav-Prak@users.noreply.github.com>\nDate: Tue, 1 Feb 2022 21:13:02 +0530\nSubject: [PATCH] Sanitize input\n\n---\n lib\/include.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/lib\/include.php b\/lib\/include.php\nindex 97b5aea..2e0ba6a 100644\n--- a\/lib\/include.php\n+++ b\/lib\/include.php\n@@ -19,7 +19,7 @@ function autoload_class($class) {\n require_once dirname(__FILE__) . '\/..\/config.php';\r\n require_once dirname(__FILE__) . '\/..\/src\/Storage.php';\r\n \r\n-$GLOBALS['server'] = !empty($_GET['server']) ? $_GET['server'] : '';\r\n+$GLOBALS['server'] = !empty($_GET['server']) ? htmlspecialchars($_GET['server']) : '';\r\n $GLOBALS['action'] = !empty($_GET['action']) ? $_GET['action'] : '';\r\n $GLOBALS['state'] = !empty($_GET['state']) ? $_GET['state'] : '';\r\n $GLOBALS['count'] = !empty($_GET['count']) ? $_GET['count'] : '';",
      "code_diff":"@@ -19,7 +19,7 @@ function autoload_class($class) {\n require_once dirname(__FILE__) . '\/..\/config.php';\n require_once dirname(__FILE__) . '\/..\/src\/Storage.php';\n \n-$GLOBALS['server'] = !empty($_GET['server']) ? $_GET['server'] : '';\n+$GLOBALS['server'] = !empty($_GET['server']) ? htmlspecialchars($_GET['server']) : '';\n $GLOBALS['action'] = !empty($_GET['action']) ? $_GET['action'] : '';\n $GLOBALS['state'] = !empty($_GET['state']) ? $_GET['state'] : '';\n $GLOBALS['count'] = !empty($_GET['count']) ? $_GET['count'] : '';"
    },
    {
      "index":134,
      "vuln_id":"GHSA-3j9m-hcv9-rpj8",
      "cwe_id":"{'CWE-79'}",
      "score":6.9,
      "chain":"{'https:\/\/github.com\/grafana\/grafana\/commit\/3cb5214fa45eb5a571fd70d6c6edf0d729983f82', 'https:\/\/github.com\/grafana\/grafana\/commit\/fb85ed691290d211a5baa44d9a641ab137f0de88', 'https:\/\/github.com\/grafana\/grafana\/commit\/31b78d51c693d828720a5b285107a50e6024c912'}",
      "dataset":"osv",
      "summary":"XSS vulnerability allowing arbitrary JavaScript execution Today we are releasing Grafana 8.2.3. This patch release includes an important security fix for an issue that affects all Grafana versions from 8.0.0-beta1.\n\n[Grafana Cloud](https:\/\/grafana.com\/cloud) instances have already been patched and an audit did not find any usage of this attack vector. [Grafana Enterprise](https:\/\/grafana.com\/products\/enterprise) customers were provided with updated binaries under embargo.\n\n## CVE-2021-41174 XSS vulnerability on unauthenticated pages\n\n### Summary\n\nCVSS Score: 6.9 Medium\nCVSS:[CVSS:3.0\/AV:N\/AC:H\/PR:N\/UI:R\/S:C\/C:L\/I:H\/A:N\/E:U\/RL:O\/RC:R\/CR:L\/MAV:N\/MAC:H\/MPR:N\/MUI:R\/MS:C\/MC:N\/MI:H\/MA:L](https:\/\/www.first.org\/cvss\/calculator\/3.0#CVSS:3.0\/AV:N\/AC:H\/PR:N\/UI:R\/S:C\/C:L\/I:H\/A:N\/E:U\/RL:O\/RC:R\/CR:L\/MAV:N\/MAC:H\/MPR:N\/MUI:R\/MS:C\/MC:N\/MI:H\/MA:L)\n\nWe received a security report to security@grafana.com on 2021-10-21 about a vulnerability in Grafana regarding the XSS vulnerability.\n\nIt was later identified as affecting Grafana versions from 8.0.0-beta1 to 8.2.2. [CVE-2021-41174](https:\/\/cve.mitre.org\/cgi-bin\/cvename.cgi?name=CVE-2021-41174) has been assigned to this vulnerability.\n\n### Impact\n\nIf an attacker is able to convince a victim to visit a URL referencing a vulnerable page, arbitrary JavaScript content may be executed within the context of the victim's browser.\n\nThe user visiting the malicious link must be unauthenticated and the link must be for a page that contains the login button in the menu bar.\n\nThere are two ways an unauthenticated user can open a page in Grafana that contains the login button:\n- Anonymous authentication is enabled. This means all pages in Grafana would be open for the attack.\n- The link is to an unauthenticated page. The following pages are vulnerable:\n  - `\/dashboard-solo\/snapshot\/*`\n  - `\/dashboard\/snapshot\/*`\n  - `\/invite\/:code`\n\nThe url has to be crafted to exploit AngularJS rendering and contain the interpolation binding for AngularJS expressions. AngularJS uses double curly braces for interpolation binding: {{ }} \n\nAn example of an expression would be: `{{constructor.constructor(\u2018alert(1)\u2019)()}}`. This can be included in the link URL like this: \n\nhttps:\/\/play.grafana.org\/dashboard\/snapshot\/%7B%7Bconstructor.constructor('alert(1)')()%7D%7D?orgId=1\n\nWhen the user follows the link and the page renders, the login button will contain the original link with a query parameter to force a redirect to the login page. The URL is not validated and the AngularJS rendering engine will execute the JavaScript expression contained in the URL.\n\n### Attack audit\n\nWe can not guarantee that the below will identify all attacks, so if you find something using the audit process described below, you should consider doing a full assessment.\n\n#### Through reverse proxy\/load balancer logs\n\nTo determine if your Grafana installation has been exploited for this vulnerability, search through your reverse proxy\/load balancer access logs for instances where the path contains `{{` followed by something that would invoke JavaScript code. For example, this could be code that attempts to show a fake login page or to steal browser or session data. The [OWASP cheat sheet](https:\/\/cheatsheetseries.owasp.org\/cheatsheets\/XSS_Filter_Evasion_Cheat_Sheet.html) has several examples of XSS attacks.\n\n#### Through the Grafana Enterprise audit feature\n\nIf you enabled \u201cLog web requests\u201d in your configuration with `router_logging = true`, look for requests where `path` contains `{{` followed by something that would invoke JavaScript code.\n\n### Patched versions\n\nRelease 8.2.3:\n\n- [Download Grafana 8.2.3](https:\/\/grafana.com\/grafana\/download\/8.2.3)\n- [Release notes](https:\/\/grafana.com\/docs\/grafana\/latest\/release-notes\/release-notes-8-2-3\/)\n\n### Solutions and mitigations\n\nDownload and install the appropriate patch for your version of Grafana.\n\n[Grafana Cloud](https:\/\/grafana.com\/cloud) instances have already been patched, and [Grafana Enterprise](https:\/\/grafana.com\/products\/enterprise) customers were provided with updated binaries under embargo.\n\n### Workaround\n\nIf for some reason you cannot upgrade, you can use a reverse proxy or similar to block access to block the literal string `{{` in the path.\n\nExample of an Nginx rule to block the literal string `{{`:\n\n```\nlocation ~ \\{\\{ {\n    deny all;\n}\n```\n### Timeline and postmortem\n\nHere is a detailed timeline starting from when we originally learned of the issue. All times in UTC. \n\n* 2021-10-21 23:13: Security researcher sends the initial report about an XSS vulnerability.\n* 2021-10-21 23:13: Confirmed to be reproducible in at least versions 8.0.5 and 8.2.2.\n* 2021-10-22 02:02 MEDIUM severity declared.\n* 2021-10-22 09:22: it is discovered that Grafana instances with anonymous auth turned on are vulnerable. This includes https:\/\/play.grafana.org\/ .\n* 2021-10-22 09:50: Anonymous access disabled for all instances on Grafana Cloud as a mitigation measure.\n* 2021-10-22 11:15: Workaround deployed on Grafana Cloud that blocks malicious requests.\n* 2021-10-22 12:35: Enabled anonymous access for instances on Grafana Cloud. \n* 2021-10-22 12:51: All instances protected by the workaround. From this point forward, Grafana Cloud is no longer affected.\n* 2021-10-22 14:05 Grafana Cloud instances updated with a fix.\n* 2021-10-22 19:23 :Determination that no weekend work is needed as the issue is of MEDIUM severity and the root cause has been identified.\n* 2021-10-25 14:13: Audit of Grafana Cloud concluded, no evidence of exploitation.\n* 2021-10-27 12:00: Grafana Enterprise images released to customers under embargo.\n* 2021-11-03 12:00: Public release.\n\n## Reporting security issues\n\nIf you think you have found a security vulnerability, please send a report to [security@grafana.com](mailto:security@grafana.com). This address can be used for all of\nGrafana Labs' open source and commercial products (including but not limited to Grafana, Tempo, Loki, k6, Tanka, and  Grafana Cloud, Grafana Enterprise, and grafana.com). We only accept vulnerability reports at this address. We would prefer that you encrypt your message to us using our PGP key. The key fingerprint is:\n\nF988 7BEA 027A 049F AE8E  5CAA D125 8932 BE24 C5CA\n\nThe key is available from [ keyserver.ubuntu.com]( https:\/\/keyserver.ubuntu.com\/pks\/lookup?op=get&fingerprint=on&search=0xD1258932BE24C5CA) by searching for [security@grafana]( https:\/\/keyserver.ubuntu.com\/pks\/lookup?search=security@grafana&fingerprint=on&op=index).\n\n## Security announcements\n\nThere is a Security [category](https:\/\/grafana.com\/tags\/security\/) on the Grafana blog where we will post a summary, remediation, and mitigation details for any patch containing security fixes and you can subscribe to updates from our [Security Announcements RSS feed](https:\/\/grafana.com\/tags\/security\/index.xml).",
      "published_date":"2021-11-08",
      "chain_len":3,
      "project":"https:\/\/github.com\/grafana\/grafana",
      "commit_href":"https:\/\/github.com\/grafana\/grafana\/commit\/3cb5214fa45eb5a571fd70d6c6edf0d729983f82",
      "commit_sha":"3cb5214fa45eb5a571fd70d6c6edf0d729983f82",
      "patch":"MULTI",
      "chain_ord":"['31b78d51c693d828720a5b285107a50e6024c912', '3cb5214fa45eb5a571fd70d6c6edf0d729983f82', 'fb85ed691290d211a5baa44d9a641ab137f0de88']",
      "before_first_fix_commit":"{'3cb5214fa45eb5a571fd70d6c6edf0d729983f82', 'a3dc30546fce2e437d858c140f1ff307a04365d6'}",
      "last_fix_commit":"fb85ed691290d211a5baa44d9a641ab137f0de88",
      "chain_ord_pos":2.0,
      "commit_datetime":"10\/25\/2021, 07:16:51",
      "message":"Merge pull request #151 from grafana\/dcech\/sanitize-replaceAll\n\nuse global replace when sanitizing urls in 8.2.3",
      "author":"Dimitris Sotirakis",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'packages\/grafana-data\/src\/text\/sanitize.ts': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/grafana\/grafana\/raw\/3cb5214fa45eb5a571fd70d6c6edf0d729983f82\/packages%2Fgrafana-data%2Fsrc%2Ftext%2Fsanitize.ts', 'patch': \"@@ -40,5 +40,5 @@ export function escapeHtml(str: string): string {\\n }\\n \\n export function sanitizeAngularInterpolation(url: string): string {\\n-  return url.replace('{{', '%7B%7B').replace('}}', '%7D%7D');\\n+  return url.replace(\/\\\\{\\\\{\/g, '%7B%7B').replace(\/\\\\}\\\\}\/g, '%7D%7D');\\n }\"}}",
      "message_norm":"merge pull request #151 from grafana\/dcech\/sanitize-replaceall\n\nuse global replace when sanitizing urls in 8.2.3",
      "language":"en",
      "entities":"[('#151', 'ISSUE', ''), ('sanitize', 'SECWORD', ''), ('sanitizing', 'SECWORD', ''), ('8.2.3', 'VERSION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['packages\/grafana-data\/src\/text\/sanitize.ts'])",
      "num_files":1.0,
      "patch_content":"From 8081dc9ee913a1bf4b98f99e78661db88a6dc1ef Mon Sep 17 00:00:00 2001\nFrom: Dan Cech <dcech@grafana.com>\nDate: Fri, 22 Oct 2021 15:23:06 -0400\nSubject: [PATCH 1\/2] use replaceAll when sanitizing urls\n\n---\n packages\/grafana-data\/src\/text\/sanitize.ts | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/packages\/grafana-data\/src\/text\/sanitize.ts b\/packages\/grafana-data\/src\/text\/sanitize.ts\nindex 6313d0db1388..4e8fa135fa8a 100644\n--- a\/packages\/grafana-data\/src\/text\/sanitize.ts\n+++ b\/packages\/grafana-data\/src\/text\/sanitize.ts\n@@ -40,5 +40,5 @@ export function escapeHtml(str: string): string {\n }\n \n export function sanitizeAngularInterpolation(url: string): string {\n-  return url.replace('{{', '%7B%7B').replace('}}', '%7D%7D');\n+  return url.replaceAll('{{', '%7B%7B').replaceAll('}}', '%7D%7D');\n }\n\nFrom 1c7ce348ce4363c55992ed5772f96981d1a86f7e Mon Sep 17 00:00:00 2001\nFrom: Dan Cech <dcech@grafana.com>\nDate: Fri, 22 Oct 2021 16:40:45 -0400\nSubject: [PATCH 2\/2] switch to global regexp\n\n---\n packages\/grafana-data\/src\/text\/sanitize.ts | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/packages\/grafana-data\/src\/text\/sanitize.ts b\/packages\/grafana-data\/src\/text\/sanitize.ts\nindex 4e8fa135fa8a..ae14afed4223 100644\n--- a\/packages\/grafana-data\/src\/text\/sanitize.ts\n+++ b\/packages\/grafana-data\/src\/text\/sanitize.ts\n@@ -40,5 +40,5 @@ export function escapeHtml(str: string): string {\n }\n \n export function sanitizeAngularInterpolation(url: string): string {\n-  return url.replaceAll('{{', '%7B%7B').replaceAll('}}', '%7D%7D');\n+  return url.replace(\/\\{\\{\/g, '%7B%7B').replace(\/\\}\\}\/g, '%7D%7D');\n }",
      "code_diff":"@@ -40,5 +40,5 @@ export function escapeHtml(str: string): string {\n }\n \n export function sanitizeAngularInterpolation(url: string): string {\n-  return url.replace('{{', '%7B%7B').replace('}}', '%7D%7D');\n+  return url.replaceAll('{{', '%7B%7B').replaceAll('}}', '%7D%7D');\n }\n\nFrom: Dan Cech <dcech@grafana.com>\n\n packages\/grafana-data\/src\/text\/sanitize.ts | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\n@@ -40,5 +40,5 @@ export function escapeHtml(str: string): string {\n }\n \n export function sanitizeAngularInterpolation(url: string): string {\n-  return url.replaceAll('{{', '%7B%7B').replaceAll('}}', '%7D%7D');\n+  return url.replace(\/\\{\\{\/g, '%7B%7B').replace(\/\\}\\}\/g, '%7D%7D');\n }"
    },
    {
      "index":135,
      "vuln_id":"GHSA-hm45-mgqm-gjm4",
      "cwe_id":"{'CWE-79'}",
      "score":7.7,
      "chain":"{'https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/commit\/a6b9785338003ec87fb75305e7d1cc2d40c7ab91', 'https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/commit\/99d88b840674674166ce005b784ae8e31e955ab1'}",
      "dataset":"osv",
      "summary":"Remote Code Execution (RCE) Exploit on Cross Site Scripting (XSS) Vulnerability ### Impact\nA RCE exploit has been discovered in the Red Discord Bot - Dashboard Webserver: this exploit allows Discord users with specially crafted Server names and Usernames\/Nicknames to inject code into the webserver front-end code.  By abusing this exploit, it's possible to perform destructive actions and\/or access sensitive information.\n\n### Patches\nThis high severity exploit has been fixed on version `0.1.7a`.\n\n### Workarounds\nThere are no workarounds, bot owners must upgrade their relevant packages (Dashboard module and Dashboard webserver) in order to patch this issue\n\n### References\n- 99d88b8\n- a6b9785\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [Cog-Creators\/Red-Dashboard](https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/issues\/new\/choose)\n* Over on the official [Red Server](https:\/\/discord.gg\/red) or at the Third Party Server [Toxic Layer](https:\/\/discord.gg\/vQZTdB9)",
      "published_date":"2020-12-08",
      "chain_len":2,
      "project":"https:\/\/github.com\/Cog-Creators\/Red-Dashboard",
      "commit_href":"https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/commit\/99d88b840674674166ce005b784ae8e31e955ab1",
      "commit_sha":"99d88b840674674166ce005b784ae8e31e955ab1",
      "patch":"MULTI",
      "chain_ord":"['99d88b840674674166ce005b784ae8e31e955ab1', 'a6b9785338003ec87fb75305e7d1cc2d40c7ab91']",
      "before_first_fix_commit":"{'261f00f52bbfee4db67f624fd7409bf08124a6c4'}",
      "last_fix_commit":"a6b9785338003ec87fb75305e7d1cc2d40c7ab91",
      "chain_ord_pos":1.0,
      "commit_datetime":"11\/30\/2020, 11:49:18",
      "message":"Fix unformatted HTML",
      "author":"NeuroAssassin",
      "comments":null,
      "stats":"{'additions': 6, 'deletions': 2, 'total': 8}",
      "files":"{'reddash\/app\/home\/templates\/dashboard.html': {'additions': 6, 'deletions': 2, 'changes': 8, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/Cog-Creators\/Red-Dashboard\/raw\/99d88b840674674166ce005b784ae8e31e955ab1\/reddash%2Fapp%2Fhome%2Ftemplates%2Fdashboard.html', 'patch': '@@ -72,6 +72,7 @@ <h1>{{ _(\\'Loading servers...\\') }}<\/h1>\\n                 } else {\\r\\n                     var base_guild_url = \"{{ url_for(\\'home_blueprint.guild\\', guild=\\'123456789123456789\\') }}\"\\r\\n                     $(\"#serverrow\").html(\"\")\\r\\n+                    let counter = 0\\r\\n                     for (let g of json.data) {\\r\\n                         var current_guild_url = base_guild_url.replace(\"123456789123456789\", g.id)\\r\\n                         $(\"#serverrow\").append(`\\r\\n@@ -80,13 +81,16 @@ <h1>{{ _(\\'Loading servers...\\') }}<\/h1>\\n                                     <div class=\"card h-100\" onmouseover=\"playGif(this)\" onmouseout=\"stopGif(this)\">\\r\\n                                         <img class=\"card-img-top\" src=\"${g.icon}png\" alt=\"Card image cap\" data-src-url=\"${g.icon}\" data-is-animated=${g.animated}>\\r\\n                                         <div class=\"card-body\">\\r\\n-                                            <h5 class=\"card-title\">${g.name}<\/h5>\\r\\n-                                            <p class=\"card-text\">Owner: ${g.owner}<\/p>\\r\\n+                                            <h5 class=\"card-title\" id=\"guild-counter-${counter}\">Loading...<\/h5>\\r\\n+                                            <p class=\"card-text\" id=\"owner-counter-${counter}\">Owner: Loading...<\/p>\\r\\n                                         <\/div>\\r\\n                                     <\/div>\\r\\n                                 <\/a>\\r\\n                             <\/div>\\r\\n                         `)\\r\\n+                        $(`#guild-counter-${counter}`).text(g.name)\\r\\n+                        $(`#owner-counter-${counter}`).text(g.owner)\\r\\n+                        counter += 1\\r\\n                     }\\r\\n                 }\\r\\n             }'}}",
      "message_norm":"fix unformatted html",
      "language":"en",
      "entities":"[('fix', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['reddash\/app\/home\/templates\/dashboard.html'])",
      "num_files":1.0,
      "patch_content":"From 99d88b840674674166ce005b784ae8e31e955ab1 Mon Sep 17 00:00:00 2001\nFrom: NeuroAssassin <42872277+NeuroAssassin@users.noreply.github.com>\nDate: Mon, 30 Nov 2020 11:49:18 +0000\nSubject: [PATCH] Fix unformatted HTML\n\n---\n reddash\/app\/home\/templates\/dashboard.html | 8 ++++++--\n 1 file changed, 6 insertions(+), 2 deletions(-)\n\ndiff --git a\/reddash\/app\/home\/templates\/dashboard.html b\/reddash\/app\/home\/templates\/dashboard.html\nindex afdfbc5..9574226 100755\n--- a\/reddash\/app\/home\/templates\/dashboard.html\n+++ b\/reddash\/app\/home\/templates\/dashboard.html\n@@ -72,6 +72,7 @@ <h1>{{ _('Loading servers...') }}<\/h1>\n                 } else {\r\n                     var base_guild_url = \"{{ url_for('home_blueprint.guild', guild='123456789123456789') }}\"\r\n                     $(\"#serverrow\").html(\"\")\r\n+                    let counter = 0\r\n                     for (let g of json.data) {\r\n                         var current_guild_url = base_guild_url.replace(\"123456789123456789\", g.id)\r\n                         $(\"#serverrow\").append(`\r\n@@ -80,13 +81,16 @@ <h1>{{ _('Loading servers...') }}<\/h1>\n                                     <div class=\"card h-100\" onmouseover=\"playGif(this)\" onmouseout=\"stopGif(this)\">\r\n                                         <img class=\"card-img-top\" src=\"${g.icon}png\" alt=\"Card image cap\" data-src-url=\"${g.icon}\" data-is-animated=${g.animated}>\r\n                                         <div class=\"card-body\">\r\n-                                            <h5 class=\"card-title\">${g.name}<\/h5>\r\n-                                            <p class=\"card-text\">Owner: ${g.owner}<\/p>\r\n+                                            <h5 class=\"card-title\" id=\"guild-counter-${counter}\">Loading...<\/h5>\r\n+                                            <p class=\"card-text\" id=\"owner-counter-${counter}\">Owner: Loading...<\/p>\r\n                                         <\/div>\r\n                                     <\/div>\r\n                                 <\/a>\r\n                             <\/div>\r\n                         `)\r\n+                        $(`#guild-counter-${counter}`).text(g.name)\r\n+                        $(`#owner-counter-${counter}`).text(g.owner)\r\n+                        counter += 1\r\n                     }\r\n                 }\r\n             }",
      "code_diff":"@@ -72,6 +72,7 @@ <h1>{{ _('Loading servers...') }}<\/h1>\n                 } else {\n                     var base_guild_url = \"{{ url_for('home_blueprint.guild', guild='123456789123456789') }}\"\n                     $(\"#serverrow\").html(\"\")\n+                    let counter = 0\n                     for (let g of json.data) {\n                         var current_guild_url = base_guild_url.replace(\"123456789123456789\", g.id)\n                         $(\"#serverrow\").append(`\n@@ -80,13 +81,16 @@ <h1>{{ _('Loading servers...') }}<\/h1>\n                                     <div class=\"card h-100\" onmouseover=\"playGif(this)\" onmouseout=\"stopGif(this)\">\n                                         <img class=\"card-img-top\" src=\"${g.icon}png\" alt=\"Card image cap\" data-src-url=\"${g.icon}\" data-is-animated=${g.animated}>\n                                         <div class=\"card-body\">\n-                                            <h5 class=\"card-title\">${g.name}<\/h5>\n-                                            <p class=\"card-text\">Owner: ${g.owner}<\/p>\n+                                            <h5 class=\"card-title\" id=\"guild-counter-${counter}\">Loading...<\/h5>\n+                                            <p class=\"card-text\" id=\"owner-counter-${counter}\">Owner: Loading...<\/p>\n                                         <\/div>\n                                     <\/div>\n                                 <\/a>\n                             <\/div>\n                         `)\n+                        $(`#guild-counter-${counter}`).text(g.name)\n+                        $(`#owner-counter-${counter}`).text(g.owner)\n+                        counter += 1\n                     }\n                 }\n             }"
    },
    {
      "index":136,
      "vuln_id":"GHSA-c53x-wwx2-pg96",
      "cwe_id":"{'CWE-79'}",
      "score":6.5,
      "chain":"{'https:\/\/github.com\/bersLucas\/liljs\/commit\/779c0dcd8aba434a1c94db7d1d2d990a629f9a6c'}",
      "dataset":"osv",
      "summary":"Cross-Site Scripting in @berslucas\/liljs Versions of  `@berslucas\/liljs` prior to 1.0.2 are vulnerable to Cross-Site Scripting (XSS). The package uses the unsafe `innerHTML` function without sanitizing input, which may allow attackers to execute arbitrary JavaScript on the victim's browser.\n\n\n## Recommendation\n\nUpgrade to version 1.0.2 or later.",
      "published_date":"2020-09-03",
      "chain_len":1,
      "project":"https:\/\/github.com\/bersLucas\/liljs",
      "commit_href":"https:\/\/github.com\/bersLucas\/liljs\/commit\/779c0dcd8aba434a1c94db7d1d2d990a629f9a6c",
      "commit_sha":"779c0dcd8aba434a1c94db7d1d2d990a629f9a6c",
      "patch":"SINGLE",
      "chain_ord":"['779c0dcd8aba434a1c94db7d1d2d990a629f9a6c']",
      "before_first_fix_commit":"{'bc0919e0031e6e6aa99be9793a6a9afa8ad2e5b1'}",
      "last_fix_commit":"779c0dcd8aba434a1c94db7d1d2d990a629f9a6c",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/10\/2019, 03:29:54",
      "message":"Use textContent over innerHTML so you can bind untrusted text values\nwithout the possibility of an XSS attack.",
      "author":"Cody Mikol",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'src\/liljs.js': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/bersLucas\/liljs\/raw\/779c0dcd8aba434a1c94db7d1d2d990a629f9a6c\/src%2Fliljs.js', 'patch': '@@ -21,7 +21,7 @@ const liljs = (elem, data = {}) => {\\n      * @param {String} property Name of the property to render\\n      * @param {String} value (Optional) A value to use instead of a property (used in lil-list-text)\\n      *\/\\n-    const setText = (elem, property, value) => elem.innerHTML = value || state[property].value;\\n+    const setText = (elem, property, value) => elem.textContent = value || state[property].value;\\n \\n     \/** Set style helper function\\n      * @function setStyle\\n@@ -43,7 +43,7 @@ const liljs = (elem, data = {}) => {\\n      *\/\\n     const setList = (elem, property) => {\\n       \/\/TODO: Find a way to update without clearing lists\\n-      elem.innerHTML = \"\";\\n+      elem.textContent = \"\";\\n       state[property].value.forEach(value => {\\n         let clone = document.importNode(state[property].template.content, true);\\n         clone.querySelectorAll(\"[lil-list-text]\").forEach(node => {'}}",
      "message_norm":"use textcontent over innerhtml so you can bind untrusted text values\nwithout the possibility of an xss attack.",
      "language":"en",
      "entities":"[('untrusted', 'SECWORD', ''), ('xss', 'SECWORD', ''), ('attack', 'SECWORD', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/liljs.js'])",
      "num_files":1.0,
      "patch_content":"From 779c0dcd8aba434a1c94db7d1d2d990a629f9a6c Mon Sep 17 00:00:00 2001\nFrom: Cody Mikol <codymikol@gmail.com>\nDate: Sat, 9 Feb 2019 22:29:54 -0500\nSubject: [PATCH] Use textContent over innerHTML so you can bind untrusted text\n values without the possibility of an XSS attack.\n\n---\n src\/liljs.js | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/liljs.js b\/src\/liljs.js\nindex cdacf36..1fb18b8 100644\n--- a\/src\/liljs.js\n+++ b\/src\/liljs.js\n@@ -21,7 +21,7 @@ const liljs = (elem, data = {}) => {\n      * @param {String} property Name of the property to render\n      * @param {String} value (Optional) A value to use instead of a property (used in lil-list-text)\n      *\/\n-    const setText = (elem, property, value) => elem.innerHTML = value || state[property].value;\n+    const setText = (elem, property, value) => elem.textContent = value || state[property].value;\n \n     \/** Set style helper function\n      * @function setStyle\n@@ -43,7 +43,7 @@ const liljs = (elem, data = {}) => {\n      *\/\n     const setList = (elem, property) => {\n       \/\/TODO: Find a way to update without clearing lists\n-      elem.innerHTML = \"\";\n+      elem.textContent = \"\";\n       state[property].value.forEach(value => {\n         let clone = document.importNode(state[property].template.content, true);\n         clone.querySelectorAll(\"[lil-list-text]\").forEach(node => {",
      "code_diff":"@@ -21,7 +21,7 @@ const liljs = (elem, data = {}) => {\n      * @param {String} property Name of the property to render\n      * @param {String} value (Optional) A value to use instead of a property (used in lil-list-text)\n      *\/\n-    const setText = (elem, property, value) => elem.innerHTML = value || state[property].value;\n+    const setText = (elem, property, value) => elem.textContent = value || state[property].value;\n \n     \/** Set style helper function\n      * @function setStyle\n@@ -43,7 +43,7 @@ const liljs = (elem, data = {}) => {\n      *\/\n     const setList = (elem, property) => {\n       \/\/TODO: Find a way to update without clearing lists\n-      elem.innerHTML = \"\";\n+      elem.textContent = \"\";\n       state[property].value.forEach(value => {\n         let clone = document.importNode(state[property].template.content, true);\n         clone.querySelectorAll(\"[lil-list-text]\").forEach(node => {"
    },
    {
      "index":137,
      "vuln_id":"GHSA-vhm6-gw82-6f8j",
      "cwe_id":"{'CWE-79'}",
      "score":4.8,
      "chain":"{'https:\/\/github.com\/librenms\/librenms\/commit\/703745d0ed3948623153117d761ce48514e2f281'}",
      "dataset":"osv",
      "summary":"Cross site scripting in LibreNMS LibreNMS prior to version 22.2.2 is vulnerable to cross-site scripting.",
      "published_date":"2022-02-28",
      "chain_len":1,
      "project":"https:\/\/github.com\/librenms\/librenms",
      "commit_href":"https:\/\/github.com\/librenms\/librenms\/commit\/703745d0ed3948623153117d761ce48514e2f281",
      "commit_sha":"703745d0ed3948623153117d761ce48514e2f281",
      "patch":"SINGLE",
      "chain_ord":"['703745d0ed3948623153117d761ce48514e2f281']",
      "before_first_fix_commit":"{'09929bd6865e54034db591ea37f5548406f5e716'}",
      "last_fix_commit":"703745d0ed3948623153117d761ce48514e2f281",
      "chain_ord_pos":1.0,
      "commit_datetime":"02\/22\/2022, 14:28:31",
      "message":"Resolved XSS issue from alert rule list modal (#13805)",
      "author":"Neil Lathwood",
      "comments":null,
      "stats":"{'additions': 1, 'deletions': 1, 'total': 2}",
      "files":"{'includes\/html\/modal\/alert_rule_list.inc.php': {'additions': 1, 'deletions': 1, 'changes': 2, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/librenms\/librenms\/raw\/703745d0ed3948623153117d761ce48514e2f281\/includes%2Fhtml%2Fmodal%2Falert_rule_list.inc.php', 'patch': '@@ -62,7 +62,7 @@\\n                             echo \"\\n                                 <tr>\\n                                     <td>{$rule[\\'name\\']}<\/td>\\n-                                    <td><i>\" . htmlentities($rule_display) . \"<\/i><\/td>\\n+                                    <td><i>\" . htmlentities(strip_tags($rule_display)) . \"<\/i><\/td>\\n                                     <td>{$rule[\\'severity\\']}<\/td>\\n                                     <td>{$rule[\\'id\\']}<\/td>\\n                                 <\/tr>'}}",
      "message_norm":"resolved xss issue from alert rule list modal (#13805)",
      "language":"no",
      "entities":"[('xss', 'SECWORD', ''), ('issue', 'FLAW', ''), ('#13805', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['includes\/html\/modal\/alert_rule_list.inc.php'])",
      "num_files":1.0,
      "patch_content":"From 703745d0ed3948623153117d761ce48514e2f281 Mon Sep 17 00:00:00 2001\nFrom: Neil Lathwood <gh+n@laf.io>\nDate: Tue, 22 Feb 2022 14:28:31 +0000\nSubject: [PATCH] Resolved XSS issue from alert rule list modal (#13805)\n\n---\n includes\/html\/modal\/alert_rule_list.inc.php | 2 +-\n 1 file changed, 1 insertion(+), 1 deletion(-)\n\ndiff --git a\/includes\/html\/modal\/alert_rule_list.inc.php b\/includes\/html\/modal\/alert_rule_list.inc.php\nindex ad6a50c73658..aa604c260ea4 100644\n--- a\/includes\/html\/modal\/alert_rule_list.inc.php\n+++ b\/includes\/html\/modal\/alert_rule_list.inc.php\n@@ -62,7 +62,7 @@\n                             echo \"\n                                 <tr>\n                                     <td>{$rule['name']}<\/td>\n-                                    <td><i>\" . htmlentities($rule_display) . \"<\/i><\/td>\n+                                    <td><i>\" . htmlentities(strip_tags($rule_display)) . \"<\/i><\/td>\n                                     <td>{$rule['severity']}<\/td>\n                                     <td>{$rule['id']}<\/td>\n                                 <\/tr>",
      "code_diff":"@@ -62,7 +62,7 @@\n                             echo \"\n                                 <tr>\n                                     <td>{$rule['name']}<\/td>\n-                                    <td><i>\" . htmlentities($rule_display) . \"<\/i><\/td>\n+                                    <td><i>\" . htmlentities(strip_tags($rule_display)) . \"<\/i><\/td>\n                                     <td>{$rule['severity']}<\/td>\n                                     <td>{$rule['id']}<\/td>\n                                 <\/tr>"
    },
    {
      "index":138,
      "vuln_id":"GHSA-mw75-qvfr-hpmr",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/star7th\/showdoc\/commit\/830c89a4c2c5fd0dd491422bf8e97b4eb5713f55'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in ShowDoc ShowDoc is vulnerable to stored cross-site scripting through file upload in versions 2.10.3 and prior. A patch is available and anticipated to be part of version 2.10.4.",
      "published_date":"2022-03-15",
      "chain_len":1,
      "project":"https:\/\/github.com\/star7th\/showdoc",
      "commit_href":"https:\/\/github.com\/star7th\/showdoc\/commit\/830c89a4c2c5fd0dd491422bf8e97b4eb5713f55",
      "commit_sha":"830c89a4c2c5fd0dd491422bf8e97b4eb5713f55",
      "patch":"SINGLE",
      "chain_ord":"['830c89a4c2c5fd0dd491422bf8e97b4eb5713f55']",
      "before_first_fix_commit":"{'da56d1d68702a7a80506245c251e58eaf84cff27', '42c0d9813df3035728b36116a6ce9116e6fa8ed3'}",
      "last_fix_commit":"830c89a4c2c5fd0dd491422bf8e97b4eb5713f55",
      "chain_ord_pos":1.0,
      "commit_datetime":"03\/13\/2022, 08:03:16",
      "message":"Merge pull request #1628 from ajaysenr\/master\n\nUpdate AttachmentModel.class.php",
      "author":"star7th",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 1, 'total': 3}",
      "files":"{'server\/Application\/Api\/Model\/AttachmentModel.class.php': {'additions': 2, 'deletions': 1, 'changes': 3, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/star7th\/showdoc\/raw\/830c89a4c2c5fd0dd491422bf8e97b4eb5713f55\/server%2FApplication%2FApi%2FModel%2FAttachmentModel.class.php', 'patch': '@@ -303,6 +303,7 @@ public function isDangerFilename($filename){\\n \\t\\t\\t|| $isDangerStr($filename , \".shtm\")\\n \\t\\t\\t|| $isDangerStr($filename , \"%\")\\n \\t\\t\\t|| $isDangerStr($filename , \".xml\")\\n+\\t\\t\\t|| $isDangerStr($filename , \".xxhtml\")\\n \\t\\t) {\\n \\t\\t\\treturn true;\\n \\t\\t}\\n@@ -312,4 +313,4 @@ public function isDangerFilename($filename){\\n \\n \\n \\n-}\\n\\\\ No newline at end of file\\n+}'}}",
      "message_norm":"merge pull request #1628 from ajaysenr\/master\n\nupdate attachmentmodel.class.php",
      "language":"en",
      "entities":"[('#1628', 'ISSUE', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['server\/Application\/Api\/Model\/AttachmentModel.class.php'])",
      "num_files":1.0,
      "patch_content":"From da56d1d68702a7a80506245c251e58eaf84cff27 Mon Sep 17 00:00:00 2001\nFrom: Ajaysen R <40132420+ajaysenr@users.noreply.github.com>\nDate: Sun, 13 Mar 2022 07:15:43 +0000\nSubject: [PATCH] Update AttachmentModel.class.php\n\n---\n server\/Application\/Api\/Model\/AttachmentModel.class.php | 3 ++-\n 1 file changed, 2 insertions(+), 1 deletion(-)\n\ndiff --git a\/server\/Application\/Api\/Model\/AttachmentModel.class.php b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\nindex 32fb24799..3dac201f4 100644\n--- a\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n+++ b\/server\/Application\/Api\/Model\/AttachmentModel.class.php\n@@ -303,6 +303,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".shtm\")\n \t\t\t|| $isDangerStr($filename , \"%\")\n \t\t\t|| $isDangerStr($filename , \".xml\")\n+\t\t\t|| $isDangerStr($filename , \".xxhtml\")\n \t\t) {\n \t\t\treturn true;\n \t\t}\n@@ -312,4 +313,4 @@ public function isDangerFilename($filename){\n \n \n \n-}\n\\ No newline at end of file\n+}",
      "code_diff":"@@ -303,6 +303,7 @@ public function isDangerFilename($filename){\n \t\t\t|| $isDangerStr($filename , \".shtm\")\n \t\t\t|| $isDangerStr($filename , \"%\")\n \t\t\t|| $isDangerStr($filename , \".xml\")\n+\t\t\t|| $isDangerStr($filename , \".xxhtml\")\n \t\t) {\n \t\t\treturn true;\n \t\t}\n@@ -312,4 +313,4 @@ public function isDangerFilename($filename){\n \n \n \n-}\n\\ No newline at end of file\n+}"
    },
    {
      "index":139,
      "vuln_id":"GHSA-h3vq-wv8j-36gw",
      "cwe_id":"{'CWE-79'}",
      "score":0.0,
      "chain":"{'https:\/\/github.com\/LLK\/scratch-svg-renderer\/commit\/7c74ec7de3254143ec3c557677f5355a90a3d07f'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in Scratch-Svg-Renderer A DOM-based cross-site scripting (XSS) vulnerability in Scratch-Svg-Renderer v0.2.0 allows attackers to execute arbitrary web scripts or HTML via a crafted sb3 file.",
      "published_date":"2022-01-08",
      "chain_len":1,
      "project":"https:\/\/github.com\/LLK\/scratch-svg-renderer",
      "commit_href":"https:\/\/github.com\/LLK\/scratch-svg-renderer\/commit\/7c74ec7de3254143ec3c557677f5355a90a3d07f",
      "commit_sha":"7c74ec7de3254143ec3c557677f5355a90a3d07f",
      "patch":"SINGLE",
      "chain_ord":"['7c74ec7de3254143ec3c557677f5355a90a3d07f']",
      "before_first_fix_commit":"{'d010f2d0edc3ab87ecabb27b9160f91317aa2722'}",
      "last_fix_commit":"7c74ec7de3254143ec3c557677f5355a90a3d07f",
      "chain_ord_pos":1.0,
      "commit_datetime":"10\/09\/2020, 19:50:27",
      "message":"Remove lots of event handlers",
      "author":"Eric Rosenbaum",
      "comments":null,
      "stats":"{'additions': 15, 'deletions': 2, 'total': 17}",
      "files":"{'src\/fixup-svg-string.js': {'additions': 15, 'deletions': 2, 'changes': 17, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/LLK\/scratch-svg-renderer\/raw\/7c74ec7de3254143ec3c557677f5355a90a3d07f\/src%2Ffixup-svg-string.js', 'patch': '@@ -50,8 +50,21 @@ module.exports = function (svgString) {\\n     \/\/ Empty script tags and javascript executing\\n     svgString = svgString.replace(\/<script[\\\\s\\\\S]*>[\\\\s\\\\S]*<\\\\\/script>\/, \\'<script><\/script>\\');\\n     \\n-    \/\/ Remove error handlers\\n-    svgString = svgString.replace(\/onerror=[\\\\s\\\\S]*[\\'\"].*?[\\'\"]\/i, \\'\\');\\n+    \/\/ Remove event handlers\\n+    const eventNames = [\\n+        \\'onbegin\\', \\'onend\\', \\'onrepeat\\', \\'onabort\\', \\'onerror\\', \\'onresize\\', \\'onscroll\\', \\'onunload\\', \\'oncopy\\',\\n+        \\'oncut\\', \\'onpaste\\', \\'oncancel\\', \\'oncanplay\\', \\'oncanplaythrough\\', \\'onchange\\', \\'onclick\\', \\'onclose\\',\\n+        \\'oncuechange\\', \\'ondblclick\\', \\'ondrag\\', \\'ondragend\\', \\'ondragenter\\', \\'ondragexit\\', \\'ondragleave\\',\\n+        \\'ondragover\\', \\'ondragstart\\', \\'ondrop\\', \\'ondurationchange\\', \\'onloadeddata\\', \\'onloadedmetadata\\',\\n+        \\'onloadstart\\', \\'onmousedown\\', \\'onmouseenter\\', \\'onmouseleave\\', \\'onmousemove\\',\\n+        \\'onemptied\\', \\'onended\\', \\'onerror\\', \\'onfocus\\', \\'oninput\\', \\'oninvalid\\', \\'onkeydown\\', \\'onkeypress\\',\\n+        \\'onkeyup\\', \\'onload\\', \\'onmouseout\\', \\'onmouseover\\', \\'onmouseup\\', \\'onmousewheel\\', \\'onpause\\', \\'onplay\\',\\n+        \\'onplaying\\', \\'onprogress\\', \\'onratechange\\', \\'onreset\\', \\'onresize\\', \\'onscroll\\', \\'onseeked\\', \\'onseeking\\',\\n+        \\'onselect\\', \\'onshow\\', \\'onstalled\\', \\'onsubmit\\', \\'onsuspend\\', \\'ontimeupdate\\', \\'ontoggle\\', \\'onvolumechange\\',\\n+        \\'onwaiting\\', \\'onactivate\\', \\'onfocusin\\', \\'onfocusout\\'\\n+    ];\\n+    const eventsRegex = new RegExp(`(${eventNames.join(\\'|\\')})\\\\\\\\s*=\\\\\\\\s*[\\'\"].*[\\'\"]`, \\'i\\');\\n+    svgString = svgString.replace(eventsRegex, \\'\\');\\n \\n     return svgString;\\n };'}}",
      "message_norm":"remove lots of event handlers",
      "language":"en",
      "entities":"[('remove', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/fixup-svg-string.js'])",
      "num_files":1.0,
      "patch_content":"From 7c74ec7de3254143ec3c557677f5355a90a3d07f Mon Sep 17 00:00:00 2001\nFrom: Eric Rosenbaum <eric.rosenbaum@gmail.com>\nDate: Fri, 9 Oct 2020 15:50:27 -0400\nSubject: [PATCH] Remove lots of event handlers\n\n---\n src\/fixup-svg-string.js | 17 +++++++++++++++--\n 1 file changed, 15 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/fixup-svg-string.js b\/src\/fixup-svg-string.js\nindex 41ea393d..60e7b055 100644\n--- a\/src\/fixup-svg-string.js\n+++ b\/src\/fixup-svg-string.js\n@@ -50,8 +50,21 @@ module.exports = function (svgString) {\n     \/\/ Empty script tags and javascript executing\n     svgString = svgString.replace(\/<script[\\s\\S]*>[\\s\\S]*<\\\/script>\/, '<script><\/script>');\n     \n-    \/\/ Remove error handlers\n-    svgString = svgString.replace(\/onerror=[\\s\\S]*['\"].*?['\"]\/i, '');\n+    \/\/ Remove event handlers\n+    const eventNames = [\n+        'onbegin', 'onend', 'onrepeat', 'onabort', 'onerror', 'onresize', 'onscroll', 'onunload', 'oncopy',\n+        'oncut', 'onpaste', 'oncancel', 'oncanplay', 'oncanplaythrough', 'onchange', 'onclick', 'onclose',\n+        'oncuechange', 'ondblclick', 'ondrag', 'ondragend', 'ondragenter', 'ondragexit', 'ondragleave',\n+        'ondragover', 'ondragstart', 'ondrop', 'ondurationchange', 'onloadeddata', 'onloadedmetadata',\n+        'onloadstart', 'onmousedown', 'onmouseenter', 'onmouseleave', 'onmousemove',\n+        'onemptied', 'onended', 'onerror', 'onfocus', 'oninput', 'oninvalid', 'onkeydown', 'onkeypress',\n+        'onkeyup', 'onload', 'onmouseout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onpause', 'onplay',\n+        'onplaying', 'onprogress', 'onratechange', 'onreset', 'onresize', 'onscroll', 'onseeked', 'onseeking',\n+        'onselect', 'onshow', 'onstalled', 'onsubmit', 'onsuspend', 'ontimeupdate', 'ontoggle', 'onvolumechange',\n+        'onwaiting', 'onactivate', 'onfocusin', 'onfocusout'\n+    ];\n+    const eventsRegex = new RegExp(`(${eventNames.join('|')})\\\\s*=\\\\s*['\"].*['\"]`, 'i');\n+    svgString = svgString.replace(eventsRegex, '');\n \n     return svgString;\n };",
      "code_diff":"@@ -50,8 +50,21 @@ module.exports = function (svgString) {\n     \/\/ Empty script tags and javascript executing\n     svgString = svgString.replace(\/<script[\\s\\S]*>[\\s\\S]*<\\\/script>\/, '<script><\/script>');\n     \n-    \/\/ Remove error handlers\n-    svgString = svgString.replace(\/onerror=[\\s\\S]*['\"].*?['\"]\/i, '');\n+    \/\/ Remove event handlers\n+    const eventNames = [\n+        'onbegin', 'onend', 'onrepeat', 'onabort', 'onerror', 'onresize', 'onscroll', 'onunload', 'oncopy',\n+        'oncut', 'onpaste', 'oncancel', 'oncanplay', 'oncanplaythrough', 'onchange', 'onclick', 'onclose',\n+        'oncuechange', 'ondblclick', 'ondrag', 'ondragend', 'ondragenter', 'ondragexit', 'ondragleave',\n+        'ondragover', 'ondragstart', 'ondrop', 'ondurationchange', 'onloadeddata', 'onloadedmetadata',\n+        'onloadstart', 'onmousedown', 'onmouseenter', 'onmouseleave', 'onmousemove',\n+        'onemptied', 'onended', 'onerror', 'onfocus', 'oninput', 'oninvalid', 'onkeydown', 'onkeypress',\n+        'onkeyup', 'onload', 'onmouseout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onpause', 'onplay',\n+        'onplaying', 'onprogress', 'onratechange', 'onreset', 'onresize', 'onscroll', 'onseeked', 'onseeking',\n+        'onselect', 'onshow', 'onstalled', 'onsubmit', 'onsuspend', 'ontimeupdate', 'ontoggle', 'onvolumechange',\n+        'onwaiting', 'onactivate', 'onfocusin', 'onfocusout'\n+    ];\n+    const eventsRegex = new RegExp(`(${eventNames.join('|')})\\\\s*=\\\\s*['\"].*['\"]`, 'i');\n+    svgString = svgString.replace(eventsRegex, '');\n \n     return svgString;\n };"
    },
    {
      "index":140,
      "vuln_id":"GHSA-q6mp-562x-ggvv",
      "cwe_id":"{'CWE-79'}",
      "score":5.4,
      "chain":"{'https:\/\/github.com\/microweber\/microweber\/commit\/70b46e231e7b2c113666745a0ab6de9a8b7ef08e'}",
      "dataset":"osv",
      "summary":"Cross-site Scripting in microweber Cross-site Scripting (XSS) - Stored in GitHub repository microweber\/microweber prior to 1.2.19.",
      "published_date":"2022-07-05",
      "chain_len":1,
      "project":"https:\/\/github.com\/microweber\/microweber",
      "commit_href":"https:\/\/github.com\/microweber\/microweber\/commit\/70b46e231e7b2c113666745a0ab6de9a8b7ef08e",
      "commit_sha":"70b46e231e7b2c113666745a0ab6de9a8b7ef08e",
      "patch":"SINGLE",
      "chain_ord":"['70b46e231e7b2c113666745a0ab6de9a8b7ef08e']",
      "before_first_fix_commit":"{'b7663f9af0f4ab777275ffe7a3b77958f98c81fb'}",
      "last_fix_commit":"70b46e231e7b2c113666745a0ab6de9a8b7ef08e",
      "chain_ord_pos":1.0,
      "commit_datetime":"07\/04\/2022, 08:02:08",
      "message":"update",
      "author":"Peter Ivanov",
      "comments":null,
      "stats":"{'additions': 2, 'deletions': 2, 'total': 4}",
      "files":"{'src\/MicroweberPackages\/Utils\/System\/Files.php': {'additions': 2, 'deletions': 2, 'changes': 4, 'status': 'modified', 'raw_url': 'https:\/\/github.com\/microweber\/microweber\/raw\/70b46e231e7b2c113666745a0ab6de9a8b7ef08e\/src%2FMicroweberPackages%2FUtils%2FSystem%2FFiles.php', 'patch': \"@@ -1154,11 +1154,11 @@ function get_allowed_files_extensions_for_upload($fileTypes = 'images', $returnA\\n                 break;\\n             case 'file':\\n             case 'files':\\n-                $are_allowed .= ',css,json,zip,gzip,csv,7z';\\n+                $are_allowed .= ',css,json,zip,gzip,psd,csv,7z';\\n                 break;\\n             case 'documents':\\n             case 'doc':\\n-                $are_allowed .= ',doc,docx,pdf,odt,pages,rtf,txt,pps,ppt,pptx,xls,xlsx';\\n+                $are_allowed .= ',doc,docx,pdf,odt,rtf,txt,pps,ppt,pptx,xls,xlsx';\\n                 break;\\n             case 'archives':\\n             case 'arc':\"}}",
      "message_norm":"update",
      "language":"ro",
      "entities":"[('update', 'ACTION', '')]",
      "classification_level_1":null,
      "classification_level_2":null,
      "list_files":"dict_keys(['src\/MicroweberPackages\/Utils\/System\/Files.php'])",
      "num_files":1.0,
      "patch_content":"From 70b46e231e7b2c113666745a0ab6de9a8b7ef08e Mon Sep 17 00:00:00 2001\nFrom: Peter Ivanov <peter@microweber.com>\nDate: Mon, 4 Jul 2022 11:02:08 +0300\nSubject: [PATCH] update\n\n---\n src\/MicroweberPackages\/Utils\/System\/Files.php | 4 ++--\n 1 file changed, 2 insertions(+), 2 deletions(-)\n\ndiff --git a\/src\/MicroweberPackages\/Utils\/System\/Files.php b\/src\/MicroweberPackages\/Utils\/System\/Files.php\nindex ff10123e4f3..481fc4bc8df 100644\n--- a\/src\/MicroweberPackages\/Utils\/System\/Files.php\n+++ b\/src\/MicroweberPackages\/Utils\/System\/Files.php\n@@ -1154,11 +1154,11 @@ function get_allowed_files_extensions_for_upload($fileTypes = 'images', $returnA\n                 break;\n             case 'file':\n             case 'files':\n-                $are_allowed .= ',css,json,zip,gzip,csv,7z';\n+                $are_allowed .= ',css,json,zip,gzip,psd,csv,7z';\n                 break;\n             case 'documents':\n             case 'doc':\n-                $are_allowed .= ',doc,docx,pdf,odt,pages,rtf,txt,pps,ppt,pptx,xls,xlsx';\n+                $are_allowed .= ',doc,docx,pdf,odt,rtf,txt,pps,ppt,pptx,xls,xlsx';\n                 break;\n             case 'archives':\n             case 'arc':",
      "code_diff":"@@ -1154,11 +1154,11 @@ function get_allowed_files_extensions_for_upload($fileTypes = 'images', $returnA\n                 break;\n             case 'file':\n             case 'files':\n-                $are_allowed .= ',css,json,zip,gzip,csv,7z';\n+                $are_allowed .= ',css,json,zip,gzip,psd,csv,7z';\n                 break;\n             case 'documents':\n             case 'doc':\n-                $are_allowed .= ',doc,docx,pdf,odt,pages,rtf,txt,pps,ppt,pptx,xls,xlsx';\n+                $are_allowed .= ',doc,docx,pdf,odt,rtf,txt,pps,ppt,pptx,xls,xlsx';\n                 break;\n             case 'archives':\n             case 'arc':"
    }
  ]
}